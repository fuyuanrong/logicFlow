import { defineComponent as H_, ref as wd, provide as W_, onMounted as z_, createElementBlock as X_, openBlock as G_ } from "vue";
var Al, He, Fv, wi, Sd, $v, Gu, Hv, nc, Uu, Yu, wa = {}, Wv = [], U_ = /acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i, Cl = Array.isArray;
function Zr(t, e) {
  for (var n in e) t[n] = e[n];
  return t;
}
function rc(t) {
  t && t.parentNode && t.parentNode.removeChild(t);
}
function ae(t, e, n) {
  var r, i, o, a = {};
  for (o in e) o == "key" ? r = e[o] : o == "ref" ? i = e[o] : a[o] = e[o];
  if (arguments.length > 2 && (a.children = arguments.length > 3 ? Al.call(arguments, 2) : n), typeof t == "function" && t.defaultProps != null) for (o in t.defaultProps) a[o] === void 0 && (a[o] = t.defaultProps[o]);
  return Es(t, a, r, i, null);
}
function Es(t, e, n, r, i) {
  var o = { type: t, props: e, key: n, ref: r, __k: null, __: null, __b: 0, __e: null, __c: null, constructor: void 0, __v: i ?? ++Fv, __i: -1, __u: 0 };
  return i == null && He.vnode != null && He.vnode(o), o;
}
function Tl() {
  return { current: null };
}
function fo(t) {
  return t.children;
}
function Ye(t, e) {
  this.props = t, this.context = e;
}
function co(t, e) {
  if (e == null) return t.__ ? co(t.__, t.__i + 1) : null;
  for (var n; e < t.__k.length; e++) if ((n = t.__k[e]) != null && n.__e != null) return n.__e;
  return typeof t.type == "function" ? co(t) : null;
}
function zv(t) {
  var e, n;
  if ((t = t.__) != null && t.__c != null) {
    for (t.__e = t.__c.base = null, e = 0; e < t.__k.length; e++) if ((n = t.__k[e]) != null && n.__e != null) {
      t.__e = t.__c.base = n.__e;
      break;
    }
    return zv(t);
  }
}
function Od(t) {
  (!t.__d && (t.__d = !0) && wi.push(t) && !Rs.__r++ || Sd !== He.debounceRendering) && ((Sd = He.debounceRendering) || $v)(Rs);
}
function Rs() {
  var t, e, n, r, i, o, a, s;
  for (wi.sort(Gu); t = wi.shift(); ) t.__d && (e = wi.length, r = void 0, o = (i = (n = t).__v).__e, a = [], s = [], n.__P && ((r = Zr({}, i)).__v = i.__v + 1, He.vnode && He.vnode(r), ic(n.__P, r, i, n.__n, n.__P.namespaceURI, 32 & i.__u ? [o] : null, a, o ?? co(i), !!(32 & i.__u), s), r.__v = i.__v, r.__.__k[r.__i] = r, Uv(a, r, s), r.__e != o && zv(r)), wi.length > e && wi.sort(Gu));
  Rs.__r = 0;
}
function Xv(t, e, n, r, i, o, a, s, l, u, f) {
  var c, d, h, v, p, g, y = r && r.__k || Wv, m = e.length;
  for (l = Y_(n, e, y, l, m), c = 0; c < m; c++) (h = n.__k[c]) != null && (d = h.__i === -1 ? wa : y[h.__i] || wa, h.__i = c, g = ic(t, h, d, i, o, a, s, l, u, f), v = h.__e, h.ref && d.ref != h.ref && (d.ref && oc(d.ref, null, h), f.push(h.ref, h.__c || v, h)), p == null && v != null && (p = v), 4 & h.__u || d.__k === h.__k ? l = Gv(h, l, t) : typeof h.type == "function" && g !== void 0 ? l = g : v && (l = v.nextSibling), h.__u &= -7);
  return n.__e = p, l;
}
function Y_(t, e, n, r, i) {
  var o, a, s, l, u, f = n.length, c = f, d = 0;
  for (t.__k = new Array(i), o = 0; o < i; o++) (a = e[o]) != null && typeof a != "boolean" && typeof a != "function" ? (l = o + d, (a = t.__k[o] = typeof a == "string" || typeof a == "number" || typeof a == "bigint" || a.constructor == String ? Es(null, a, null, null, null) : Cl(a) ? Es(fo, { children: a }, null, null, null) : a.constructor === void 0 && a.__b > 0 ? Es(a.type, a.props, a.key, a.ref ? a.ref : null, a.__v) : a).__ = t, a.__b = t.__b + 1, s = null, (u = a.__i = V_(a, n, l, c)) !== -1 && (c--, (s = n[u]) && (s.__u |= 2)), s == null || s.__v === null ? (u == -1 && d--, typeof a.type != "function" && (a.__u |= 4)) : u != l && (u == l - 1 ? d-- : u == l + 1 ? d++ : (u > l ? d-- : d++, a.__u |= 4))) : t.__k[o] = null;
  if (c) for (o = 0; o < f; o++) (s = n[o]) != null && !(2 & s.__u) && (s.__e == r && (r = co(s)), Yv(s, s));
  return r;
}
function Gv(t, e, n) {
  var r, i;
  if (typeof t.type == "function") {
    for (r = t.__k, i = 0; r && i < r.length; i++) r[i] && (r[i].__ = t, e = Gv(r[i], e, n));
    return e;
  }
  t.__e != e && (e && t.type && !n.contains(e) && (e = co(t)), n.insertBefore(t.__e, e || null), e = t.__e);
  do
    e = e && e.nextSibling;
  while (e != null && e.nodeType == 8);
  return e;
}
function Ls(t, e) {
  return e = e || [], t == null || typeof t == "boolean" || (Cl(t) ? t.some(function(n) {
    Ls(n, e);
  }) : e.push(t)), e;
}
function V_(t, e, n, r) {
  var i, o, a = t.key, s = t.type, l = e[n];
  if (l === null || l && a == l.key && s === l.type && !(2 & l.__u)) return n;
  if (r > (l != null && !(2 & l.__u) ? 1 : 0)) for (i = n - 1, o = n + 1; i >= 0 || o < e.length; ) {
    if (i >= 0) {
      if ((l = e[i]) && !(2 & l.__u) && a == l.key && s === l.type) return i;
      i--;
    }
    if (o < e.length) {
      if ((l = e[o]) && !(2 & l.__u) && a == l.key && s === l.type) return o;
      o++;
    }
  }
  return -1;
}
function Ad(t, e, n) {
  e[0] == "-" ? t.setProperty(e, n ?? "") : t[e] = n == null ? "" : typeof n != "number" || U_.test(e) ? n : n + "px";
}
function qa(t, e, n, r, i) {
  var o;
  e: if (e == "style") if (typeof n == "string") t.style.cssText = n;
  else {
    if (typeof r == "string" && (t.style.cssText = r = ""), r) for (e in r) n && e in n || Ad(t.style, e, "");
    if (n) for (e in n) r && n[e] === r[e] || Ad(t.style, e, n[e]);
  }
  else if (e[0] == "o" && e[1] == "n") o = e != (e = e.replace(Hv, "$1")), e = e.toLowerCase() in t || e == "onFocusOut" || e == "onFocusIn" ? e.toLowerCase().slice(2) : e.slice(2), t.l || (t.l = {}), t.l[e + o] = n, n ? r ? n.u = r.u : (n.u = nc, t.addEventListener(e, o ? Yu : Uu, o)) : t.removeEventListener(e, o ? Yu : Uu, o);
  else {
    if (i == "http://www.w3.org/2000/svg") e = e.replace(/xlink(H|:h)/, "h").replace(/sName$/, "s");
    else if (e != "width" && e != "height" && e != "href" && e != "list" && e != "form" && e != "tabIndex" && e != "download" && e != "rowSpan" && e != "colSpan" && e != "role" && e != "popover" && e in t) try {
      t[e] = n ?? "";
      break e;
    } catch {
    }
    typeof n == "function" || (n == null || n === !1 && e[4] != "-" ? t.removeAttribute(e) : t.setAttribute(e, e == "popover" && n == 1 ? "" : n));
  }
}
function Cd(t) {
  return function(e) {
    if (this.l) {
      var n = this.l[e.type + t];
      if (e.t == null) e.t = nc++;
      else if (e.t < n.u) return;
      return n(He.event ? He.event(e) : e);
    }
  };
}
function ic(t, e, n, r, i, o, a, s, l, u) {
  var f, c, d, h, v, p, g, y, m, A, T, k, C, S, I, X, Q, ue = e.type;
  if (e.constructor !== void 0) return null;
  128 & n.__u && (l = !!(32 & n.__u), o = [s = e.__e = n.__e]), (f = He.__b) && f(e);
  e: if (typeof ue == "function") try {
    if (y = e.props, m = "prototype" in ue && ue.prototype.render, A = (f = ue.contextType) && r[f.__c], T = f ? A ? A.props.value : f.__ : r, n.__c ? g = (c = e.__c = n.__c).__ = c.__E : (m ? e.__c = c = new ue(y, T) : (e.__c = c = new Ye(y, T), c.constructor = ue, c.render = q_), A && A.sub(c), c.props = y, c.state || (c.state = {}), c.context = T, c.__n = r, d = c.__d = !0, c.__h = [], c._sb = []), m && c.__s == null && (c.__s = c.state), m && ue.getDerivedStateFromProps != null && (c.__s == c.state && (c.__s = Zr({}, c.__s)), Zr(c.__s, ue.getDerivedStateFromProps(y, c.__s))), h = c.props, v = c.state, c.__v = e, d) m && ue.getDerivedStateFromProps == null && c.componentWillMount != null && c.componentWillMount(), m && c.componentDidMount != null && c.__h.push(c.componentDidMount);
    else {
      if (m && ue.getDerivedStateFromProps == null && y !== h && c.componentWillReceiveProps != null && c.componentWillReceiveProps(y, T), !c.__e && (c.shouldComponentUpdate != null && c.shouldComponentUpdate(y, c.__s, T) === !1 || e.__v == n.__v)) {
        for (e.__v != n.__v && (c.props = y, c.state = c.__s, c.__d = !1), e.__e = n.__e, e.__k = n.__k, e.__k.some(function(de) {
          de && (de.__ = e);
        }), k = 0; k < c._sb.length; k++) c.__h.push(c._sb[k]);
        c._sb = [], c.__h.length && a.push(c);
        break e;
      }
      c.componentWillUpdate != null && c.componentWillUpdate(y, c.__s, T), m && c.componentDidUpdate != null && c.__h.push(function() {
        c.componentDidUpdate(h, v, p);
      });
    }
    if (c.context = T, c.props = y, c.__P = t, c.__e = !1, C = He.__r, S = 0, m) {
      for (c.state = c.__s, c.__d = !1, C && C(e), f = c.render(c.props, c.state, c.context), I = 0; I < c._sb.length; I++) c.__h.push(c._sb[I]);
      c._sb = [];
    } else do
      c.__d = !1, C && C(e), f = c.render(c.props, c.state, c.context), c.state = c.__s;
    while (c.__d && ++S < 25);
    c.state = c.__s, c.getChildContext != null && (r = Zr(Zr({}, r), c.getChildContext())), m && !d && c.getSnapshotBeforeUpdate != null && (p = c.getSnapshotBeforeUpdate(h, v)), s = Xv(t, Cl(X = f != null && f.type === fo && f.key == null ? f.props.children : f) ? X : [X], e, n, r, i, o, a, s, l, u), c.base = e.__e, e.__u &= -161, c.__h.length && a.push(c), g && (c.__E = c.__ = null);
  } catch (de) {
    if (e.__v = null, l || o != null) if (de.then) {
      for (e.__u |= l ? 160 : 128; s && s.nodeType == 8 && s.nextSibling; ) s = s.nextSibling;
      o[o.indexOf(s)] = null, e.__e = s;
    } else for (Q = o.length; Q--; ) rc(o[Q]);
    else e.__e = n.__e, e.__k = n.__k;
    He.__e(de, e, n);
  }
  else o == null && e.__v == n.__v ? (e.__k = n.__k, e.__e = n.__e) : s = e.__e = K_(n.__e, e, n, r, i, o, a, l, u);
  return (f = He.diffed) && f(e), 128 & e.__u ? void 0 : s;
}
function Uv(t, e, n) {
  for (var r = 0; r < n.length; r++) oc(n[r], n[++r], n[++r]);
  He.__c && He.__c(e, t), t.some(function(i) {
    try {
      t = i.__h, i.__h = [], t.some(function(o) {
        o.call(i);
      });
    } catch (o) {
      He.__e(o, i.__v);
    }
  });
}
function K_(t, e, n, r, i, o, a, s, l) {
  var u, f, c, d, h, v, p, g = n.props, y = e.props, m = e.type;
  if (m == "svg" ? i = "http://www.w3.org/2000/svg" : m == "math" ? i = "http://www.w3.org/1998/Math/MathML" : i || (i = "http://www.w3.org/1999/xhtml"), o != null) {
    for (u = 0; u < o.length; u++) if ((h = o[u]) && "setAttribute" in h == !!m && (m ? h.localName == m : h.nodeType == 3)) {
      t = h, o[u] = null;
      break;
    }
  }
  if (t == null) {
    if (m == null) return document.createTextNode(y);
    t = document.createElementNS(i, m, y.is && y), s && (He.__m && He.__m(e, o), s = !1), o = null;
  }
  if (m === null) g === y || s && t.data === y || (t.data = y);
  else {
    if (o = o && Al.call(t.childNodes), g = n.props || wa, !s && o != null) for (g = {}, u = 0; u < t.attributes.length; u++) g[(h = t.attributes[u]).name] = h.value;
    for (u in g) if (h = g[u], u != "children") {
      if (u == "dangerouslySetInnerHTML") c = h;
      else if (!(u in y)) {
        if (u == "value" && "defaultValue" in y || u == "checked" && "defaultChecked" in y) continue;
        qa(t, u, null, h, i);
      }
    }
    for (u in y) h = y[u], u == "children" ? d = h : u == "dangerouslySetInnerHTML" ? f = h : u == "value" ? v = h : u == "checked" ? p = h : s && typeof h != "function" || g[u] === h || qa(t, u, h, g[u], i);
    if (f) s || c && (f.__html === c.__html || f.__html === t.innerHTML) || (t.innerHTML = f.__html), e.__k = [];
    else if (c && (t.innerHTML = ""), Xv(t, Cl(d) ? d : [d], e, n, r, m == "foreignObject" ? "http://www.w3.org/1999/xhtml" : i, o, a, o ? o[0] : n.__k && co(n, 0), s, l), o != null) for (u = o.length; u--; ) rc(o[u]);
    s || (u = "value", m == "progress" && v == null ? t.removeAttribute("value") : v !== void 0 && (v !== t[u] || m == "progress" && !v || m == "option" && v !== g[u]) && qa(t, u, v, g[u], i), u = "checked", p !== void 0 && p !== t[u] && qa(t, u, p, g[u], i));
  }
  return t;
}
function oc(t, e, n) {
  try {
    if (typeof t == "function") {
      var r = typeof t.__u == "function";
      r && t.__u(), r && e == null || (t.__u = t(e));
    } else t.current = e;
  } catch (i) {
    He.__e(i, n);
  }
}
function Yv(t, e, n) {
  var r, i;
  if (He.unmount && He.unmount(t), (r = t.ref) && (r.current && r.current !== t.__e || oc(r, null, e)), (r = t.__c) != null) {
    if (r.componentWillUnmount) try {
      r.componentWillUnmount();
    } catch (o) {
      He.__e(o, e);
    }
    r.base = r.__P = null;
  }
  if (r = t.__k) for (i = 0; i < r.length; i++) r[i] && Yv(r[i], e, n || typeof t.type != "function");
  n || rc(t.__e), t.__c = t.__ = t.__e = void 0;
}
function q_(t, e, n) {
  return this.constructor(t, n);
}
function Z_(t, e, n) {
  var r, i, o, a;
  e == document && (e = document.documentElement), He.__ && He.__(t, e), i = (r = !1) ? null : e.__k, o = [], a = [], ic(e, t = e.__k = ae(fo, null, [t]), i || wa, wa, e.namespaceURI, i ? null : e.firstChild ? Al.call(e.childNodes) : null, o, i ? i.__e : e.firstChild, r, a), Uv(o, t, a);
}
Al = Wv.slice, He = { __e: function(t, e, n, r) {
  for (var i, o, a; e = e.__; ) if ((i = e.__c) && !i.__) try {
    if ((o = i.constructor) && o.getDerivedStateFromError != null && (i.setState(o.getDerivedStateFromError(t)), a = i.__d), i.componentDidCatch != null && (i.componentDidCatch(t, r || {}), a = i.__d), a) return i.__E = i;
  } catch (s) {
    t = s;
  }
  throw t;
} }, Fv = 0, Ye.prototype.setState = function(t, e) {
  var n;
  n = this.__s != null && this.__s !== this.state ? this.__s : this.__s = Zr({}, this.state), typeof t == "function" && (t = t(Zr({}, n), this.props)), t && Zr(n, t), t != null && this.__v && (e && this._sb.push(e), Od(this));
}, Ye.prototype.forceUpdate = function(t) {
  this.__v && (this.__e = !0, t && this.__h.push(t), Od(this));
}, Ye.prototype.render = fo, wi = [], $v = typeof Promise == "function" ? Promise.prototype.then.bind(Promise.resolve()) : setTimeout, Gu = function(t, e) {
  return t.__v.__b - e.__v.__b;
}, Rs.__r = 0, Hv = /(PointerCapture)$|Capture$/i, nc = 0, Uu = Cd(!1), Yu = Cd(!0);
var J_ = "An invariant failed, however the error is obfuscated because this is a production build.", Is = [];
Object.freeze(Is);
var ac = {};
Object.freeze(ac);
function mn() {
  return ++ie.mobxGuid;
}
function De(t) {
  throw St(!1, t), "X";
}
function St(t, e) {
  if (!t)
    throw new Error("[mobx] " + (e || J_));
}
var Td = [];
function Q_(t, e) {
  return process.env.NODE_ENV === "production" || Td.indexOf(t) !== -1 ? !1 : (Td.push(t), console.error("[mobx] Deprecated: " + t), !0);
}
function sc(t) {
  var e = !1;
  return function() {
    if (!e)
      return e = !0, t.apply(this, arguments);
  };
}
var Za = function() {
};
function e0(t) {
  var e = [];
  return t.forEach(function(n) {
    e.indexOf(n) === -1 && e.push(n);
  }), e;
}
function lc(t) {
  return t !== null && typeof t == "object";
}
function Bi(t) {
  if (t === null || typeof t != "object")
    return !1;
  var e = Object.getPrototypeOf(t);
  return e === Object.prototype || e === null;
}
function t0(t) {
  if (Co(t) || un(t))
    return t;
  if (Array.isArray(t))
    return new Map(t);
  if (Bi(t)) {
    var e = /* @__PURE__ */ new Map();
    for (var n in t)
      e.set(n, t[n]);
    return e;
  } else
    return De("Cannot convert to map from '" + t + "'");
}
function Ao(t, e, n) {
  Object.defineProperty(t, e, {
    enumerable: !1,
    writable: !0,
    configurable: !0,
    value: n
  });
}
function n0(t, e, n) {
  Object.defineProperty(t, e, {
    enumerable: !1,
    writable: !1,
    configurable: !0,
    value: n
  });
}
function Vv(t, e) {
  var n = Object.getOwnPropertyDescriptor(t, e);
  return !n || n.configurable !== !1 && n.writable !== !1;
}
function r0(t, e) {
  process.env.NODE_ENV !== "production" && !Vv(t, e) && De("Cannot make property '" + e.toString() + "' observable, it is not configurable and writable in the target object");
}
function li(t, e) {
  var n = "isMobX" + t;
  return e.prototype[n] = !0, function(r) {
    return lc(r) && r[n] === !0;
  };
}
function Co(t) {
  return t instanceof Map;
}
function Ba(t) {
  return t instanceof Set;
}
function uc(t) {
  var e = /* @__PURE__ */ new Set();
  for (var n in t)
    e.add(n);
  return Object.getOwnPropertySymbols(t).forEach(function(r) {
    Object.getOwnPropertyDescriptor(t, r).enumerable && e.add(r);
  }), Array.from(e);
}
function kn(t) {
  return t && t.toString ? t.toString() : new String(t).toString();
}
function Kv(t) {
  return t === null ? null : typeof t == "object" ? "" + t : t;
}
var i0 = typeof Reflect < "u" && Reflect.ownKeys ? Reflect.ownKeys : Object.getOwnPropertySymbols ? function(t) {
  return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t));
} : (
  /* istanbul ignore next */
  Object.getOwnPropertyNames
), Me = Symbol("mobx administration"), To = (
  /** @class */
  function() {
    function t(e) {
      e === void 0 && (e = "Atom@" + mn()), this.name = e, this.isPendingUnobservation = !1, this.isBeingObserved = !1, this.observers = /* @__PURE__ */ new Set(), this.diffValue = 0, this.lastAccessedBy = 0, this.lowestObserverState = st.NOT_TRACKING;
    }
    return t.prototype.onBecomeObserved = function() {
      this.onBecomeObservedListeners && this.onBecomeObservedListeners.forEach(function(e) {
        return e();
      });
    }, t.prototype.onBecomeUnobserved = function() {
      this.onBecomeUnobservedListeners && this.onBecomeUnobservedListeners.forEach(function(e) {
        return e();
      });
    }, t.prototype.reportObserved = function() {
      return ag(this);
    }, t.prototype.reportChanged = function() {
      lr(), N0(this), ur();
    }, t.prototype.toString = function() {
      return this.name;
    }, t;
  }()
), fc = li("Atom", To);
function cc(t, e, n) {
  e === void 0 && (e = Za), n === void 0 && (n = Za);
  var r = new To(t);
  return e !== Za && X0(r, e), n !== Za && dg(r, n), r;
}
function o0(t, e) {
  return wg(t, e);
}
function a0(t, e) {
  return Object.is(t, e);
}
var ho = {
  structural: o0,
  default: a0
};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var Vu = function(t, e) {
  return Vu = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(n, r) {
    n.__proto__ = r;
  } || function(n, r) {
    for (var i in r) r.hasOwnProperty(i) && (n[i] = r[i]);
  }, Vu(t, e);
};
function s0(t, e) {
  Vu(t, e);
  function n() {
    this.constructor = t;
  }
  t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
}
var xt = function() {
  return xt = Object.assign || function(e) {
    for (var n, r = 1, i = arguments.length; r < i; r++) {
      n = arguments[r];
      for (var o in n) Object.prototype.hasOwnProperty.call(n, o) && (e[o] = n[o]);
    }
    return e;
  }, xt.apply(this, arguments);
};
function rr(t) {
  var e = typeof Symbol == "function" && t[Symbol.iterator], n = 0;
  return e ? e.call(t) : {
    next: function() {
      return t && n >= t.length && (t = void 0), { value: t && t[n++], done: !t };
    }
  };
}
function ro(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}
function dc() {
  for (var t = [], e = 0; e < arguments.length; e++)
    t = t.concat(ro(arguments[e]));
  return t;
}
var js = Symbol("mobx did run lazy initializers"), na = Symbol("mobx pending decorators"), l0 = {}, u0 = {};
function f0(t, e) {
  var n = e ? l0 : u0;
  return n[t] || (n[t] = {
    configurable: !0,
    enumerable: e,
    get: function() {
      return Pi(this), this[t];
    },
    set: function(r) {
      Pi(this), this[t] = r;
    }
  });
}
function Pi(t) {
  var e, n;
  if (t[js] !== !0) {
    var r = t[na];
    if (r) {
      Ao(t, js, !0);
      var i = dc(Object.getOwnPropertySymbols(r), Object.keys(r));
      try {
        for (var o = rr(i), a = o.next(); !a.done; a = o.next()) {
          var s = a.value, l = r[s];
          l.propertyCreator(t, l.prop, l.descriptor, l.decoratorTarget, l.decoratorArguments);
        }
      } catch (u) {
        e = { error: u };
      } finally {
        try {
          a && !a.done && (n = o.return) && n.call(o);
        } finally {
          if (e) throw e.error;
        }
      }
    }
  }
}
function qv(t, e) {
  return function() {
    var r, i = function(a, s, l, u) {
      if (u === !0)
        return e(a, s, l, a, r), null;
      if (process.env.NODE_ENV !== "production" && !Nd(arguments) && De("This function is a decorator, but it wasn't invoked like a decorator"), !Object.prototype.hasOwnProperty.call(a, na)) {
        var f = a[na];
        Ao(a, na, xt({}, f));
      }
      return a[na][s] = {
        prop: s,
        propertyCreator: e,
        descriptor: l,
        decoratorTarget: a,
        decoratorArguments: r
      }, f0(s, t);
    };
    return Nd(arguments) ? (r = Is, i.apply(null, arguments)) : (r = Array.prototype.slice.call(arguments), i);
  };
}
function Nd(t) {
  return (t.length === 2 || t.length === 3) && (typeof t[1] == "string" || typeof t[1] == "symbol") || t.length === 4 && t[3] === !0;
}
function Fa(t, e, n) {
  return ni(t) ? t : Array.isArray(t) ? H.array(t, { name: n }) : Bi(t) ? H.object(t, void 0, { name: n }) : Co(t) ? H.map(t, { name: n }) : Ba(t) ? H.set(t, { name: n }) : t;
}
function c0(t, e, n) {
  return t == null || vr(t) || Cr(t) || un(t) || Xn(t) ? t : Array.isArray(t) ? H.array(t, { name: n, deep: !1 }) : Bi(t) ? H.object(t, void 0, { name: n, deep: !1 }) : Co(t) ? H.map(t, { name: n, deep: !1 }) : Ba(t) ? H.set(t, { name: n, deep: !1 }) : De(process.env.NODE_ENV !== "production" && "The shallow modifier / decorator can only used in combination with arrays, objects, maps and sets");
}
function Nl(t) {
  return t;
}
function d0(t, e, n) {
  if (process.env.NODE_ENV !== "production" && ni(t))
    throw "observable.struct should not be used with observable values";
  return wg(t, e) ? e : t;
}
function Ml(t) {
  St(t);
  var e = qv(!0, function(r, i, o, a, s) {
    process.env.NODE_ENV !== "production" && St(!o || !o.get, '@observable cannot be used on getter (property "' + kn(i) + '"), use @computed instead.');
    var l = o ? o.initializer ? o.initializer.call(r) : o.value : void 0;
    yc(r).addObservableProp(i, l, t);
  }), n = (
    // Extra process checks, as this happens during module initialization
    typeof process < "u" && process.env && process.env.NODE_ENV !== "production" ? function() {
      return arguments.length < 2 ? De("Incorrect decorator invocation. @observable decorator doesn't expect any arguments") : e.apply(null, arguments);
    } : e
  );
  return n.enhancer = t, n;
}
var Zv = {
  deep: !0,
  name: void 0,
  defaultDecorator: void 0,
  proxy: !0
};
Object.freeze(Zv);
function h0(t) {
  /^(deep|name|equals|defaultDecorator|proxy)$/.test(t) || De("invalid option for (extend)observable: " + t);
}
function to(t) {
  if (t == null)
    return Zv;
  if (typeof t == "string")
    return { name: t, deep: !0, proxy: !0 };
  if (process.env.NODE_ENV !== "production") {
    if (typeof t != "object")
      return De("expected options object");
    Object.keys(t).forEach(h0);
  }
  return t;
}
var hc = Ml(Fa), p0 = Ml(c0), Jv = Ml(Nl), v0 = Ml(d0);
function Ja(t) {
  return t.defaultDecorator ? t.defaultDecorator.enhancer : t.deep === !1 ? Nl : Fa;
}
function g0(t, e, n) {
  if (typeof arguments[1] == "string" || typeof arguments[1] == "symbol")
    return hc.apply(null, arguments);
  if (ni(t))
    return t;
  var r = Bi(t) ? H.object(t, e, n) : Array.isArray(t) ? H.array(t, e) : Co(t) ? H.map(t, e) : Ba(t) ? H.set(t, e) : t;
  if (r !== t)
    return r;
  De(process.env.NODE_ENV !== "production" && "The provided value could not be converted into an observable. If you want just create an observable reference to the object use 'observable.box(value)'");
}
var Md = {
  box: function(t, e) {
    arguments.length > 2 && Uo("box");
    var n = to(e);
    return new Mi(t, Ja(n), n.name, !0, n.equals);
  },
  array: function(t, e) {
    arguments.length > 2 && Uo("array");
    var n = to(e);
    return ib(t, Ja(n), n.name);
  },
  map: function(t, e) {
    arguments.length > 2 && Uo("map");
    var n = to(e);
    return new gc(t, Ja(n), n.name);
  },
  set: function(t, e) {
    arguments.length > 2 && Uo("set");
    var n = to(e);
    return new xg(t, Ja(n), n.name);
  },
  object: function(t, e, n) {
    typeof arguments[1] == "string" && Uo("object");
    var r = to(n);
    if (r.proxy === !1)
      return Qu({}, t, e, r);
    var i = pg(r), o = Qu({}, void 0, void 0, r), a = tb(o);
    return vg(a, t, e, i), a;
  },
  ref: Jv,
  shallow: p0,
  deep: hc,
  struct: v0
}, H = g0;
Object.keys(Md).forEach(function(t) {
  return H[t] = Md[t];
});
function Uo(t) {
  De(
    // process.env.NODE_ENV !== "production" &&
    "Expected one or two arguments to observable." + t + ". Did you accidentally try to use observable." + t + " as decorator?"
  );
}
var ks = qv(!1, function(t, e, n, r, i) {
  process.env.NODE_ENV !== "production" && St(n && n.get, "Trying to declare a computed value for unspecified getter '" + kn(e) + "'");
  var o = n.get, a = n.set, s = i[0] || {};
  yc(t).addComputedProp(t, e, xt({
    get: o,
    set: a,
    context: t
  }, s));
}), y0 = ks({ equals: ho.structural }), yt = function(e, n, r) {
  if (typeof n == "string" || e !== null && typeof e == "object" && arguments.length === 1)
    return ks.apply(null, arguments);
  process.env.NODE_ENV !== "production" && (St(typeof e == "function", "First argument to `computed` should be an expression."), St(arguments.length < 3, "Computed takes one or two arguments if used as function"));
  var i = typeof n == "object" ? n : {};
  return i.get = e, i.set = typeof n == "function" ? n : i.set, i.name = i.name || e.name || "", new vo(i);
};
yt.struct = y0;
var st;
(function(t) {
  t[t.NOT_TRACKING = -1] = "NOT_TRACKING", t[t.UP_TO_DATE = 0] = "UP_TO_DATE", t[t.POSSIBLY_STALE = 1] = "POSSIBLY_STALE", t[t.STALE = 2] = "STALE";
})(st || (st = {}));
var sr;
(function(t) {
  t[t.NONE = 0] = "NONE", t[t.LOG = 1] = "LOG", t[t.BREAK = 2] = "BREAK";
})(sr || (sr = {}));
var Bs = (
  /** @class */
  /* @__PURE__ */ function() {
    function t(e) {
      this.cause = e;
    }
    return t;
  }()
);
function ra(t) {
  return t instanceof Bs;
}
function Ku(t) {
  switch (t.dependenciesState) {
    case st.UP_TO_DATE:
      return !1;
    case st.NOT_TRACKING:
    case st.STALE:
      return !0;
    case st.POSSIBLY_STALE: {
      for (var e = pc(!0), n = No(), r = t.observing, i = r.length, o = 0; o < i; o++) {
        var a = r[o];
        if (go(a)) {
          if (ie.disableErrorBoundaries)
            a.get();
          else
            try {
              a.get();
            } catch {
              return ei(n), aa(e), !0;
            }
          if (t.dependenciesState === st.STALE)
            return ei(n), aa(e), !0;
        }
      }
      return tg(t), ei(n), aa(e), !1;
    }
  }
}
function po(t) {
  var e = t.observers.size > 0;
  ie.computationDepth > 0 && e && De(process.env.NODE_ENV !== "production" && "Computed values are not allowed to cause side effects by changing observables that are already being observed. Tried to modify: " + t.name), !ie.allowStateChanges && (e || ie.enforceActions === "strict") && De(process.env.NODE_ENV !== "production" && (ie.enforceActions ? "Since strict-mode is enabled, changing observed observable values outside actions is not allowed. Please wrap the code in an `action` if this change is intended. Tried to modify: " : "Side effects like changing state are not allowed at this point. Are you trying to modify state from, for example, the render function of a React component? Tried to modify: ") + t.name);
}
function m0(t) {
  process.env.NODE_ENV !== "production" && !ie.allowStateReads && ie.observableRequiresReaction && console.warn("[mobx] Observable " + t.name + " being read outside a reactive context");
}
function Qv(t, e, n) {
  var r = pc(!0);
  tg(t), t.newObserving = new Array(t.observing.length + 100), t.unboundDepsCount = 0, t.runId = ++ie.runId;
  var i = ie.trackingDerivation;
  ie.trackingDerivation = t;
  var o;
  if (ie.disableErrorBoundaries === !0)
    o = e.call(n);
  else
    try {
      o = e.call(n);
    } catch (a) {
      o = new Bs(a);
    }
  return ie.trackingDerivation = i, b0(t), _0(t), aa(r), o;
}
function _0(t) {
  process.env.NODE_ENV !== "production" && t.observing.length === 0 && (ie.reactionRequiresObservable || t.requiresObservable) && console.warn("[mobx] Derivation " + t.name + " is created/updated without reading any observable value");
}
function b0(t) {
  for (var e = t.observing, n = t.observing = t.newObserving, r = st.UP_TO_DATE, i = 0, o = t.unboundDepsCount, a = 0; a < o; a++) {
    var s = n[a];
    s.diffValue === 0 && (s.diffValue = 1, i !== a && (n[i] = s), i++), s.dependenciesState > r && (r = s.dependenciesState);
  }
  for (n.length = i, t.newObserving = null, o = e.length; o--; ) {
    var s = e[o];
    s.diffValue === 0 && ig(s, t), s.diffValue = 0;
  }
  for (; i--; ) {
    var s = n[i];
    s.diffValue === 1 && (s.diffValue = 0, T0(s, t));
  }
  r !== st.UP_TO_DATE && (t.dependenciesState = r, t.onBecomeStale());
}
function qu(t) {
  var e = t.observing;
  t.observing = [];
  for (var n = e.length; n--; )
    ig(e[n], t);
  t.dependenciesState = st.NOT_TRACKING;
}
function eg(t) {
  var e = No();
  try {
    return t();
  } finally {
    ei(e);
  }
}
function No() {
  var t = ie.trackingDerivation;
  return ie.trackingDerivation = null, t;
}
function ei(t) {
  ie.trackingDerivation = t;
}
function pc(t) {
  var e = ie.allowStateReads;
  return ie.allowStateReads = t, e;
}
function aa(t) {
  ie.allowStateReads = t;
}
function tg(t) {
  if (t.dependenciesState !== st.UP_TO_DATE) {
    t.dependenciesState = st.UP_TO_DATE;
    for (var e = t.observing, n = e.length; n--; )
      e[n].lowestObserverState = st.UP_TO_DATE;
  }
}
var Fs = 0, x0 = 1, Pd = Object.getOwnPropertyDescriptor(function() {
}, "name"), E0 = Pd && Pd.configurable;
function Ni(t, e, n) {
  process.env.NODE_ENV !== "production" && (St(typeof e == "function", "`action` can only be invoked on functions"), (typeof t != "string" || !t) && De("actions should have valid names, got: '" + t + "'"));
  var r = function() {
    return ng(t, e, n || this, arguments);
  };
  return r.isMobxAction = !0, process.env.NODE_ENV !== "production" && E0 && Object.defineProperty(r, "name", { value: t }), r;
}
function ng(t, e, n, r) {
  var i = w0(t, n, r);
  try {
    return e.apply(n, r);
  } catch (o) {
    throw i.error = o, o;
  } finally {
    S0(i);
  }
}
function w0(t, e, n) {
  var r = Yt() && !!t, i = 0;
  if (r && process.env.NODE_ENV !== "production") {
    i = Date.now();
    var o = n && n.length || 0, a = new Array(o);
    if (o > 0)
      for (var s = 0; s < o; s++)
        a[s] = n[s];
    On({
      type: "action",
      name: t,
      object: e,
      arguments: a
    });
  }
  var l = No();
  lr();
  var u = Pl(!0), f = pc(!0), c = {
    prevDerivation: l,
    prevAllowStateChanges: u,
    prevAllowStateReads: f,
    notifySpy: r,
    startTime: i,
    actionId: x0++,
    parentActionId: Fs
  };
  return Fs = c.actionId, c;
}
function S0(t) {
  Fs !== t.actionId && De("invalid action stack. did you forget to finish an action?"), Fs = t.parentActionId, t.error !== void 0 && (ie.suppressReactionErrors = !0), Dl(t.prevAllowStateChanges), aa(t.prevAllowStateReads), ur(), ei(t.prevDerivation), t.notifySpy && process.env.NODE_ENV !== "production" && An({ time: Date.now() - t.startTime }), ie.suppressReactionErrors = !1;
}
function Pl(t) {
  var e = ie.allowStateChanges;
  return ie.allowStateChanges = t, e;
}
function Dl(t) {
  ie.allowStateChanges = t;
}
var Mi = (
  /** @class */
  function(t) {
    s0(e, t);
    function e(n, r, i, o, a) {
      i === void 0 && (i = "ObservableValue@" + mn()), o === void 0 && (o = !0), a === void 0 && (a = ho.default);
      var s = t.call(this, i) || this;
      return s.enhancer = r, s.name = i, s.equals = a, s.hasUnreportedChange = !1, s.value = r(n, void 0, i), o && Yt() && process.env.NODE_ENV !== "production" && Di({ type: "create", name: s.name, newValue: "" + s.value }), s;
    }
    return e.prototype.dehanceValue = function(n) {
      return this.dehancer !== void 0 ? this.dehancer(n) : n;
    }, e.prototype.set = function(n) {
      var r = this.value;
      if (n = this.prepareNewValue(n), n !== ie.UNCHANGED) {
        var i = Yt();
        i && process.env.NODE_ENV !== "production" && On({
          type: "update",
          name: this.name,
          newValue: n,
          oldValue: r
        }), this.setNewValue(n), i && process.env.NODE_ENV !== "production" && An();
      }
    }, e.prototype.prepareNewValue = function(n) {
      if (po(this), wr(this)) {
        var r = Sr(this, {
          object: this,
          type: "update",
          newValue: n
        });
        if (!r)
          return ie.UNCHANGED;
        n = r.newValue;
      }
      return n = this.enhancer(n, this.value, this.name), this.equals(this.value, n) ? ie.UNCHANGED : n;
    }, e.prototype.setNewValue = function(n) {
      var r = this.value;
      this.value = n, this.reportChanged(), fr(this) && cr(this, {
        type: "update",
        object: this,
        newValue: n,
        oldValue: r
      });
    }, e.prototype.get = function() {
      return this.reportObserved(), this.dehanceValue(this.value);
    }, e.prototype.intercept = function(n) {
      return $a(this, n);
    }, e.prototype.observe = function(n, r) {
      return r && n({
        object: this,
        type: "update",
        newValue: this.value,
        oldValue: void 0
      }), Ha(this, n);
    }, e.prototype.toJSON = function() {
      return this.get();
    }, e.prototype.toString = function() {
      return this.name + "[" + this.value + "]";
    }, e.prototype.valueOf = function() {
      return Kv(this.get());
    }, e.prototype[Symbol.toPrimitive] = function() {
      return this.valueOf();
    }, e;
  }(To)
), O0 = li("ObservableValue", Mi), vo = (
  /** @class */
  function() {
    function t(e) {
      this.dependenciesState = st.NOT_TRACKING, this.observing = [], this.newObserving = null, this.isBeingObserved = !1, this.isPendingUnobservation = !1, this.observers = /* @__PURE__ */ new Set(), this.diffValue = 0, this.runId = 0, this.lastAccessedBy = 0, this.lowestObserverState = st.UP_TO_DATE, this.unboundDepsCount = 0, this.__mapid = "#" + mn(), this.value = new Bs(null), this.isComputing = !1, this.isRunningSetter = !1, this.isTracing = sr.NONE, St(e.get, "missing option for computed: get"), this.derivation = e.get, this.name = e.name || "ComputedValue@" + mn(), e.set && (this.setter = Ni(this.name + "-setter", e.set)), this.equals = e.equals || (e.compareStructural || e.struct ? ho.structural : ho.default), this.scope = e.context, this.requiresReaction = !!e.requiresReaction, this.keepAlive = !!e.keepAlive;
    }
    return t.prototype.onBecomeStale = function() {
      P0(this);
    }, t.prototype.onBecomeObserved = function() {
      this.onBecomeObservedListeners && this.onBecomeObservedListeners.forEach(function(e) {
        return e();
      });
    }, t.prototype.onBecomeUnobserved = function() {
      this.onBecomeUnobservedListeners && this.onBecomeUnobservedListeners.forEach(function(e) {
        return e();
      });
    }, t.prototype.get = function() {
      this.isComputing && De("Cycle detected in computation " + this.name + ": " + this.derivation), ie.inBatch === 0 && this.observers.size === 0 && !this.keepAlive ? Ku(this) && (this.warnAboutUntrackedRead(), lr(), this.value = this.computeValue(!1), ur()) : (ag(this), Ku(this) && this.trackAndCompute() && M0(this));
      var e = this.value;
      if (ra(e))
        throw e.cause;
      return e;
    }, t.prototype.peek = function() {
      var e = this.computeValue(!1);
      if (ra(e))
        throw e.cause;
      return e;
    }, t.prototype.set = function(e) {
      if (this.setter) {
        St(!this.isRunningSetter, "The setter of computed value '" + this.name + "' is trying to update itself. Did you intend to update an _observable_ value, instead of the computed property?"), this.isRunningSetter = !0;
        try {
          this.setter.call(this.scope, e);
        } finally {
          this.isRunningSetter = !1;
        }
      } else
        St(!1, process.env.NODE_ENV !== "production" && "[ComputedValue '" + this.name + "'] It is not possible to assign a new value to a computed value.");
    }, t.prototype.trackAndCompute = function() {
      Yt() && process.env.NODE_ENV !== "production" && Di({
        object: this.scope,
        type: "compute",
        name: this.name
      });
      var e = this.value, n = (
        /* see #1208 */
        this.dependenciesState === st.NOT_TRACKING
      ), r = this.computeValue(!0), i = n || ra(e) || ra(r) || !this.equals(e, r);
      return i && (this.value = r), i;
    }, t.prototype.computeValue = function(e) {
      this.isComputing = !0, ie.computationDepth++;
      var n;
      if (e)
        n = Qv(this, this.derivation, this.scope);
      else if (ie.disableErrorBoundaries === !0)
        n = this.derivation.call(this.scope);
      else
        try {
          n = this.derivation.call(this.scope);
        } catch (r) {
          n = new Bs(r);
        }
      return ie.computationDepth--, this.isComputing = !1, n;
    }, t.prototype.suspend = function() {
      this.keepAlive || (qu(this), this.value = void 0);
    }, t.prototype.observe = function(e, n) {
      var r = this, i = !0, o = void 0;
      return H0(function() {
        var a = r.get();
        if (!i || n) {
          var s = No();
          e({
            type: "update",
            object: r,
            newValue: a,
            oldValue: o
          }), ei(s);
        }
        i = !1, o = a;
      });
    }, t.prototype.warnAboutUntrackedRead = function() {
      process.env.NODE_ENV !== "production" && (this.requiresReaction === !0 && De("[mobx] Computed value " + this.name + " is read outside a reactive context"), this.isTracing !== sr.NONE && console.log("[mobx.trace] '" + this.name + "' is being read outside a reactive context. Doing a full recompute"), ie.computedRequiresReaction && console.warn("[mobx] Computed value " + this.name + " is being read outside a reactive context. Doing a full recompute"));
    }, t.prototype.toJSON = function() {
      return this.get();
    }, t.prototype.toString = function() {
      return this.name + "[" + this.derivation.toString() + "]";
    }, t.prototype.valueOf = function() {
      return Kv(this.get());
    }, t.prototype[Symbol.toPrimitive] = function() {
      return this.valueOf();
    }, t;
  }()
), go = li("ComputedValue", vo), ws = (
  /** @class */
  /* @__PURE__ */ function() {
    function t() {
      this.version = 5, this.UNCHANGED = {}, this.trackingDerivation = null, this.computationDepth = 0, this.runId = 0, this.mobxGuid = 0, this.inBatch = 0, this.pendingUnobservations = [], this.pendingReactions = [], this.isRunningReactions = !1, this.allowStateChanges = !0, this.allowStateReads = !0, this.enforceActions = !1, this.spyListeners = [], this.globalReactionErrorHandlers = [], this.computedRequiresReaction = !1, this.reactionRequiresObservable = !1, this.observableRequiresReaction = !1, this.computedConfigurable = !1, this.disableErrorBoundaries = !1, this.suppressReactionErrors = !1;
    }
    return t;
  }()
), A0 = {};
function $s() {
  return typeof window < "u" ? window : typeof global < "u" ? global : typeof self < "u" ? self : A0;
}
var Ss = !0, rg = !1, ie = function() {
  var t = $s();
  return t.__mobxInstanceCount > 0 && !t.__mobxGlobals && (Ss = !1), t.__mobxGlobals && t.__mobxGlobals.version !== new ws().version && (Ss = !1), Ss ? t.__mobxGlobals ? (t.__mobxInstanceCount += 1, t.__mobxGlobals.UNCHANGED || (t.__mobxGlobals.UNCHANGED = {}), t.__mobxGlobals) : (t.__mobxInstanceCount = 1, t.__mobxGlobals = new ws()) : (setTimeout(function() {
    rg || De("There are multiple, different versions of MobX active. Make sure MobX is loaded only once or use `configure({ isolateGlobalState: true })`");
  }, 1), new ws());
}();
function C0() {
  (ie.pendingReactions.length || ie.inBatch || ie.isRunningReactions) && De("isolateGlobalState should be called before MobX is running any reactions"), rg = !0, Ss && (--$s().__mobxInstanceCount === 0 && ($s().__mobxGlobals = void 0), ie = new ws());
}
function Zu() {
  return ie;
}
function T0(t, e) {
  t.observers.add(e), t.lowestObserverState > e.dependenciesState && (t.lowestObserverState = e.dependenciesState);
}
function ig(t, e) {
  t.observers.delete(e), t.observers.size === 0 && og(t);
}
function og(t) {
  t.isPendingUnobservation === !1 && (t.isPendingUnobservation = !0, ie.pendingUnobservations.push(t));
}
function lr() {
  ie.inBatch++;
}
function ur() {
  if (--ie.inBatch === 0) {
    ug();
    for (var t = ie.pendingUnobservations, e = 0; e < t.length; e++) {
      var n = t[e];
      n.isPendingUnobservation = !1, n.observers.size === 0 && (n.isBeingObserved && (n.isBeingObserved = !1, n.onBecomeUnobserved()), n instanceof vo && n.suspend());
    }
    ie.pendingUnobservations = [];
  }
}
function ag(t) {
  m0(t);
  var e = ie.trackingDerivation;
  return e !== null ? (e.runId !== t.lastAccessedBy && (t.lastAccessedBy = e.runId, e.newObserving[e.unboundDepsCount++] = t, t.isBeingObserved || (t.isBeingObserved = !0, t.onBecomeObserved())), !0) : (t.observers.size === 0 && ie.inBatch > 0 && og(t), !1);
}
function N0(t) {
  t.lowestObserverState !== st.STALE && (t.lowestObserverState = st.STALE, t.observers.forEach(function(e) {
    e.dependenciesState === st.UP_TO_DATE && (e.isTracing !== sr.NONE && sg(e, t), e.onBecomeStale()), e.dependenciesState = st.STALE;
  }));
}
function M0(t) {
  t.lowestObserverState !== st.STALE && (t.lowestObserverState = st.STALE, t.observers.forEach(function(e) {
    e.dependenciesState === st.POSSIBLY_STALE ? e.dependenciesState = st.STALE : e.dependenciesState === st.UP_TO_DATE && (t.lowestObserverState = st.UP_TO_DATE);
  }));
}
function P0(t) {
  t.lowestObserverState === st.UP_TO_DATE && (t.lowestObserverState = st.POSSIBLY_STALE, t.observers.forEach(function(e) {
    e.dependenciesState === st.UP_TO_DATE && (e.dependenciesState = st.POSSIBLY_STALE, e.isTracing !== sr.NONE && sg(e, t), e.onBecomeStale());
  }));
}
function sg(t, e) {
  if (console.log("[mobx.trace] '" + t.name + "' is invalidated due to a change in: '" + e.name + "'"), t.isTracing === sr.BREAK) {
    var n = [];
    lg(U0(t), n, 1), new Function(`debugger;
/*
Tracing '` + t.name + `'

You are entering this break point because derivation '` + t.name + "' is being traced and '" + e.name + `' is now forcing it to update.
Just follow the stacktrace you should now see in the devtools to see precisely what piece of your code is causing this update
The stackframe you are looking for is at least ~6-8 stack-frames up.

` + (t instanceof vo ? t.derivation.toString().replace(/[*]\//g, "/") : "") + `

The dependencies for this derivation are:

` + n.join(`
`) + `
*/
    `)();
  }
}
function lg(t, e, n) {
  if (e.length >= 1e3) {
    e.push("(and many more)");
    return;
  }
  e.push("" + new Array(n).join("	") + t.name), t.dependencies && t.dependencies.forEach(function(r) {
    return lg(r, e, n + 1);
  });
}
var Sa = (
  /** @class */
  function() {
    function t(e, n, r, i) {
      e === void 0 && (e = "Reaction@" + mn()), i === void 0 && (i = !1), this.name = e, this.onInvalidate = n, this.errorHandler = r, this.requiresObservable = i, this.observing = [], this.newObserving = [], this.dependenciesState = st.NOT_TRACKING, this.diffValue = 0, this.runId = 0, this.unboundDepsCount = 0, this.__mapid = "#" + mn(), this.isDisposed = !1, this._isScheduled = !1, this._isTrackPending = !1, this._isRunning = !1, this.isTracing = sr.NONE;
    }
    return t.prototype.onBecomeStale = function() {
      this.schedule();
    }, t.prototype.schedule = function() {
      this._isScheduled || (this._isScheduled = !0, ie.pendingReactions.push(this), ug());
    }, t.prototype.isScheduled = function() {
      return this._isScheduled;
    }, t.prototype.runReaction = function() {
      if (!this.isDisposed) {
        if (lr(), this._isScheduled = !1, Ku(this)) {
          this._isTrackPending = !0;
          try {
            this.onInvalidate(), this._isTrackPending && Yt() && process.env.NODE_ENV !== "production" && Di({
              name: this.name,
              type: "scheduled-reaction"
            });
          } catch (e) {
            this.reportExceptionInDerivation(e);
          }
        }
        ur();
      }
    }, t.prototype.track = function(e) {
      if (!this.isDisposed) {
        lr();
        var n = Yt(), r;
        n && process.env.NODE_ENV !== "production" && (r = Date.now(), On({
          name: this.name,
          type: "reaction"
        })), this._isRunning = !0;
        var i = Qv(this, e, void 0);
        this._isRunning = !1, this._isTrackPending = !1, this.isDisposed && qu(this), ra(i) && this.reportExceptionInDerivation(i.cause), n && process.env.NODE_ENV !== "production" && An({
          time: Date.now() - r
        }), ur();
      }
    }, t.prototype.reportExceptionInDerivation = function(e) {
      var n = this;
      if (this.errorHandler) {
        this.errorHandler(e, this);
        return;
      }
      if (ie.disableErrorBoundaries)
        throw e;
      var r = "[mobx] Encountered an uncaught exception that was thrown by a reaction or observer component, in: '" + this + "'";
      ie.suppressReactionErrors ? console.warn("[mobx] (error in reaction '" + this.name + "' suppressed, fix error of causing action below)") : console.error(r, e), Yt() && Di({
        type: "error",
        name: this.name,
        message: r,
        error: "" + e
      }), ie.globalReactionErrorHandlers.forEach(function(i) {
        return i(e, n);
      });
    }, t.prototype.dispose = function() {
      this.isDisposed || (this.isDisposed = !0, this._isRunning || (lr(), qu(this), ur()));
    }, t.prototype.getDisposer = function() {
      var e = this.dispose.bind(this);
      return e[Me] = this, e;
    }, t.prototype.toString = function() {
      return "Reaction[" + this.name + "]";
    }, t.prototype.trace = function(e) {
      e === void 0 && (e = !1), J0(this, e);
    }, t;
  }()
), Dd = 100, Ju = function(t) {
  return t();
};
function ug() {
  ie.inBatch > 0 || ie.isRunningReactions || Ju(D0);
}
function D0() {
  ie.isRunningReactions = !0;
  for (var t = ie.pendingReactions, e = 0; t.length > 0; ) {
    ++e === Dd && (console.error("Reaction doesn't converge to a stable state after " + Dd + " iterations." + (" Probably there is a cycle in the reactive function: " + t[0])), t.splice(0));
    for (var n = t.splice(0), r = 0, i = n.length; r < i; r++)
      n[r].runReaction();
  }
  ie.isRunningReactions = !1;
}
var Hs = li("Reaction", Sa);
function R0(t) {
  var e = Ju;
  Ju = function(n) {
    return t(function() {
      return e(n);
    });
  };
}
function Yt() {
  return process.env.NODE_ENV !== "production" && !!ie.spyListeners.length;
}
function Di(t) {
  if (process.env.NODE_ENV !== "production" && ie.spyListeners.length)
    for (var e = ie.spyListeners, n = 0, r = e.length; n < r; n++)
      e[n](t);
}
function On(t) {
  if (process.env.NODE_ENV !== "production") {
    var e = xt(xt({}, t), { spyReportStart: !0 });
    Di(e);
  }
}
var L0 = { spyReportEnd: !0 };
function An(t) {
  process.env.NODE_ENV !== "production" && Di(t ? xt(xt({}, t), { spyReportEnd: !0 }) : L0);
}
function I0(t) {
  return process.env.NODE_ENV === "production" ? (console.warn("[mobx.spy] Is a no-op in production builds"), function() {
  }) : (ie.spyListeners.push(t), sc(function() {
    ie.spyListeners = ie.spyListeners.filter(function(e) {
      return e !== t;
    });
  }));
}
function j0() {
  De(process.env.NODE_ENV !== "production" && "@action fields are not reassignable");
}
function Rd(t) {
  return function(e, n, r) {
    if (r) {
      if (process.env.NODE_ENV !== "production" && r.get !== void 0)
        return De("@action cannot be used with getters");
      if (r.value)
        return {
          value: Ni(t, r.value),
          enumerable: !1,
          configurable: !0,
          writable: !0
          // for typescript, this must be writable, otherwise it cannot inherit :/ (see inheritable actions test)
        };
      var i = r.initializer;
      return {
        enumerable: !1,
        configurable: !0,
        writable: !0,
        initializer: function() {
          return Ni(t, i.call(this));
        }
      };
    }
    return k0(t).apply(this, arguments);
  };
}
function k0(t) {
  return function(e, n, r) {
    Object.defineProperty(e, n, {
      configurable: !0,
      enumerable: !1,
      get: function() {
      },
      set: function(i) {
        Ao(this, n, F(t, i));
      }
    });
  };
}
function B0(t, e, n, r) {
  return r === !0 ? (gu(t, e, n.value), null) : n ? {
    configurable: !0,
    enumerable: !1,
    get: function() {
      return gu(this, e, n.value || n.initializer.call(this)), this[e];
    },
    set: j0
  } : {
    enumerable: !1,
    configurable: !0,
    set: function(i) {
      gu(this, e, i);
    },
    get: function() {
    }
  };
}
var F = function(e, n, r, i) {
  if (arguments.length === 1 && typeof e == "function")
    return Ni(e.name || "<unnamed action>", e);
  if (arguments.length === 2 && typeof n == "function")
    return Ni(e, n);
  if (arguments.length === 1 && typeof e == "string")
    return Rd(e);
  if (i === !0)
    Ao(e, n, Ni(e.name || n, r.value, this));
  else
    return Rd(n).apply(null, arguments);
};
F.bound = B0;
function F0(t, e) {
  var n = typeof t == "string" ? t : t.name || "<unnamed action>", r = typeof t == "function" ? t : e;
  return process.env.NODE_ENV !== "production" && (St(typeof r == "function" && r.length === 0, "`runInAction` expects a function without arguments"), (typeof n != "string" || !n) && De("actions should have valid names, got: '" + n + "'")), ng(n, r, this, void 0);
}
function $0(t) {
  return typeof t == "function" && t.isMobxAction === !0;
}
function gu(t, e, n) {
  Ao(t, e, Ni(e, n.bind(t)));
}
function H0(t, e) {
  e === void 0 && (e = ac), process.env.NODE_ENV !== "production" && (St(typeof t == "function", "Autorun expects a function as first argument"), St($0(t) === !1, "Autorun does not accept actions since actions are untrackable"));
  var n = e && e.name || t.name || "Autorun@" + mn(), r = !e.scheduler && !e.delay, i;
  if (r)
    i = new Sa(n, function() {
      this.track(s);
    }, e.onError, e.requiresObservable);
  else {
    var o = fg(e), a = !1;
    i = new Sa(n, function() {
      a || (a = !0, o(function() {
        a = !1, i.isDisposed || i.track(s);
      }));
    }, e.onError, e.requiresObservable);
  }
  function s() {
    t(i);
  }
  return i.schedule(), i.getDisposer();
}
var W0 = function(t) {
  return t();
};
function fg(t) {
  return t.scheduler ? t.scheduler : t.delay ? function(e) {
    return setTimeout(e, t.delay);
  } : W0;
}
function cg(t, e, n) {
  n === void 0 && (n = ac), process.env.NODE_ENV !== "production" && (St(typeof t == "function", "First argument to reaction should be a function"), St(typeof n == "object", "Third argument of reactions should be an object"));
  var r = n.name || "Reaction@" + mn(), i = F(r, n.onError ? z0(n.onError, e) : e), o = !n.scheduler && !n.delay, a = fg(n), s = !0, l = !1, u, f = n.compareStructural ? ho.structural : n.equals || ho.default, c = new Sa(r, function() {
    s || o ? d() : l || (l = !0, a(d));
  }, n.onError, n.requiresObservable);
  function d() {
    if (l = !1, !c.isDisposed) {
      var h = !1;
      c.track(function() {
        var v = t(c);
        h = s || !f(u, v), u = v;
      }), s && n.fireImmediately && i(u, c), !s && h === !0 && i(u, c), s && (s = !1);
    }
  }
  return c.schedule(), c.getDisposer();
}
function z0(t, e) {
  return function() {
    try {
      return e.apply(this, arguments);
    } catch (n) {
      t.call(this, n);
    }
  };
}
function X0(t, e, n) {
  return hg("onBecomeObserved", t, e);
}
function dg(t, e, n) {
  return hg("onBecomeUnobserved", t, e);
}
function hg(t, e, n, r) {
  var i = ri(e), o = n, a = t + "Listeners";
  i[a] ? i[a].add(o) : i[a] = /* @__PURE__ */ new Set([o]);
  var s = i[t];
  return typeof s != "function" ? De(process.env.NODE_ENV !== "production" && "Not an atom that can be (un)observed") : function() {
    var l = i[a];
    l && (l.delete(o), l.size === 0 && delete i[a]);
  };
}
function G0(t) {
  var e = t.enforceActions, n = t.computedRequiresReaction, r = t.computedConfigurable, i = t.disableErrorBoundaries, o = t.reactionScheduler, a = t.reactionRequiresObservable, s = t.observableRequiresReaction;
  if (C0(), e !== void 0) {
    (typeof e == "boolean" || e === "strict") && Q_(`Deprecated value for 'enforceActions', use 'false' => '"never"', 'true' => '"observed"', '"strict"' => "'always'" instead`);
    var l = void 0;
    switch (e) {
      case !0:
      case "observed":
        l = !0;
        break;
      case !1:
      case "never":
        l = !1;
        break;
      case "strict":
      case "always":
        l = "strict";
        break;
      default:
        De("Invalid value for 'enforceActions': '" + e + "', expected 'never', 'always' or 'observed'");
    }
    ie.enforceActions = l, ie.allowStateChanges = !(l === !0 || l === "strict");
  }
  n !== void 0 && (ie.computedRequiresReaction = !!n), a !== void 0 && (ie.reactionRequiresObservable = !!a), s !== void 0 && (ie.observableRequiresReaction = !!s, ie.allowStateReads = !ie.observableRequiresReaction), r !== void 0 && (ie.computedConfigurable = !!r), i !== void 0 && (i === !0 && console.warn("WARNING: Debug feature only. MobX will NOT recover from errors when `disableErrorBoundaries` is enabled."), ie.disableErrorBoundaries = !!i), o && R0(o);
}
function Qu(t, e, n, r) {
  process.env.NODE_ENV !== "production" && (St(arguments.length >= 2 && arguments.length <= 4, "'extendObservable' expected 2-4 arguments"), St(typeof t == "object", "'extendObservable' expects an object as first argument"), St(!un(t), "'extendObservable' should not be used on maps, use map.merge instead")), r = to(r);
  var i = pg(r);
  return Pi(t), yc(t, r.name, i.enhancer), e && vg(t, e, n, i), t;
}
function pg(t) {
  return t.defaultDecorator || (t.deep === !1 ? Jv : hc);
}
function vg(t, e, n, r) {
  var i, o, a, s;
  if (process.env.NODE_ENV !== "production" && (St(!ni(e), "Extending an object with another observable (object) is not supported. Please construct an explicit propertymap, using `toJS` if need. See issue #540"), n)) {
    var l = uc(n);
    try {
      for (var u = rr(l), f = u.next(); !f.done; f = u.next()) {
        var c = f.value;
        c in e || De("Trying to declare a decorator for unspecified property '" + kn(c) + "'");
      }
    } catch (y) {
      i = { error: y };
    } finally {
      try {
        f && !f.done && (o = u.return) && o.call(u);
      } finally {
        if (i) throw i.error;
      }
    }
  }
  lr();
  try {
    var l = i0(e);
    try {
      for (var d = rr(l), h = d.next(); !h.done; h = d.next()) {
        var c = h.value, v = Object.getOwnPropertyDescriptor(e, c);
        process.env.NODE_ENV !== "production" && (Bi(e) || De("'extendObservable' only accepts plain objects as second argument"), mg(v.value) && De("Passing a 'computed' as initial property value is no longer supported by extendObservable. Use a getter or decorator instead"));
        var p = n && c in n ? n[c] : v.get ? ks : r;
        process.env.NODE_ENV !== "production" && typeof p != "function" && De("Not a valid decorator for '" + kn(c) + "', got: " + p);
        var g = p(t, c, v, !0);
        g && Object.defineProperty(t, c, g);
      }
    } catch (m) {
      a = { error: m };
    } finally {
      try {
        h && !h.done && (s = d.return) && s.call(d);
      } finally {
        if (a) throw a.error;
      }
    }
  } finally {
    ur();
  }
}
function U0(t, e) {
  return gg(ri(t, e));
}
function gg(t) {
  var e = {
    name: t.name
  };
  return t.observing && t.observing.length > 0 && (e.dependencies = e0(t.observing).map(gg)), e;
}
function yg(t, e) {
  if (t == null)
    return !1;
  if (e !== void 0) {
    if (vr(t) === !1 || !t[Me].values.has(e))
      return !1;
    var n = ri(t, e);
    return go(n);
  }
  return go(t);
}
function mg(t) {
  return arguments.length > 1 ? De(process.env.NODE_ENV !== "production" && "isComputed expects only 1 argument. Use isObservableProp to inspect the observability of a property") : yg(t);
}
function Ld(t, e) {
  return typeof e != "string" ? De(process.env.NODE_ENV !== "production" && "isComputed expected a property name as second argument") : yg(t, e);
}
function Y0(t, e) {
  return t == null ? !1 : vr(t) || !!t[Me] || fc(t) || Hs(t) || go(t);
}
function ni(t) {
  return arguments.length !== 1 && De(process.env.NODE_ENV !== "production" && "isObservable expects only 1 argument. Use isObservableProp to inspect the observability of a property"), Y0(t);
}
function yo(t) {
  return vr(t) ? t[Me].getKeys() : un(t) || Xn(t) ? Array.from(t.keys()) : Cr(t) ? t.map(function(e, n) {
    return n;
  }) : De(process.env.NODE_ENV !== "production" && "'keys()' can only be used on observable objects, arrays, sets and maps");
}
function V0(t) {
  return vr(t) ? yo(t).map(function(e) {
    return t[e];
  }) : un(t) ? yo(t).map(function(e) {
    return t.get(e);
  }) : Xn(t) ? Array.from(t.values()) : Cr(t) ? t.slice() : De(process.env.NODE_ENV !== "production" && "'values()' can only be used on observable objects, arrays, sets and maps");
}
function K0(t) {
  return vr(t) ? yo(t).map(function(e) {
    return [e, t[e]];
  }) : un(t) ? yo(t).map(function(e) {
    return [e, t.get(e)];
  }) : Xn(t) ? Array.from(t.entries()) : Cr(t) ? t.map(function(e, n) {
    return [n, e];
  }) : De(process.env.NODE_ENV !== "production" && "'entries()' can only be used on observable objects, arrays and maps");
}
function vc(t, e, n) {
  if (arguments.length === 2 && !Xn(t)) {
    lr();
    var r = e;
    try {
      for (var i in r)
        vc(t, i, r[i]);
    } finally {
      ur();
    }
    return;
  }
  if (vr(t)) {
    var o = t[Me], a = o.values.get(e);
    a ? o.write(e, n) : o.addObservableProp(e, n, o.defaultEnhancer);
  } else if (un(t))
    t.set(e, n);
  else if (Xn(t))
    t.add(e);
  else if (Cr(t))
    typeof e != "number" && (e = parseInt(e, 10)), St(e >= 0, "Not a valid index: '" + e + "'"), lr(), e >= t.length && (t.length = e + 1), t[e] = n, ur();
  else
    return De(process.env.NODE_ENV !== "production" && "'set()' can only be used on observable objects, arrays and maps");
}
function _g(t, e, n, r) {
  return q0(t, e, n);
}
function q0(t, e, n) {
  return Rl(t).observe(e, n);
}
var Z0 = {
  detectCycles: !0,
  exportMapsAsObjects: !0,
  recurseEverything: !1
};
function Yi(t, e, n, r) {
  return r.detectCycles && t.set(e, n), n;
}
function Ur(t, e, n) {
  if (!e.recurseEverything && !ni(t) || typeof t != "object")
    return t;
  if (t === null)
    return null;
  if (t instanceof Date)
    return t;
  if (O0(t))
    return Ur(t.get(), e, n);
  ni(t) && yo(t);
  var r = e.detectCycles === !0;
  if (r && t !== null && n.has(t))
    return n.get(t);
  if (Cr(t) || Array.isArray(t)) {
    var i = Yi(n, t, [], e), o = t.map(function(h) {
      return Ur(h, e, n);
    });
    i.length = o.length;
    for (var a = 0, s = o.length; a < s; a++)
      i[a] = o[a];
    return i;
  }
  if (Xn(t) || Object.getPrototypeOf(t) === Set.prototype)
    if (e.exportMapsAsObjects === !1) {
      var l = Yi(n, t, /* @__PURE__ */ new Set(), e);
      return t.forEach(function(h) {
        l.add(Ur(h, e, n));
      }), l;
    } else {
      var u = Yi(n, t, [], e);
      return t.forEach(function(h) {
        u.push(Ur(h, e, n));
      }), u;
    }
  if (un(t) || Object.getPrototypeOf(t) === Map.prototype)
    if (e.exportMapsAsObjects === !1) {
      var f = Yi(n, t, /* @__PURE__ */ new Map(), e);
      return t.forEach(function(h, v) {
        f.set(v, Ur(h, e, n));
      }), f;
    } else {
      var c = Yi(n, t, {}, e);
      return t.forEach(function(h, v) {
        c[v] = Ur(h, e, n);
      }), c;
    }
  var d = Yi(n, t, {}, e);
  return uc(t).forEach(function(h) {
    d[h] = Ur(t[h], e, n);
  }), d;
}
function tr(t, e) {
  typeof e == "boolean" && (e = { detectCycles: e }), e || (e = Z0), e.detectCycles = e.detectCycles === void 0 ? e.recurseEverything === !0 : e.detectCycles === !0;
  var n;
  return e.detectCycles && (n = /* @__PURE__ */ new Map()), Ur(t, e, n);
}
function J0() {
  for (var t = [], e = 0; e < arguments.length; e++)
    t[e] = arguments[e];
  var n = !1;
  typeof t[t.length - 1] == "boolean" && (n = t.pop());
  var r = Q0(t);
  if (!r)
    return De(process.env.NODE_ENV !== "production" && "'trace(break?)' can only be used inside a tracked computed value or a Reaction. Consider passing in the computed value or reaction explicitly");
  r.isTracing === sr.NONE && console.log("[mobx.trace] '" + r.name + "' tracing enabled"), r.isTracing = n ? sr.BREAK : sr.LOG;
}
function Q0(t) {
  switch (t.length) {
    case 0:
      return ie.trackingDerivation;
    case 1:
      return ri(t[0]);
    case 2:
      return ri(t[0], t[1]);
  }
}
function ir(t, e) {
  e === void 0 && (e = void 0), lr();
  try {
    return t.apply(e);
  } finally {
    ur();
  }
}
function Qa(t) {
  return t[Me];
}
function es(t) {
  return typeof t == "string" || typeof t == "number" || typeof t == "symbol";
}
var eb = {
  has: function(t, e) {
    if (e === Me || e === "constructor" || e === js)
      return !0;
    var n = Qa(t);
    return es(e) ? n.has(e) : e in t;
  },
  get: function(t, e) {
    if (e === Me || e === "constructor" || e === js)
      return t[e];
    var n = Qa(t), r = n.values.get(e);
    if (r instanceof To) {
      var i = r.get();
      return i === void 0 && n.has(e), i;
    }
    return es(e) && n.has(e), t[e];
  },
  set: function(t, e, n) {
    return es(e) ? (vc(t, e, n), !0) : !1;
  },
  deleteProperty: function(t, e) {
    if (!es(e))
      return !1;
    var n = Qa(t);
    return n.remove(e), !0;
  },
  ownKeys: function(t) {
    var e = Qa(t);
    return e.keysAtom.reportObserved(), Reflect.ownKeys(t);
  },
  preventExtensions: function(t) {
    return De("Dynamic observable objects cannot be frozen"), !1;
  }
};
function tb(t) {
  var e = new Proxy(t, eb);
  return t[Me].proxy = e, e;
}
function wr(t) {
  return t.interceptors !== void 0 && t.interceptors.length > 0;
}
function $a(t, e) {
  var n = t.interceptors || (t.interceptors = []);
  return n.push(e), sc(function() {
    var r = n.indexOf(e);
    r !== -1 && n.splice(r, 1);
  });
}
function Sr(t, e) {
  var n = No();
  try {
    for (var r = dc(t.interceptors || []), i = 0, o = r.length; i < o && (e = r[i](e), St(!e || e.type, "Intercept handlers should return nothing or a change object"), !!e); i++)
      ;
    return e;
  } finally {
    ei(n);
  }
}
function fr(t) {
  return t.changeListeners !== void 0 && t.changeListeners.length > 0;
}
function Ha(t, e) {
  var n = t.changeListeners || (t.changeListeners = []);
  return n.push(e), sc(function() {
    var r = n.indexOf(e);
    r !== -1 && n.splice(r, 1);
  });
}
function cr(t, e) {
  var n = No(), r = t.changeListeners;
  if (r) {
    r = r.slice();
    for (var i = 0, o = r.length; i < o; i++)
      r[i](e);
    ei(n);
  }
}
var nb = 1e4, rb = {
  get: function(t, e) {
    return e === Me ? t[Me] : e === "length" ? t[Me].getArrayLength() : typeof e == "number" ? Ir.get.call(t, e) : typeof e == "string" && !isNaN(e) ? Ir.get.call(t, parseInt(e)) : Ir.hasOwnProperty(e) ? Ir[e] : t[e];
  },
  set: function(t, e, n) {
    return e === "length" && t[Me].setArrayLength(n), typeof e == "number" && Ir.set.call(t, e, n), typeof e == "symbol" || isNaN(e) ? t[e] = n : Ir.set.call(t, parseInt(e), n), !0;
  },
  preventExtensions: function(t) {
    return De("Observable arrays cannot be frozen"), !1;
  }
};
function ib(t, e, n, r) {
  n === void 0 && (n = "ObservableArray@" + mn()), r === void 0 && (r = !1);
  var i = new bg(n, e, r);
  n0(i.values, Me, i);
  var o = new Proxy(i.values, rb);
  if (i.proxy = o, t && t.length) {
    var a = Pl(!0);
    i.spliceWithArray(0, 0, t), Dl(a);
  }
  return o;
}
var bg = (
  /** @class */
  function() {
    function t(e, n, r) {
      this.owned = r, this.values = [], this.proxy = void 0, this.lastKnownLength = 0, this.atom = new To(e || "ObservableArray@" + mn()), this.enhancer = function(i, o) {
        return n(i, o, e + "[..]");
      };
    }
    return t.prototype.dehanceValue = function(e) {
      return this.dehancer !== void 0 ? this.dehancer(e) : e;
    }, t.prototype.dehanceValues = function(e) {
      return this.dehancer !== void 0 && e.length > 0 ? e.map(this.dehancer) : e;
    }, t.prototype.intercept = function(e) {
      return $a(this, e);
    }, t.prototype.observe = function(e, n) {
      return n === void 0 && (n = !1), n && e({
        object: this.proxy,
        type: "splice",
        index: 0,
        added: this.values.slice(),
        addedCount: this.values.length,
        removed: [],
        removedCount: 0
      }), Ha(this, e);
    }, t.prototype.getArrayLength = function() {
      return this.atom.reportObserved(), this.values.length;
    }, t.prototype.setArrayLength = function(e) {
      if (typeof e != "number" || e < 0)
        throw new Error("[mobx.array] Out of range: " + e);
      var n = this.values.length;
      if (e !== n)
        if (e > n) {
          for (var r = new Array(e - n), i = 0; i < e - n; i++)
            r[i] = void 0;
          this.spliceWithArray(n, 0, r);
        } else
          this.spliceWithArray(e, n - e);
    }, t.prototype.updateArrayLength = function(e, n) {
      if (e !== this.lastKnownLength)
        throw new Error("[mobx] Modification exception: the internal structure of an observable array was changed.");
      this.lastKnownLength += n;
    }, t.prototype.spliceWithArray = function(e, n, r) {
      var i = this;
      po(this.atom);
      var o = this.values.length;
      if (e === void 0 ? e = 0 : e > o ? e = o : e < 0 && (e = Math.max(0, o + e)), arguments.length === 1 ? n = o - e : n == null ? n = 0 : n = Math.max(0, Math.min(n, o - e)), r === void 0 && (r = Is), wr(this)) {
        var a = Sr(this, {
          object: this.proxy,
          type: "splice",
          index: e,
          removedCount: n,
          added: r
        });
        if (!a)
          return Is;
        n = a.removedCount, r = a.added;
      }
      if (r = r.length === 0 ? r : r.map(function(u) {
        return i.enhancer(u, void 0);
      }), process.env.NODE_ENV !== "production") {
        var s = r.length - n;
        this.updateArrayLength(o, s);
      }
      var l = this.spliceItemsIntoValues(e, n, r);
      return (n !== 0 || r.length !== 0) && this.notifyArraySplice(e, r, l), this.dehanceValues(l);
    }, t.prototype.spliceItemsIntoValues = function(e, n, r) {
      var i;
      if (r.length < nb)
        return (i = this.values).splice.apply(i, dc([e, n], r));
      var o = this.values.slice(e, e + n);
      return this.values = this.values.slice(0, e).concat(r, this.values.slice(e + n)), o;
    }, t.prototype.notifyArrayChildUpdate = function(e, n, r) {
      var i = !this.owned && Yt(), o = fr(this), a = o || i ? {
        object: this.proxy,
        type: "update",
        index: e,
        newValue: n,
        oldValue: r
      } : null;
      i && process.env.NODE_ENV !== "production" && On(xt(xt({}, a), { name: this.atom.name })), this.atom.reportChanged(), o && cr(this, a), i && process.env.NODE_ENV !== "production" && An();
    }, t.prototype.notifyArraySplice = function(e, n, r) {
      var i = !this.owned && Yt(), o = fr(this), a = o || i ? {
        object: this.proxy,
        type: "splice",
        index: e,
        removed: r,
        added: n,
        removedCount: r.length,
        addedCount: n.length
      } : null;
      i && process.env.NODE_ENV !== "production" && On(xt(xt({}, a), { name: this.atom.name })), this.atom.reportChanged(), o && cr(this, a), i && process.env.NODE_ENV !== "production" && An();
    }, t;
  }()
), Ir = {
  intercept: function(t) {
    return this[Me].intercept(t);
  },
  observe: function(t, e) {
    e === void 0 && (e = !1);
    var n = this[Me];
    return n.observe(t, e);
  },
  clear: function() {
    return this.splice(0);
  },
  replace: function(t) {
    var e = this[Me];
    return e.spliceWithArray(0, e.values.length, t);
  },
  /**
   * Converts this array back to a (shallow) javascript structure.
   * For a deep clone use mobx.toJS
   */
  toJS: function() {
    return this.slice();
  },
  toJSON: function() {
    return this.toJS();
  },
  /*
   * functions that do alter the internal structure of the array, (based on lib.es6.d.ts)
   * since these functions alter the inner structure of the array, the have side effects.
   * Because the have side effects, they should not be used in computed function,
   * and for that reason the do not call dependencyState.notifyObserved
   */
  splice: function(t, e) {
    for (var n = [], r = 2; r < arguments.length; r++)
      n[r - 2] = arguments[r];
    var i = this[Me];
    switch (arguments.length) {
      case 0:
        return [];
      case 1:
        return i.spliceWithArray(t);
      case 2:
        return i.spliceWithArray(t, e);
    }
    return i.spliceWithArray(t, e, n);
  },
  spliceWithArray: function(t, e, n) {
    var r = this[Me];
    return r.spliceWithArray(t, e, n);
  },
  push: function() {
    for (var t = [], e = 0; e < arguments.length; e++)
      t[e] = arguments[e];
    var n = this[Me];
    return n.spliceWithArray(n.values.length, 0, t), n.values.length;
  },
  pop: function() {
    return this.splice(Math.max(this[Me].values.length - 1, 0), 1)[0];
  },
  shift: function() {
    return this.splice(0, 1)[0];
  },
  unshift: function() {
    for (var t = [], e = 0; e < arguments.length; e++)
      t[e] = arguments[e];
    var n = this[Me];
    return n.spliceWithArray(0, 0, t), n.values.length;
  },
  reverse: function() {
    process.env.NODE_ENV !== "production" && console.warn("[mobx] `observableArray.reverse()` will not update the array in place. Use `observableArray.slice().reverse()` to suppress this warning and perform the operation on a copy, or `observableArray.replace(observableArray.slice().reverse())` to reverse & update in place");
    var t = this.slice();
    return t.reverse.apply(t, arguments);
  },
  sort: function(t) {
    process.env.NODE_ENV !== "production" && console.warn("[mobx] `observableArray.sort()` will not update the array in place. Use `observableArray.slice().sort()` to suppress this warning and perform the operation on a copy, or `observableArray.replace(observableArray.slice().sort())` to sort & update in place");
    var e = this.slice();
    return e.sort.apply(e, arguments);
  },
  remove: function(t) {
    var e = this[Me], n = e.dehanceValues(e.values).indexOf(t);
    return n > -1 ? (this.splice(n, 1), !0) : !1;
  },
  get: function(t) {
    var e = this[Me];
    if (e) {
      if (t < e.values.length)
        return e.atom.reportObserved(), e.dehanceValue(e.values[t]);
      console.warn("[mobx.array] Attempt to read an array index (" + t + ") that is out of bounds (" + e.values.length + "). Please check length first. Out of bound indices will not be tracked by MobX");
    }
  },
  set: function(t, e) {
    var n = this[Me], r = n.values;
    if (t < r.length) {
      po(n.atom);
      var i = r[t];
      if (wr(n)) {
        var o = Sr(n, {
          type: "update",
          object: n.proxy,
          index: t,
          newValue: e
        });
        if (!o)
          return;
        e = o.newValue;
      }
      e = n.enhancer(e, i);
      var a = e !== i;
      a && (r[t] = e, n.notifyArrayChildUpdate(t, e, i));
    } else if (t === r.length)
      n.spliceWithArray(t, 0, [e]);
    else
      throw new Error("[mobx.array] Index out of bounds, " + t + " is larger than " + r.length);
  }
};
[
  "concat",
  "flat",
  "includes",
  "indexOf",
  "join",
  "lastIndexOf",
  "slice",
  "toString",
  "toLocaleString"
].forEach(function(t) {
  typeof Array.prototype[t] == "function" && (Ir[t] = function() {
    var e = this[Me];
    e.atom.reportObserved();
    var n = e.dehanceValues(e.values);
    return n[t].apply(n, arguments);
  });
});
["every", "filter", "find", "findIndex", "flatMap", "forEach", "map", "some"].forEach(function(t) {
  typeof Array.prototype[t] == "function" && (Ir[t] = function(e, n) {
    var r = this, i = this[Me];
    i.atom.reportObserved();
    var o = i.dehanceValues(i.values);
    return o[t](function(a, s) {
      return e.call(n, a, s, r);
    }, n);
  });
});
["reduce", "reduceRight"].forEach(function(t) {
  Ir[t] = function() {
    var e = this, n = this[Me];
    n.atom.reportObserved();
    var r = arguments[0];
    return arguments[0] = function(i, o, a) {
      return o = n.dehanceValue(o), r(i, o, a, e);
    }, n.values[t].apply(n.values, arguments);
  };
});
var ob = li("ObservableArrayAdministration", bg);
function Cr(t) {
  return lc(t) && ob(t[Me]);
}
var Id, ab = {}, gc = (
  /** @class */
  function() {
    function t(e, n, r) {
      if (n === void 0 && (n = Fa), r === void 0 && (r = "ObservableMap@" + mn()), this.enhancer = n, this.name = r, this[Id] = ab, this._keysAtom = cc(this.name + ".keys()"), this[Symbol.toStringTag] = "Map", typeof Map != "function")
        throw new Error("mobx.map requires Map polyfill for the current browser. Check babel-polyfill or core-js/es6/map.js");
      this._data = /* @__PURE__ */ new Map(), this._hasMap = /* @__PURE__ */ new Map(), this.merge(e);
    }
    return t.prototype._has = function(e) {
      return this._data.has(e);
    }, t.prototype.has = function(e) {
      var n = this;
      if (!ie.trackingDerivation)
        return this._has(e);
      var r = this._hasMap.get(e);
      if (!r) {
        var i = r = new Mi(this._has(e), Nl, this.name + "." + kn(e) + "?", !1);
        this._hasMap.set(e, i), dg(i, function() {
          return n._hasMap.delete(e);
        });
      }
      return r.get();
    }, t.prototype.set = function(e, n) {
      var r = this._has(e);
      if (wr(this)) {
        var i = Sr(this, {
          type: r ? "update" : "add",
          object: this,
          newValue: n,
          name: e
        });
        if (!i)
          return this;
        n = i.newValue;
      }
      return r ? this._updateValue(e, n) : this._addValue(e, n), this;
    }, t.prototype.delete = function(e) {
      var n = this;
      if (po(this._keysAtom), wr(this)) {
        var r = Sr(this, {
          type: "delete",
          object: this,
          name: e
        });
        if (!r)
          return !1;
      }
      if (this._has(e)) {
        var i = Yt(), o = fr(this), r = o || i ? {
          type: "delete",
          object: this,
          oldValue: this._data.get(e).value,
          name: e
        } : null;
        return i && process.env.NODE_ENV !== "production" && On(xt(xt({}, r), { name: this.name, key: e })), ir(function() {
          n._keysAtom.reportChanged(), n._updateHasMapEntry(e, !1);
          var s = n._data.get(e);
          s.setNewValue(void 0), n._data.delete(e);
        }), o && cr(this, r), i && process.env.NODE_ENV !== "production" && An(), !0;
      }
      return !1;
    }, t.prototype._updateHasMapEntry = function(e, n) {
      var r = this._hasMap.get(e);
      r && r.setNewValue(n);
    }, t.prototype._updateValue = function(e, n) {
      var r = this._data.get(e);
      if (n = r.prepareNewValue(n), n !== ie.UNCHANGED) {
        var i = Yt(), o = fr(this), a = o || i ? {
          type: "update",
          object: this,
          oldValue: r.value,
          name: e,
          newValue: n
        } : null;
        i && process.env.NODE_ENV !== "production" && On(xt(xt({}, a), { name: this.name, key: e })), r.setNewValue(n), o && cr(this, a), i && process.env.NODE_ENV !== "production" && An();
      }
    }, t.prototype._addValue = function(e, n) {
      var r = this;
      po(this._keysAtom), ir(function() {
        var s = new Mi(n, r.enhancer, r.name + "." + kn(e), !1);
        r._data.set(e, s), n = s.value, r._updateHasMapEntry(e, !0), r._keysAtom.reportChanged();
      });
      var i = Yt(), o = fr(this), a = o || i ? {
        type: "add",
        object: this,
        name: e,
        newValue: n
      } : null;
      i && process.env.NODE_ENV !== "production" && On(xt(xt({}, a), { name: this.name, key: e })), o && cr(this, a), i && process.env.NODE_ENV !== "production" && An();
    }, t.prototype.get = function(e) {
      return this.has(e) ? this.dehanceValue(this._data.get(e).get()) : this.dehanceValue(void 0);
    }, t.prototype.dehanceValue = function(e) {
      return this.dehancer !== void 0 ? this.dehancer(e) : e;
    }, t.prototype.keys = function() {
      return this._keysAtom.reportObserved(), this._data.keys();
    }, t.prototype.values = function() {
      var e = this, n = this.keys();
      return Ws({
        next: function() {
          var r = n.next(), i = r.done, o = r.value;
          return {
            done: i,
            value: i ? void 0 : e.get(o)
          };
        }
      });
    }, t.prototype.entries = function() {
      var e = this, n = this.keys();
      return Ws({
        next: function() {
          var r = n.next(), i = r.done, o = r.value;
          return {
            done: i,
            value: i ? void 0 : [o, e.get(o)]
          };
        }
      });
    }, t.prototype[Id = Me, Symbol.iterator] = function() {
      return this.entries();
    }, t.prototype.forEach = function(e, n) {
      var r, i;
      try {
        for (var o = rr(this), a = o.next(); !a.done; a = o.next()) {
          var s = ro(a.value, 2), l = s[0], u = s[1];
          e.call(n, u, l, this);
        }
      } catch (f) {
        r = { error: f };
      } finally {
        try {
          a && !a.done && (i = o.return) && i.call(o);
        } finally {
          if (r) throw r.error;
        }
      }
    }, t.prototype.merge = function(e) {
      var n = this;
      return un(e) && (e = e.toJS()), ir(function() {
        var r = Pl(!0);
        try {
          Bi(e) ? uc(e).forEach(function(i) {
            return n.set(i, e[i]);
          }) : Array.isArray(e) ? e.forEach(function(i) {
            var o = ro(i, 2), a = o[0], s = o[1];
            return n.set(a, s);
          }) : Co(e) ? (e.constructor !== Map && De("Cannot initialize from classes that inherit from Map: " + e.constructor.name), e.forEach(function(i, o) {
            return n.set(o, i);
          })) : e != null && De("Cannot initialize map from " + e);
        } finally {
          Dl(r);
        }
      }), this;
    }, t.prototype.clear = function() {
      var e = this;
      ir(function() {
        eg(function() {
          var n, r;
          try {
            for (var i = rr(e.keys()), o = i.next(); !o.done; o = i.next()) {
              var a = o.value;
              e.delete(a);
            }
          } catch (s) {
            n = { error: s };
          } finally {
            try {
              o && !o.done && (r = i.return) && r.call(i);
            } finally {
              if (n) throw n.error;
            }
          }
        });
      });
    }, t.prototype.replace = function(e) {
      var n = this;
      return ir(function() {
        var r, i, o, a, s = t0(e), l = /* @__PURE__ */ new Map(), u = !1;
        try {
          for (var f = rr(n._data.keys()), c = f.next(); !c.done; c = f.next()) {
            var d = c.value;
            if (!s.has(d)) {
              var h = n.delete(d);
              if (h)
                u = !0;
              else {
                var v = n._data.get(d);
                l.set(d, v);
              }
            }
          }
        } catch (I) {
          r = { error: I };
        } finally {
          try {
            c && !c.done && (i = f.return) && i.call(f);
          } finally {
            if (r) throw r.error;
          }
        }
        try {
          for (var p = rr(s.entries()), g = p.next(); !g.done; g = p.next()) {
            var y = ro(g.value, 2), d = y[0], v = y[1], m = n._data.has(d);
            if (n.set(d, v), n._data.has(d)) {
              var A = n._data.get(d);
              l.set(d, A), m || (u = !0);
            }
          }
        } catch (I) {
          o = { error: I };
        } finally {
          try {
            g && !g.done && (a = p.return) && a.call(p);
          } finally {
            if (o) throw o.error;
          }
        }
        if (!u)
          if (n._data.size !== l.size)
            n._keysAtom.reportChanged();
          else
            for (var T = n._data.keys(), k = l.keys(), C = T.next(), S = k.next(); !C.done; ) {
              if (C.value !== S.value) {
                n._keysAtom.reportChanged();
                break;
              }
              C = T.next(), S = k.next();
            }
        n._data = l;
      }), this;
    }, Object.defineProperty(t.prototype, "size", {
      get: function() {
        return this._keysAtom.reportObserved(), this._data.size;
      },
      enumerable: !0,
      configurable: !0
    }), t.prototype.toPOJO = function() {
      var e, n, r = {};
      try {
        for (var i = rr(this), o = i.next(); !o.done; o = i.next()) {
          var a = ro(o.value, 2), s = a[0], l = a[1];
          r[typeof s == "symbol" ? s : kn(s)] = l;
        }
      } catch (u) {
        e = { error: u };
      } finally {
        try {
          o && !o.done && (n = i.return) && n.call(i);
        } finally {
          if (e) throw e.error;
        }
      }
      return r;
    }, t.prototype.toJS = function() {
      return new Map(this);
    }, t.prototype.toJSON = function() {
      return this.toPOJO();
    }, t.prototype.toString = function() {
      var e = this;
      return this.name + "[{ " + Array.from(this.keys()).map(function(n) {
        return kn(n) + ": " + ("" + e.get(n));
      }).join(", ") + " }]";
    }, t.prototype.observe = function(e, n) {
      return process.env.NODE_ENV !== "production" && St(n !== !0, "`observe` doesn't support fireImmediately=true in combination with maps."), Ha(this, e);
    }, t.prototype.intercept = function(e) {
      return $a(this, e);
    }, t;
  }()
), un = li("ObservableMap", gc), jd, sb = {}, xg = (
  /** @class */
  function() {
    function t(e, n, r) {
      if (n === void 0 && (n = Fa), r === void 0 && (r = "ObservableSet@" + mn()), this.name = r, this[jd] = sb, this._data = /* @__PURE__ */ new Set(), this._atom = cc(this.name), this[Symbol.toStringTag] = "Set", typeof Set != "function")
        throw new Error("mobx.set requires Set polyfill for the current browser. Check babel-polyfill or core-js/es6/set.js");
      this.enhancer = function(i, o) {
        return n(i, o, r);
      }, e && this.replace(e);
    }
    return t.prototype.dehanceValue = function(e) {
      return this.dehancer !== void 0 ? this.dehancer(e) : e;
    }, t.prototype.clear = function() {
      var e = this;
      ir(function() {
        eg(function() {
          var n, r;
          try {
            for (var i = rr(e._data.values()), o = i.next(); !o.done; o = i.next()) {
              var a = o.value;
              e.delete(a);
            }
          } catch (s) {
            n = { error: s };
          } finally {
            try {
              o && !o.done && (r = i.return) && r.call(i);
            } finally {
              if (n) throw n.error;
            }
          }
        });
      });
    }, t.prototype.forEach = function(e, n) {
      var r, i;
      try {
        for (var o = rr(this), a = o.next(); !a.done; a = o.next()) {
          var s = a.value;
          e.call(n, s, s, this);
        }
      } catch (l) {
        r = { error: l };
      } finally {
        try {
          a && !a.done && (i = o.return) && i.call(o);
        } finally {
          if (r) throw r.error;
        }
      }
    }, Object.defineProperty(t.prototype, "size", {
      get: function() {
        return this._atom.reportObserved(), this._data.size;
      },
      enumerable: !0,
      configurable: !0
    }), t.prototype.add = function(e) {
      var n = this;
      if (po(this._atom), wr(this)) {
        var r = Sr(this, {
          type: "add",
          object: this,
          newValue: e
        });
        if (!r)
          return this;
      }
      if (!this.has(e)) {
        ir(function() {
          n._data.add(n.enhancer(e, void 0)), n._atom.reportChanged();
        });
        var i = Yt(), o = fr(this), r = o || i ? {
          type: "add",
          object: this,
          newValue: e
        } : null;
        i && process.env.NODE_ENV !== "production" && On(r), o && cr(this, r), i && process.env.NODE_ENV !== "production" && An();
      }
      return this;
    }, t.prototype.delete = function(e) {
      var n = this;
      if (wr(this)) {
        var r = Sr(this, {
          type: "delete",
          object: this,
          oldValue: e
        });
        if (!r)
          return !1;
      }
      if (this.has(e)) {
        var i = Yt(), o = fr(this), r = o || i ? {
          type: "delete",
          object: this,
          oldValue: e
        } : null;
        return i && process.env.NODE_ENV !== "production" && On(xt(xt({}, r), { name: this.name })), ir(function() {
          n._atom.reportChanged(), n._data.delete(e);
        }), o && cr(this, r), i && process.env.NODE_ENV !== "production" && An(), !0;
      }
      return !1;
    }, t.prototype.has = function(e) {
      return this._atom.reportObserved(), this._data.has(this.dehanceValue(e));
    }, t.prototype.entries = function() {
      var e = 0, n = Array.from(this.keys()), r = Array.from(this.values());
      return Ws({
        next: function() {
          var i = e;
          return e += 1, i < r.length ? { value: [n[i], r[i]], done: !1 } : { done: !0 };
        }
      });
    }, t.prototype.keys = function() {
      return this.values();
    }, t.prototype.values = function() {
      this._atom.reportObserved();
      var e = this, n = 0, r = Array.from(this._data.values());
      return Ws({
        next: function() {
          return n < r.length ? { value: e.dehanceValue(r[n++]), done: !1 } : { done: !0 };
        }
      });
    }, t.prototype.replace = function(e) {
      var n = this;
      return Xn(e) && (e = e.toJS()), ir(function() {
        var r = Pl(!0);
        try {
          Array.isArray(e) ? (n.clear(), e.forEach(function(i) {
            return n.add(i);
          })) : Ba(e) ? (n.clear(), e.forEach(function(i) {
            return n.add(i);
          })) : e != null && De("Cannot initialize set from " + e);
        } finally {
          Dl(r);
        }
      }), this;
    }, t.prototype.observe = function(e, n) {
      return process.env.NODE_ENV !== "production" && St(n !== !0, "`observe` doesn't support fireImmediately=true in combination with sets."), Ha(this, e);
    }, t.prototype.intercept = function(e) {
      return $a(this, e);
    }, t.prototype.toJS = function() {
      return new Set(this);
    }, t.prototype.toString = function() {
      return this.name + "[ " + Array.from(this).join(", ") + " ]";
    }, t.prototype[jd = Me, Symbol.iterator] = function() {
      return this.values();
    }, t;
  }()
), Xn = li("ObservableSet", xg), Eg = (
  /** @class */
  function() {
    function t(e, n, r, i) {
      n === void 0 && (n = /* @__PURE__ */ new Map()), this.target = e, this.values = n, this.name = r, this.defaultEnhancer = i, this.keysAtom = new To(r + ".keys");
    }
    return t.prototype.read = function(e) {
      return this.values.get(e).get();
    }, t.prototype.write = function(e, n) {
      var r = this.target, i = this.values.get(e);
      if (i instanceof vo) {
        i.set(n);
        return;
      }
      if (wr(this)) {
        var o = Sr(this, {
          type: "update",
          object: this.proxy || r,
          name: e,
          newValue: n
        });
        if (!o)
          return;
        n = o.newValue;
      }
      if (n = i.prepareNewValue(n), n !== ie.UNCHANGED) {
        var a = fr(this), s = Yt(), o = a || s ? {
          type: "update",
          object: this.proxy || r,
          oldValue: i.value,
          name: e,
          newValue: n
        } : null;
        s && process.env.NODE_ENV !== "production" && On(xt(xt({}, o), { name: this.name, key: e })), i.setNewValue(n), a && cr(this, o), s && process.env.NODE_ENV !== "production" && An();
      }
    }, t.prototype.has = function(e) {
      var n = this.pendingKeys || (this.pendingKeys = /* @__PURE__ */ new Map()), r = n.get(e);
      if (r)
        return r.get();
      var i = !!this.values.get(e);
      return r = new Mi(i, Nl, this.name + "." + kn(e) + "?", !1), n.set(e, r), r.get();
    }, t.prototype.addObservableProp = function(e, n, r) {
      r === void 0 && (r = this.defaultEnhancer);
      var i = this.target;
      if (r0(i, e), wr(this)) {
        var o = Sr(this, {
          object: this.proxy || i,
          name: e,
          type: "add",
          newValue: n
        });
        if (!o)
          return;
        n = o.newValue;
      }
      var a = new Mi(n, r, this.name + "." + kn(e), !1);
      this.values.set(e, a), n = a.value, Object.defineProperty(i, e, lb(e)), this.notifyPropertyAddition(e, n);
    }, t.prototype.addComputedProp = function(e, n, r) {
      var i = this.target;
      r.name = r.name || this.name + "." + kn(n), this.values.set(n, new vo(r)), (e === i || Vv(e, n)) && Object.defineProperty(e, n, ub(n));
    }, t.prototype.remove = function(e) {
      if (this.values.has(e)) {
        var n = this.target;
        if (wr(this)) {
          var r = Sr(this, {
            object: this.proxy || n,
            name: e,
            type: "remove"
          });
          if (!r)
            return;
        }
        try {
          lr();
          var i = fr(this), o = Yt(), a = this.values.get(e), s = a && a.get();
          if (a && a.set(void 0), this.keysAtom.reportChanged(), this.values.delete(e), this.pendingKeys) {
            var l = this.pendingKeys.get(e);
            l && l.set(!1);
          }
          delete this.target[e];
          var r = i || o ? {
            type: "remove",
            object: this.proxy || n,
            oldValue: s,
            name: e
          } : null;
          o && process.env.NODE_ENV !== "production" && On(xt(xt({}, r), { name: this.name, key: e })), i && cr(this, r), o && process.env.NODE_ENV !== "production" && An();
        } finally {
          ur();
        }
      }
    }, t.prototype.illegalAccess = function(e, n) {
      console.warn("Property '" + n + "' of '" + e + "' was accessed through the prototype chain. Use 'decorate' instead to declare the prop or access it statically through it's owner");
    }, t.prototype.observe = function(e, n) {
      return process.env.NODE_ENV !== "production" && St(n !== !0, "`observe` doesn't support the fire immediately property for observable objects."), Ha(this, e);
    }, t.prototype.intercept = function(e) {
      return $a(this, e);
    }, t.prototype.notifyPropertyAddition = function(e, n) {
      var r = fr(this), i = Yt(), o = r || i ? {
        type: "add",
        object: this.proxy || this.target,
        name: e,
        newValue: n
      } : null;
      if (i && process.env.NODE_ENV !== "production" && On(xt(xt({}, o), { name: this.name, key: e })), r && cr(this, o), i && process.env.NODE_ENV !== "production" && An(), this.pendingKeys) {
        var a = this.pendingKeys.get(e);
        a && a.set(!0);
      }
      this.keysAtom.reportChanged();
    }, t.prototype.getKeys = function() {
      var e, n;
      this.keysAtom.reportObserved();
      var r = [];
      try {
        for (var i = rr(this.values), o = i.next(); !o.done; o = i.next()) {
          var a = ro(o.value, 2), s = a[0], l = a[1];
          l instanceof Mi && r.push(s);
        }
      } catch (u) {
        e = { error: u };
      } finally {
        try {
          o && !o.done && (n = i.return) && n.call(i);
        } finally {
          if (e) throw e.error;
        }
      }
      return r;
    }, t;
  }()
);
function yc(t, e, n) {
  if (e === void 0 && (e = ""), n === void 0 && (n = Fa), Object.prototype.hasOwnProperty.call(t, Me))
    return t[Me];
  process.env.NODE_ENV !== "production" && St(Object.isExtensible(t), "Cannot make the designated object observable; it is not extensible"), Bi(t) || (e = (t.constructor.name || "ObservableObject") + "@" + mn()), e || (e = "ObservableObject@" + mn());
  var r = new Eg(t, /* @__PURE__ */ new Map(), kn(e), n);
  return Ao(t, Me, r), r;
}
var kd = /* @__PURE__ */ Object.create(null), Bd = /* @__PURE__ */ Object.create(null);
function lb(t) {
  return kd[t] || (kd[t] = {
    configurable: !0,
    enumerable: !0,
    get: function() {
      return this[Me].read(t);
    },
    set: function(e) {
      this[Me].write(t, e);
    }
  });
}
function Fd(t) {
  var e = t[Me];
  return e || (Pi(t), t[Me]);
}
function ub(t) {
  return Bd[t] || (Bd[t] = {
    configurable: ie.computedConfigurable,
    enumerable: !1,
    get: function() {
      return Fd(this).read(t);
    },
    set: function(e) {
      Fd(this).write(t, e);
    }
  });
}
var fb = li("ObservableObjectAdministration", Eg);
function vr(t) {
  return lc(t) ? (Pi(t), fb(t[Me])) : !1;
}
function ri(t, e) {
  if (typeof t == "object" && t !== null) {
    if (Cr(t))
      return e !== void 0 && De(process.env.NODE_ENV !== "production" && "It is not possible to get index atoms from arrays"), t[Me].atom;
    if (Xn(t))
      return t[Me];
    if (un(t)) {
      var n = t;
      if (e === void 0)
        return n._keysAtom;
      var r = n._data.get(e) || n._hasMap.get(e);
      return r || De(process.env.NODE_ENV !== "production" && "the entry '" + e + "' does not exist in the observable map '" + ef(t) + "'"), r;
    }
    if (Pi(t), e && !t[Me] && t[e], vr(t)) {
      if (!e)
        return De(process.env.NODE_ENV !== "production" && "please specify a property");
      var r = t[Me].values.get(e);
      return r || De(process.env.NODE_ENV !== "production" && "no observable property '" + e + "' found on the observable object '" + ef(t) + "'"), r;
    }
    if (fc(t) || go(t) || Hs(t))
      return t;
  } else if (typeof t == "function" && Hs(t[Me]))
    return t[Me];
  return De(process.env.NODE_ENV !== "production" && "Cannot obtain atom from " + t);
}
function Rl(t, e) {
  if (t || De("Expecting some object"), e !== void 0)
    return Rl(ri(t, e));
  if (fc(t) || go(t) || Hs(t) || un(t) || Xn(t))
    return t;
  if (Pi(t), t[Me])
    return t[Me];
  De(process.env.NODE_ENV !== "production" && "Cannot obtain administration from " + t);
}
function ef(t, e) {
  var n;
  return e !== void 0 ? n = ri(t, e) : vr(t) || un(t) || Xn(t) ? n = Rl(t) : n = ri(t), n.name;
}
var $d = Object.prototype.toString;
function wg(t, e, n) {
  return n === void 0 && (n = -1), tf(t, e, n);
}
function tf(t, e, n, r, i) {
  if (t === e)
    return t !== 0 || 1 / t === 1 / e;
  if (t == null || e == null)
    return !1;
  if (t !== t)
    return e !== e;
  var o = typeof t;
  if (o !== "function" && o !== "object" && typeof e != "object")
    return !1;
  var a = $d.call(t);
  if (a !== $d.call(e))
    return !1;
  switch (a) {
    // Strings, numbers, regular expressions, dates, and booleans are compared by value.
    case "[object RegExp]":
    // RegExps are coerced to strings for comparison (Note: '' + /a/i === '/a/i')
    case "[object String]":
      return "" + t == "" + e;
    case "[object Number]":
      return +t != +t ? +e != +e : +t == 0 ? 1 / +t === 1 / e : +t == +e;
    case "[object Date]":
    case "[object Boolean]":
      return +t == +e;
    case "[object Symbol]":
      return typeof Symbol < "u" && Symbol.valueOf.call(t) === Symbol.valueOf.call(e);
    case "[object Map]":
    case "[object Set]":
      n >= 0 && n++;
      break;
  }
  t = Hd(t), e = Hd(e);
  var s = a === "[object Array]";
  if (!s) {
    if (typeof t != "object" || typeof e != "object")
      return !1;
    var l = t.constructor, u = e.constructor;
    if (l !== u && !(typeof l == "function" && l instanceof l && typeof u == "function" && u instanceof u) && "constructor" in t && "constructor" in e)
      return !1;
  }
  if (n === 0)
    return !1;
  n < 0 && (n = -1), r = r || [], i = i || [];
  for (var f = r.length; f--; )
    if (r[f] === t)
      return i[f] === e;
  if (r.push(t), i.push(e), s) {
    if (f = t.length, f !== e.length)
      return !1;
    for (; f--; )
      if (!tf(t[f], e[f], n - 1, r, i))
        return !1;
  } else {
    var c = Object.keys(t), d = void 0;
    if (f = c.length, Object.keys(e).length !== f)
      return !1;
    for (; f--; )
      if (d = c[f], !(cb(e, d) && tf(t[d], e[d], n - 1, r, i)))
        return !1;
  }
  return r.pop(), i.pop(), !0;
}
function Hd(t) {
  return Cr(t) ? t.slice() : Co(t) || un(t) || Ba(t) || Xn(t) ? Array.from(t.entries()) : t;
}
function cb(t, e) {
  return Object.prototype.hasOwnProperty.call(t, e);
}
function Ws(t) {
  return t[Symbol.iterator] = db, t;
}
function db() {
  return this;
}
if (typeof Proxy > "u" || typeof Symbol > "u")
  throw new Error("[mobx] MobX 5+ requires Proxy and Symbol objects. If your environment doesn't support Symbol or Proxy objects, please downgrade to MobX 4. For React Native Android, consider upgrading JSCore.");
try {
  process.env.NODE_ENV;
} catch {
  var Wd = $s();
  typeof process > "u" && (Wd.process = {}), Wd.process.env = {};
}
(function() {
  function t() {
  }
  if (t.name !== "testCodeMinification" && process.env.NODE_ENV !== "production" && typeof process < "u" && process.env.IGNORE_MOBX_MINIFY_WARNING !== "true") {
    var e = ["process", "env", "NODE_ENV"].join(".");
    console.warn("[mobx] you are running a minified build, but '" + e + "' was not set to 'production' in your bundler. This results in an unnecessarily large and slow bundle");
  }
})();
typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__ == "object" && __MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({
  spy: I0,
  extras: {
    getDebugName: ef
  },
  $mobx: Me
});
function hb(t) {
  return !(t.prototype && t.prototype.render) && !Ye.isPrototypeOf(t);
}
function Sg(t) {
  var e = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {}, n = e.prefix, r = n === void 0 ? "" : n, i = e.suffix, o = i === void 0 ? "" : i, a = t.displayName || t.name || t.constructor && t.constructor.name || "<component>";
  return r + a + o;
}
var zd = typeof Symbol == "function" && typeof Symbol.iterator == "symbol" ? function(t) {
  return typeof t;
} : function(t) {
  return t && typeof Symbol == "function" && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t;
}, Og = function(t, e) {
  if (!(t instanceof e))
    throw new TypeError("Cannot call a class as a function");
}, Ag = /* @__PURE__ */ function() {
  function t(e, n) {
    for (var r = 0; r < n.length; r++) {
      var i = n[r];
      i.enumerable = i.enumerable || !1, i.configurable = !0, "value" in i && (i.writable = !0), Object.defineProperty(e, i.key, i);
    }
  }
  return function(e, n, r) {
    return n && t(e.prototype, n), r && t(e, r), e;
  };
}(), Cg = function(t, e) {
  if (typeof e != "function" && e !== null)
    throw new TypeError("Super expression must either be null or a function, not " + typeof e);
  t.prototype = Object.create(e && e.prototype, {
    constructor: {
      value: t,
      enumerable: !1,
      writable: !0,
      configurable: !0
    }
  }), e && (Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : t.__proto__ = e);
}, Tg = function(t, e) {
  if (!t)
    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
  return e && (typeof e == "object" || typeof e == "function") ? e : t;
}, Xd = console;
function pb(t) {
  var e = Zu().allowStateChanges;
  return Zu().allowStateChanges = t, e;
}
function vb(t) {
  Zu().allowStateChanges = t;
}
function gb(t, e, n, r, i) {
  var o = pb(t), a = void 0;
  try {
    a = e(n, r, i);
  } finally {
    vb(o);
  }
  return a;
}
function Gd(t, e) {
  var n = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : !1, r = t[e], i = Ng[e], o = r ? n === !0 ? function() {
    i.apply(this, arguments), r.apply(this, arguments);
  } : function() {
    r.apply(this, arguments), i.apply(this, arguments);
  } : i;
  t[e] = o;
}
function Ud(t, e) {
  if (t == null || e == null || (typeof t > "u" ? "undefined" : zd(t)) !== "object" || (typeof e > "u" ? "undefined" : zd(e)) !== "object")
    return t !== e;
  var n = Object.keys(t);
  if (n.length !== Object.keys(e).length)
    return !0;
  for (var r = void 0, i = n.length - 1; r = n[i]; i--)
    if (e[r] !== t[r])
      return !0;
  return !1;
}
var Ng = {
  componentWillMount: function() {
    var e = this, n = Sg(this), r = !1, i = !1;
    function o(c) {
      var d = this[c], h = cc("reactive " + c);
      Object.defineProperty(this, c, {
        configurable: !0,
        enumerable: !0,
        get: function() {
          return h.reportObserved(), d;
        },
        set: function(p) {
          !i && Ud(d, p) ? (d = p, r = !0, h.reportChanged(), r = !1) : d = p;
        }
      });
    }
    o.call(this, "props"), o.call(this, "state");
    var a = this.render.bind(this), s = null, l = !1, u = function() {
      return s = new Sa(n + ".render()", function() {
        if (!l && (l = !0, typeof e.componentWillReact == "function" && e.componentWillReact(), e.__$mobxIsUnmounted !== !0)) {
          var d = !0;
          try {
            i = !0, r || Ye.prototype.forceUpdate.call(e), d = !1;
          } finally {
            i = !1, d && s.dispose();
          }
        }
      }), s.reactComponent = e, f.$mobx = s, e.render = f, f(e.props, e.state, e.context);
    }, f = function(d, h, v) {
      l = !1;
      var p = void 0, g = void 0;
      if (s.track(function() {
        try {
          g = gb(!1, a, d, h, v);
        } catch (y) {
          p = y;
        }
      }), p)
        throw p;
      return g;
    };
    this.render = u;
  },
  componentWillUnmount: function() {
    this.render.$mobx && this.render.$mobx.dispose(), this.__$mobxIsUnmounted = !0;
  },
  componentDidMount: function() {
  },
  componentDidUpdate: function() {
  },
  shouldComponentUpdate: function(e, n) {
    return this.state !== n ? !0 : Ud(this.props, e);
  }
};
function mc(t) {
  if (arguments.length > 1 && Xd.warn('Mobx observer: Using observer to inject stores is not supported. Use `@connect(["store1", "store2"]) ComponentClass instead or preferably, use `@inject("store1", "store2") @observer ComponentClass` or `inject("store1", "store2")(observer(componentClass))``'), t.isMobxInjector === !0 && Xd.warn("Mobx observer: You are trying to use 'observer' on a component that already has 'inject'. Please apply 'observer' before applying 'inject'"), hb(t)) {
    var e, n;
    return mc((n = e = function(i) {
      Cg(o, i);
      function o() {
        return Og(this, o), Tg(this, (o.__proto__ || Object.getPrototypeOf(o)).apply(this, arguments));
      }
      return Ag(o, [{
        key: "render",
        value: function() {
          return t.call(this, this.props, this.context);
        }
      }]), o;
    }(Ye), e.displayName = Sg(t), n));
  }
  if (!t)
    throw new Error("Please pass a valid component to 'observer'");
  var r = t.prototype || t;
  return yb(r), t.isMobXReactObserver = !0, t;
}
function yb(t) {
  Gd(t, "componentWillMount", !0), Gd(t, "componentDidMount"), t.shouldComponentUpdate || (t.shouldComponentUpdate = Ng.shouldComponentUpdate);
}
var mb = mc(function(t) {
  var e = t.children;
  return e[0]();
});
mb.displayName = "Observer";
var _b = typeof window < "u" ? window : typeof global < "u" ? global : typeof self < "u" ? self : {};
function bb(t, e) {
  return e = { exports: {} }, t(e, e.exports), e.exports;
}
bb(function(t, e) {
  (function(n, r) {
    t.exports = r();
  })(_b, function() {
    var n = {
      childContextTypes: !0,
      contextTypes: !0,
      defaultProps: !0,
      displayName: !0,
      getDefaultProps: !0,
      getDerivedStateFromProps: !0,
      mixins: !0,
      propTypes: !0,
      type: !0
    }, r = {
      name: !0,
      length: !0,
      prototype: !0,
      caller: !0,
      callee: !0,
      arguments: !0,
      arity: !0
    }, i = Object.defineProperty, o = Object.getOwnPropertyNames, a = Object.getOwnPropertySymbols, s = Object.getOwnPropertyDescriptor, l = Object.getPrototypeOf, u = l && l(Object);
    return function f(c, d, h) {
      if (typeof d != "string") {
        if (u) {
          var v = l(d);
          v && v !== u && f(c, v, h);
        }
        var p = o(d);
        a && (p = p.concat(a(d)));
        for (var g = 0; g < p.length; ++g) {
          var y = p[g];
          if (!n[y] && !r[y] && (!h || !h[y])) {
            var m = s(d, y);
            try {
              i(c, y, m);
            } catch {
            }
          }
        }
        return c;
      }
      return c;
    };
  });
});
var Yd = { children: !0, key: !0, ref: !0 }, Vd = console;
(function(t) {
  Cg(e, t);
  function e() {
    return Og(this, e), Tg(this, (e.__proto__ || Object.getPrototypeOf(e)).apply(this, arguments));
  }
  return Ag(e, [{
    key: "render",
    value: function(r) {
      var i = r.children;
      return i.length > 1 ? ae(
        "div",
        null,
        " ",
        i,
        " "
      ) : i[0];
    }
  }, {
    key: "getChildContext",
    value: function() {
      var r = {}, i = this.context.mobxStores;
      if (i)
        for (var o in i)
          r[o] = i[o];
      for (var a in this.props)
        !Yd[a] && a !== "suppressChangedStoreWarning" && (r[a] = this.props[a]);
      return {
        mobxStores: r
      };
    }
  }, {
    key: "componentWillReceiveProps",
    value: function(r) {
      if (Object.keys(r).length !== Object.keys(this.props).length && Vd.warn("MobX Provider: The set of provided stores has changed. Please avoid changing stores as the change might not propagate to all children"), !r.suppressChangedStoreWarning)
        for (var i in r)
          !Yd[i] && this.props[i] !== r[i] && Vd.warn("MobX Provider: Provided store '" + i + "' has changed. Please avoid replacing stores as the change might not propagate to all children");
    }
  }]), e;
})(Ye);
if (!Ye)
  throw new Error("mobx-preact requires Preact to be available");
var xr, yu, Kd, Mg = [], Ut = He, qd = Ut.__b, Zd = Ut.__r, Jd = Ut.diffed, Qd = Ut.__c, eh = Ut.unmount, th = Ut.__;
function xb() {
  for (var t; t = Mg.shift(); ) if (t.__P && t.__H) try {
    t.__H.__h.forEach(Os), t.__H.__h.forEach(nf), t.__H.__h = [];
  } catch (e) {
    t.__H.__h = [], Ut.__e(e, t.__v);
  }
}
Ut.__b = function(t) {
  xr = null, qd && qd(t);
}, Ut.__ = function(t, e) {
  t && e.__k && e.__k.__m && (t.__m = e.__k.__m), th && th(t, e);
}, Ut.__r = function(t) {
  Zd && Zd(t);
  var e = (xr = t.__c).__H;
  e && (yu === xr ? (e.__h = [], xr.__h = [], e.__.forEach(function(n) {
    n.__N && (n.__ = n.__N), n.i = n.__N = void 0;
  })) : (e.__h.forEach(Os), e.__h.forEach(nf), e.__h = [])), yu = xr;
}, Ut.diffed = function(t) {
  Jd && Jd(t);
  var e = t.__c;
  e && e.__H && (e.__H.__h.length && (Mg.push(e) !== 1 && Kd === Ut.requestAnimationFrame || ((Kd = Ut.requestAnimationFrame) || Eb)(xb)), e.__H.__.forEach(function(n) {
    n.i && (n.__H = n.i), n.i = void 0;
  })), yu = xr = null;
}, Ut.__c = function(t, e) {
  e.some(function(n) {
    try {
      n.__h.forEach(Os), n.__h = n.__h.filter(function(r) {
        return !r.__ || nf(r);
      });
    } catch (r) {
      e.some(function(i) {
        i.__h && (i.__h = []);
      }), e = [], Ut.__e(r, n.__v);
    }
  }), Qd && Qd(t, e);
}, Ut.unmount = function(t) {
  eh && eh(t);
  var e, n = t.__c;
  n && n.__H && (n.__H.__.forEach(function(r) {
    try {
      Os(r);
    } catch (i) {
      e = i;
    }
  }), n.__H = void 0, e && Ut.__e(e, n.__v));
};
var nh = typeof requestAnimationFrame == "function";
function Eb(t) {
  var e, n = function() {
    clearTimeout(r), nh && cancelAnimationFrame(e), setTimeout(t);
  }, r = setTimeout(n, 100);
  nh && (e = requestAnimationFrame(n));
}
function Os(t) {
  var e = xr, n = t.__c;
  typeof n == "function" && (t.__c = void 0, n()), xr = e;
}
function nf(t) {
  var e = xr;
  t.__c = t.__(), xr = e;
}
function wb(t, e) {
  for (var n in e) t[n] = e[n];
  return t;
}
function rh(t, e) {
  for (var n in t) if (n !== "__source" && !(n in e)) return !0;
  for (var r in e) if (r !== "__source" && t[r] !== e[r]) return !0;
  return !1;
}
function ih(t, e) {
  this.props = t, this.context = e;
}
(ih.prototype = new Ye()).isPureReactComponent = !0, ih.prototype.shouldComponentUpdate = function(t, e) {
  return rh(this.props, t) || rh(this.state, e);
};
var oh = He.__b;
He.__b = function(t) {
  t.type && t.type.__f && t.ref && (t.props.ref = t.ref, t.ref = null), oh && oh(t);
};
var Sb = He.__e;
He.__e = function(t, e, n, r) {
  if (t.then) {
    for (var i, o = e; o = o.__; ) if ((i = o.__c) && i.__c) return e.__e == null && (e.__e = n.__e, e.__k = n.__k), i.__c(t, e);
  }
  Sb(t, e, n, r);
};
var ah = He.unmount;
function Pg(t, e, n) {
  return t && (t.__c && t.__c.__H && (t.__c.__H.__.forEach(function(r) {
    typeof r.__c == "function" && r.__c();
  }), t.__c.__H = null), (t = wb({}, t)).__c != null && (t.__c.__P === n && (t.__c.__P = e), t.__c = null), t.__k = t.__k && t.__k.map(function(r) {
    return Pg(r, e, n);
  })), t;
}
function Dg(t, e, n) {
  return t && n && (t.__v = null, t.__k = t.__k && t.__k.map(function(r) {
    return Dg(r, e, n);
  }), t.__c && t.__c.__P === e && (t.__e && n.appendChild(t.__e), t.__c.__e = !0, t.__c.__P = n)), t;
}
function mu() {
  this.__u = 0, this.o = null, this.__b = null;
}
function Rg(t) {
  var e = t.__.__c;
  return e && e.__a && e.__a(t);
}
function ts() {
  this.i = null, this.l = null;
}
He.unmount = function(t) {
  var e = t.__c;
  e && e.__R && e.__R(), e && 32 & t.__u && (t.type = null), ah && ah(t);
}, (mu.prototype = new Ye()).__c = function(t, e) {
  var n = e.__c, r = this;
  r.o == null && (r.o = []), r.o.push(n);
  var i = Rg(r.__v), o = !1, a = function() {
    o || (o = !0, n.__R = null, i ? i(s) : s());
  };
  n.__R = a;
  var s = function() {
    if (!--r.__u) {
      if (r.state.__a) {
        var l = r.state.__a;
        r.__v.__k[0] = Dg(l, l.__c.__P, l.__c.__O);
      }
      var u;
      for (r.setState({ __a: r.__b = null }); u = r.o.pop(); ) u.forceUpdate();
    }
  };
  r.__u++ || 32 & e.__u || r.setState({ __a: r.__b = r.__v.__k[0] }), t.then(a, a);
}, mu.prototype.componentWillUnmount = function() {
  this.o = [];
}, mu.prototype.render = function(t, e) {
  if (this.__b) {
    if (this.__v.__k) {
      var n = document.createElement("div"), r = this.__v.__k[0].__c;
      this.__v.__k[0] = Pg(this.__b, n, r.__O = r.__P);
    }
    this.__b = null;
  }
  var i = e.__a && ae(fo, null, t.fallback);
  return i && (i.__u &= -33), [ae(fo, null, e.__a ? null : t.children), i];
};
var sh = function(t, e, n) {
  if (++n[1] === n[0] && t.l.delete(e), t.props.revealOrder && (t.props.revealOrder[0] !== "t" || !t.l.size)) for (n = t.i; n; ) {
    for (; n.length > 3; ) n.pop()();
    if (n[1] < n[0]) break;
    t.i = n = n[2];
  }
};
(ts.prototype = new Ye()).__a = function(t) {
  var e = this, n = Rg(e.__v), r = e.l.get(t);
  return r[0]++, function(i) {
    var o = function() {
      e.props.revealOrder ? (r.push(i), sh(e, t, r)) : i();
    };
    n ? n(o) : o();
  };
}, ts.prototype.render = function(t) {
  this.i = null, this.l = /* @__PURE__ */ new Map();
  var e = Ls(t.children);
  t.revealOrder && t.revealOrder[0] === "b" && e.reverse();
  for (var n = e.length; n--; ) this.l.set(e[n], this.i = [1, 0, this.i]);
  return t.children;
}, ts.prototype.componentDidUpdate = ts.prototype.componentDidMount = function() {
  var t = this;
  this.l.forEach(function(e, n) {
    sh(t, n, e);
  });
};
var Ob = typeof Symbol < "u" && Symbol.for && Symbol.for("react.element") || 60103, Ab = /^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/, Cb = /^on(Ani|Tra|Tou|BeforeInp|Compo)/, Tb = /[A-Z0-9]/g, Nb = typeof document < "u", Mb = function(t) {
  return (typeof Symbol < "u" && typeof Symbol() == "symbol" ? /fil|che|rad/ : /fil|che|ra/).test(t);
};
function lh(t, e, n) {
  return e.__k == null && (e.textContent = ""), Z_(t, e), typeof n == "function" && n(), t ? t.__c : null;
}
Ye.prototype.isReactComponent = {}, ["componentWillMount", "componentWillReceiveProps", "componentWillUpdate"].forEach(function(t) {
  Object.defineProperty(Ye.prototype, t, { configurable: !0, get: function() {
    return this["UNSAFE_" + t];
  }, set: function(e) {
    Object.defineProperty(this, t, { configurable: !0, writable: !0, value: e });
  } });
});
var uh = He.event;
function Pb() {
}
function Db() {
  return this.cancelBubble;
}
function Rb() {
  return this.defaultPrevented;
}
He.event = function(t) {
  return uh && (t = uh(t)), t.persist = Pb, t.isPropagationStopped = Db, t.isDefaultPrevented = Rb, t.nativeEvent = t;
};
var Lb = { enumerable: !1, configurable: !0, get: function() {
  return this.class;
} }, fh = He.vnode;
He.vnode = function(t) {
  typeof t.type == "string" && function(e) {
    var n = e.props, r = e.type, i = {}, o = r.indexOf("-") === -1;
    for (var a in n) {
      var s = n[a];
      if (!(a === "value" && "defaultValue" in n && s == null || Nb && a === "children" && r === "noscript" || a === "class" || a === "className")) {
        var l = a.toLowerCase();
        a === "defaultValue" && "value" in n && n.value == null ? a = "value" : a === "download" && s === !0 ? s = "" : l === "translate" && s === "no" ? s = !1 : l[0] === "o" && l[1] === "n" ? l === "ondoubleclick" ? a = "ondblclick" : l !== "onchange" || r !== "input" && r !== "textarea" || Mb(n.type) ? l === "onfocus" ? a = "onfocusin" : l === "onblur" ? a = "onfocusout" : Cb.test(a) && (a = l) : l = a = "oninput" : o && Ab.test(a) ? a = a.replace(Tb, "-$&").toLowerCase() : s === null && (s = void 0), l === "oninput" && i[a = l] && (a = "oninputCapture"), i[a] = s;
      }
    }
    r == "select" && i.multiple && Array.isArray(i.value) && (i.value = Ls(n.children).forEach(function(u) {
      u.props.selected = i.value.indexOf(u.props.value) != -1;
    })), r == "select" && i.defaultValue != null && (i.value = Ls(n.children).forEach(function(u) {
      u.props.selected = i.multiple ? i.defaultValue.indexOf(u.props.value) != -1 : i.defaultValue == u.props.value;
    })), n.class && !n.className ? (i.class = n.class, Object.defineProperty(i, "className", Lb)) : (n.className && !n.class || n.class && n.className) && (i.class = i.className = n.className), e.props = i;
  }(t), t.$$typeof = Ob, fh && fh(t);
};
var ch = He.__r;
He.__r = function(t) {
  ch && ch(t), t.__c;
};
var dh = He.diffed;
He.diffed = function(t) {
  dh && dh(t);
  var e = t.props, n = t.__e;
  n != null && t.type === "textarea" && "value" in e && e.value !== n.value && (n.value = e.value == null ? "" : e.value);
};
var Ib = 0;
function B(t, e, n, r, i, o) {
  e || (e = {});
  var a, s, l = e;
  if ("ref" in l) for (s in l = {}, e) s == "ref" ? a = e[s] : l[s] = e[s];
  var u = { type: t, props: l, key: n, ref: a, __k: null, __: null, __b: 0, __e: null, __c: null, constructor: void 0, __v: --Ib, __i: -1, __u: 0, __source: i, __self: o };
  if (typeof t == "function" && (a = t.defaultProps)) for (s in a) l[s] === void 0 && (l[s] = a[s]);
  return He.vnode && He.vnode(u), u;
}
var Lg = typeof global == "object" && global && global.Object === Object && global, jb = typeof self == "object" && self && self.Object === Object && self, Ft = Lg || jb || Function("return this")(), tn = Ft.Symbol, Ig = Object.prototype, kb = Ig.hasOwnProperty, Bb = Ig.toString, Yo = tn ? tn.toStringTag : void 0;
function Fb(t) {
  var e = kb.call(t, Yo), n = t[Yo];
  try {
    t[Yo] = void 0;
    var r = !0;
  } catch {
  }
  var i = Bb.call(t);
  return r && (e ? t[Yo] = n : delete t[Yo]), i;
}
var $b = Object.prototype, Hb = $b.toString;
function Wb(t) {
  return Hb.call(t);
}
var zb = "[object Null]", Xb = "[object Undefined]", hh = tn ? tn.toStringTag : void 0;
function fn(t) {
  return t == null ? t === void 0 ? Xb : zb : hh && hh in Object(t) ? Fb(t) : Wb(t);
}
function Nt(t) {
  return t != null && typeof t == "object";
}
var Gb = "[object Symbol]";
function Cn(t) {
  return typeof t == "symbol" || Nt(t) && fn(t) == Gb;
}
var Ub = NaN;
function ph(t) {
  return typeof t == "number" ? t : Cn(t) ? Ub : +t;
}
function Ct(t, e) {
  for (var n = -1, r = t == null ? 0 : t.length, i = Array(r); ++n < r; )
    i[n] = e(t[n], n, t);
  return i;
}
var Ie = Array.isArray, vh = tn ? tn.prototype : void 0, gh = vh ? vh.toString : void 0;
function Tn(t) {
  if (typeof t == "string")
    return t;
  if (Ie(t))
    return Ct(t, Tn) + "";
  if (Cn(t))
    return gh ? gh.call(t) : "";
  var e = t + "";
  return e == "0" && 1 / t == -1 / 0 ? "-0" : e;
}
function Ll(t, e) {
  return function(n, r) {
    var i;
    if (n === void 0 && r === void 0)
      return e;
    if (n !== void 0 && (i = n), r !== void 0) {
      if (i === void 0)
        return r;
      typeof n == "string" || typeof r == "string" ? (n = Tn(n), r = Tn(r)) : (n = ph(n), r = ph(r)), i = t(n, r);
    }
    return i;
  };
}
var Yb = Ll(function(t, e) {
  return t + e;
}, 0), Vb = /\s/;
function jg(t) {
  for (var e = t.length; e-- && Vb.test(t.charAt(e)); )
    ;
  return e;
}
var Kb = /^\s+/;
function kg(t) {
  return t && t.slice(0, jg(t) + 1).replace(Kb, "");
}
function Tt(t) {
  var e = typeof t;
  return t != null && (e == "object" || e == "function");
}
var yh = NaN, qb = /^[-+]0x[0-9a-f]+$/i, Zb = /^0b[01]+$/i, Jb = /^0o[0-7]+$/i, Qb = parseInt;
function Hn(t) {
  if (typeof t == "number")
    return t;
  if (Cn(t))
    return yh;
  if (Tt(t)) {
    var e = typeof t.valueOf == "function" ? t.valueOf() : t;
    t = Tt(e) ? e + "" : e;
  }
  if (typeof t != "string")
    return t === 0 ? t : +t;
  t = kg(t);
  var n = Zb.test(t);
  return n || Jb.test(t) ? Qb(t.slice(2), n ? 2 : 8) : qb.test(t) ? yh : +t;
}
var ex = 1 / 0, tx = 17976931348623157e292;
function jr(t) {
  if (!t)
    return t === 0 ? t : 0;
  if (t = Hn(t), t === ex || t === -1 / 0) {
    var e = t < 0 ? -1 : 1;
    return e * tx;
  }
  return t === t ? t : 0;
}
function We(t) {
  var e = jr(t), n = e % 1;
  return e === e ? n ? e - n : e : 0;
}
var nx = "Expected a function";
function rx(t, e) {
  if (typeof e != "function")
    throw new TypeError(nx);
  return t = We(t), function() {
    if (--t < 1)
      return e.apply(this, arguments);
  };
}
function _n(t) {
  return t;
}
var ix = "[object AsyncFunction]", ox = "[object Function]", ax = "[object GeneratorFunction]", sx = "[object Proxy]";
function kr(t) {
  if (!Tt(t))
    return !1;
  var e = fn(t);
  return e == ox || e == ax || e == ix || e == sx;
}
var As = Ft["__core-js_shared__"], mh = function() {
  var t = /[^.]+$/.exec(As && As.keys && As.keys.IE_PROTO || "");
  return t ? "Symbol(src)_1." + t : "";
}();
function lx(t) {
  return !!mh && mh in t;
}
var ux = Function.prototype, fx = ux.toString;
function Fi(t) {
  if (t != null) {
    try {
      return fx.call(t);
    } catch {
    }
    try {
      return t + "";
    } catch {
    }
  }
  return "";
}
var cx = /[\\^$.*+?()[\]{}|]/g, dx = /^\[object .+?Constructor\]$/, hx = Function.prototype, px = Object.prototype, vx = hx.toString, gx = px.hasOwnProperty, yx = RegExp(
  "^" + vx.call(gx).replace(cx, "\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?") + "$"
);
function Bg(t) {
  if (!Tt(t) || lx(t))
    return !1;
  var e = kr(t) ? yx : dx;
  return e.test(Fi(t));
}
function mx(t, e) {
  return t == null ? void 0 : t[e];
}
function $i(t, e) {
  var n = mx(t, e);
  return Bg(n) ? n : void 0;
}
var Oa = $i(Ft, "WeakMap"), zs = Oa && new Oa(), Fg = zs ? function(t, e) {
  return zs.set(t, e), t;
} : _n, _h = Object.create, Mo = /* @__PURE__ */ function() {
  function t() {
  }
  return function(e) {
    if (!Tt(e))
      return {};
    if (_h)
      return _h(e);
    t.prototype = e;
    var n = new t();
    return t.prototype = void 0, n;
  };
}();
function Aa(t) {
  return function() {
    var e = arguments;
    switch (e.length) {
      case 0:
        return new t();
      case 1:
        return new t(e[0]);
      case 2:
        return new t(e[0], e[1]);
      case 3:
        return new t(e[0], e[1], e[2]);
      case 4:
        return new t(e[0], e[1], e[2], e[3]);
      case 5:
        return new t(e[0], e[1], e[2], e[3], e[4]);
      case 6:
        return new t(e[0], e[1], e[2], e[3], e[4], e[5]);
      case 7:
        return new t(e[0], e[1], e[2], e[3], e[4], e[5], e[6]);
    }
    var n = Mo(t.prototype), r = t.apply(n, e);
    return Tt(r) ? r : n;
  };
}
var _x = 1;
function bx(t, e, n) {
  var r = e & _x, i = Aa(t);
  function o() {
    var a = this && this !== Ft && this instanceof o ? i : t;
    return a.apply(r ? n : this, arguments);
  }
  return o;
}
function Nn(t, e, n) {
  switch (n.length) {
    case 0:
      return t.call(e);
    case 1:
      return t.call(e, n[0]);
    case 2:
      return t.call(e, n[0], n[1]);
    case 3:
      return t.call(e, n[0], n[1], n[2]);
  }
  return t.apply(e, n);
}
var xx = Math.max;
function $g(t, e, n, r) {
  for (var i = -1, o = t.length, a = n.length, s = -1, l = e.length, u = xx(o - a, 0), f = Array(l + u), c = !r; ++s < l; )
    f[s] = e[s];
  for (; ++i < a; )
    (c || i < o) && (f[n[i]] = t[i]);
  for (; u--; )
    f[s++] = t[i++];
  return f;
}
var Ex = Math.max;
function Hg(t, e, n, r) {
  for (var i = -1, o = t.length, a = -1, s = n.length, l = -1, u = e.length, f = Ex(o - s, 0), c = Array(f + u), d = !r; ++i < f; )
    c[i] = t[i];
  for (var h = i; ++l < u; )
    c[h + l] = e[l];
  for (; ++a < s; )
    (d || i < o) && (c[h + n[a]] = t[i++]);
  return c;
}
function wx(t, e) {
  for (var n = t.length, r = 0; n--; )
    t[n] === e && ++r;
  return r;
}
function Il() {
}
var Sx = 4294967295;
function Je(t) {
  this.__wrapped__ = t, this.__actions__ = [], this.__dir__ = 1, this.__filtered__ = !1, this.__iteratees__ = [], this.__takeCount__ = Sx, this.__views__ = [];
}
Je.prototype = Mo(Il.prototype);
Je.prototype.constructor = Je;
function so() {
}
var _c = zs ? function(t) {
  return zs.get(t);
} : so, lo = {}, Ox = Object.prototype, Ax = Ox.hasOwnProperty;
function Cs(t) {
  for (var e = t.name + "", n = lo[e], r = Ax.call(lo, e) ? n.length : 0; r--; ) {
    var i = n[r], o = i.func;
    if (o == null || o == t)
      return i.name;
  }
  return e;
}
function Gn(t, e) {
  this.__wrapped__ = t, this.__actions__ = [], this.__chain__ = !!e, this.__index__ = 0, this.__values__ = void 0;
}
Gn.prototype = Mo(Il.prototype);
Gn.prototype.constructor = Gn;
function yn(t, e) {
  var n = -1, r = t.length;
  for (e || (e = Array(r)); ++n < r; )
    e[n] = t[n];
  return e;
}
function Wg(t) {
  if (t instanceof Je)
    return t.clone();
  var e = new Gn(t.__wrapped__, t.__chain__);
  return e.__actions__ = yn(t.__actions__), e.__index__ = t.__index__, e.__values__ = t.__values__, e;
}
var Cx = Object.prototype, Tx = Cx.hasOwnProperty;
function _(t) {
  if (Nt(t) && !Ie(t) && !(t instanceof Je)) {
    if (t instanceof Gn)
      return t;
    if (Tx.call(t, "__wrapped__"))
      return Wg(t);
  }
  return new Gn(t);
}
_.prototype = Il.prototype;
_.prototype.constructor = _;
function rf(t) {
  var e = Cs(t), n = _[e];
  if (typeof n != "function" || !(e in Je.prototype))
    return !1;
  if (t === n)
    return !0;
  var r = _c(n);
  return !!r && t === r[0];
}
var Nx = 800, Mx = 16, Px = Date.now;
function zg(t) {
  var e = 0, n = 0;
  return function() {
    var r = Px(), i = Mx - (r - n);
    if (n = r, i > 0) {
      if (++e >= Nx)
        return arguments[0];
    } else
      e = 0;
    return t.apply(void 0, arguments);
  };
}
var Xg = zg(Fg), Dx = /\{\n\/\* \[wrapped with (.+)\] \*/, Rx = /,? & /;
function Lx(t) {
  var e = t.match(Dx);
  return e ? e[1].split(Rx) : [];
}
var Ix = /\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;
function jx(t, e) {
  var n = e.length;
  if (!n)
    return t;
  var r = n - 1;
  return e[r] = (n > 1 ? "& " : "") + e[r], e = e.join(n > 2 ? ", " : " "), t.replace(Ix, `{
/* [wrapped with ` + e + `] */
`);
}
function bc(t) {
  return function() {
    return t;
  };
}
var Xs = function() {
  try {
    var t = $i(Object, "defineProperty");
    return t({}, "", {}), t;
  } catch {
  }
}(), kx = Xs ? function(t, e) {
  return Xs(t, "toString", {
    configurable: !0,
    enumerable: !1,
    value: bc(e),
    writable: !0
  });
} : _n, xc = zg(kx);
function Vn(t, e) {
  for (var n = -1, r = t == null ? 0 : t.length; ++n < r && e(t[n], n, t) !== !1; )
    ;
  return t;
}
function jl(t, e, n, r) {
  for (var i = t.length, o = n + (r ? 1 : -1); r ? o-- : ++o < i; )
    if (e(t[o], o, t))
      return o;
  return -1;
}
function Gg(t) {
  return t !== t;
}
function Bx(t, e, n) {
  for (var r = n - 1, i = t.length; ++r < i; )
    if (t[r] === e)
      return r;
  return -1;
}
function Po(t, e, n) {
  return e === e ? Bx(t, e, n) : jl(t, Gg, n);
}
function kl(t, e) {
  var n = t == null ? 0 : t.length;
  return !!n && Po(t, e, 0) > -1;
}
var Fx = 1, $x = 2, Hx = 8, Wx = 16, zx = 32, Xx = 64, Gx = 128, Ux = 256, Yx = 512, Vx = [
  ["ary", Gx],
  ["bind", Fx],
  ["bindKey", $x],
  ["curry", Hx],
  ["curryRight", Wx],
  ["flip", Yx],
  ["partial", zx],
  ["partialRight", Xx],
  ["rearg", Ux]
];
function Kx(t, e) {
  return Vn(Vx, function(n) {
    var r = "_." + n[0];
    e & n[1] && !kl(t, r) && t.push(r);
  }), t.sort();
}
function Ug(t, e, n) {
  var r = e + "";
  return xc(t, jx(r, Kx(Lx(r), n)));
}
var qx = 4, Zx = 8, bh = 32, xh = 64;
function Yg(t, e, n, r, i, o, a, s, l, u) {
  var f = e & Zx, c = f ? a : void 0, d = f ? void 0 : a, h = f ? o : void 0, v = f ? void 0 : o;
  e |= f ? bh : xh, e &= ~(f ? xh : bh), e & qx || (e &= -4);
  var p = [
    t,
    e,
    i,
    h,
    c,
    v,
    d,
    s,
    l,
    u
  ], g = n.apply(void 0, p);
  return rf(t) && Xg(g, p), g.placeholder = r, Ug(g, t, e);
}
function Do(t) {
  var e = t;
  return e.placeholder;
}
var Jx = 9007199254740991, Qx = /^(?:0|[1-9]\d*)$/;
function Br(t, e) {
  var n = typeof t;
  return e = e ?? Jx, !!e && (n == "number" || n != "symbol" && Qx.test(t)) && t > -1 && t % 1 == 0 && t < e;
}
var eE = Math.min;
function tE(t, e) {
  for (var n = t.length, r = eE(e.length, n), i = yn(t); r--; ) {
    var o = e[r];
    t[r] = Br(o, n) ? i[o] : void 0;
  }
  return t;
}
var Eh = "__lodash_placeholder__";
function ii(t, e) {
  for (var n = -1, r = t.length, i = 0, o = []; ++n < r; ) {
    var a = t[n];
    (a === e || a === Eh) && (t[n] = Eh, o[i++] = n);
  }
  return o;
}
var nE = 1, rE = 2, iE = 8, oE = 16, aE = 128, sE = 512;
function Bl(t, e, n, r, i, o, a, s, l, u) {
  var f = e & aE, c = e & nE, d = e & rE, h = e & (iE | oE), v = e & sE, p = d ? void 0 : Aa(t);
  function g() {
    for (var y = arguments.length, m = Array(y), A = y; A--; )
      m[A] = arguments[A];
    if (h)
      var T = Do(g), k = wx(m, T);
    if (r && (m = $g(m, r, i, h)), o && (m = Hg(m, o, a, h)), y -= k, h && y < u) {
      var C = ii(m, T);
      return Yg(
        t,
        e,
        Bl,
        g.placeholder,
        n,
        m,
        C,
        s,
        l,
        u - y
      );
    }
    var S = c ? n : this, I = d ? S[t] : t;
    return y = m.length, s ? m = tE(m, s) : v && y > 1 && m.reverse(), f && l < y && (m.length = l), this && this !== Ft && this instanceof g && (I = p || Aa(I)), I.apply(S, m);
  }
  return g;
}
function lE(t, e, n) {
  var r = Aa(t);
  function i() {
    for (var o = arguments.length, a = Array(o), s = o, l = Do(i); s--; )
      a[s] = arguments[s];
    var u = o < 3 && a[0] !== l && a[o - 1] !== l ? [] : ii(a, l);
    if (o -= u.length, o < n)
      return Yg(
        t,
        e,
        Bl,
        i.placeholder,
        void 0,
        a,
        u,
        void 0,
        void 0,
        n - o
      );
    var f = this && this !== Ft && this instanceof i ? r : t;
    return Nn(f, this, a);
  }
  return i;
}
var uE = 1;
function fE(t, e, n, r) {
  var i = e & uE, o = Aa(t);
  function a() {
    for (var s = -1, l = arguments.length, u = -1, f = r.length, c = Array(f + l), d = this && this !== Ft && this instanceof a ? o : t; ++u < f; )
      c[u] = r[u];
    for (; l--; )
      c[u++] = arguments[++s];
    return Nn(d, i ? n : this, c);
  }
  return a;
}
var wh = "__lodash_placeholder__", _u = 1, cE = 2, dE = 4, Sh = 8, Vo = 128, Oh = 256, hE = Math.min;
function pE(t, e) {
  var n = t[1], r = e[1], i = n | r, o = i < (_u | cE | Vo), a = r == Vo && n == Sh || r == Vo && n == Oh && t[7].length <= e[8] || r == (Vo | Oh) && e[7].length <= e[8] && n == Sh;
  if (!(o || a))
    return t;
  r & _u && (t[2] = e[2], i |= n & _u ? 0 : dE);
  var s = e[3];
  if (s) {
    var l = t[3];
    t[3] = l ? $g(l, s, e[4]) : s, t[4] = l ? ii(t[3], wh) : e[4];
  }
  return s = e[5], s && (l = t[5], t[5] = l ? Hg(l, s, e[6]) : s, t[6] = l ? ii(t[5], wh) : e[6]), s = e[7], s && (t[7] = s), r & Vo && (t[8] = t[8] == null ? e[8] : hE(t[8], e[8])), t[9] == null && (t[9] = e[9]), t[0] = e[0], t[1] = i, t;
}
var vE = "Expected a function", Ah = 1, gE = 2, Ch = 8, Th = 16, Nh = 32, yE = 64, Mh = Math.max;
function Fr(t, e, n, r, i, o, a, s) {
  var l = e & gE;
  if (!l && typeof t != "function")
    throw new TypeError(vE);
  var u = r ? r.length : 0;
  if (u || (e &= -97, r = i = void 0), a = a === void 0 ? a : Mh(We(a), 0), s = s === void 0 ? s : We(s), u -= i ? i.length : 0, e & yE) {
    var f = r, c = i;
    r = i = void 0;
  }
  var d = l ? void 0 : _c(t), h = [
    t,
    e,
    n,
    r,
    i,
    f,
    c,
    o,
    a,
    s
  ];
  if (d && pE(h, d), t = h[0], e = h[1], n = h[2], r = h[3], i = h[4], s = h[9] = h[9] === void 0 ? l ? 0 : t.length : Mh(h[9] - u, 0), !s && e & (Ch | Th) && (e &= -25), !e || e == Ah)
    var v = bx(t, e, n);
  else e == Ch || e == Th ? v = lE(t, e, s) : (e == Nh || e == (Ah | Nh)) && !i.length ? v = fE(t, e, n, r) : v = Bl.apply(void 0, h);
  var p = d ? Fg : Xg;
  return Ug(p(v, h), t, e);
}
var mE = 128;
function Vg(t, e, n) {
  return e = n ? void 0 : e, e = t && e == null ? t.length : e, Fr(t, mE, void 0, void 0, void 0, void 0, e);
}
function $r(t, e, n) {
  e == "__proto__" && Xs ? Xs(t, e, {
    configurable: !0,
    enumerable: !0,
    value: n,
    writable: !0
  }) : t[e] = n;
}
function gr(t, e) {
  return t === e || t !== t && e !== e;
}
var _E = Object.prototype, bE = _E.hasOwnProperty;
function Wa(t, e, n) {
  var r = t[e];
  (!(bE.call(t, e) && gr(r, n)) || n === void 0 && !(e in t)) && $r(t, e, n);
}
function Tr(t, e, n, r) {
  var i = !n;
  n || (n = {});
  for (var o = -1, a = e.length; ++o < a; ) {
    var s = e[o], l = r ? r(n[s], t[s], s, n, t) : void 0;
    l === void 0 && (l = t[s]), i ? $r(n, s, l) : Wa(n, s, l);
  }
  return n;
}
var Ph = Math.max;
function Kg(t, e, n) {
  return e = Ph(e === void 0 ? t.length - 1 : e, 0), function() {
    for (var r = arguments, i = -1, o = Ph(r.length - e, 0), a = Array(o); ++i < o; )
      a[i] = r[e + i];
    i = -1;
    for (var s = Array(e + 1); ++i < e; )
      s[i] = r[i];
    return s[e] = n(a), Nn(t, this, s);
  };
}
function Ve(t, e) {
  return xc(Kg(t, e, _n), t + "");
}
var xE = 9007199254740991;
function Fl(t) {
  return typeof t == "number" && t > -1 && t % 1 == 0 && t <= xE;
}
function bn(t) {
  return t != null && Fl(t.length) && !kr(t);
}
function an(t, e, n) {
  if (!Tt(n))
    return !1;
  var r = typeof e;
  return (r == "number" ? bn(n) && Br(e, n.length) : r == "string" && e in n) ? gr(n[e], t) : !1;
}
function Ro(t) {
  return Ve(function(e, n) {
    var r = -1, i = n.length, o = i > 1 ? n[i - 1] : void 0, a = i > 2 ? n[2] : void 0;
    for (o = t.length > 3 && typeof o == "function" ? (i--, o) : void 0, a && an(n[0], n[1], a) && (o = i < 3 ? void 0 : o, i = 1), e = Object(e); ++r < i; ) {
      var s = n[r];
      s && t(e, s, r, o);
    }
    return e;
  });
}
var EE = Object.prototype;
function za(t) {
  var e = t && t.constructor, n = typeof e == "function" && e.prototype || EE;
  return t === n;
}
function Ec(t, e) {
  for (var n = -1, r = Array(t); ++n < t; )
    r[n] = e(n);
  return r;
}
var wE = "[object Arguments]";
function Dh(t) {
  return Nt(t) && fn(t) == wE;
}
var qg = Object.prototype, SE = qg.hasOwnProperty, OE = qg.propertyIsEnumerable, Ri = Dh(/* @__PURE__ */ function() {
  return arguments;
}()) ? Dh : function(t) {
  return Nt(t) && SE.call(t, "callee") && !OE.call(t, "callee");
};
function wc() {
  return !1;
}
var Zg = typeof exports == "object" && exports && !exports.nodeType && exports, Rh = Zg && typeof module == "object" && module && !module.nodeType && module, AE = Rh && Rh.exports === Zg, Lh = AE ? Ft.Buffer : void 0, CE = Lh ? Lh.isBuffer : void 0, oi = CE || wc, TE = "[object Arguments]", NE = "[object Array]", ME = "[object Boolean]", PE = "[object Date]", DE = "[object Error]", RE = "[object Function]", LE = "[object Map]", IE = "[object Number]", jE = "[object Object]", kE = "[object RegExp]", BE = "[object Set]", FE = "[object String]", $E = "[object WeakMap]", HE = "[object ArrayBuffer]", WE = "[object DataView]", zE = "[object Float32Array]", XE = "[object Float64Array]", GE = "[object Int8Array]", UE = "[object Int16Array]", YE = "[object Int32Array]", VE = "[object Uint8Array]", KE = "[object Uint8ClampedArray]", qE = "[object Uint16Array]", ZE = "[object Uint32Array]", wt = {};
wt[zE] = wt[XE] = wt[GE] = wt[UE] = wt[YE] = wt[VE] = wt[KE] = wt[qE] = wt[ZE] = !0;
wt[TE] = wt[NE] = wt[HE] = wt[ME] = wt[WE] = wt[PE] = wt[DE] = wt[RE] = wt[LE] = wt[IE] = wt[jE] = wt[kE] = wt[BE] = wt[FE] = wt[$E] = !1;
function JE(t) {
  return Nt(t) && Fl(t.length) && !!wt[fn(t)];
}
function Mn(t) {
  return function(e) {
    return t(e);
  };
}
var Jg = typeof exports == "object" && exports && !exports.nodeType && exports, sa = Jg && typeof module == "object" && module && !module.nodeType && module, QE = sa && sa.exports === Jg, bu = QE && Lg.process, Un = function() {
  try {
    var t = sa && sa.require && sa.require("util").types;
    return t || bu && bu.binding && bu.binding("util");
  } catch {
  }
}(), Ih = Un && Un.isTypedArray, Lo = Ih ? Mn(Ih) : JE, ew = Object.prototype, tw = ew.hasOwnProperty;
function Qg(t, e) {
  var n = Ie(t), r = !n && Ri(t), i = !n && !r && oi(t), o = !n && !r && !i && Lo(t), a = n || r || i || o, s = a ? Ec(t.length, String) : [], l = s.length;
  for (var u in t)
    (e || tw.call(t, u)) && !(a && // Safari 9 has enumerable `arguments.length` in strict mode.
    (u == "length" || // Node.js 0.10 has enumerable non-index properties on buffers.
    i && (u == "offset" || u == "parent") || // PhantomJS 2 has enumerable non-index properties on typed arrays.
    o && (u == "buffer" || u == "byteLength" || u == "byteOffset") || // Skip index properties.
    Br(u, l))) && s.push(u);
  return s;
}
function ey(t, e) {
  return function(n) {
    return t(e(n));
  };
}
var nw = ey(Object.keys, Object), rw = Object.prototype, iw = rw.hasOwnProperty;
function Sc(t) {
  if (!za(t))
    return nw(t);
  var e = [];
  for (var n in Object(t))
    iw.call(t, n) && n != "constructor" && e.push(n);
  return e;
}
function $t(t) {
  return bn(t) ? Qg(t) : Sc(t);
}
var ow = Object.prototype, aw = ow.hasOwnProperty, ut = Ro(function(t, e) {
  if (za(e) || bn(e)) {
    Tr(e, $t(e), t);
    return;
  }
  for (var n in e)
    aw.call(e, n) && Wa(t, n, e[n]);
});
function sw(t) {
  var e = [];
  if (t != null)
    for (var n in Object(t))
      e.push(n);
  return e;
}
var lw = Object.prototype, uw = lw.hasOwnProperty;
function fw(t) {
  if (!Tt(t))
    return sw(t);
  var e = za(t), n = [];
  for (var r in t)
    r == "constructor" && (e || !uw.call(t, r)) || n.push(r);
  return n;
}
function xn(t) {
  return bn(t) ? Qg(t, !0) : fw(t);
}
var cw = Ro(function(t, e) {
  Tr(e, xn(e), t);
}), of = Ro(function(t, e, n, r) {
  Tr(e, xn(e), t, r);
}), dw = Ro(function(t, e, n, r) {
  Tr(e, $t(e), t, r);
}), hw = /\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/, pw = /^\w*$/;
function Oc(t, e) {
  if (Ie(t))
    return !1;
  var n = typeof t;
  return n == "number" || n == "symbol" || n == "boolean" || t == null || Cn(t) ? !0 : pw.test(t) || !hw.test(t) || e != null && t in Object(e);
}
var Ca = $i(Object, "create");
function vw() {
  this.__data__ = Ca ? Ca(null) : {}, this.size = 0;
}
function gw(t) {
  var e = this.has(t) && delete this.__data__[t];
  return this.size -= e ? 1 : 0, e;
}
var yw = "__lodash_hash_undefined__", mw = Object.prototype, _w = mw.hasOwnProperty;
function bw(t) {
  var e = this.__data__;
  if (Ca) {
    var n = e[t];
    return n === yw ? void 0 : n;
  }
  return _w.call(e, t) ? e[t] : void 0;
}
var xw = Object.prototype, Ew = xw.hasOwnProperty;
function ww(t) {
  var e = this.__data__;
  return Ca ? e[t] !== void 0 : Ew.call(e, t);
}
var Sw = "__lodash_hash_undefined__";
function Ow(t, e) {
  var n = this.__data__;
  return this.size += this.has(t) ? 0 : 1, n[t] = Ca && e === void 0 ? Sw : e, this;
}
function Li(t) {
  var e = -1, n = t == null ? 0 : t.length;
  for (this.clear(); ++e < n; ) {
    var r = t[e];
    this.set(r[0], r[1]);
  }
}
Li.prototype.clear = vw;
Li.prototype.delete = gw;
Li.prototype.get = bw;
Li.prototype.has = ww;
Li.prototype.set = Ow;
function Aw() {
  this.__data__ = [], this.size = 0;
}
function $l(t, e) {
  for (var n = t.length; n--; )
    if (gr(t[n][0], e))
      return n;
  return -1;
}
var Cw = Array.prototype, Tw = Cw.splice;
function Nw(t) {
  var e = this.__data__, n = $l(e, t);
  if (n < 0)
    return !1;
  var r = e.length - 1;
  return n == r ? e.pop() : Tw.call(e, n, 1), --this.size, !0;
}
function Mw(t) {
  var e = this.__data__, n = $l(e, t);
  return n < 0 ? void 0 : e[n][1];
}
function Pw(t) {
  return $l(this.__data__, t) > -1;
}
function Dw(t, e) {
  var n = this.__data__, r = $l(n, t);
  return r < 0 ? (++this.size, n.push([t, e])) : n[r][1] = e, this;
}
function Hr(t) {
  var e = -1, n = t == null ? 0 : t.length;
  for (this.clear(); ++e < n; ) {
    var r = t[e];
    this.set(r[0], r[1]);
  }
}
Hr.prototype.clear = Aw;
Hr.prototype.delete = Nw;
Hr.prototype.get = Mw;
Hr.prototype.has = Pw;
Hr.prototype.set = Dw;
var Ta = $i(Ft, "Map");
function Rw() {
  this.size = 0, this.__data__ = {
    hash: new Li(),
    map: new (Ta || Hr)(),
    string: new Li()
  };
}
function Lw(t) {
  var e = typeof t;
  return e == "string" || e == "number" || e == "symbol" || e == "boolean" ? t !== "__proto__" : t === null;
}
function Hl(t, e) {
  var n = t.__data__;
  return Lw(e) ? n[typeof e == "string" ? "string" : "hash"] : n.map;
}
function Iw(t) {
  var e = Hl(this, t).delete(t);
  return this.size -= e ? 1 : 0, e;
}
function jw(t) {
  return Hl(this, t).get(t);
}
function kw(t) {
  return Hl(this, t).has(t);
}
function Bw(t, e) {
  var n = Hl(this, t), r = n.size;
  return n.set(t, e), this.size += n.size == r ? 0 : 1, this;
}
function Wr(t) {
  var e = -1, n = t == null ? 0 : t.length;
  for (this.clear(); ++e < n; ) {
    var r = t[e];
    this.set(r[0], r[1]);
  }
}
Wr.prototype.clear = Rw;
Wr.prototype.delete = Iw;
Wr.prototype.get = jw;
Wr.prototype.has = kw;
Wr.prototype.set = Bw;
var Fw = "Expected a function";
function Wl(t, e) {
  if (typeof t != "function" || e != null && typeof e != "function")
    throw new TypeError(Fw);
  var n = function() {
    var r = arguments, i = e ? e.apply(this, r) : r[0], o = n.cache;
    if (o.has(i))
      return o.get(i);
    var a = t.apply(this, r);
    return n.cache = o.set(i, a) || o, a;
  };
  return n.cache = new (Wl.Cache || Wr)(), n;
}
Wl.Cache = Wr;
var $w = 500;
function Hw(t) {
  var e = Wl(t, function(r) {
    return n.size === $w && n.clear(), r;
  }), n = e.cache;
  return e;
}
var Ww = /[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g, zw = /\\(\\)?/g, ty = Hw(function(t) {
  var e = [];
  return t.charCodeAt(0) === 46 && e.push(""), t.replace(Ww, function(n, r, i, o) {
    e.push(i ? o.replace(zw, "$1") : r || n);
  }), e;
});
function pt(t) {
  return t == null ? "" : Tn(t);
}
function ui(t, e) {
  return Ie(t) ? t : Oc(t, e) ? [t] : ty(pt(t));
}
function Nr(t) {
  if (typeof t == "string" || Cn(t))
    return t;
  var e = t + "";
  return e == "0" && 1 / t == -1 / 0 ? "-0" : e;
}
function Hi(t, e) {
  e = ui(e, t);
  for (var n = 0, r = e.length; t != null && n < r; )
    t = t[Nr(e[n++])];
  return n && n == r ? t : void 0;
}
function Io(t, e, n) {
  var r = t == null ? void 0 : Hi(t, e);
  return r === void 0 ? n : r;
}
function Ac(t, e) {
  for (var n = -1, r = e.length, i = Array(r), o = t == null; ++n < r; )
    i[n] = o ? void 0 : Io(t, e[n]);
  return i;
}
function fi(t, e) {
  for (var n = -1, r = e.length, i = t.length; ++n < r; )
    t[i + n] = e[n];
  return t;
}
var jh = tn ? tn.isConcatSpreadable : void 0;
function Xw(t) {
  return Ie(t) || Ri(t) || !!(jh && t && t[jh]);
}
function Kt(t, e, n, r, i) {
  var o = -1, a = t.length;
  for (n || (n = Xw), i || (i = []); ++o < a; ) {
    var s = t[o];
    e > 0 && n(s) ? e > 1 ? Kt(s, e - 1, n, r, i) : fi(i, s) : r || (i[i.length] = s);
  }
  return i;
}
function ny(t) {
  var e = t == null ? 0 : t.length;
  return e ? Kt(t, 1) : [];
}
function zr(t) {
  return xc(Kg(t, void 0, ny), t + "");
}
var Gw = zr(Ac), zl = ey(Object.getPrototypeOf, Object), Uw = "[object Object]", Yw = Function.prototype, Vw = Object.prototype, ry = Yw.toString, Kw = Vw.hasOwnProperty, qw = ry.call(Object);
function Xa(t) {
  if (!Nt(t) || fn(t) != Uw)
    return !1;
  var e = zl(t);
  if (e === null)
    return !0;
  var n = Kw.call(e, "constructor") && e.constructor;
  return typeof n == "function" && n instanceof n && ry.call(n) == qw;
}
var Zw = "[object DOMException]", Jw = "[object Error]";
function Cc(t) {
  if (!Nt(t))
    return !1;
  var e = fn(t);
  return e == Jw || e == Zw || typeof t.message == "string" && typeof t.name == "string" && !Xa(t);
}
var iy = Ve(function(t, e) {
  try {
    return Nn(t, void 0, e);
  } catch (n) {
    return Cc(n) ? n : new Error(n);
  }
}), Qw = "Expected a function";
function oy(t, e) {
  var n;
  if (typeof e != "function")
    throw new TypeError(Qw);
  return t = We(t), function() {
    return --t > 0 && (n = e.apply(this, arguments)), t <= 1 && (e = void 0), n;
  };
}
var e1 = 1, t1 = 32, Xl = Ve(function(t, e, n) {
  var r = e1;
  if (n.length) {
    var i = ii(n, Do(Xl));
    r |= t1;
  }
  return Fr(t, r, e, n, i);
});
Xl.placeholder = {};
var n1 = zr(function(t, e) {
  return Vn(e, function(n) {
    n = Nr(n), $r(t, n, Xl(t[n], t));
  }), t;
}), r1 = 1, i1 = 2, o1 = 32, Tc = Ve(function(t, e, n) {
  var r = r1 | i1;
  if (n.length) {
    var i = ii(n, Do(Tc));
    r |= o1;
  }
  return Fr(e, r, t, n, i);
});
Tc.placeholder = {};
function Yn(t, e, n) {
  var r = -1, i = t.length;
  e < 0 && (e = -e > i ? 0 : i + e), n = n > i ? i : n, n < 0 && (n += i), i = e > n ? 0 : n - e >>> 0, e >>>= 0;
  for (var o = Array(i); ++r < i; )
    o[r] = t[r + e];
  return o;
}
function ci(t, e, n) {
  var r = t.length;
  return n = n === void 0 ? r : n, !e && n >= r ? t : Yn(t, e, n);
}
var a1 = "\\ud800-\\udfff", s1 = "\\u0300-\\u036f", l1 = "\\ufe20-\\ufe2f", u1 = "\\u20d0-\\u20ff", f1 = s1 + l1 + u1, c1 = "\\ufe0e\\ufe0f", d1 = "\\u200d", h1 = RegExp("[" + d1 + a1 + f1 + c1 + "]");
function jo(t) {
  return h1.test(t);
}
function p1(t) {
  return t.split("");
}
var ay = "\\ud800-\\udfff", v1 = "\\u0300-\\u036f", g1 = "\\ufe20-\\ufe2f", y1 = "\\u20d0-\\u20ff", m1 = v1 + g1 + y1, _1 = "\\ufe0e\\ufe0f", b1 = "[" + ay + "]", af = "[" + m1 + "]", sf = "\\ud83c[\\udffb-\\udfff]", x1 = "(?:" + af + "|" + sf + ")", sy = "[^" + ay + "]", ly = "(?:\\ud83c[\\udde6-\\uddff]){2}", uy = "[\\ud800-\\udbff][\\udc00-\\udfff]", E1 = "\\u200d", fy = x1 + "?", cy = "[" + _1 + "]?", w1 = "(?:" + E1 + "(?:" + [sy, ly, uy].join("|") + ")" + cy + fy + ")*", S1 = cy + fy + w1, O1 = "(?:" + [sy + af + "?", af, ly, uy, b1].join("|") + ")", A1 = RegExp(sf + "(?=" + sf + ")|" + O1 + S1, "g");
function C1(t) {
  return t.match(A1) || [];
}
function hr(t) {
  return jo(t) ? C1(t) : p1(t);
}
function dy(t) {
  return function(e) {
    e = pt(e);
    var n = jo(e) ? hr(e) : void 0, r = n ? n[0] : e.charAt(0), i = n ? ci(n, 1).join("") : e.slice(1);
    return r[t]() + i;
  };
}
var Nc = dy("toUpperCase");
function hy(t) {
  return Nc(pt(t).toLowerCase());
}
function Mc(t, e, n, r) {
  var i = -1, o = t == null ? 0 : t.length;
  for (r && o && (n = t[++i]); ++i < o; )
    n = e(n, t[i], i, t);
  return n;
}
function Pc(t) {
  return function(e) {
    return t == null ? void 0 : t[e];
  };
}
var T1 = {
  // Latin-1 Supplement block.
  À: "A",
  Á: "A",
  Â: "A",
  Ã: "A",
  Ä: "A",
  Å: "A",
  à: "a",
  á: "a",
  â: "a",
  ã: "a",
  ä: "a",
  å: "a",
  Ç: "C",
  ç: "c",
  Ð: "D",
  ð: "d",
  È: "E",
  É: "E",
  Ê: "E",
  Ë: "E",
  è: "e",
  é: "e",
  ê: "e",
  ë: "e",
  Ì: "I",
  Í: "I",
  Î: "I",
  Ï: "I",
  ì: "i",
  í: "i",
  î: "i",
  ï: "i",
  Ñ: "N",
  ñ: "n",
  Ò: "O",
  Ó: "O",
  Ô: "O",
  Õ: "O",
  Ö: "O",
  Ø: "O",
  ò: "o",
  ó: "o",
  ô: "o",
  õ: "o",
  ö: "o",
  ø: "o",
  Ù: "U",
  Ú: "U",
  Û: "U",
  Ü: "U",
  ù: "u",
  ú: "u",
  û: "u",
  ü: "u",
  Ý: "Y",
  ý: "y",
  ÿ: "y",
  Æ: "Ae",
  æ: "ae",
  Þ: "Th",
  þ: "th",
  ß: "ss",
  // Latin Extended-A block.
  Ā: "A",
  Ă: "A",
  Ą: "A",
  ā: "a",
  ă: "a",
  ą: "a",
  Ć: "C",
  Ĉ: "C",
  Ċ: "C",
  Č: "C",
  ć: "c",
  ĉ: "c",
  ċ: "c",
  č: "c",
  Ď: "D",
  Đ: "D",
  ď: "d",
  đ: "d",
  Ē: "E",
  Ĕ: "E",
  Ė: "E",
  Ę: "E",
  Ě: "E",
  ē: "e",
  ĕ: "e",
  ė: "e",
  ę: "e",
  ě: "e",
  Ĝ: "G",
  Ğ: "G",
  Ġ: "G",
  Ģ: "G",
  ĝ: "g",
  ğ: "g",
  ġ: "g",
  ģ: "g",
  Ĥ: "H",
  Ħ: "H",
  ĥ: "h",
  ħ: "h",
  Ĩ: "I",
  Ī: "I",
  Ĭ: "I",
  Į: "I",
  İ: "I",
  ĩ: "i",
  ī: "i",
  ĭ: "i",
  į: "i",
  ı: "i",
  Ĵ: "J",
  ĵ: "j",
  Ķ: "K",
  ķ: "k",
  ĸ: "k",
  Ĺ: "L",
  Ļ: "L",
  Ľ: "L",
  Ŀ: "L",
  Ł: "L",
  ĺ: "l",
  ļ: "l",
  ľ: "l",
  ŀ: "l",
  ł: "l",
  Ń: "N",
  Ņ: "N",
  Ň: "N",
  Ŋ: "N",
  ń: "n",
  ņ: "n",
  ň: "n",
  ŋ: "n",
  Ō: "O",
  Ŏ: "O",
  Ő: "O",
  ō: "o",
  ŏ: "o",
  ő: "o",
  Ŕ: "R",
  Ŗ: "R",
  Ř: "R",
  ŕ: "r",
  ŗ: "r",
  ř: "r",
  Ś: "S",
  Ŝ: "S",
  Ş: "S",
  Š: "S",
  ś: "s",
  ŝ: "s",
  ş: "s",
  š: "s",
  Ţ: "T",
  Ť: "T",
  Ŧ: "T",
  ţ: "t",
  ť: "t",
  ŧ: "t",
  Ũ: "U",
  Ū: "U",
  Ŭ: "U",
  Ů: "U",
  Ű: "U",
  Ų: "U",
  ũ: "u",
  ū: "u",
  ŭ: "u",
  ů: "u",
  ű: "u",
  ų: "u",
  Ŵ: "W",
  ŵ: "w",
  Ŷ: "Y",
  ŷ: "y",
  Ÿ: "Y",
  Ź: "Z",
  Ż: "Z",
  Ž: "Z",
  ź: "z",
  ż: "z",
  ž: "z",
  Ĳ: "IJ",
  ĳ: "ij",
  Œ: "Oe",
  œ: "oe",
  ŉ: "'n",
  ſ: "s"
}, N1 = Pc(T1), M1 = /[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g, P1 = "\\u0300-\\u036f", D1 = "\\ufe20-\\ufe2f", R1 = "\\u20d0-\\u20ff", L1 = P1 + D1 + R1, I1 = "[" + L1 + "]", j1 = RegExp(I1, "g");
function py(t) {
  return t = pt(t), t && t.replace(M1, N1).replace(j1, "");
}
var k1 = /[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;
function B1(t) {
  return t.match(k1) || [];
}
var F1 = /[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;
function $1(t) {
  return F1.test(t);
}
var vy = "\\ud800-\\udfff", H1 = "\\u0300-\\u036f", W1 = "\\ufe20-\\ufe2f", z1 = "\\u20d0-\\u20ff", X1 = H1 + W1 + z1, gy = "\\u2700-\\u27bf", yy = "a-z\\xdf-\\xf6\\xf8-\\xff", G1 = "\\xac\\xb1\\xd7\\xf7", U1 = "\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf", Y1 = "\\u2000-\\u206f", V1 = " \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000", my = "A-Z\\xc0-\\xd6\\xd8-\\xde", K1 = "\\ufe0e\\ufe0f", _y = G1 + U1 + Y1 + V1, by = "['’]", kh = "[" + _y + "]", q1 = "[" + X1 + "]", xy = "\\d+", Z1 = "[" + gy + "]", Ey = "[" + yy + "]", wy = "[^" + vy + _y + xy + gy + yy + my + "]", J1 = "\\ud83c[\\udffb-\\udfff]", Q1 = "(?:" + q1 + "|" + J1 + ")", eS = "[^" + vy + "]", Sy = "(?:\\ud83c[\\udde6-\\uddff]){2}", Oy = "[\\ud800-\\udbff][\\udc00-\\udfff]", no = "[" + my + "]", tS = "\\u200d", Bh = "(?:" + Ey + "|" + wy + ")", nS = "(?:" + no + "|" + wy + ")", Fh = "(?:" + by + "(?:d|ll|m|re|s|t|ve))?", $h = "(?:" + by + "(?:D|LL|M|RE|S|T|VE))?", Ay = Q1 + "?", Cy = "[" + K1 + "]?", rS = "(?:" + tS + "(?:" + [eS, Sy, Oy].join("|") + ")" + Cy + Ay + ")*", iS = "\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])", oS = "\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])", aS = Cy + Ay + rS, sS = "(?:" + [Z1, Sy, Oy].join("|") + ")" + aS, lS = RegExp([
  no + "?" + Ey + "+" + Fh + "(?=" + [kh, no, "$"].join("|") + ")",
  nS + "+" + $h + "(?=" + [kh, no + Bh, "$"].join("|") + ")",
  no + "?" + Bh + "+" + Fh,
  no + "+" + $h,
  oS,
  iS,
  xy,
  sS
].join("|"), "g");
function uS(t) {
  return t.match(lS) || [];
}
function Ty(t, e, n) {
  return t = pt(t), e = n ? void 0 : e, e === void 0 ? $1(t) ? uS(t) : B1(t) : t.match(e) || [];
}
var fS = "['’]", cS = RegExp(fS, "g");
function ko(t) {
  return function(e) {
    return Mc(Ty(py(e).replace(cS, "")), t, "");
  };
}
var dS = ko(function(t, e, n) {
  return e = e.toLowerCase(), t + (n ? hy(e) : e);
});
function hS() {
  if (!arguments.length)
    return [];
  var t = arguments[0];
  return Ie(t) ? t : [t];
}
var pS = Ft.isFinite, vS = Math.min;
function Dc(t) {
  var e = Math[t];
  return function(n, r) {
    if (n = Hn(n), r = r == null ? 0 : vS(We(r), 292), r && pS(n)) {
      var i = (pt(n) + "e").split("e"), o = e(i[0] + "e" + (+i[1] + r));
      return i = (pt(o) + "e").split("e"), +(i[0] + "e" + (+i[1] - r));
    }
    return e(n);
  };
}
var gS = Dc("ceil");
function Ny(t) {
  var e = _(t);
  return e.__chain__ = !0, e;
}
var yS = Math.ceil, mS = Math.max;
function _S(t, e, n) {
  (n ? an(t, e, n) : e === void 0) ? e = 1 : e = mS(We(e), 0);
  var r = t == null ? 0 : t.length;
  if (!r || e < 1)
    return [];
  for (var i = 0, o = 0, a = Array(yS(r / e)); i < r; )
    a[o++] = Yn(t, i, i += e);
  return a;
}
function Wi(t, e, n) {
  return t === t && (n !== void 0 && (t = t <= n ? t : n), e !== void 0 && (t = t >= e ? t : e)), t;
}
function bS(t, e, n) {
  return n === void 0 && (n = e, e = void 0), n !== void 0 && (n = Hn(n), n = n === n ? n : 0), e !== void 0 && (e = Hn(e), e = e === e ? e : 0), Wi(Hn(t), e, n);
}
function xS() {
  this.__data__ = new Hr(), this.size = 0;
}
function ES(t) {
  var e = this.__data__, n = e.delete(t);
  return this.size = e.size, n;
}
function wS(t) {
  return this.__data__.get(t);
}
function SS(t) {
  return this.__data__.has(t);
}
var OS = 200;
function AS(t, e) {
  var n = this.__data__;
  if (n instanceof Hr) {
    var r = n.__data__;
    if (!Ta || r.length < OS - 1)
      return r.push([t, e]), this.size = ++n.size, this;
    n = this.__data__ = new Wr(r);
  }
  return n.set(t, e), this.size = n.size, this;
}
function dr(t) {
  var e = this.__data__ = new Hr(t);
  this.size = e.size;
}
dr.prototype.clear = xS;
dr.prototype.delete = ES;
dr.prototype.get = wS;
dr.prototype.has = SS;
dr.prototype.set = AS;
function My(t, e) {
  return t && Tr(e, $t(e), t);
}
function CS(t, e) {
  return t && Tr(e, xn(e), t);
}
var Py = typeof exports == "object" && exports && !exports.nodeType && exports, Hh = Py && typeof module == "object" && module && !module.nodeType && module, TS = Hh && Hh.exports === Py, Wh = TS ? Ft.Buffer : void 0, zh = Wh ? Wh.allocUnsafe : void 0;
function Dy(t, e) {
  if (e)
    return t.slice();
  var n = t.length, r = zh ? zh(n) : new t.constructor(n);
  return t.copy(r), r;
}
function di(t, e) {
  for (var n = -1, r = t == null ? 0 : t.length, i = 0, o = []; ++n < r; ) {
    var a = t[n];
    e(a, n, t) && (o[i++] = a);
  }
  return o;
}
function Rc() {
  return [];
}
var NS = Object.prototype, MS = NS.propertyIsEnumerable, Xh = Object.getOwnPropertySymbols, Lc = Xh ? function(t) {
  return t == null ? [] : (t = Object(t), di(Xh(t), function(e) {
    return MS.call(t, e);
  }));
} : Rc;
function PS(t, e) {
  return Tr(t, Lc(t), e);
}
var DS = Object.getOwnPropertySymbols, Ry = DS ? function(t) {
  for (var e = []; t; )
    fi(e, Lc(t)), t = zl(t);
  return e;
} : Rc;
function RS(t, e) {
  return Tr(t, Ry(t), e);
}
function Ly(t, e, n) {
  var r = e(t);
  return Ie(t) ? r : fi(r, n(t));
}
function lf(t) {
  return Ly(t, $t, Lc);
}
function Ic(t) {
  return Ly(t, xn, Ry);
}
var uf = $i(Ft, "DataView"), ff = $i(Ft, "Promise"), uo = $i(Ft, "Set"), Gh = "[object Map]", LS = "[object Object]", Uh = "[object Promise]", Yh = "[object Set]", Vh = "[object WeakMap]", Kh = "[object DataView]", IS = Fi(uf), jS = Fi(Ta), kS = Fi(ff), BS = Fi(uo), FS = Fi(Oa), Qt = fn;
(uf && Qt(new uf(new ArrayBuffer(1))) != Kh || Ta && Qt(new Ta()) != Gh || ff && Qt(ff.resolve()) != Uh || uo && Qt(new uo()) != Yh || Oa && Qt(new Oa()) != Vh) && (Qt = function(t) {
  var e = fn(t), n = e == LS ? t.constructor : void 0, r = n ? Fi(n) : "";
  if (r)
    switch (r) {
      case IS:
        return Kh;
      case jS:
        return Gh;
      case kS:
        return Uh;
      case BS:
        return Yh;
      case FS:
        return Vh;
    }
  return e;
});
var $S = Object.prototype, HS = $S.hasOwnProperty;
function WS(t) {
  var e = t.length, n = new t.constructor(e);
  return e && typeof t[0] == "string" && HS.call(t, "index") && (n.index = t.index, n.input = t.input), n;
}
var Gs = Ft.Uint8Array;
function jc(t) {
  var e = new t.constructor(t.byteLength);
  return new Gs(e).set(new Gs(t)), e;
}
function zS(t, e) {
  var n = e ? jc(t.buffer) : t.buffer;
  return new t.constructor(n, t.byteOffset, t.byteLength);
}
var XS = /\w*$/;
function GS(t) {
  var e = new t.constructor(t.source, XS.exec(t));
  return e.lastIndex = t.lastIndex, e;
}
var qh = tn ? tn.prototype : void 0, Zh = qh ? qh.valueOf : void 0;
function US(t) {
  return Zh ? Object(Zh.call(t)) : {};
}
function Iy(t, e) {
  var n = e ? jc(t.buffer) : t.buffer;
  return new t.constructor(n, t.byteOffset, t.length);
}
var YS = "[object Boolean]", VS = "[object Date]", KS = "[object Map]", qS = "[object Number]", ZS = "[object RegExp]", JS = "[object Set]", QS = "[object String]", eO = "[object Symbol]", tO = "[object ArrayBuffer]", nO = "[object DataView]", rO = "[object Float32Array]", iO = "[object Float64Array]", oO = "[object Int8Array]", aO = "[object Int16Array]", sO = "[object Int32Array]", lO = "[object Uint8Array]", uO = "[object Uint8ClampedArray]", fO = "[object Uint16Array]", cO = "[object Uint32Array]";
function dO(t, e, n) {
  var r = t.constructor;
  switch (e) {
    case tO:
      return jc(t);
    case YS:
    case VS:
      return new r(+t);
    case nO:
      return zS(t, n);
    case rO:
    case iO:
    case oO:
    case aO:
    case sO:
    case lO:
    case uO:
    case fO:
    case cO:
      return Iy(t, n);
    case KS:
      return new r();
    case qS:
    case QS:
      return new r(t);
    case ZS:
      return GS(t);
    case JS:
      return new r();
    case eO:
      return US(t);
  }
}
function jy(t) {
  return typeof t.constructor == "function" && !za(t) ? Mo(zl(t)) : {};
}
var hO = "[object Map]";
function pO(t) {
  return Nt(t) && Qt(t) == hO;
}
var Jh = Un && Un.isMap, ky = Jh ? Mn(Jh) : pO, vO = "[object Set]";
function gO(t) {
  return Nt(t) && Qt(t) == vO;
}
var Qh = Un && Un.isSet, By = Qh ? Mn(Qh) : gO, yO = 1, mO = 2, _O = 4, Fy = "[object Arguments]", bO = "[object Array]", xO = "[object Boolean]", EO = "[object Date]", wO = "[object Error]", $y = "[object Function]", SO = "[object GeneratorFunction]", OO = "[object Map]", AO = "[object Number]", Hy = "[object Object]", CO = "[object RegExp]", TO = "[object Set]", NO = "[object String]", MO = "[object Symbol]", PO = "[object WeakMap]", DO = "[object ArrayBuffer]", RO = "[object DataView]", LO = "[object Float32Array]", IO = "[object Float64Array]", jO = "[object Int8Array]", kO = "[object Int16Array]", BO = "[object Int32Array]", FO = "[object Uint8Array]", $O = "[object Uint8ClampedArray]", HO = "[object Uint16Array]", WO = "[object Uint32Array]", _t = {};
_t[Fy] = _t[bO] = _t[DO] = _t[RO] = _t[xO] = _t[EO] = _t[LO] = _t[IO] = _t[jO] = _t[kO] = _t[BO] = _t[OO] = _t[AO] = _t[Hy] = _t[CO] = _t[TO] = _t[NO] = _t[MO] = _t[FO] = _t[$O] = _t[HO] = _t[WO] = !0;
_t[wO] = _t[$y] = _t[PO] = !1;
function Wn(t, e, n, r, i, o) {
  var a, s = e & yO, l = e & mO, u = e & _O;
  if (n && (a = i ? n(t, r, i, o) : n(t)), a !== void 0)
    return a;
  if (!Tt(t))
    return t;
  var f = Ie(t);
  if (f) {
    if (a = WS(t), !s)
      return yn(t, a);
  } else {
    var c = Qt(t), d = c == $y || c == SO;
    if (oi(t))
      return Dy(t, s);
    if (c == Hy || c == Fy || d && !i) {
      if (a = l || d ? {} : jy(t), !s)
        return l ? RS(t, CS(a, t)) : PS(t, My(a, t));
    } else {
      if (!_t[c])
        return i ? t : {};
      a = dO(t, c, s);
    }
  }
  o || (o = new dr());
  var h = o.get(t);
  if (h)
    return h;
  o.set(t, a), By(t) ? t.forEach(function(g) {
    a.add(Wn(g, e, n, g, t, o));
  }) : ky(t) && t.forEach(function(g, y) {
    a.set(y, Wn(g, e, n, y, t, o));
  });
  var v = u ? l ? Ic : lf : l ? xn : $t, p = f ? void 0 : v(t);
  return Vn(p || t, function(g, y) {
    p && (y = g, g = t[y]), Wa(a, y, Wn(g, e, n, y, t, o));
  }), a;
}
var zO = 4;
function XO(t) {
  return Wn(t, zO);
}
var GO = 1, UO = 4;
function Fe(t) {
  return Wn(t, GO | UO);
}
var YO = 1, VO = 4;
function KO(t, e) {
  return e = typeof e == "function" ? e : void 0, Wn(t, YO | VO, e);
}
var qO = 4;
function ZO(t, e) {
  return e = typeof e == "function" ? e : void 0, Wn(t, qO, e);
}
function JO() {
  return new Gn(this.value(), this.__chain__);
}
function QO(t) {
  for (var e = -1, n = t == null ? 0 : t.length, r = 0, i = []; ++e < n; ) {
    var o = t[e];
    o && (i[r++] = o);
  }
  return i;
}
function eA() {
  var t = arguments.length;
  if (!t)
    return [];
  for (var e = Array(t - 1), n = arguments[0], r = t; r--; )
    e[r - 1] = arguments[r];
  return fi(Ie(n) ? yn(n) : [n], Kt(e, 1));
}
var tA = "__lodash_hash_undefined__";
function nA(t) {
  return this.__data__.set(t, tA), this;
}
function rA(t) {
  return this.__data__.has(t);
}
function Ii(t) {
  var e = -1, n = t == null ? 0 : t.length;
  for (this.__data__ = new Wr(); ++e < n; )
    this.add(t[e]);
}
Ii.prototype.add = Ii.prototype.push = nA;
Ii.prototype.has = rA;
function kc(t, e) {
  for (var n = -1, r = t == null ? 0 : t.length; ++n < r; )
    if (e(t[n], n, t))
      return !0;
  return !1;
}
function Na(t, e) {
  return t.has(e);
}
var iA = 1, oA = 2;
function Wy(t, e, n, r, i, o) {
  var a = n & iA, s = t.length, l = e.length;
  if (s != l && !(a && l > s))
    return !1;
  var u = o.get(t), f = o.get(e);
  if (u && f)
    return u == e && f == t;
  var c = -1, d = !0, h = n & oA ? new Ii() : void 0;
  for (o.set(t, e), o.set(e, t); ++c < s; ) {
    var v = t[c], p = e[c];
    if (r)
      var g = a ? r(p, v, c, e, t, o) : r(v, p, c, t, e, o);
    if (g !== void 0) {
      if (g)
        continue;
      d = !1;
      break;
    }
    if (h) {
      if (!kc(e, function(y, m) {
        if (!Na(h, m) && (v === y || i(v, y, n, r, o)))
          return h.push(m);
      })) {
        d = !1;
        break;
      }
    } else if (!(v === p || i(v, p, n, r, o))) {
      d = !1;
      break;
    }
  }
  return o.delete(t), o.delete(e), d;
}
function Bc(t) {
  var e = -1, n = Array(t.size);
  return t.forEach(function(r, i) {
    n[++e] = [i, r];
  }), n;
}
function Gl(t) {
  var e = -1, n = Array(t.size);
  return t.forEach(function(r) {
    n[++e] = r;
  }), n;
}
var aA = 1, sA = 2, lA = "[object Boolean]", uA = "[object Date]", fA = "[object Error]", cA = "[object Map]", dA = "[object Number]", hA = "[object RegExp]", pA = "[object Set]", vA = "[object String]", gA = "[object Symbol]", yA = "[object ArrayBuffer]", mA = "[object DataView]", ep = tn ? tn.prototype : void 0, xu = ep ? ep.valueOf : void 0;
function _A(t, e, n, r, i, o, a) {
  switch (n) {
    case mA:
      if (t.byteLength != e.byteLength || t.byteOffset != e.byteOffset)
        return !1;
      t = t.buffer, e = e.buffer;
    case yA:
      return !(t.byteLength != e.byteLength || !o(new Gs(t), new Gs(e)));
    case lA:
    case uA:
    case dA:
      return gr(+t, +e);
    case fA:
      return t.name == e.name && t.message == e.message;
    case hA:
    case vA:
      return t == e + "";
    case cA:
      var s = Bc;
    case pA:
      var l = r & aA;
      if (s || (s = Gl), t.size != e.size && !l)
        return !1;
      var u = a.get(t);
      if (u)
        return u == e;
      r |= sA, a.set(t, e);
      var f = Wy(s(t), s(e), r, i, o, a);
      return a.delete(t), f;
    case gA:
      if (xu)
        return xu.call(t) == xu.call(e);
  }
  return !1;
}
var bA = 1, xA = Object.prototype, EA = xA.hasOwnProperty;
function wA(t, e, n, r, i, o) {
  var a = n & bA, s = lf(t), l = s.length, u = lf(e), f = u.length;
  if (l != f && !a)
    return !1;
  for (var c = l; c--; ) {
    var d = s[c];
    if (!(a ? d in e : EA.call(e, d)))
      return !1;
  }
  var h = o.get(t), v = o.get(e);
  if (h && v)
    return h == e && v == t;
  var p = !0;
  o.set(t, e), o.set(e, t);
  for (var g = a; ++c < l; ) {
    d = s[c];
    var y = t[d], m = e[d];
    if (r)
      var A = a ? r(m, y, d, e, t, o) : r(y, m, d, t, e, o);
    if (!(A === void 0 ? y === m || i(y, m, n, r, o) : A)) {
      p = !1;
      break;
    }
    g || (g = d == "constructor");
  }
  if (p && !g) {
    var T = t.constructor, k = e.constructor;
    T != k && "constructor" in t && "constructor" in e && !(typeof T == "function" && T instanceof T && typeof k == "function" && k instanceof k) && (p = !1);
  }
  return o.delete(t), o.delete(e), p;
}
var SA = 1, tp = "[object Arguments]", np = "[object Array]", ns = "[object Object]", OA = Object.prototype, rp = OA.hasOwnProperty;
function AA(t, e, n, r, i, o) {
  var a = Ie(t), s = Ie(e), l = a ? np : Qt(t), u = s ? np : Qt(e);
  l = l == tp ? ns : l, u = u == tp ? ns : u;
  var f = l == ns, c = u == ns, d = l == u;
  if (d && oi(t)) {
    if (!oi(e))
      return !1;
    a = !0, f = !1;
  }
  if (d && !f)
    return o || (o = new dr()), a || Lo(t) ? Wy(t, e, n, r, i, o) : _A(t, e, l, n, r, i, o);
  if (!(n & SA)) {
    var h = f && rp.call(t, "__wrapped__"), v = c && rp.call(e, "__wrapped__");
    if (h || v) {
      var p = h ? t.value() : t, g = v ? e.value() : e;
      return o || (o = new dr()), i(p, g, n, r, o);
    }
  }
  return d ? (o || (o = new dr()), wA(t, e, n, r, i, o)) : !1;
}
function Ga(t, e, n, r, i) {
  return t === e ? !0 : t == null || e == null || !Nt(t) && !Nt(e) ? t !== t && e !== e : AA(t, e, n, r, Ga, i);
}
var CA = 1, TA = 2;
function Fc(t, e, n, r) {
  var i = n.length, o = i, a = !r;
  if (t == null)
    return !o;
  for (t = Object(t); i--; ) {
    var s = n[i];
    if (a && s[2] ? s[1] !== t[s[0]] : !(s[0] in t))
      return !1;
  }
  for (; ++i < o; ) {
    s = n[i];
    var l = s[0], u = t[l], f = s[1];
    if (a && s[2]) {
      if (u === void 0 && !(l in t))
        return !1;
    } else {
      var c = new dr();
      if (r)
        var d = r(u, f, l, t, e, c);
      if (!(d === void 0 ? Ga(f, u, CA | TA, r, c) : d))
        return !1;
    }
  }
  return !0;
}
function zy(t) {
  return t === t && !Tt(t);
}
function $c(t) {
  for (var e = $t(t), n = e.length; n--; ) {
    var r = e[n], i = t[r];
    e[n] = [r, i, zy(i)];
  }
  return e;
}
function Xy(t, e) {
  return function(n) {
    return n == null ? !1 : n[t] === e && (e !== void 0 || t in Object(n));
  };
}
function Gy(t) {
  var e = $c(t);
  return e.length == 1 && e[0][2] ? Xy(e[0][0], e[0][1]) : function(n) {
    return n === t || Fc(n, t, e);
  };
}
function NA(t, e) {
  return t != null && e in Object(t);
}
function Uy(t, e, n) {
  e = ui(e, t);
  for (var r = -1, i = e.length, o = !1; ++r < i; ) {
    var a = Nr(e[r]);
    if (!(o = t != null && n(t, a)))
      break;
    t = t[a];
  }
  return o || ++r != i ? o : (i = t == null ? 0 : t.length, !!i && Fl(i) && Br(a, i) && (Ie(t) || Ri(t)));
}
function Hc(t, e) {
  return t != null && Uy(t, e, NA);
}
var MA = 1, PA = 2;
function Yy(t, e) {
  return Oc(t) && zy(e) ? Xy(Nr(t), e) : function(n) {
    var r = Io(n, t);
    return r === void 0 && r === e ? Hc(n, t) : Ga(e, r, MA | PA);
  };
}
function Wc(t) {
  return function(e) {
    return e == null ? void 0 : e[t];
  };
}
function DA(t) {
  return function(e) {
    return Hi(e, t);
  };
}
function Vy(t) {
  return Oc(t) ? Wc(Nr(t)) : DA(t);
}
function je(t) {
  return typeof t == "function" ? t : t == null ? _n : typeof t == "object" ? Ie(t) ? Yy(t[0], t[1]) : Gy(t) : Vy(t);
}
var RA = "Expected a function";
function LA(t) {
  var e = t == null ? 0 : t.length, n = je;
  return t = e ? Ct(t, function(r) {
    if (typeof r[1] != "function")
      throw new TypeError(RA);
    return [n(r[0]), r[1]];
  }) : [], Ve(function(r) {
    for (var i = -1; ++i < e; ) {
      var o = t[i];
      if (Nn(o[0], this, r))
        return Nn(o[1], this, r);
    }
  });
}
function Ky(t, e, n) {
  var r = n.length;
  if (t == null)
    return !r;
  for (t = Object(t); r--; ) {
    var i = n[r], o = e[i], a = t[i];
    if (a === void 0 && !(i in t) || !o(a))
      return !1;
  }
  return !0;
}
function IA(t) {
  var e = $t(t);
  return function(n) {
    return Ky(n, t, e);
  };
}
var jA = 1;
function kA(t) {
  return IA(Wn(t, jA));
}
function BA(t, e) {
  return e == null || Ky(t, e, $t(e));
}
function FA(t, e, n, r) {
  for (var i = -1, o = t == null ? 0 : t.length; ++i < o; ) {
    var a = t[i];
    e(r, a, n(a), t);
  }
  return r;
}
function qy(t) {
  return function(e, n, r) {
    for (var i = -1, o = Object(e), a = r(e), s = a.length; s--; ) {
      var l = a[t ? s : ++i];
      if (n(o[l], l, o) === !1)
        break;
    }
    return e;
  };
}
var zc = qy();
function Mr(t, e) {
  return t && zc(t, e, $t);
}
function Zy(t, e) {
  return function(n, r) {
    if (n == null)
      return n;
    if (!bn(n))
      return t(n, r);
    for (var i = n.length, o = e ? i : -1, a = Object(n); (e ? o-- : ++o < i) && r(a[o], o, a) !== !1; )
      ;
    return n;
  };
}
var hi = Zy(Mr);
function $A(t, e, n, r) {
  return hi(t, function(i, o, a) {
    e(r, i, n(i), a);
  }), r;
}
function Ul(t, e) {
  return function(n, r) {
    var i = Ie(n) ? FA : $A, o = e ? e() : {};
    return i(n, t, je(r), o);
  };
}
var HA = Object.prototype, WA = HA.hasOwnProperty, zA = Ul(function(t, e, n) {
  WA.call(t, n) ? ++t[n] : $r(t, n, 1);
});
function XA(t, e) {
  var n = Mo(t);
  return e == null ? n : My(n, e);
}
var GA = 8;
function Xc(t, e, n) {
  e = n ? void 0 : e;
  var r = Fr(t, GA, void 0, void 0, void 0, void 0, void 0, e);
  return r.placeholder = Xc.placeholder, r;
}
Xc.placeholder = {};
var UA = 16;
function Gc(t, e, n) {
  e = n ? void 0 : e;
  var r = Fr(t, UA, void 0, void 0, void 0, void 0, void 0, e);
  return r.placeholder = Gc.placeholder, r;
}
Gc.placeholder = {};
var Ts = function() {
  return Ft.Date.now();
}, YA = "Expected a function", VA = Math.max, KA = Math.min;
function Yl(t, e, n) {
  var r, i, o, a, s, l, u = 0, f = !1, c = !1, d = !0;
  if (typeof t != "function")
    throw new TypeError(YA);
  e = Hn(e) || 0, Tt(n) && (f = !!n.leading, c = "maxWait" in n, o = c ? VA(Hn(n.maxWait) || 0, e) : o, d = "trailing" in n ? !!n.trailing : d);
  function h(C) {
    var S = r, I = i;
    return r = i = void 0, u = C, a = t.apply(I, S), a;
  }
  function v(C) {
    return u = C, s = setTimeout(y, e), f ? h(C) : a;
  }
  function p(C) {
    var S = C - l, I = C - u, X = e - S;
    return c ? KA(X, o - I) : X;
  }
  function g(C) {
    var S = C - l, I = C - u;
    return l === void 0 || S >= e || S < 0 || c && I >= o;
  }
  function y() {
    var C = Ts();
    if (g(C))
      return m(C);
    s = setTimeout(y, p(C));
  }
  function m(C) {
    return s = void 0, d && r ? h(C) : (r = i = void 0, a);
  }
  function A() {
    s !== void 0 && clearTimeout(s), u = 0, r = l = i = s = void 0;
  }
  function T() {
    return s === void 0 ? a : m(Ts());
  }
  function k() {
    var C = Ts(), S = g(C);
    if (r = arguments, i = this, l = C, S) {
      if (s === void 0)
        return v(l);
      if (c)
        return clearTimeout(s), s = setTimeout(y, e), h(l);
    }
    return s === void 0 && (s = setTimeout(y, e)), a;
  }
  return k.cancel = A, k.flush = T, k;
}
function qA(t, e) {
  return t == null || t !== t ? e : t;
}
var Jy = Object.prototype, ZA = Jy.hasOwnProperty, JA = Ve(function(t, e) {
  t = Object(t);
  var n = -1, r = e.length, i = r > 2 ? e[2] : void 0;
  for (i && an(e[0], e[1], i) && (r = 1); ++n < r; )
    for (var o = e[n], a = xn(o), s = -1, l = a.length; ++s < l; ) {
      var u = a[s], f = t[u];
      (f === void 0 || gr(f, Jy[u]) && !ZA.call(t, u)) && (t[u] = o[u]);
    }
  return t;
});
function cf(t, e, n) {
  (n !== void 0 && !gr(t[e], n) || n === void 0 && !(e in t)) && $r(t, e, n);
}
function Dt(t) {
  return Nt(t) && bn(t);
}
function df(t, e) {
  if (!(e === "constructor" && typeof t[e] == "function") && e != "__proto__")
    return t[e];
}
function Qy(t) {
  return Tr(t, xn(t));
}
function QA(t, e, n, r, i, o, a) {
  var s = df(t, n), l = df(e, n), u = a.get(l);
  if (u) {
    cf(t, n, u);
    return;
  }
  var f = o ? o(s, l, n + "", t, e, a) : void 0, c = f === void 0;
  if (c) {
    var d = Ie(l), h = !d && oi(l), v = !d && !h && Lo(l);
    f = l, d || h || v ? Ie(s) ? f = s : Dt(s) ? f = yn(s) : h ? (c = !1, f = Dy(l, !0)) : v ? (c = !1, f = Iy(l, !0)) : f = [] : Xa(l) || Ri(l) ? (f = s, Ri(s) ? f = Qy(s) : (!Tt(s) || kr(s)) && (f = jy(l))) : c = !1;
  }
  c && (a.set(l, f), i(f, l, r, o, a), a.delete(l)), cf(t, n, f);
}
function Vl(t, e, n, r, i) {
  t !== e && zc(e, function(o, a) {
    if (i || (i = new dr()), Tt(o))
      QA(t, e, a, n, Vl, r, i);
    else {
      var s = r ? r(df(t, a), o, a + "", t, e, i) : void 0;
      s === void 0 && (s = o), cf(t, a, s);
    }
  }, xn);
}
function em(t, e, n, r, i, o) {
  return Tt(t) && Tt(e) && (o.set(e, t), Vl(t, e, void 0, em, o), o.delete(e)), t;
}
var tm = Ro(function(t, e, n, r) {
  Vl(t, e, n, r);
}), eC = Ve(function(t) {
  return t.push(void 0, em), Nn(tm, void 0, t);
}), tC = "Expected a function";
function nm(t, e, n) {
  if (typeof t != "function")
    throw new TypeError(tC);
  return setTimeout(function() {
    t.apply(void 0, n);
  }, e);
}
var nC = Ve(function(t, e) {
  return nm(t, 1, e);
}), rC = Ve(function(t, e, n) {
  return nm(t, Hn(e) || 0, n);
});
function Uc(t, e, n) {
  for (var r = -1, i = t == null ? 0 : t.length; ++r < i; )
    if (n(e, t[r]))
      return !0;
  return !1;
}
var iC = 200;
function Ua(t, e, n, r) {
  var i = -1, o = kl, a = !0, s = t.length, l = [], u = e.length;
  if (!s)
    return l;
  n && (e = Ct(e, Mn(n))), r ? (o = Uc, a = !1) : e.length >= iC && (o = Na, a = !1, e = new Ii(e));
  e:
    for (; ++i < s; ) {
      var f = t[i], c = n == null ? f : n(f);
      if (f = r || f !== 0 ? f : 0, a && c === c) {
        for (var d = u; d--; )
          if (e[d] === c)
            continue e;
        l.push(f);
      } else o(e, c, r) || l.push(f);
    }
  return l;
}
var oC = Ve(function(t, e) {
  return Dt(t) ? Ua(t, Kt(e, 1, Dt, !0)) : [];
});
function Pn(t) {
  var e = t == null ? 0 : t.length;
  return e ? t[e - 1] : void 0;
}
var aC = Ve(function(t, e) {
  var n = Pn(e);
  return Dt(n) && (n = void 0), Dt(t) ? Ua(t, Kt(e, 1, Dt, !0), je(n)) : [];
}), sC = Ve(function(t, e) {
  var n = Pn(e);
  return Dt(n) && (n = void 0), Dt(t) ? Ua(t, Kt(e, 1, Dt, !0), void 0, n) : [];
}), lC = Ll(function(t, e) {
  return t / e;
}, 1);
function uC(t, e, n) {
  var r = t == null ? 0 : t.length;
  return r ? (e = n || e === void 0 ? 1 : We(e), Yn(t, e < 0 ? 0 : e, r)) : [];
}
function fC(t, e, n) {
  var r = t == null ? 0 : t.length;
  return r ? (e = n || e === void 0 ? 1 : We(e), e = r - e, Yn(t, 0, e < 0 ? 0 : e)) : [];
}
function Kl(t, e, n, r) {
  for (var i = t.length, o = r ? i : -1; (r ? o-- : ++o < i) && e(t[o], o, t); )
    ;
  return n ? Yn(t, r ? 0 : o, r ? o + 1 : i) : Yn(t, r ? o + 1 : 0, r ? i : o);
}
function cC(t, e) {
  return t && t.length ? Kl(t, je(e), !0, !0) : [];
}
function dC(t, e) {
  return t && t.length ? Kl(t, je(e), !0) : [];
}
function Pr(t) {
  return typeof t == "function" ? t : _n;
}
function at(t, e) {
  var n = Ie(t) ? Vn : hi;
  return n(t, Pr(e));
}
function hC(t, e) {
  for (var n = t == null ? 0 : t.length; n-- && e(t[n], n, t) !== !1; )
    ;
  return t;
}
var rm = qy(!0);
function Yc(t, e) {
  return t && rm(t, e, $t);
}
var im = Zy(Yc, !0);
function pC(t, e) {
  var n = Ie(t) ? hC : im;
  return n(t, Pr(e));
}
function vC(t, e, n) {
  t = pt(t), e = Tn(e);
  var r = t.length;
  n = n === void 0 ? r : Wi(We(n), 0, r);
  var i = n;
  return n -= e.length, n >= 0 && t.slice(n, i) == e;
}
function gC(t, e) {
  return Ct(e, function(n) {
    return [n, t[n]];
  });
}
function yC(t) {
  var e = -1, n = Array(t.size);
  return t.forEach(function(r) {
    n[++e] = [r, r];
  }), n;
}
var mC = "[object Map]", _C = "[object Set]";
function om(t) {
  return function(e) {
    var n = Qt(e);
    return n == mC ? Bc(e) : n == _C ? yC(e) : gC(e, t(e));
  };
}
var Xr = om($t), bC = om(xn), xC = {
  "&": "&amp;",
  "<": "&lt;",
  ">": "&gt;",
  '"': "&quot;",
  "'": "&#39;"
}, EC = Pc(xC), am = /[&<>"']/g, wC = RegExp(am.source);
function sm(t) {
  return t = pt(t), t && wC.test(t) ? t.replace(am, EC) : t;
}
var lm = /[\\^$.*+?()[\]{}|]/g, SC = RegExp(lm.source);
function OC(t) {
  return t = pt(t), t && SC.test(t) ? t.replace(lm, "\\$&") : t;
}
function um(t, e) {
  for (var n = -1, r = t == null ? 0 : t.length; ++n < r; )
    if (!e(t[n], n, t))
      return !1;
  return !0;
}
function AC(t, e) {
  var n = !0;
  return hi(t, function(r, i, o) {
    return n = !!e(r, i, o), n;
  }), n;
}
function CC(t, e, n) {
  var r = Ie(t) ? um : AC;
  return n && an(t, e, n) && (e = void 0), r(t, je(e));
}
var TC = 4294967295;
function fm(t) {
  return t ? Wi(We(t), 0, TC) : 0;
}
function NC(t, e, n, r) {
  var i = t.length;
  for (n = We(n), n < 0 && (n = -n > i ? 0 : i + n), r = r === void 0 || r > i ? i : We(r), r < 0 && (r += i), r = n > r ? 0 : fm(r); n < r; )
    t[n++] = e;
  return t;
}
function MC(t, e, n, r) {
  var i = t == null ? 0 : t.length;
  return i ? (n && typeof n != "number" && an(t, e, n) && (n = 0, r = i), NC(t, e, n, r)) : [];
}
function cm(t, e) {
  var n = [];
  return hi(t, function(r, i, o) {
    e(r, i, o) && n.push(r);
  }), n;
}
function PC(t, e) {
  var n = Ie(t) ? di : cm;
  return n(t, je(e));
}
function dm(t) {
  return function(e, n, r) {
    var i = Object(e);
    if (!bn(e)) {
      var o = je(n);
      e = $t(e), n = function(s) {
        return o(i[s], s, i);
      };
    }
    var a = t(e, n, r);
    return a > -1 ? i[o ? e[a] : a] : void 0;
  };
}
var DC = Math.max;
function Vc(t, e, n) {
  var r = t == null ? 0 : t.length;
  if (!r)
    return -1;
  var i = n == null ? 0 : We(n);
  return i < 0 && (i = DC(r + i, 0)), jl(t, je(e), i);
}
var ai = dm(Vc);
function hm(t, e, n) {
  var r;
  return n(t, function(i, o, a) {
    if (e(i, o, a))
      return r = o, !1;
  }), r;
}
function RC(t, e) {
  return hm(t, je(e), Mr);
}
var LC = Math.max, IC = Math.min;
function pm(t, e, n) {
  var r = t == null ? 0 : t.length;
  if (!r)
    return -1;
  var i = r - 1;
  return n !== void 0 && (i = We(n), i = n < 0 ? LC(r + i, 0) : IC(i, r - 1)), jl(t, je(e), i, !0);
}
var jC = dm(pm);
function kC(t, e) {
  return hm(t, je(e), Yc);
}
function BC(t) {
  return t && t.length ? t[0] : void 0;
}
function vm(t, e) {
  var n = -1, r = bn(t) ? Array(t.length) : [];
  return hi(t, function(i, o, a) {
    r[++n] = e(i, o, a);
  }), r;
}
function Dn(t, e) {
  var n = Ie(t) ? Ct : vm;
  return n(t, je(e));
}
function FC(t, e) {
  return Kt(Dn(t, e), 1);
}
var $C = 1 / 0;
function HC(t, e) {
  return Kt(Dn(t, e), $C);
}
function WC(t, e, n) {
  return n = n === void 0 ? 1 : We(n), Kt(Dn(t, e), n);
}
var zC = 1 / 0;
function XC(t) {
  var e = t == null ? 0 : t.length;
  return e ? Kt(t, zC) : [];
}
function GC(t, e) {
  var n = t == null ? 0 : t.length;
  return n ? (e = e === void 0 ? 1 : We(e), Kt(t, e)) : [];
}
var UC = 512;
function YC(t) {
  return Fr(t, UC);
}
var VC = Dc("floor"), KC = "Expected a function", qC = 8, ZC = 32, JC = 128, QC = 256;
function gm(t) {
  return zr(function(e) {
    var n = e.length, r = n, i = Gn.prototype.thru;
    for (t && e.reverse(); r--; ) {
      var o = e[r];
      if (typeof o != "function")
        throw new TypeError(KC);
      if (i && !a && Cs(o) == "wrapper")
        var a = new Gn([], !0);
    }
    for (r = a ? r : n; ++r < n; ) {
      o = e[r];
      var s = Cs(o), l = s == "wrapper" ? _c(o) : void 0;
      l && rf(l[0]) && l[1] == (JC | qC | ZC | QC) && !l[4].length && l[9] == 1 ? a = a[Cs(l[0])].apply(a, l[3]) : a = o.length == 1 && rf(o) ? a[s]() : a.thru(o);
    }
    return function() {
      var u = arguments, f = u[0];
      if (a && u.length == 1 && Ie(f))
        return a.plant(f).value();
      for (var c = 0, d = n ? e[c].apply(this, u) : f; ++c < n; )
        d = e[c].call(this, d);
      return d;
    };
  });
}
var eT = gm(), tT = gm(!0);
function nT(t, e) {
  return t == null ? t : zc(t, Pr(e), xn);
}
function rT(t, e) {
  return t == null ? t : rm(t, Pr(e), xn);
}
function iT(t, e) {
  return t && Mr(t, Pr(e));
}
function oT(t, e) {
  return t && Yc(t, Pr(e));
}
function aT(t) {
  for (var e = -1, n = t == null ? 0 : t.length, r = {}; ++e < n; ) {
    var i = t[e];
    r[i[0]] = i[1];
  }
  return r;
}
function ql(t, e) {
  return di(e, function(n) {
    return kr(t[n]);
  });
}
function sT(t) {
  return t == null ? [] : ql(t, $t(t));
}
function lT(t) {
  return t == null ? [] : ql(t, xn(t));
}
var uT = Object.prototype, fT = uT.hasOwnProperty, cT = Ul(function(t, e, n) {
  fT.call(t, n) ? t[n].push(e) : $r(t, n, [e]);
});
function Kc(t, e) {
  return t > e;
}
function Zl(t) {
  return function(e, n) {
    return typeof e == "string" && typeof n == "string" || (e = Hn(e), n = Hn(n)), t(e, n);
  };
}
var dT = Zl(Kc), hT = Zl(function(t, e) {
  return t >= e;
}), pT = Object.prototype, vT = pT.hasOwnProperty;
function gT(t, e) {
  return t != null && vT.call(t, e);
}
function Us(t, e) {
  return t != null && Uy(t, e, gT);
}
var yT = Math.max, mT = Math.min;
function _T(t, e, n) {
  return t >= mT(e, n) && t < yT(e, n);
}
function bT(t, e, n) {
  return e = jr(e), n === void 0 ? (n = e, e = 0) : n = jr(n), t = Hn(t), _T(t, e, n);
}
var xT = "[object String]";
function Jl(t) {
  return typeof t == "string" || !Ie(t) && Nt(t) && fn(t) == xT;
}
function qc(t, e) {
  return Ct(e, function(n) {
    return t[n];
  });
}
function Bo(t) {
  return t == null ? [] : qc(t, $t(t));
}
var ET = Math.max;
function wT(t, e, n, r) {
  t = bn(t) ? t : Bo(t), n = n && !r ? We(n) : 0;
  var i = t.length;
  return n < 0 && (n = ET(i + n, 0)), Jl(t) ? n <= i && t.indexOf(e, n) > -1 : !!i && Po(t, e, n) > -1;
}
var ST = Math.max;
function ym(t, e, n) {
  var r = t == null ? 0 : t.length;
  if (!r)
    return -1;
  var i = n == null ? 0 : We(n);
  return i < 0 && (i = ST(r + i, 0)), Po(t, e, i);
}
function OT(t) {
  var e = t == null ? 0 : t.length;
  return e ? Yn(t, 0, -1) : [];
}
var AT = Math.min;
function Zc(t, e, n) {
  for (var r = n ? Uc : kl, i = t[0].length, o = t.length, a = o, s = Array(o), l = 1 / 0, u = []; a--; ) {
    var f = t[a];
    a && e && (f = Ct(f, Mn(e))), l = AT(f.length, l), s[a] = !n && (e || i >= 120 && f.length >= 120) ? new Ii(a && f) : void 0;
  }
  f = t[0];
  var c = -1, d = s[0];
  e:
    for (; ++c < i && u.length < l; ) {
      var h = f[c], v = e ? e(h) : h;
      if (h = n || h !== 0 ? h : 0, !(d ? Na(d, v) : r(u, v, n))) {
        for (a = o; --a; ) {
          var p = s[a];
          if (!(p ? Na(p, v) : r(t[a], v, n)))
            continue e;
        }
        d && d.push(v), u.push(h);
      }
    }
  return u;
}
function Jc(t) {
  return Dt(t) ? t : [];
}
var CT = Ve(function(t) {
  var e = Ct(t, Jc);
  return e.length && e[0] === t[0] ? Zc(e) : [];
}), TT = Ve(function(t) {
  var e = Pn(t), n = Ct(t, Jc);
  return e === Pn(n) ? e = void 0 : n.pop(), n.length && n[0] === t[0] ? Zc(n, je(e)) : [];
}), NT = Ve(function(t) {
  var e = Pn(t), n = Ct(t, Jc);
  return e = typeof e == "function" ? e : void 0, e && n.pop(), n.length && n[0] === t[0] ? Zc(n, void 0, e) : [];
});
function MT(t, e, n, r) {
  return Mr(t, function(i, o, a) {
    e(r, n(i), o, a);
  }), r;
}
function mm(t, e) {
  return function(n, r) {
    return MT(n, t, e(r), {});
  };
}
var PT = Object.prototype, DT = PT.toString, RT = mm(function(t, e, n) {
  e != null && typeof e.toString != "function" && (e = DT.call(e)), t[e] = n;
}, bc(_n)), _m = Object.prototype, LT = _m.hasOwnProperty, IT = _m.toString, jT = mm(function(t, e, n) {
  e != null && typeof e.toString != "function" && (e = IT.call(e)), LT.call(t, e) ? t[e].push(n) : t[e] = [n];
}, je);
function bm(t, e) {
  return e.length < 2 ? t : Hi(t, Yn(e, 0, -1));
}
function Ya(t, e, n) {
  e = ui(e, t), t = bm(t, e);
  var r = t == null ? t : t[Nr(Pn(e))];
  return r == null ? void 0 : Nn(r, t, n);
}
var kT = Ve(Ya), BT = Ve(function(t, e, n) {
  var r = -1, i = typeof e == "function", o = bn(t) ? Array(t.length) : [];
  return hi(t, function(a) {
    o[++r] = i ? Nn(e, a, n) : Ya(a, e, n);
  }), o;
}), FT = "[object ArrayBuffer]";
function $T(t) {
  return Nt(t) && fn(t) == FT;
}
var ip = Un && Un.isArrayBuffer, HT = ip ? Mn(ip) : $T, WT = "[object Boolean]";
function Ys(t) {
  return t === !0 || t === !1 || Nt(t) && fn(t) == WT;
}
var zT = "[object Date]";
function XT(t) {
  return Nt(t) && fn(t) == zT;
}
var op = Un && Un.isDate, GT = op ? Mn(op) : XT;
function UT(t) {
  return Nt(t) && t.nodeType === 1 && !Xa(t);
}
var YT = "[object Map]", VT = "[object Set]", KT = Object.prototype, qT = KT.hasOwnProperty;
function Qc(t) {
  if (t == null)
    return !0;
  if (bn(t) && (Ie(t) || typeof t == "string" || typeof t.splice == "function" || oi(t) || Lo(t) || Ri(t)))
    return !t.length;
  var e = Qt(t);
  if (e == YT || e == VT)
    return !t.size;
  if (za(t))
    return !Sc(t).length;
  for (var n in t)
    if (qT.call(t, n))
      return !1;
  return !0;
}
function hf(t, e) {
  return Ga(t, e);
}
function ZT(t, e, n) {
  n = typeof n == "function" ? n : void 0;
  var r = n ? n(t, e) : void 0;
  return r === void 0 ? Ga(t, e, void 0, n) : !!r;
}
var JT = Ft.isFinite;
function QT(t) {
  return typeof t == "number" && JT(t);
}
function xm(t) {
  return typeof t == "number" && t == We(t);
}
function eN(t, e) {
  return t === e || Fc(t, e, $c(e));
}
function tN(t, e, n) {
  return n = typeof n == "function" ? n : void 0, Fc(t, e, $c(e), n);
}
var nN = "[object Number]";
function Em(t) {
  return typeof t == "number" || Nt(t) && fn(t) == nN;
}
function rN(t) {
  return Em(t) && t != +t;
}
var iN = As ? kr : wc, oN = "Unsupported core-js use. Try https://npms.io/search?q=ponyfill.";
function aN(t) {
  if (iN(t))
    throw new Error(oN);
  return Bg(t);
}
function Bn(t) {
  return t == null;
}
function sN(t) {
  return t === null;
}
var lN = "[object RegExp]";
function uN(t) {
  return Nt(t) && fn(t) == lN;
}
var ap = Un && Un.isRegExp, ed = ap ? Mn(ap) : uN, fN = 9007199254740991;
function cN(t) {
  return xm(t) && t >= -9007199254740991 && t <= fN;
}
function ji(t) {
  return t === void 0;
}
var dN = "[object WeakMap]";
function hN(t) {
  return Nt(t) && Qt(t) == dN;
}
var pN = "[object WeakSet]";
function vN(t) {
  return Nt(t) && fn(t) == pN;
}
var gN = 1;
function yN(t) {
  return je(typeof t == "function" ? t : Wn(t, gN));
}
var mN = Array.prototype, _N = mN.join;
function bN(t, e) {
  return t == null ? "" : _N.call(t, e);
}
var xN = ko(function(t, e, n) {
  return t + (n ? "-" : "") + e.toLowerCase();
}), EN = Ul(function(t, e, n) {
  $r(t, n, e);
});
function wN(t, e, n) {
  for (var r = n + 1; r--; )
    if (t[r] === e)
      return r;
  return r;
}
var SN = Math.max, ON = Math.min;
function AN(t, e, n) {
  var r = t == null ? 0 : t.length;
  if (!r)
    return -1;
  var i = r;
  return n !== void 0 && (i = We(n), i = i < 0 ? SN(r + i, 0) : ON(i, r - 1)), e === e ? wN(t, e, i) : jl(t, Gg, i, !0);
}
var CN = ko(function(t, e, n) {
  return t + (n ? " " : "") + e.toLowerCase();
}), TN = dy("toLowerCase");
function td(t, e) {
  return t < e;
}
var NN = Zl(td), MN = Zl(function(t, e) {
  return t <= e;
});
function wm(t, e) {
  var n = {};
  return e = je(e), Mr(t, function(r, i, o) {
    $r(n, e(r, i, o), r);
  }), n;
}
function PN(t, e) {
  var n = {};
  return e = je(e), Mr(t, function(r, i, o) {
    $r(n, i, e(r, i, o));
  }), n;
}
var DN = 1;
function RN(t) {
  return Gy(Wn(t, DN));
}
var LN = 1;
function IN(t, e) {
  return Yy(t, Wn(e, LN));
}
function Ql(t, e, n) {
  for (var r = -1, i = t.length; ++r < i; ) {
    var o = t[r], a = e(o);
    if (a != null && (s === void 0 ? a === a && !Cn(a) : n(a, s)))
      var s = a, l = o;
  }
  return l;
}
function jN(t) {
  return t && t.length ? Ql(t, _n, Kc) : void 0;
}
function kN(t, e) {
  return t && t.length ? Ql(t, je(e), Kc) : void 0;
}
function nd(t, e) {
  for (var n, r = -1, i = t.length; ++r < i; ) {
    var o = e(t[r]);
    o !== void 0 && (n = n === void 0 ? o : n + o);
  }
  return n;
}
var BN = NaN;
function Sm(t, e) {
  var n = t == null ? 0 : t.length;
  return n ? nd(t, e) / n : BN;
}
function FN(t) {
  return Sm(t, _n);
}
function $N(t, e) {
  return Sm(t, je(e));
}
var mo = Ro(function(t, e, n) {
  Vl(t, e, n);
}), HN = Ve(function(t, e) {
  return function(n) {
    return Ya(n, t, e);
  };
}), WN = Ve(function(t, e) {
  return function(n) {
    return Ya(t, n, e);
  };
});
function zN(t) {
  return t && t.length ? Ql(t, _n, td) : void 0;
}
function XN(t, e) {
  return t && t.length ? Ql(t, je(e), td) : void 0;
}
function GN(t, e, n) {
  var r = $t(e), i = ql(e, r), o = !(Tt(n) && "chain" in n) || !!n.chain, a = kr(t);
  return Vn(i, function(s) {
    var l = e[s];
    t[s] = l, a && (t.prototype[s] = function() {
      var u = this.__chain__;
      if (o || u) {
        var f = t(this.__wrapped__), c = f.__actions__ = yn(this.__actions__);
        return c.push({ func: l, args: arguments, thisArg: t }), f.__chain__ = u, f;
      }
      return l.apply(t, fi([this.value()], arguments));
    });
  }), t;
}
var UN = Ll(function(t, e) {
  return t * e;
}, 1), YN = "Expected a function";
function eu(t) {
  if (typeof t != "function")
    throw new TypeError(YN);
  return function() {
    var e = arguments;
    switch (e.length) {
      case 0:
        return !t.call(this);
      case 1:
        return !t.call(this, e[0]);
      case 2:
        return !t.call(this, e[0], e[1]);
      case 3:
        return !t.call(this, e[0], e[1], e[2]);
    }
    return !t.apply(this, e);
  };
}
function VN(t) {
  for (var e, n = []; !(e = t.next()).done; )
    n.push(e.value);
  return n;
}
var KN = "[object Map]", qN = "[object Set]", Eu = tn ? tn.iterator : void 0;
function Om(t) {
  if (!t)
    return [];
  if (bn(t))
    return Jl(t) ? hr(t) : yn(t);
  if (Eu && t[Eu])
    return VN(t[Eu]());
  var e = Qt(t), n = e == KN ? Bc : e == qN ? Gl : Bo;
  return n(t);
}
function ZN() {
  this.__values__ === void 0 && (this.__values__ = Om(this.value()));
  var t = this.__index__ >= this.__values__.length, e = t ? void 0 : this.__values__[this.__index__++];
  return { done: t, value: e };
}
function Am(t, e) {
  var n = t.length;
  if (n)
    return e += e < 0 ? n : 0, Br(e, n) ? t[e] : void 0;
}
function JN(t, e) {
  return t && t.length ? Am(t, We(e)) : void 0;
}
function QN(t) {
  return t = We(t), Ve(function(e) {
    return Am(e, t);
  });
}
function rd(t, e) {
  return e = ui(e, t), t = bm(t, e), t == null || delete t[Nr(Pn(e))];
}
function eM(t) {
  return Xa(t) ? void 0 : t;
}
var tM = 1, nM = 2, rM = 4, iM = zr(function(t, e) {
  var n = {};
  if (t == null)
    return n;
  var r = !1;
  e = Ct(e, function(o) {
    return o = ui(o, t), r || (r = o.length > 1), o;
  }), Tr(t, Ic(t), n), r && (n = Wn(n, tM | nM | rM, eM));
  for (var i = e.length; i--; )
    rd(n, e[i]);
  return n;
});
function Va(t, e, n, r) {
  if (!Tt(t))
    return t;
  e = ui(e, t);
  for (var i = -1, o = e.length, a = o - 1, s = t; s != null && ++i < o; ) {
    var l = Nr(e[i]), u = n;
    if (l === "__proto__" || l === "constructor" || l === "prototype")
      return t;
    if (i != a) {
      var f = s[l];
      u = r ? r(f, l, s) : void 0, u === void 0 && (u = Tt(f) ? f : Br(e[i + 1]) ? [] : {});
    }
    Wa(s, l, u), s = s[l];
  }
  return t;
}
function Cm(t, e, n) {
  for (var r = -1, i = e.length, o = {}; ++r < i; ) {
    var a = e[r], s = Hi(t, a);
    n(s, a) && Va(o, ui(a, t), s);
  }
  return o;
}
function Tm(t, e) {
  if (t == null)
    return {};
  var n = Ct(Ic(t), function(r) {
    return [r];
  });
  return e = je(e), Cm(t, n, function(r, i) {
    return e(r, i[0]);
  });
}
function oM(t, e) {
  return Tm(t, eu(je(e)));
}
function aM(t) {
  return oy(2, t);
}
function sM(t, e) {
  var n = t.length;
  for (t.sort(e); n--; )
    t[n] = t[n].value;
  return t;
}
function Nm(t, e) {
  if (t !== e) {
    var n = t !== void 0, r = t === null, i = t === t, o = Cn(t), a = e !== void 0, s = e === null, l = e === e, u = Cn(e);
    if (!s && !u && !o && t > e || o && a && l && !s && !u || r && a && l || !n && l || !i)
      return 1;
    if (!r && !o && !u && t < e || u && n && i && !r && !o || s && n && i || !a && i || !l)
      return -1;
  }
  return 0;
}
function lM(t, e, n) {
  for (var r = -1, i = t.criteria, o = e.criteria, a = i.length, s = n.length; ++r < a; ) {
    var l = Nm(i[r], o[r]);
    if (l) {
      if (r >= s)
        return l;
      var u = n[r];
      return l * (u == "desc" ? -1 : 1);
    }
  }
  return t.index - e.index;
}
function Mm(t, e, n) {
  e.length ? e = Ct(e, function(o) {
    return Ie(o) ? function(a) {
      return Hi(a, o.length === 1 ? o[0] : o);
    } : o;
  }) : e = [_n];
  var r = -1;
  e = Ct(e, Mn(je));
  var i = vm(t, function(o, a, s) {
    var l = Ct(e, function(u) {
      return u(o);
    });
    return { criteria: l, index: ++r, value: o };
  });
  return sM(i, function(o, a) {
    return lM(o, a, n);
  });
}
function uM(t, e, n, r) {
  return t == null ? [] : (Ie(e) || (e = e == null ? [] : [e]), n = r ? void 0 : n, Ie(n) || (n = n == null ? [] : [n]), Mm(t, e, n));
}
function id(t) {
  return zr(function(e) {
    return e = Ct(e, Mn(je)), Ve(function(n) {
      var r = this;
      return t(e, function(i) {
        return Nn(i, r, n);
      });
    });
  });
}
var fM = id(Ct), cM = Ve, dM = Math.min, hM = cM(function(t, e) {
  e = e.length == 1 && Ie(e[0]) ? Ct(e[0], Mn(je)) : Ct(Kt(e, 1), Mn(je));
  var n = e.length;
  return Ve(function(r) {
    for (var i = -1, o = dM(r.length, n); ++i < o; )
      r[i] = e[i].call(this, r[i]);
    return Nn(t, this, r);
  });
}), pM = id(um), vM = id(kc), gM = 9007199254740991, yM = Math.floor;
function pf(t, e) {
  var n = "";
  if (!t || e < 1 || e > gM)
    return n;
  do
    e % 2 && (n += t), e = yM(e / 2), e && (t += t);
  while (e);
  return n;
}
var mM = Wc("length"), Pm = "\\ud800-\\udfff", _M = "\\u0300-\\u036f", bM = "\\ufe20-\\ufe2f", xM = "\\u20d0-\\u20ff", EM = _M + bM + xM, wM = "\\ufe0e\\ufe0f", SM = "[" + Pm + "]", vf = "[" + EM + "]", gf = "\\ud83c[\\udffb-\\udfff]", OM = "(?:" + vf + "|" + gf + ")", Dm = "[^" + Pm + "]", Rm = "(?:\\ud83c[\\udde6-\\uddff]){2}", Lm = "[\\ud800-\\udbff][\\udc00-\\udfff]", AM = "\\u200d", Im = OM + "?", jm = "[" + wM + "]?", CM = "(?:" + AM + "(?:" + [Dm, Rm, Lm].join("|") + ")" + jm + Im + ")*", TM = jm + Im + CM, NM = "(?:" + [Dm + vf + "?", vf, Rm, Lm, SM].join("|") + ")", sp = RegExp(gf + "(?=" + gf + ")|" + NM + TM, "g");
function MM(t) {
  for (var e = sp.lastIndex = 0; sp.test(t); )
    ++e;
  return e;
}
function Fo(t) {
  return jo(t) ? MM(t) : mM(t);
}
var PM = Math.ceil;
function Vs(t, e) {
  e = e === void 0 ? " " : Tn(e);
  var n = e.length;
  if (n < 2)
    return n ? pf(e, t) : e;
  var r = pf(e, PM(t / Fo(e)));
  return jo(e) ? ci(hr(r), 0, t).join("") : r.slice(0, t);
}
var DM = Math.ceil, RM = Math.floor;
function LM(t, e, n) {
  t = pt(t), e = We(e);
  var r = e ? Fo(t) : 0;
  if (!e || r >= e)
    return t;
  var i = (e - r) / 2;
  return Vs(RM(i), n) + t + Vs(DM(i), n);
}
function IM(t, e, n) {
  t = pt(t), e = We(e);
  var r = e ? Fo(t) : 0;
  return e && r < e ? t + Vs(e - r, n) : t;
}
function jM(t, e, n) {
  t = pt(t), e = We(e);
  var r = e ? Fo(t) : 0;
  return e && r < e ? Vs(e - r, n) + t : t;
}
var kM = /^\s+/, BM = Ft.parseInt;
function FM(t, e, n) {
  return n || e == null ? e = 0 : e && (e = +e), BM(pt(t).replace(kM, ""), e || 0);
}
var $M = 32, tu = Ve(function(t, e) {
  var n = ii(e, Do(tu));
  return Fr(t, $M, void 0, e, n);
});
tu.placeholder = {};
var HM = 64, od = Ve(function(t, e) {
  var n = ii(e, Do(od));
  return Fr(t, HM, void 0, e, n);
});
od.placeholder = {};
var WM = Ul(function(t, e, n) {
  t[n ? 0 : 1].push(e);
}, function() {
  return [[], []];
});
function zM(t, e) {
  return Cm(t, e, function(n, r) {
    return Hc(t, r);
  });
}
var Ti = zr(function(t, e) {
  return t == null ? {} : zM(t, e);
});
function XM(t) {
  for (var e, n = this; n instanceof Il; ) {
    var r = Wg(n);
    r.__index__ = 0, r.__values__ = void 0, e ? i.__wrapped__ = r : e = r;
    var i = r;
    n = n.__wrapped__;
  }
  return i.__wrapped__ = t, e;
}
function GM(t) {
  return function(e) {
    return t == null ? void 0 : Hi(t, e);
  };
}
function UM(t, e, n, r) {
  for (var i = n - 1, o = t.length; ++i < o; )
    if (r(t[i], e))
      return i;
  return -1;
}
var YM = Array.prototype, lp = YM.splice;
function ad(t, e, n, r) {
  var i = r ? UM : Po, o = -1, a = e.length, s = t;
  for (t === e && (e = yn(e)), n && (s = Ct(t, Mn(n))); ++o < a; )
    for (var l = 0, u = e[o], f = n ? n(u) : u; (l = i(s, f, l, r)) > -1; )
      s !== t && lp.call(s, l, 1), lp.call(t, l, 1);
  return t;
}
function km(t, e) {
  return t && t.length && e && e.length ? ad(t, e) : t;
}
var VM = Ve(km);
function KM(t, e, n) {
  return t && t.length && e && e.length ? ad(t, e, je(n)) : t;
}
function qM(t, e, n) {
  return t && t.length && e && e.length ? ad(t, e, void 0, n) : t;
}
var ZM = Array.prototype, JM = ZM.splice;
function Bm(t, e) {
  for (var n = t ? e.length : 0, r = n - 1; n--; ) {
    var i = e[n];
    if (n == r || i !== o) {
      var o = i;
      Br(i) ? JM.call(t, i, 1) : rd(t, i);
    }
  }
  return t;
}
var QM = zr(function(t, e) {
  var n = t == null ? 0 : t.length, r = Ac(t, e);
  return Bm(t, Ct(e, function(i) {
    return Br(i, n) ? +i : i;
  }).sort(Nm)), r;
}), eP = Math.floor, tP = Math.random;
function sd(t, e) {
  return t + eP(tP() * (e - t + 1));
}
var nP = parseFloat, rP = Math.min, iP = Math.random;
function oP(t, e, n) {
  if (n && typeof n != "boolean" && an(t, e, n) && (e = n = void 0), n === void 0 && (typeof e == "boolean" ? (n = e, e = void 0) : typeof t == "boolean" && (n = t, t = void 0)), t === void 0 && e === void 0 ? (t = 0, e = 1) : (t = jr(t), e === void 0 ? (e = t, t = 0) : e = jr(e)), t > e) {
    var r = t;
    t = e, e = r;
  }
  if (n || t % 1 || e % 1) {
    var i = iP();
    return rP(t + i * (e - t + nP("1e-" + ((i + "").length - 1))), e);
  }
  return sd(t, e);
}
var aP = Math.ceil, sP = Math.max;
function lP(t, e, n, r) {
  for (var i = -1, o = sP(aP((e - t) / (n || 1)), 0), a = Array(o); o--; )
    a[r ? o : ++i] = t, t += n;
  return a;
}
function Fm(t) {
  return function(e, n, r) {
    return r && typeof r != "number" && an(e, n, r) && (n = r = void 0), e = jr(e), n === void 0 ? (n = e, e = 0) : n = jr(n), r = r === void 0 ? e < n ? 1 : -1 : jr(r), lP(e, n, r, t);
  };
}
var uP = Fm(), fP = Fm(!0), cP = 256, dP = zr(function(t, e) {
  return Fr(t, cP, void 0, void 0, void 0, e);
});
function $m(t, e, n, r, i) {
  return i(t, function(o, a, s) {
    n = r ? (r = !1, o) : e(n, o, a, s);
  }), n;
}
function Hm(t, e, n) {
  var r = Ie(t) ? Mc : $m, i = arguments.length < 3;
  return r(t, je(e), n, i, hi);
}
function hP(t, e, n, r) {
  var i = t == null ? 0 : t.length;
  for (r && i && (n = t[--i]); i--; )
    n = e(n, t[i], i, t);
  return n;
}
function pP(t, e, n) {
  var r = Ie(t) ? hP : $m, i = arguments.length < 3;
  return r(t, je(e), n, i, im);
}
function vP(t, e) {
  var n = Ie(t) ? di : cm;
  return n(t, eu(je(e)));
}
function gP(t, e) {
  var n = [];
  if (!(t && t.length))
    return n;
  var r = -1, i = [], o = t.length;
  for (e = je(e); ++r < o; ) {
    var a = t[r];
    e(a, r, t) && (n.push(a), i.push(r));
  }
  return Bm(t, i), n;
}
function yP(t, e, n) {
  return (n ? an(t, e, n) : e === void 0) ? e = 1 : e = We(e), pf(pt(t), e);
}
function mP() {
  var t = arguments, e = pt(t[0]);
  return t.length < 3 ? e : e.replace(t[1], t[2]);
}
var _P = "Expected a function";
function bP(t, e) {
  if (typeof t != "function")
    throw new TypeError(_P);
  return e = e === void 0 ? e : We(e), Ve(t, e);
}
function xP(t, e, n) {
  e = ui(e, t);
  var r = -1, i = e.length;
  for (i || (i = 1, t = void 0); ++r < i; ) {
    var o = t == null ? void 0 : t[Nr(e[r])];
    o === void 0 && (r = i, o = n), t = kr(o) ? o.call(t) : o;
  }
  return t;
}
var EP = Array.prototype, wP = EP.reverse;
function yf(t) {
  return t == null ? t : wP.call(t);
}
var SP = Dc("round");
function Wm(t) {
  var e = t.length;
  return e ? t[sd(0, e - 1)] : void 0;
}
function OP(t) {
  return Wm(Bo(t));
}
function AP(t) {
  var e = Ie(t) ? Wm : OP;
  return e(t);
}
function nu(t, e) {
  var n = -1, r = t.length, i = r - 1;
  for (e = e === void 0 ? r : e; ++n < e; ) {
    var o = sd(n, i), a = t[o];
    t[o] = t[n], t[n] = a;
  }
  return t.length = e, t;
}
function CP(t, e) {
  return nu(yn(t), Wi(e, 0, t.length));
}
function TP(t, e) {
  var n = Bo(t);
  return nu(n, Wi(e, 0, n.length));
}
function NP(t, e, n) {
  (n ? an(t, e, n) : e === void 0) ? e = 1 : e = We(e);
  var r = Ie(t) ? CP : TP;
  return r(t, e);
}
function zm(t, e, n) {
  return t == null ? t : Va(t, e, n);
}
function MP(t, e, n, r) {
  return r = typeof r == "function" ? r : void 0, t == null ? t : Va(t, e, n, r);
}
function PP(t) {
  return nu(yn(t));
}
function DP(t) {
  return nu(Bo(t));
}
function RP(t) {
  var e = Ie(t) ? PP : DP;
  return e(t);
}
var LP = "[object Map]", IP = "[object Set]";
function jP(t) {
  if (t == null)
    return 0;
  if (bn(t))
    return Jl(t) ? Fo(t) : t.length;
  var e = Qt(t);
  return e == LP || e == IP ? t.size : Sc(t).length;
}
function kP(t, e, n) {
  var r = t == null ? 0 : t.length;
  return r ? (n && typeof n != "number" && an(t, e, n) ? (e = 0, n = r) : (e = e == null ? 0 : We(e), n = n === void 0 ? r : We(n)), Yn(t, e, n)) : [];
}
var BP = ko(function(t, e, n) {
  return t + (n ? "_" : "") + e.toLowerCase();
});
function FP(t, e) {
  var n;
  return hi(t, function(r, i, o) {
    return n = e(r, i, o), !n;
  }), !!n;
}
function $P(t, e, n) {
  var r = Ie(t) ? kc : FP;
  return n && an(t, e, n) && (e = void 0), r(t, je(e));
}
var HP = Ve(function(t, e) {
  if (t == null)
    return [];
  var n = e.length;
  return n > 1 && an(t, e[0], e[1]) ? e = [] : n > 2 && an(e[0], e[1], e[2]) && (e = [e[0]]), Mm(t, Kt(e, 1), []);
}), WP = 4294967295, zP = WP - 1, XP = Math.floor, GP = Math.min;
function ld(t, e, n, r) {
  var i = 0, o = t == null ? 0 : t.length;
  if (o === 0)
    return 0;
  e = n(e);
  for (var a = e !== e, s = e === null, l = Cn(e), u = e === void 0; i < o; ) {
    var f = XP((i + o) / 2), c = n(t[f]), d = c !== void 0, h = c === null, v = c === c, p = Cn(c);
    if (a)
      var g = r || v;
    else u ? g = v && (r || d) : s ? g = v && d && (r || !h) : l ? g = v && d && !h && (r || !p) : h || p ? g = !1 : g = r ? c <= e : c < e;
    g ? i = f + 1 : o = f;
  }
  return GP(o, zP);
}
var UP = 4294967295, YP = UP >>> 1;
function ru(t, e, n) {
  var r = 0, i = t == null ? r : t.length;
  if (typeof e == "number" && e === e && i <= YP) {
    for (; r < i; ) {
      var o = r + i >>> 1, a = t[o];
      a !== null && !Cn(a) && (n ? a <= e : a < e) ? r = o + 1 : i = o;
    }
    return i;
  }
  return ld(t, e, _n, n);
}
function VP(t, e) {
  return ru(t, e);
}
function KP(t, e, n) {
  return ld(t, e, je(n));
}
function qP(t, e) {
  var n = t == null ? 0 : t.length;
  if (n) {
    var r = ru(t, e);
    if (r < n && gr(t[r], e))
      return r;
  }
  return -1;
}
function ZP(t, e) {
  return ru(t, e, !0);
}
function JP(t, e, n) {
  return ld(t, e, je(n), !0);
}
function QP(t, e) {
  var n = t == null ? 0 : t.length;
  if (n) {
    var r = ru(t, e, !0) - 1;
    if (gr(t[r], e))
      return r;
  }
  return -1;
}
function Xm(t, e) {
  for (var n = -1, r = t.length, i = 0, o = []; ++n < r; ) {
    var a = t[n], s = e ? e(a) : a;
    if (!n || !gr(s, l)) {
      var l = s;
      o[i++] = a === 0 ? 0 : a;
    }
  }
  return o;
}
function eD(t) {
  return t && t.length ? Xm(t) : [];
}
function tD(t, e) {
  return t && t.length ? Xm(t, je(e)) : [];
}
var nD = 4294967295;
function rD(t, e, n) {
  return n && typeof n != "number" && an(t, e, n) && (e = n = void 0), n = n === void 0 ? nD : n >>> 0, n ? (t = pt(t), t && (typeof e == "string" || e != null && !ed(e)) && (e = Tn(e), !e && jo(t)) ? ci(hr(t), 0, n) : t.split(e, n)) : [];
}
var iD = "Expected a function", oD = Math.max;
function aD(t, e) {
  if (typeof t != "function")
    throw new TypeError(iD);
  return e = e == null ? 0 : oD(We(e), 0), Ve(function(n) {
    var r = n[e], i = ci(n, 0, e);
    return r && fi(i, r), Nn(t, this, i);
  });
}
var sD = ko(function(t, e, n) {
  return t + (n ? " " : "") + Nc(e);
});
function lD(t, e, n) {
  return t = pt(t), n = n == null ? 0 : Wi(We(n), 0, t.length), e = Tn(e), t.slice(n, n + e.length) == e;
}
function uD() {
  return {};
}
function fD() {
  return "";
}
function cD() {
  return !0;
}
var dD = Ll(function(t, e) {
  return t - e;
}, 0);
function hD(t) {
  return t && t.length ? nd(t, _n) : 0;
}
function pD(t, e) {
  return t && t.length ? nd(t, je(e)) : 0;
}
function vD(t) {
  var e = t == null ? 0 : t.length;
  return e ? Yn(t, 1, e) : [];
}
function gD(t, e, n) {
  return t && t.length ? (e = n || e === void 0 ? 1 : We(e), Yn(t, 0, e < 0 ? 0 : e)) : [];
}
function yD(t, e, n) {
  var r = t == null ? 0 : t.length;
  return r ? (e = n || e === void 0 ? 1 : We(e), e = r - e, Yn(t, e < 0 ? 0 : e, r)) : [];
}
function mD(t, e) {
  return t && t.length ? Kl(t, je(e), !1, !0) : [];
}
function _D(t, e) {
  return t && t.length ? Kl(t, je(e)) : [];
}
function bD(t, e) {
  return e(t), t;
}
var Gm = Object.prototype, xD = Gm.hasOwnProperty;
function up(t, e, n, r) {
  return t === void 0 || gr(t, Gm[n]) && !xD.call(r, n) ? e : t;
}
var ED = {
  "\\": "\\",
  "'": "'",
  "\n": "n",
  "\r": "r",
  "\u2028": "u2028",
  "\u2029": "u2029"
};
function wD(t) {
  return "\\" + ED[t];
}
var Um = /<%=([\s\S]+?)%>/g, SD = /<%-([\s\S]+?)%>/g, OD = /<%([\s\S]+?)%>/g, mf = {
  /**
   * Used to detect `data` property values to be HTML-escaped.
   *
   * @memberOf _.templateSettings
   * @type {RegExp}
   */
  escape: SD,
  /**
   * Used to detect code to be evaluated.
   *
   * @memberOf _.templateSettings
   * @type {RegExp}
   */
  evaluate: OD,
  /**
   * Used to detect `data` property values to inject.
   *
   * @memberOf _.templateSettings
   * @type {RegExp}
   */
  interpolate: Um,
  /**
   * Used to reference the data object in the template text.
   *
   * @memberOf _.templateSettings
   * @type {string}
   */
  variable: "",
  /**
   * Used to import variables into the compiled template.
   *
   * @memberOf _.templateSettings
   * @type {Object}
   */
  imports: {
    /**
     * A reference to the `lodash` function.
     *
     * @memberOf _.templateSettings.imports
     * @type {Function}
     */
    _: { escape: sm }
  }
}, AD = "Invalid `variable` option passed into `_.template`", CD = /\b__p \+= '';/g, TD = /\b(__p \+=) '' \+/g, ND = /(__e\(.*?\)|\b__t\)) \+\n'';/g, MD = /[()=,{}\[\]\/\s]/, PD = /\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g, rs = /($^)/, DD = /['\n\r\u2028\u2029\\]/g, RD = Object.prototype, fp = RD.hasOwnProperty;
function LD(t, e, n) {
  var r = mf.imports._.templateSettings || mf;
  n && an(t, e, n) && (e = void 0), t = pt(t), e = of({}, e, r, up);
  var i = of({}, e.imports, r.imports, up), o = $t(i), a = qc(i, o), s, l, u = 0, f = e.interpolate || rs, c = "__p += '", d = RegExp(
    (e.escape || rs).source + "|" + f.source + "|" + (f === Um ? PD : rs).source + "|" + (e.evaluate || rs).source + "|$",
    "g"
  ), h = fp.call(e, "sourceURL") ? "//# sourceURL=" + (e.sourceURL + "").replace(/\s/g, " ") + `
` : "";
  t.replace(d, function(g, y, m, A, T, k) {
    return m || (m = A), c += t.slice(u, k).replace(DD, wD), y && (s = !0, c += `' +
__e(` + y + `) +
'`), T && (l = !0, c += `';
` + T + `;
__p += '`), m && (c += `' +
((__t = (` + m + `)) == null ? '' : __t) +
'`), u = k + g.length, g;
  }), c += `';
`;
  var v = fp.call(e, "variable") && e.variable;
  if (!v)
    c = `with (obj) {
` + c + `
}
`;
  else if (MD.test(v))
    throw new Error(AD);
  c = (l ? c.replace(CD, "") : c).replace(TD, "$1").replace(ND, "$1;"), c = "function(" + (v || "obj") + `) {
` + (v ? "" : `obj || (obj = {});
`) + "var __t, __p = ''" + (s ? ", __e = _.escape" : "") + (l ? `, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
` : `;
`) + c + `return __p
}`;
  var p = iy(function() {
    return Function(o, h + "return " + c).apply(void 0, a);
  });
  if (p.source = c, Cc(p))
    throw p;
  return p;
}
var ID = "Expected a function";
function Ym(t, e, n) {
  var r = !0, i = !0;
  if (typeof t != "function")
    throw new TypeError(ID);
  return Tt(n) && (r = "leading" in n ? !!n.leading : r, i = "trailing" in n ? !!n.trailing : i), Yl(t, e, {
    leading: r,
    maxWait: e,
    trailing: i
  });
}
function iu(t, e) {
  return e(t);
}
var jD = 9007199254740991, wu = 4294967295, kD = Math.min;
function BD(t, e) {
  if (t = We(t), t < 1 || t > jD)
    return [];
  var n = wu, r = kD(t, wu);
  e = Pr(e), t -= wu;
  for (var i = Ec(r, e); ++n < t; )
    e(n);
  return i;
}
function FD() {
  return this;
}
function Vm(t, e) {
  var n = t;
  return n instanceof Je && (n = n.value()), Mc(e, function(r, i) {
    return i.func.apply(i.thisArg, fi([r], i.args));
  }, n);
}
function $D() {
  return Vm(this.__wrapped__, this.__actions__);
}
function HD(t) {
  return pt(t).toLowerCase();
}
function WD(t) {
  return Ie(t) ? Ct(t, Nr) : Cn(t) ? [t] : yn(ty(pt(t)));
}
var zD = 9007199254740991;
function XD(t) {
  return t ? Wi(We(t), -9007199254740991, zD) : t === 0 ? t : 0;
}
function GD(t) {
  return pt(t).toUpperCase();
}
function UD(t, e, n) {
  var r = Ie(t), i = r || oi(t) || Lo(t);
  if (e = je(e), n == null) {
    var o = t && t.constructor;
    i ? n = r ? new o() : [] : Tt(t) ? n = kr(o) ? Mo(zl(t)) : {} : n = {};
  }
  return (i ? Vn : Mr)(t, function(a, s, l) {
    return e(n, a, s, l);
  }), n;
}
function Km(t, e) {
  for (var n = t.length; n-- && Po(e, t[n], 0) > -1; )
    ;
  return n;
}
function qm(t, e) {
  for (var n = -1, r = t.length; ++n < r && Po(e, t[n], 0) > -1; )
    ;
  return n;
}
function YD(t, e, n) {
  if (t = pt(t), t && (n || e === void 0))
    return kg(t);
  if (!t || !(e = Tn(e)))
    return t;
  var r = hr(t), i = hr(e), o = qm(r, i), a = Km(r, i) + 1;
  return ci(r, o, a).join("");
}
function VD(t, e, n) {
  if (t = pt(t), t && (n || e === void 0))
    return t.slice(0, jg(t) + 1);
  if (!t || !(e = Tn(e)))
    return t;
  var r = hr(t), i = Km(r, hr(e)) + 1;
  return ci(r, 0, i).join("");
}
var KD = /^\s+/;
function qD(t, e, n) {
  if (t = pt(t), t && (n || e === void 0))
    return t.replace(KD, "");
  if (!t || !(e = Tn(e)))
    return t;
  var r = hr(t), i = qm(r, hr(e));
  return ci(r, i).join("");
}
var ZD = 30, JD = "...", QD = /\w*$/;
function e2(t, e) {
  var n = ZD, r = JD;
  if (Tt(e)) {
    var i = "separator" in e ? e.separator : i;
    n = "length" in e ? We(e.length) : n, r = "omission" in e ? Tn(e.omission) : r;
  }
  t = pt(t);
  var o = t.length;
  if (jo(t)) {
    var a = hr(t);
    o = a.length;
  }
  if (n >= o)
    return t;
  var s = n - Fo(r);
  if (s < 1)
    return r;
  var l = a ? ci(a, 0, s).join("") : t.slice(0, s);
  if (i === void 0)
    return l + r;
  if (a && (s += l.length - s), ed(i)) {
    if (t.slice(s).search(i)) {
      var u, f = l;
      for (i.global || (i = RegExp(i.source, pt(QD.exec(i)) + "g")), i.lastIndex = 0; u = i.exec(f); )
        var c = u.index;
      l = l.slice(0, c === void 0 ? s : c);
    }
  } else if (t.indexOf(Tn(i), s) != s) {
    var d = l.lastIndexOf(i);
    d > -1 && (l = l.slice(0, d));
  }
  return l + r;
}
function t2(t) {
  return Vg(t, 1);
}
var n2 = {
  "&amp;": "&",
  "&lt;": "<",
  "&gt;": ">",
  "&quot;": '"',
  "&#39;": "'"
}, r2 = Pc(n2), Zm = /&(?:amp|lt|gt|quot|#39);/g, i2 = RegExp(Zm.source);
function o2(t) {
  return t = pt(t), t && i2.test(t) ? t.replace(Zm, r2) : t;
}
var a2 = 1 / 0, s2 = uo && 1 / Gl(new uo([, -0]))[1] == a2 ? function(t) {
  return new uo(t);
} : so, l2 = 200;
function si(t, e, n) {
  var r = -1, i = kl, o = t.length, a = !0, s = [], l = s;
  if (n)
    a = !1, i = Uc;
  else if (o >= l2) {
    var u = e ? null : s2(t);
    if (u)
      return Gl(u);
    a = !1, i = Na, l = new Ii();
  } else
    l = e ? [] : s;
  e:
    for (; ++r < o; ) {
      var f = t[r], c = e ? e(f) : f;
      if (f = n || f !== 0 ? f : 0, a && c === c) {
        for (var d = l.length; d--; )
          if (l[d] === c)
            continue e;
        e && l.push(c), s.push(f);
      } else i(l, c, n) || (l !== s && l.push(c), s.push(f));
    }
  return s;
}
var u2 = Ve(function(t) {
  return si(Kt(t, 1, Dt, !0));
}), f2 = Ve(function(t) {
  var e = Pn(t);
  return Dt(e) && (e = void 0), si(Kt(t, 1, Dt, !0), je(e));
}), c2 = Ve(function(t) {
  var e = Pn(t);
  return e = typeof e == "function" ? e : void 0, si(Kt(t, 1, Dt, !0), void 0, e);
});
function d2(t) {
  return t && t.length ? si(t) : [];
}
function h2(t, e) {
  return t && t.length ? si(t, je(e)) : [];
}
function p2(t, e) {
  return e = typeof e == "function" ? e : void 0, t && t.length ? si(t, void 0, e) : [];
}
var v2 = 0;
function g2(t) {
  var e = ++v2;
  return pt(t) + e;
}
function y2(t, e) {
  return t == null ? !0 : rd(t, e);
}
var m2 = Math.max;
function ud(t) {
  if (!(t && t.length))
    return [];
  var e = 0;
  return t = di(t, function(n) {
    if (Dt(n))
      return e = m2(n.length, e), !0;
  }), Ec(e, function(n) {
    return Ct(t, Wc(n));
  });
}
function Jm(t, e) {
  if (!(t && t.length))
    return [];
  var n = ud(t);
  return e == null ? n : Ct(n, function(r) {
    return Nn(e, void 0, r);
  });
}
function Qm(t, e, n, r) {
  return Va(t, e, n(Hi(t, e)), r);
}
function _2(t, e, n) {
  return t == null ? t : Qm(t, e, Pr(n));
}
function b2(t, e, n, r) {
  return r = typeof r == "function" ? r : void 0, t == null ? t : Qm(t, e, Pr(n), r);
}
var x2 = ko(function(t, e, n) {
  return t + (n ? " " : "") + e.toUpperCase();
});
function E2(t) {
  return t == null ? [] : qc(t, xn(t));
}
var w2 = Ve(function(t, e) {
  return Dt(t) ? Ua(t, e) : [];
});
function S2(t, e) {
  return tu(Pr(e), t);
}
var O2 = zr(function(t) {
  var e = t.length, n = e ? t[0] : 0, r = this.__wrapped__, i = function(o) {
    return Ac(o, t);
  };
  return e > 1 || this.__actions__.length || !(r instanceof Je) || !Br(n) ? this.thru(i) : (r = r.slice(n, +n + (e ? 1 : 0)), r.__actions__.push({
    func: iu,
    args: [i],
    thisArg: void 0
  }), new Gn(r, this.__chain__).thru(function(o) {
    return e && !o.length && o.push(void 0), o;
  }));
});
function A2() {
  return Ny(this);
}
function C2() {
  var t = this.__wrapped__;
  if (t instanceof Je) {
    var e = t;
    return this.__actions__.length && (e = new Je(this)), e = e.reverse(), e.__actions__.push({
      func: iu,
      args: [yf],
      thisArg: void 0
    }), new Gn(e, this.__chain__);
  }
  return this.thru(yf);
}
function fd(t, e, n) {
  var r = t.length;
  if (r < 2)
    return r ? si(t[0]) : [];
  for (var i = -1, o = Array(r); ++i < r; )
    for (var a = t[i], s = -1; ++s < r; )
      s != i && (o[i] = Ua(o[i] || a, t[s], e, n));
  return si(Kt(o, 1), e, n);
}
var T2 = Ve(function(t) {
  return fd(di(t, Dt));
}), N2 = Ve(function(t) {
  var e = Pn(t);
  return Dt(e) && (e = void 0), fd(di(t, Dt), je(e));
}), M2 = Ve(function(t) {
  var e = Pn(t);
  return e = typeof e == "function" ? e : void 0, fd(di(t, Dt), void 0, e);
}), P2 = Ve(ud);
function e_(t, e, n) {
  for (var r = -1, i = t.length, o = e.length, a = {}; ++r < i; ) {
    var s = r < o ? e[r] : void 0;
    n(a, t[r], s);
  }
  return a;
}
function D2(t, e) {
  return e_(t || [], e || [], Wa);
}
function R2(t, e) {
  return e_(t || [], e || [], Va);
}
var L2 = Ve(function(t) {
  var e = t.length, n = e > 1 ? t[e - 1] : void 0;
  return n = typeof n == "function" ? (t.pop(), n) : void 0, Jm(t, n);
});
const fe = {
  chunk: _S,
  compact: QO,
  concat: eA,
  difference: oC,
  differenceBy: aC,
  differenceWith: sC,
  drop: uC,
  dropRight: fC,
  dropRightWhile: cC,
  dropWhile: dC,
  fill: MC,
  findIndex: Vc,
  findLastIndex: pm,
  flatten: ny,
  flattenDeep: XC,
  flattenDepth: GC,
  fromPairs: aT,
  head: BC,
  indexOf: ym,
  initial: OT,
  intersection: CT,
  intersectionBy: TT,
  intersectionWith: NT,
  join: bN,
  lastIndexOf: AN,
  nth: JN,
  pull: VM,
  pullAll: km,
  pullAllBy: KM,
  pullAllWith: qM,
  pullAt: QM,
  remove: gP,
  reverse: yf,
  slice: kP,
  sortedIndex: VP,
  sortedIndexBy: KP,
  sortedIndexOf: qP,
  sortedLastIndex: ZP,
  sortedLastIndexBy: JP,
  sortedLastIndexOf: QP,
  sortedUniq: eD,
  sortedUniqBy: tD,
  tail: vD,
  take: gD,
  takeRight: yD,
  takeRightWhile: mD,
  takeWhile: _D,
  union: u2,
  unionBy: f2,
  unionWith: c2,
  uniq: d2,
  uniqBy: h2,
  uniqWith: p2,
  unzip: ud,
  unzipWith: Jm,
  without: w2,
  xor: T2,
  xorBy: N2,
  xorWith: M2,
  zip: P2,
  zipObject: D2,
  zipObjectDeep: R2,
  zipWith: L2
}, mt = {
  countBy: zA,
  every: CC,
  filter: PC,
  find: ai,
  findLast: jC,
  flatMap: FC,
  flatMapDeep: HC,
  flatMapDepth: WC,
  forEach: at,
  forEachRight: pC,
  groupBy: cT,
  includes: wT,
  invokeMap: BT,
  keyBy: EN,
  map: Dn,
  orderBy: uM,
  partition: WM,
  reduce: Hm,
  reduceRight: pP,
  reject: vP,
  sample: AP,
  sampleSize: NP,
  shuffle: RP,
  size: jP,
  some: $P,
  sortBy: HP
}, I2 = {
  now: Ts
}, Mt = {
  after: rx,
  ary: Vg,
  before: oy,
  bind: Xl,
  bindKey: Tc,
  curry: Xc,
  curryRight: Gc,
  debounce: Yl,
  defer: nC,
  delay: rC,
  flip: YC,
  memoize: Wl,
  once: aM,
  overArgs: hM,
  partial: tu,
  partialRight: od,
  rearg: dP,
  rest: bP,
  spread: aD,
  throttle: Ym,
  unary: t2,
  wrap: S2
}, Se = {
  castArray: hS,
  clone: XO,
  cloneDeep: Fe,
  cloneDeepWith: KO,
  cloneWith: ZO,
  conformsTo: BA,
  eq: gr,
  gt: dT,
  gte: hT,
  isArguments: Ri,
  isArrayBuffer: HT,
  isArrayLike: bn,
  isArrayLikeObject: Dt,
  isBoolean: Ys,
  isBuffer: oi,
  isDate: GT,
  isElement: UT,
  isEmpty: Qc,
  isEqual: hf,
  isEqualWith: ZT,
  isError: Cc,
  isFinite: QT,
  isFunction: kr,
  isInteger: xm,
  isLength: Fl,
  isMap: ky,
  isMatch: eN,
  isMatchWith: tN,
  isNaN: rN,
  isNative: aN,
  isNil: Bn,
  isNull: sN,
  isNumber: Em,
  isObjectLike: Nt,
  isPlainObject: Xa,
  isRegExp: ed,
  isSafeInteger: cN,
  isSet: By,
  isString: Jl,
  isSymbol: Cn,
  isTypedArray: Lo,
  isUndefined: ji,
  isWeakMap: hN,
  isWeakSet: vN,
  lt: NN,
  lte: MN,
  toArray: Om,
  toFinite: jr,
  toLength: fm,
  toNumber: Hn,
  toPlainObject: Qy,
  toSafeInteger: XD,
  toString: pt
}, cn = {
  add: Yb,
  ceil: gS,
  divide: lC,
  floor: VC,
  max: jN,
  maxBy: kN,
  mean: FN,
  meanBy: $N,
  min: zN,
  minBy: XN,
  multiply: UN,
  round: SP,
  subtract: dD,
  sum: hD,
  sumBy: pD
}, cd = {
  clamp: bS,
  inRange: bT,
  random: oP
}, Re = {
  assign: ut,
  assignIn: cw,
  assignInWith: of,
  assignWith: dw,
  at: Gw,
  create: XA,
  defaults: JA,
  defaultsDeep: eC,
  findKey: RC,
  findLastKey: kC,
  forIn: nT,
  forInRight: rT,
  forOwn: iT,
  forOwnRight: oT,
  functions: sT,
  functionsIn: lT,
  get: Io,
  has: Us,
  hasIn: Hc,
  invert: RT,
  invertBy: jT,
  invoke: kT,
  keysIn: xn,
  mapKeys: wm,
  mapValues: PN,
  merge: mo,
  mergeWith: tm,
  omit: iM,
  omitBy: oM,
  pick: Ti,
  pickBy: Tm,
  result: xP,
  set: zm,
  setWith: MP,
  toPairs: Xr,
  toPairsIn: bC,
  transform: UD,
  unset: y2,
  update: _2,
  updateWith: b2,
  values: Bo,
  valuesIn: E2
}, Dr = {
  at: O2,
  chain: Ny,
  commit: JO,
  next: ZN,
  plant: XM,
  reverse: C2,
  tap: bD,
  toIterator: FD,
  value: $D,
  wrapperChain: A2
}, ft = {
  camelCase: dS,
  capitalize: hy,
  deburr: py,
  endsWith: vC,
  escape: sm,
  escapeRegExp: OC,
  kebabCase: xN,
  lowerCase: CN,
  lowerFirst: TN,
  pad: LM,
  padEnd: IM,
  padStart: jM,
  parseInt: FM,
  repeat: yP,
  replace: mP,
  snakeCase: BP,
  split: rD,
  startCase: sD,
  startsWith: lD,
  template: LD,
  templateSettings: mf,
  toLower: HD,
  toUpper: GD,
  trim: YD,
  trimEnd: VD,
  trimStart: qD,
  truncate: e2,
  unescape: o2,
  upperCase: x2,
  upperFirst: Nc,
  words: Ty
}, vt = {
  attempt: iy,
  bindAll: n1,
  cond: LA,
  conforms: kA,
  constant: bc,
  defaultTo: qA,
  flow: eT,
  flowRight: tT,
  iteratee: yN,
  matches: RN,
  matchesProperty: IN,
  method: HN,
  methodOf: WN,
  noop: so,
  nthArg: QN,
  over: fM,
  overEvery: pM,
  overSome: vM,
  property: Vy,
  propertyOf: GM,
  range: uP,
  rangeRight: fP,
  stubArray: Rc,
  stubFalse: wc,
  stubObject: uD,
  stubString: fD,
  stubTrue: cD,
  times: BD,
  toPath: WD,
  uniqueId: g2
};
function j2() {
  var t = new Je(this.__wrapped__);
  return t.__actions__ = yn(this.__actions__), t.__dir__ = this.__dir__, t.__filtered__ = this.__filtered__, t.__iteratees__ = yn(this.__iteratees__), t.__takeCount__ = this.__takeCount__, t.__views__ = yn(this.__views__), t;
}
function k2() {
  if (this.__filtered__) {
    var t = new Je(this);
    t.__dir__ = -1, t.__filtered__ = !0;
  } else
    t = this.clone(), t.__dir__ *= -1;
  return t;
}
var B2 = Math.max, F2 = Math.min;
function $2(t, e, n) {
  for (var r = -1, i = n.length; ++r < i; ) {
    var o = n[r], a = o.size;
    switch (o.type) {
      case "drop":
        t += a;
        break;
      case "dropRight":
        e -= a;
        break;
      case "take":
        e = F2(e, t + a);
        break;
      case "takeRight":
        t = B2(t, e - a);
        break;
    }
  }
  return { start: t, end: e };
}
var H2 = 1, W2 = 2, z2 = Math.min;
function X2() {
  var t = this.__wrapped__.value(), e = this.__dir__, n = Ie(t), r = e < 0, i = n ? t.length : 0, o = $2(0, i, this.__views__), a = o.start, s = o.end, l = s - a, u = r ? s : a - 1, f = this.__iteratees__, c = f.length, d = 0, h = z2(l, this.__takeCount__);
  if (!n || !r && i == l && h == l)
    return Vm(t, this.__actions__);
  var v = [];
  e:
    for (; l-- && d < h; ) {
      u += e;
      for (var p = -1, g = t[u]; ++p < c; ) {
        var y = f[p], m = y.iteratee, A = y.type, T = m(g);
        if (A == W2)
          g = T;
        else if (!T) {
          if (A == H2)
            continue e;
          break e;
        }
      }
      v[d++] = g;
    }
  return v;
}
/**
 * @license
 * Lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="es" -o ./`
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */
var G2 = "4.17.21", U2 = 2, Y2 = 1, V2 = 3, t_ = 4294967295, K2 = Array.prototype, q2 = Object.prototype, n_ = q2.hasOwnProperty, cp = tn ? tn.iterator : void 0, Z2 = Math.max, dp = Math.min, dd = /* @__PURE__ */ function(t) {
  return function(e, n, r) {
    if (r == null) {
      var i = Tt(n), o = i && $t(n), a = o && o.length && ql(n, o);
      (a ? a.length : i) || (r = n, n = e, e = this);
    }
    return t(e, n, r);
  };
}(GN);
_.after = Mt.after;
_.ary = Mt.ary;
_.assign = Re.assign;
_.assignIn = Re.assignIn;
_.assignInWith = Re.assignInWith;
_.assignWith = Re.assignWith;
_.at = Re.at;
_.before = Mt.before;
_.bind = Mt.bind;
_.bindAll = vt.bindAll;
_.bindKey = Mt.bindKey;
_.castArray = Se.castArray;
_.chain = Dr.chain;
_.chunk = fe.chunk;
_.compact = fe.compact;
_.concat = fe.concat;
_.cond = vt.cond;
_.conforms = vt.conforms;
_.constant = vt.constant;
_.countBy = mt.countBy;
_.create = Re.create;
_.curry = Mt.curry;
_.curryRight = Mt.curryRight;
_.debounce = Mt.debounce;
_.defaults = Re.defaults;
_.defaultsDeep = Re.defaultsDeep;
_.defer = Mt.defer;
_.delay = Mt.delay;
_.difference = fe.difference;
_.differenceBy = fe.differenceBy;
_.differenceWith = fe.differenceWith;
_.drop = fe.drop;
_.dropRight = fe.dropRight;
_.dropRightWhile = fe.dropRightWhile;
_.dropWhile = fe.dropWhile;
_.fill = fe.fill;
_.filter = mt.filter;
_.flatMap = mt.flatMap;
_.flatMapDeep = mt.flatMapDeep;
_.flatMapDepth = mt.flatMapDepth;
_.flatten = fe.flatten;
_.flattenDeep = fe.flattenDeep;
_.flattenDepth = fe.flattenDepth;
_.flip = Mt.flip;
_.flow = vt.flow;
_.flowRight = vt.flowRight;
_.fromPairs = fe.fromPairs;
_.functions = Re.functions;
_.functionsIn = Re.functionsIn;
_.groupBy = mt.groupBy;
_.initial = fe.initial;
_.intersection = fe.intersection;
_.intersectionBy = fe.intersectionBy;
_.intersectionWith = fe.intersectionWith;
_.invert = Re.invert;
_.invertBy = Re.invertBy;
_.invokeMap = mt.invokeMap;
_.iteratee = vt.iteratee;
_.keyBy = mt.keyBy;
_.keys = $t;
_.keysIn = Re.keysIn;
_.map = mt.map;
_.mapKeys = Re.mapKeys;
_.mapValues = Re.mapValues;
_.matches = vt.matches;
_.matchesProperty = vt.matchesProperty;
_.memoize = Mt.memoize;
_.merge = Re.merge;
_.mergeWith = Re.mergeWith;
_.method = vt.method;
_.methodOf = vt.methodOf;
_.mixin = dd;
_.negate = eu;
_.nthArg = vt.nthArg;
_.omit = Re.omit;
_.omitBy = Re.omitBy;
_.once = Mt.once;
_.orderBy = mt.orderBy;
_.over = vt.over;
_.overArgs = Mt.overArgs;
_.overEvery = vt.overEvery;
_.overSome = vt.overSome;
_.partial = Mt.partial;
_.partialRight = Mt.partialRight;
_.partition = mt.partition;
_.pick = Re.pick;
_.pickBy = Re.pickBy;
_.property = vt.property;
_.propertyOf = vt.propertyOf;
_.pull = fe.pull;
_.pullAll = fe.pullAll;
_.pullAllBy = fe.pullAllBy;
_.pullAllWith = fe.pullAllWith;
_.pullAt = fe.pullAt;
_.range = vt.range;
_.rangeRight = vt.rangeRight;
_.rearg = Mt.rearg;
_.reject = mt.reject;
_.remove = fe.remove;
_.rest = Mt.rest;
_.reverse = fe.reverse;
_.sampleSize = mt.sampleSize;
_.set = Re.set;
_.setWith = Re.setWith;
_.shuffle = mt.shuffle;
_.slice = fe.slice;
_.sortBy = mt.sortBy;
_.sortedUniq = fe.sortedUniq;
_.sortedUniqBy = fe.sortedUniqBy;
_.split = ft.split;
_.spread = Mt.spread;
_.tail = fe.tail;
_.take = fe.take;
_.takeRight = fe.takeRight;
_.takeRightWhile = fe.takeRightWhile;
_.takeWhile = fe.takeWhile;
_.tap = Dr.tap;
_.throttle = Mt.throttle;
_.thru = iu;
_.toArray = Se.toArray;
_.toPairs = Re.toPairs;
_.toPairsIn = Re.toPairsIn;
_.toPath = vt.toPath;
_.toPlainObject = Se.toPlainObject;
_.transform = Re.transform;
_.unary = Mt.unary;
_.union = fe.union;
_.unionBy = fe.unionBy;
_.unionWith = fe.unionWith;
_.uniq = fe.uniq;
_.uniqBy = fe.uniqBy;
_.uniqWith = fe.uniqWith;
_.unset = Re.unset;
_.unzip = fe.unzip;
_.unzipWith = fe.unzipWith;
_.update = Re.update;
_.updateWith = Re.updateWith;
_.values = Re.values;
_.valuesIn = Re.valuesIn;
_.without = fe.without;
_.words = ft.words;
_.wrap = Mt.wrap;
_.xor = fe.xor;
_.xorBy = fe.xorBy;
_.xorWith = fe.xorWith;
_.zip = fe.zip;
_.zipObject = fe.zipObject;
_.zipObjectDeep = fe.zipObjectDeep;
_.zipWith = fe.zipWith;
_.entries = Re.toPairs;
_.entriesIn = Re.toPairsIn;
_.extend = Re.assignIn;
_.extendWith = Re.assignInWith;
dd(_, _);
_.add = cn.add;
_.attempt = vt.attempt;
_.camelCase = ft.camelCase;
_.capitalize = ft.capitalize;
_.ceil = cn.ceil;
_.clamp = cd.clamp;
_.clone = Se.clone;
_.cloneDeep = Se.cloneDeep;
_.cloneDeepWith = Se.cloneDeepWith;
_.cloneWith = Se.cloneWith;
_.conformsTo = Se.conformsTo;
_.deburr = ft.deburr;
_.defaultTo = vt.defaultTo;
_.divide = cn.divide;
_.endsWith = ft.endsWith;
_.eq = Se.eq;
_.escape = ft.escape;
_.escapeRegExp = ft.escapeRegExp;
_.every = mt.every;
_.find = mt.find;
_.findIndex = fe.findIndex;
_.findKey = Re.findKey;
_.findLast = mt.findLast;
_.findLastIndex = fe.findLastIndex;
_.findLastKey = Re.findLastKey;
_.floor = cn.floor;
_.forEach = mt.forEach;
_.forEachRight = mt.forEachRight;
_.forIn = Re.forIn;
_.forInRight = Re.forInRight;
_.forOwn = Re.forOwn;
_.forOwnRight = Re.forOwnRight;
_.get = Re.get;
_.gt = Se.gt;
_.gte = Se.gte;
_.has = Re.has;
_.hasIn = Re.hasIn;
_.head = fe.head;
_.identity = _n;
_.includes = mt.includes;
_.indexOf = fe.indexOf;
_.inRange = cd.inRange;
_.invoke = Re.invoke;
_.isArguments = Se.isArguments;
_.isArray = Ie;
_.isArrayBuffer = Se.isArrayBuffer;
_.isArrayLike = Se.isArrayLike;
_.isArrayLikeObject = Se.isArrayLikeObject;
_.isBoolean = Se.isBoolean;
_.isBuffer = Se.isBuffer;
_.isDate = Se.isDate;
_.isElement = Se.isElement;
_.isEmpty = Se.isEmpty;
_.isEqual = Se.isEqual;
_.isEqualWith = Se.isEqualWith;
_.isError = Se.isError;
_.isFinite = Se.isFinite;
_.isFunction = Se.isFunction;
_.isInteger = Se.isInteger;
_.isLength = Se.isLength;
_.isMap = Se.isMap;
_.isMatch = Se.isMatch;
_.isMatchWith = Se.isMatchWith;
_.isNaN = Se.isNaN;
_.isNative = Se.isNative;
_.isNil = Se.isNil;
_.isNull = Se.isNull;
_.isNumber = Se.isNumber;
_.isObject = Tt;
_.isObjectLike = Se.isObjectLike;
_.isPlainObject = Se.isPlainObject;
_.isRegExp = Se.isRegExp;
_.isSafeInteger = Se.isSafeInteger;
_.isSet = Se.isSet;
_.isString = Se.isString;
_.isSymbol = Se.isSymbol;
_.isTypedArray = Se.isTypedArray;
_.isUndefined = Se.isUndefined;
_.isWeakMap = Se.isWeakMap;
_.isWeakSet = Se.isWeakSet;
_.join = fe.join;
_.kebabCase = ft.kebabCase;
_.last = Pn;
_.lastIndexOf = fe.lastIndexOf;
_.lowerCase = ft.lowerCase;
_.lowerFirst = ft.lowerFirst;
_.lt = Se.lt;
_.lte = Se.lte;
_.max = cn.max;
_.maxBy = cn.maxBy;
_.mean = cn.mean;
_.meanBy = cn.meanBy;
_.min = cn.min;
_.minBy = cn.minBy;
_.stubArray = vt.stubArray;
_.stubFalse = vt.stubFalse;
_.stubObject = vt.stubObject;
_.stubString = vt.stubString;
_.stubTrue = vt.stubTrue;
_.multiply = cn.multiply;
_.nth = fe.nth;
_.noop = vt.noop;
_.now = I2.now;
_.pad = ft.pad;
_.padEnd = ft.padEnd;
_.padStart = ft.padStart;
_.parseInt = ft.parseInt;
_.random = cd.random;
_.reduce = mt.reduce;
_.reduceRight = mt.reduceRight;
_.repeat = ft.repeat;
_.replace = ft.replace;
_.result = Re.result;
_.round = cn.round;
_.sample = mt.sample;
_.size = mt.size;
_.snakeCase = ft.snakeCase;
_.some = mt.some;
_.sortedIndex = fe.sortedIndex;
_.sortedIndexBy = fe.sortedIndexBy;
_.sortedIndexOf = fe.sortedIndexOf;
_.sortedLastIndex = fe.sortedLastIndex;
_.sortedLastIndexBy = fe.sortedLastIndexBy;
_.sortedLastIndexOf = fe.sortedLastIndexOf;
_.startCase = ft.startCase;
_.startsWith = ft.startsWith;
_.subtract = cn.subtract;
_.sum = cn.sum;
_.sumBy = cn.sumBy;
_.template = ft.template;
_.times = vt.times;
_.toFinite = Se.toFinite;
_.toInteger = We;
_.toLength = Se.toLength;
_.toLower = ft.toLower;
_.toNumber = Se.toNumber;
_.toSafeInteger = Se.toSafeInteger;
_.toString = Se.toString;
_.toUpper = ft.toUpper;
_.trim = ft.trim;
_.trimEnd = ft.trimEnd;
_.trimStart = ft.trimStart;
_.truncate = ft.truncate;
_.unescape = ft.unescape;
_.uniqueId = vt.uniqueId;
_.upperCase = ft.upperCase;
_.upperFirst = ft.upperFirst;
_.each = mt.forEach;
_.eachRight = mt.forEachRight;
_.first = fe.head;
dd(_, function() {
  var t = {};
  return Mr(_, function(e, n) {
    n_.call(_.prototype, n) || (t[n] = e);
  }), t;
}(), { chain: !1 });
_.VERSION = G2;
(_.templateSettings = ft.templateSettings).imports._ = _;
Vn(["bind", "bindKey", "curry", "curryRight", "partial", "partialRight"], function(t) {
  _[t].placeholder = _;
});
Vn(["drop", "take"], function(t, e) {
  Je.prototype[t] = function(n) {
    n = n === void 0 ? 1 : Z2(We(n), 0);
    var r = this.__filtered__ && !e ? new Je(this) : this.clone();
    return r.__filtered__ ? r.__takeCount__ = dp(n, r.__takeCount__) : r.__views__.push({
      size: dp(n, t_),
      type: t + (r.__dir__ < 0 ? "Right" : "")
    }), r;
  }, Je.prototype[t + "Right"] = function(n) {
    return this.reverse()[t](n).reverse();
  };
});
Vn(["filter", "map", "takeWhile"], function(t, e) {
  var n = e + 1, r = n == Y2 || n == V2;
  Je.prototype[t] = function(i) {
    var o = this.clone();
    return o.__iteratees__.push({
      iteratee: je(i),
      type: n
    }), o.__filtered__ = o.__filtered__ || r, o;
  };
});
Vn(["head", "last"], function(t, e) {
  var n = "take" + (e ? "Right" : "");
  Je.prototype[t] = function() {
    return this[n](1).value()[0];
  };
});
Vn(["initial", "tail"], function(t, e) {
  var n = "drop" + (e ? "" : "Right");
  Je.prototype[t] = function() {
    return this.__filtered__ ? new Je(this) : this[n](1);
  };
});
Je.prototype.compact = function() {
  return this.filter(_n);
};
Je.prototype.find = function(t) {
  return this.filter(t).head();
};
Je.prototype.findLast = function(t) {
  return this.reverse().find(t);
};
Je.prototype.invokeMap = Ve(function(t, e) {
  return typeof t == "function" ? new Je(this) : this.map(function(n) {
    return Ya(n, t, e);
  });
});
Je.prototype.reject = function(t) {
  return this.filter(eu(je(t)));
};
Je.prototype.slice = function(t, e) {
  t = We(t);
  var n = this;
  return n.__filtered__ && (t > 0 || e < 0) ? new Je(n) : (t < 0 ? n = n.takeRight(-t) : t && (n = n.drop(t)), e !== void 0 && (e = We(e), n = e < 0 ? n.dropRight(-e) : n.take(e - t)), n);
};
Je.prototype.takeRightWhile = function(t) {
  return this.reverse().takeWhile(t).reverse();
};
Je.prototype.toArray = function() {
  return this.take(t_);
};
Mr(Je.prototype, function(t, e) {
  var n = /^(?:filter|find|map|reject)|While$/.test(e), r = /^(?:head|last)$/.test(e), i = _[r ? "take" + (e == "last" ? "Right" : "") : e], o = r || /^find/.test(e);
  i && (_.prototype[e] = function() {
    var a = this.__wrapped__, s = r ? [1] : arguments, l = a instanceof Je, u = s[0], f = l || Ie(a), c = function(y) {
      var m = i.apply(_, fi([y], s));
      return r && d ? m[0] : m;
    };
    f && n && typeof u == "function" && u.length != 1 && (l = f = !1);
    var d = this.__chain__, h = !!this.__actions__.length, v = o && !d, p = l && !h;
    if (!o && f) {
      a = p ? a : new Je(this);
      var g = t.apply(a, s);
      return g.__actions__.push({ func: iu, args: [c], thisArg: void 0 }), new Gn(g, d);
    }
    return v && p ? t.apply(this, s) : (g = this.thru(c), v ? r ? g.value()[0] : g.value() : g);
  });
});
Vn(["pop", "push", "shift", "sort", "splice", "unshift"], function(t) {
  var e = K2[t], n = /^(?:push|sort|unshift)$/.test(t) ? "tap" : "thru", r = /^(?:pop|shift)$/.test(t);
  _.prototype[t] = function() {
    var i = arguments;
    if (r && !this.__chain__) {
      var o = this.value();
      return e.apply(Ie(o) ? o : [], i);
    }
    return this[n](function(a) {
      return e.apply(Ie(a) ? a : [], i);
    });
  };
});
Mr(Je.prototype, function(t, e) {
  var n = _[e];
  if (n) {
    var r = n.name + "";
    n_.call(lo, r) || (lo[r] = []), lo[r].push({ name: e, func: n });
  }
});
lo[Bl(void 0, U2).name] = [{
  name: "wrapper",
  func: void 0
}];
Je.prototype.clone = j2;
Je.prototype.reverse = k2;
Je.prototype.value = X2;
_.prototype.at = Dr.at;
_.prototype.chain = Dr.wrapperChain;
_.prototype.commit = Dr.commit;
_.prototype.next = Dr.next;
_.prototype.plant = Dr.plant;
_.prototype.reverse = Dr.reverse;
_.prototype.toJSON = _.prototype.valueOf = _.prototype.value = Dr.value;
_.prototype.first = _.prototype.head;
cp && (_.prototype[cp] = Dr.toIterator);
var J2 = function(t, e) {
  var n = {};
  for (var r in t) Object.prototype.hasOwnProperty.call(t, r) && e.indexOf(r) < 0 && (n[r] = t[r]);
  if (t != null && typeof Object.getOwnPropertySymbols == "function")
    for (var i = 0, r = Object.getOwnPropertySymbols(t); i < r.length; i++)
      e.indexOf(r[i]) < 0 && Object.prototype.propertyIsEnumerable.call(t, r[i]) && (n[r[i]] = t[r[i]]);
  return n;
}, Ma;
(function(t) {
  function e(n) {
    var r = J2(n, []), i = n.container;
    if (!i)
      throw new Error("Ensure the container of LogicFlow is specified and valid.");
    return ut({}, t.defaults, r);
  }
  t.get = e;
})(Ma || (Ma = {}));
(function(t) {
  t.defaults = {
    background: !1,
    grid: !1,
    textEdit: !0,
    snapline: !0,
    outline: !1,
    disabledTools: []
  };
})(Ma || (Ma = {}));
var hp = {
  node: !1,
  edge: !1
}, Q2 = {
  node: !0,
  edge: !0
}, eR = function(t) {
  return !t || typeof t == "boolean" ? Fe(t === !0 ? Q2 : hp) : mo(Fe(hp), t);
}, tR = function() {
  return Io(window, "navigator.userAgent", "").match(/MSIE|Trident/) !== null;
};
function en(t) {
  try {
    return JSON.parse(JSON.stringify(t));
  } catch {
    return t;
  }
}
var pp = 200, nR = 9999, rR = 10, Qe;
(function(t) {
  t[t.DEFAULT = 1] = "DEFAULT", t[t.TEXT_EDIT = 2] = "TEXT_EDIT", t[t.SHOW_MENU = 3] = "SHOW_MENU", t[t.ALLOW_CONNECT = 4] = "ALLOW_CONNECT", t[t.NOT_ALLOW_CONNECT = 5] = "NOT_ALLOW_CONNECT";
})(Qe || (Qe = {}));
var At;
(function(t) {
  t.NODE = "node", t.EDGE = "edge", t.GRAPH = "graph";
})(At || (At = {}));
var $e;
(function(t) {
  t.NODE = "node", t.CIRCLE_NODE = "circle-node", t.POLYGON_NODE = "polygon-node", t.RECT_NODE = "rect-node", t.TEXT_NODE = "text-node", t.ELLIPSE_NODE = "ellipse-node", t.DIAMOND_NODE = "diamond-node", t.HTML_NODE = "html-node", t.CUSTOM_HTML_NODE = "custom-html-node", t.EDGE = "edge", t.LINE_EDGE = "line-edge", t.POLYLINE_EDGE = "polyline-edge", t.BEZIER_EDGE = "bezier-edge", t.GRAPH = "graph";
})($e || ($e = {}));
var pe;
(function(t) {
  t.ELEMENT_CLICK = "element:click", t.NODE_ADD = "node:add", t.NODE_DELETE = "node:delete", t.NODE_CLICK = "node:click", t.NODE_DBCLICK = "node:dbclick", t.NODE_GROUP_COPY = "node:group-copy-add", t.NODE_DND_ADD = "node:dnd-add", t.NODE_DND_DRAG = "node:dnd-drag", t.NODE_MOUSEDOWN = "node:mousedown", t.NODE_DRAGSTART = "node:dragstart", t.NODE_DRAG = "node:drag", t.NODE_DROP = "node:drop", t.NODE_MOUSEUP = "node:mouseup", t.NODE_MOUSEMOVE = "node:mousemove", t.NODE_MOUSEENTER = "node:mouseenter", t.NODE_MOUSELEAVE = "node:mouseleave", t.NODE_CONTEXTMENU = "node:contextmenu", t.NODE_ROTATE = "node:rotate", t.NODE_RESIZE = "node:resize", t.NODE_FOCUS = "node:focus", t.NODE_BLUR = "node:blur", t.NODE_PROPERTIES_CHANGE = "node:properties-change", t.NODE_PROPERTIES_DELETE = "node:properties-delete", t.EDGE_ADD = "edge:add", t.EDGE_DELETE = "edge:delete", t.EDGE_CLICK = "edge:click", t.EDGE_DBCLICK = "edge:dbclick", t.EDGE_FOCUS = "edge:focus", t.EDGE_BLUR = "edge:blur", t.EDGE_MOUSEENTER = "edge:mouseenter", t.EDGE_MOUSELEAVE = "edge:mouseleave", t.EDGE_CONTEXTMENU = "edge:contextmenu", t.EDGE_ADJUST = "edge:adjust", t.EDGE_EXCHANGE_NODE = "edge:exchange-node", t.ANCHOR_DRAGSTART = "anchor:dragstart", t.ANCHOR_DRAG = "anchor:drag", t.ANCHOR_DROP = "anchor:drop", t.ANCHOR_DRAGEND = "anchor:dragend", t.ADJUST_POINT_MOUSEDOWN = "adjustPoint:mousedown", t.ADJUST_POINT_MOUSEUP = "adjustPoint:mouseup", t.ADJUST_POINT_MOUSEMOVE = "adjustPoint:mousemove", t.ADJUST_POINT_DRAGSTART = "adjustPoint:dragstart", t.ADJUST_POINT_DRAG = "adjustPoint:drag", t.ADJUST_POINT_DROP = "adjustPoint:drop", t.ADJUST_POINT_DRAGEND = "adjustPoint:dragend", t.BLANK_MOUSEDOWN = "blank:mousedown", t.BLANK_DRAGSTART = "blank:dragstart", t.BLANK_DRAG = "blank:drag", t.BLANK_DROP = "blank:drop", t.BLANK_MOUSEMOVE = "blank:mousemove", t.BLANK_MOUSEUP = "blank:mouseup", t.BLANK_CLICK = "blank:click", t.BLANK_CONTEXTMENU = "blank:contextmenu", t.SELECTION_MOUSEDOWN = "selection:mousedown", t.SELECTION_DRAGSTART = "selection:dragstart", t.SELECTION_DRAG = "selection:drag", t.SELECTION_DROP = "selection:drop", t.SELECTION_MOUSEMOVE = "selection:mousemove", t.SELECTION_MOUSEUP = "selection:mouseup", t.SELECTION_CONTEXTMENU = "selection:contextmenu", t.CONNECTION_NOT_ALLOWED = "connection:not-allowed", t.TEXT_MOUSEDOWN = "text:mousedown", t.TEXT_DRAGSTART = "text:dragstart", t.TEXT_DRAG = "text:drag", t.TEXT_DROP = "text:drop", t.TEXT_CLICK = "text:click", t.TEXT_DBCLICK = "text:dbclick", t.TEXT_BLUR = "text:blur", t.TEXT_MOUSEMOVE = "text:mousemove", t.TEXT_MOUSEUP = "text:mouseup", t.TEXT_FOCUS = "text:focus", t.TEXT_ADD = "text:add", t.TEXT_UPDATE = "text:update", t.TEXT_CLEAR = "text:clear", t.LABEL_MOUSEDOWN = "label:mousedown", t.LABEL_DRAGSTART = "label:dragstart", t.LABEL_DRAG = "label:drag", t.LABEL_DROP = "label:drop", t.LABEL_CLICK = "label:click", t.LABEL_DBCLICK = "label:dbclick", t.LABEL_BLUR = "label:blur", t.LABEL_MOUSEMOVE = "label:mousemove", t.LABEL_MOUSEUP = "label:mouseup", t.LABEL_FOCUS = "label:focus", t.LABEL_ADD = "label:add", t.LABEL_UPDATE = "label:update", t.LABEL_CLEAR = "label:clear", t.LABEL_DELETE = "label:delete", t.LABEL_SHOULD_ADD = "label:should-add", t.LABEL_BATCH_ADD = "label:batch-add", t.LABEL_SHOULD_UPDATE = "label:should-update", t.LABEL_SHOULD_DELETE = "label:should-delete", t.LABEL_BATCH_DELETE = "label:batch-delete", t.LABEL_NOT_ALLOWED_ADD = "label:not-allowed-add", t.HISTORY_CHANGE = "history:change", t.GRAPH_TRANSFORM = "graph:transform", t.GRAPH_RENDERED = "graph:rendered", t.GRAPH_UPDATED = "graph:updated";
})(pe || (pe = {}));
var or;
(function(t) {
  t[t.DEFAULT = 0] = "DEFAULT", t[t.INCREASE = 1] = "INCREASE";
})(or || (or = {}));
var bt;
(function(t) {
  t.HORIZONTAL = "horizontal", t.VERTICAL = "vertical";
})(bt || (bt = {}));
var zn;
(function(t) {
  t.TEXT = "text", t.LABEL = "label";
})(zn || (zn = {}));
var iR = 0, Kn = (
  /** @class */
  function() {
    function t(e) {
      var n = e.onDragStart, r = n === void 0 ? so : n, i = e.onDragging, o = i === void 0 ? so : i, a = e.onDragEnd, s = a === void 0 ? so : a, l = e.eventType, u = l === void 0 ? "" : l, f = e.eventCenter, c = e.step, d = c === void 0 ? 1 : c, h = e.isStopPropagation, v = h === void 0 ? !0 : h, p = e.model, g = e.data, y = this;
      this.isDragging = !1, this.isStartDragging = !1, this.startX = 0, this.startY = 0, this.sumDeltaX = 0, this.sumDeltaY = 0, this.handleMouseDown = function(m) {
        var A, T, k = window == null ? void 0 : window.document;
        if (m.button === iR) {
          y.isStopPropagation && m.stopPropagation(), y.isStartDragging = !0, y.startX = m.clientX, y.startY = m.clientY, k.addEventListener("mousemove", y.handleMouseMove, !1), k.addEventListener("mouseup", y.handleMouseUp, !1);
          var C = (A = y.model) === null || A === void 0 ? void 0 : A.getData();
          (T = y.eventCenter) === null || T === void 0 || T.emit(pe["".concat(y.eventType, "_MOUSEDOWN")], {
            e: m,
            data: y.data || C
          }), y.startTime = (/* @__PURE__ */ new Date()).getTime();
        }
      }, this.handleMouseMove = function(m) {
        var A, T;
        if (y.isStopPropagation && m.stopPropagation(), !!y.isStartDragging && (y.sumDeltaX += m.clientX - y.startX, y.sumDeltaY += m.clientY - y.startY, y.startX = m.clientX, y.startY = m.clientY, y.step <= 1 || Math.abs(y.sumDeltaX) > y.step || Math.abs(y.sumDeltaY) > y.step)) {
          var k = y.sumDeltaX % y.step, C = y.sumDeltaY % y.step, S = y.sumDeltaX - k, I = y.sumDeltaY - C;
          y.sumDeltaX = k, y.sumDeltaY = C;
          var X = (A = y.model) === null || A === void 0 ? void 0 : A.getData();
          y.isDragging || ((T = y.eventCenter) === null || T === void 0 || T.emit(pe["".concat(y.eventType, "_DRAGSTART")], {
            e: m,
            data: y.data || X
          }), y.onDragStart({ event: m })), y.isDragging = !0, Promise.resolve().then(function() {
            var Q, ue;
            y.onDragging({
              deltaX: S,
              deltaY: I,
              event: m
            }), (Q = y.eventCenter) === null || Q === void 0 || Q.emit(pe["".concat(y.eventType, "_MOUSEMOVE")], {
              deltaX: S,
              deltaY: I,
              e: m,
              data: y.data || X
            }), (ue = y.eventCenter) === null || ue === void 0 || ue.emit(pe["".concat(y.eventType, "_DRAG")], {
              e: m,
              data: y.data || X
            });
          });
        }
      }, this.handleMouseUp = function(m) {
        var A = window.document;
        y.isStartDragging = !1, y.isStopPropagation && m.stopPropagation(), Promise.resolve().then(function() {
          var T, k, C;
          A.removeEventListener("mousemove", y.handleMouseMove, !1), A.removeEventListener("mouseup", y.handleMouseUp, !1);
          var S = (T = y.model) === null || T === void 0 ? void 0 : T.getData();
          (k = y.eventCenter) === null || k === void 0 || k.emit(pe["".concat(y.eventType, "_MOUSEUP")], {
            e: m,
            data: y.data || S
          }), y.isDragging && (y.isDragging = !1, y.onDragEnd({ event: m }), (C = y.eventCenter) === null || C === void 0 || C.emit(pe["".concat(y.eventType, "_DROP")], {
            e: m,
            data: y.data || S
          }));
        });
      }, this.cancelDrag = function() {
        var m = window == null ? void 0 : window.document;
        m.removeEventListener("mousemove", y.handleMouseMove, !1), m.removeEventListener("mouseup", y.handleMouseUp, !1), y.onDragEnd({ event: void 0 }), y.isDragging = !1;
      }, this.destroy = function() {
        y.isStartDragging && y.cancelDrag();
      }, this.onDragStart = r, this.onDragging = o, this.onDragEnd = s, this.step = d, this.isStopPropagation = v, this.eventType = u, this.eventCenter = f, this.model = p, this.data = g;
    }
    return t.prototype.setStep = function(e) {
      this.step = e;
    }, t.prototype.setModel = function(e) {
      this.model = e;
    }, t;
  }()
), oR = function(t) {
  var e = t.x, n = t.y, r = t.width, i = t.height;
  return {
    x: e - r / 2,
    y: n - i / 2,
    x1: e + r / 2,
    y1: n + i / 2
  };
}, aR = function(t) {
  var e = t.startPoint, n = t.endPoint, r = (e.x + n.x) / 2, i = (e.y + n.y) / 2, o = Math.abs(e.x - n.x) + 10, a = Math.abs(e.y - n.y) + 10;
  return {
    x: r - o / 2,
    y: i - a / 2,
    x1: r + o / 2,
    y1: i + a / 2
  };
}, sR = function(t) {
  var e = t.points, n = ki(e), r = Ra(n, 8), i = r.x, o = r.y, a = r.width, s = r.height;
  return {
    x: i - a / 2,
    y: o - s / 2,
    x1: i + a / 2,
    y1: o + s / 2
  };
}, lR = function(t) {
  var e = t.path, n = hd(e), r = Ra(n, 8), i = r.x, o = r.y, a = r.width, s = r.height;
  return {
    x: i - a / 2,
    y: o - s / 2,
    x1: i + a / 2,
    y1: o + s / 2
  };
}, uR = function(t) {
  if (t.modelType === $e.LINE_EDGE)
    return aR(t);
  if (t.modelType === $e.POLYLINE_EDGE)
    return sR(t);
  if (t.modelType === $e.BEZIER_EDGE)
    return lR(t);
}, fR = function(t, e, n, r) {
  var i = (e.y - t.y) * (r.x - n.x) - (t.x - e.x) * (n.y - r.y);
  if (i === 0)
    return !1;
  var o = ((e.x - t.x) * (r.x - n.x) * (n.y - t.y) + (e.y - t.y) * (r.x - n.x) * t.x - (r.y - n.y) * (e.x - t.x) * n.x) / i, a = -((e.y - t.y) * (r.y - n.y) * (n.x - t.x) + (e.x - t.x) * (r.y - n.y) * t.y - (r.x - n.x) * (e.y - t.y) * n.y) / i;
  return (
    // 交点在线段1上
    (o - t.x) * (o - e.x) <= 0 && (a - t.y) * (a - e.y) <= 0 && // 且交点也在线段2上
    (o - n.x) * (o - r.x) <= 0 && (a - n.y) * (a - r.y) <= 0 ? {
      x: o,
      y: a
    } : !1
  );
}, Pa = function(t, e, n) {
  var r = t.x, i = t.y, o = e.x, a = e.y, s = n.x, l = n.y, u = (l - a) / (s - o), f = a - u * o;
  return (r >= o && r <= s || r <= o && r >= s) && (i >= a && i <= l || i <= a && i >= l) && Math.abs(i - u * r - f) < Number.EPSILON;
}, Da = function(t) {
  var e = t.start, n = t.end, r = t.offset, i = t.verticalLength, o = t.type, a = {
    leftX: 0,
    leftY: 0,
    rightX: 0,
    rightY: 0
  }, s = Math.atan((n.y - e.y) / (n.x - e.x)), l = Math.atan(r / i), u = Math.sqrt(i * i + r * r);
  return o === "start" ? n.x >= e.x ? (a.leftX = e.x + u * Math.sin(s + l), a.leftY = e.y - u * Math.cos(s + l), a.rightX = e.x - u * Math.sin(s - l), a.rightY = e.y + u * Math.cos(s - l)) : (a.leftX = e.x - u * Math.sin(s + l), a.leftY = e.y + u * Math.cos(s + l), a.rightX = e.x + u * Math.sin(s - l), a.rightY = e.y - u * Math.cos(s - l)) : o === "end" && (n.x >= e.x ? (a.leftX = n.x + u * Math.sin(s - l), a.leftY = n.y - u * Math.cos(s - l), a.rightX = n.x - u * Math.sin(s + l), a.rightY = n.y + u * Math.cos(s + l)) : (a.leftX = n.x - u * Math.sin(s - l), a.leftY = n.y + u * Math.cos(s - l), a.rightX = n.x + u * Math.sin(s + l), a.rightY = n.y - u * Math.cos(s + l))), a;
}, io = function() {
  return io = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, io.apply(this, arguments);
}, Fn = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, Jr = function(t, e, n) {
  if (n || arguments.length === 2) for (var r = 0, i = e.length, o; r < i; r++)
    (o || !(r in e)) && (o || (o = Array.prototype.slice.call(e, 0, r)), o[r] = e[r]);
  return t.concat(o || Array.prototype.slice.call(e));
}, cR = function(t, e) {
  return Math.abs(t.centerX - e.centerX) * 2 < t.width + e.width && Math.abs(t.centerY - e.centerY) * 2 < t.height + e.height;
}, _f = function(t) {
  var e = [], n = {};
  return t.forEach(function(r) {
    var i = "".concat(r.x, "-").concat(r.y);
    r.id = i, n[i] = r;
  }), Object.keys(n).forEach(function(r) {
    e.push(n[r]);
  }), e;
}, Ks = function(t, e) {
  return t.width === 0 && t.height === 0 ? t : {
    x: t.x,
    y: t.y,
    centerX: t.centerX,
    centerY: t.centerY,
    minX: t.minX - e,
    minY: t.minY - e,
    maxX: t.maxX + e,
    maxY: t.maxY + e,
    height: t.height + 2 * e,
    width: t.width + 2 * e
  };
}, dR = function(t, e) {
  var n = Math.abs(t.x - e.centerX), r = Math.abs(t.y - e.centerY);
  return n / e.width > r / e.height ? bt.HORIZONTAL : bt.VERTICAL;
}, qs = function(t, e, n) {
  var r = dR(n, e);
  return r === bt.HORIZONTAL ? {
    x: n.x > t.centerX ? t.maxX : t.minX,
    y: n.y
  } : {
    x: n.x,
    y: n.y > t.centerY ? t.maxY : t.minY
  };
}, vp = function(t, e) {
  var n = Math.min(t.minX, e.minX), r = Math.min(t.minY, e.minY), i = Math.max(t.maxX, e.maxX), o = Math.max(t.maxY, e.maxY);
  return {
    x: (n + i) / 2,
    y: (r + o) / 2,
    centerX: (n + i) / 2,
    centerY: (r + o) / 2,
    minX: n,
    minY: r,
    maxX: i,
    maxY: o,
    height: o - r,
    width: i - n
  };
}, Ra = function(t, e) {
  t === void 0 && (t = []);
  var n = [], r = [];
  t.forEach(function(f) {
    n.push(f.x), r.push(f.y);
  });
  var i = Math.min.apply(Math, Jr([], Fn(n), !1)), o = Math.max.apply(Math, Jr([], Fn(n), !1)), a = Math.min.apply(Math, Jr([], Fn(r), !1)), s = Math.max.apply(Math, Jr([], Fn(r), !1)), l = o - i, u = s - a;
  return e && (l += e, u += e), {
    centerX: (i + o) / 2,
    centerY: (a + s) / 2,
    maxX: o,
    maxY: s,
    minX: i,
    minY: a,
    x: (i + o) / 2,
    y: (a + s) / 2,
    height: u,
    width: l
  };
}, Zs = function(t) {
  var e = t.minX, n = t.minY, r = t.maxX, i = t.maxY;
  return [
    {
      x: e,
      y: n
    },
    {
      x: r,
      y: n
    },
    {
      x: r,
      y: i
    },
    {
      x: e,
      y: i
    }
  ];
}, is = function(t, e) {
  var n = t.x, r = t.y;
  return n < e.minX || n > e.maxX || r < e.minY || r > e.maxY;
}, hR = function(t, e) {
  return e < t.minX || e > t.maxX ? [] : [
    {
      x: e,
      y: t.minY
    },
    {
      x: e,
      y: t.maxY
    }
  ];
}, pR = function(t, e) {
  return e < t.minY || e > t.maxY ? [] : [
    {
      x: t.minX,
      y: e
    },
    {
      x: t.maxX,
      y: e
    }
  ];
}, vR = function(t, e) {
  return Jr(Jr([], Fn(hR(t, e.x)), !1), Fn(pR(t, e.y)), !1);
}, bf = function(t, e) {
  return Math.abs(t.x - e.x) + Math.abs(t.y - e.y);
}, gR = function(t, e) {
  var n = -2, r = 0;
  return e.forEach(function(i) {
    i && (t.x === i.x && (r += n), t.y === i.y && (r += n));
  }), r;
}, gp = function(t, e, n, r, i) {
  return bf(t, e) + bf(t, n) + gR(t, [e, n, r, i]);
}, r_ = function(t, e, n, r, i) {
  i || (i = 0), t.unshift(e[r]), n[r] && n[r] !== r && i <= 100 && r_(t, e, n, n[r], i + 1);
}, yR = function(t, e) {
  var n = t.indexOf(e);
  n > -1 && t.splice(n, 1);
}, ia = function(t, e, n, r) {
  var i = e.x - t.x, o = e.y - t.y, a = r.x - n.x, s = r.y - n.y, l = (-o * (t.x - n.x) + i * (t.y - n.y)) / (-a * o + i * s), u = (a * (t.y - n.y) - s * (t.x - n.x)) / (-a * o + i * s);
  return l >= 0 && l <= 1 && u >= 0 && u <= 1;
}, yp = function(t, e, n) {
  if (n.width === 0 && n.height === 0)
    return !1;
  var r = Fn(Zs(n), 4), i = r[0], o = r[1], a = r[2], s = r[3];
  return ia(t, e, i, o) || ia(t, e, i, s) || ia(t, e, o, a) || ia(t, e, a, s);
}, mR = function(t, e, n, r) {
  var i = [];
  return t.forEach(function(o) {
    o !== e && (o.x === e.x || o.y === e.y) && !yp(o, e, n) && !yp(o, e, r) && i.push(o);
  }), _f(i);
}, _R = function(t, e, n, r, i, o, a) {
  var s = [], l = [e], u = {}, f = {}, c = {};
  e.id && (f[e.id] = 0, c[e.id] = gp(e, n, e));
  var d = {};
  t.forEach(function(p) {
    p.id && (d[p.id] = p);
  });
  for (var h = function() {
    var p, g = 1 / 0;
    if (l.forEach(function(m) {
      m.id && c[m.id] < g && (g = c[m.id], p = m);
    }), p === n && n.id) {
      var y = [];
      return r_(y, d, u, n.id), { value: y };
    }
    if (!p)
      return { value: [e, n] };
    yR(l, p), s.push(p), mR(t, p, r, i).forEach(function(m) {
      if (s.indexOf(m) === -1 && (l.indexOf(m) === -1 && l.push(m), p != null && p.id && (m != null && m.id))) {
        var A = c[p.id] + bf(p, m);
        if (f[m.id] && A >= f[m.id])
          return;
        u[m.id] = p.id, f[m.id] = A, c[m.id] = f[m.id] + gp(m, n, e, o, a);
      }
    });
  }; l.length; ) {
    var v = h();
    if (typeof v == "object")
      return v.value;
  }
  return [e, n];
}, mp = function(t) {
  return gn(t);
}, i_ = function(t) {
  for (var e = 1; e < t.length - 1; ) {
    var n = t[e - 1], r = t[e], i = t[e + 1];
    n.x === r.x && r.x === i.x || n.y === r.y && r.y === i.y ? t.splice(e, 1) : e++;
  }
  return t;
}, _p = function(t, e, n, r, i) {
  var o = mp(n), a = mp(r), s = Ks(o, i), l = Ks(a, i), u = qs(s, o, t), f = qs(l, a, e);
  if (cR(s, l)) {
    var c = xR(t, e, u, f);
    return Jr(Jr([t, u], Fn(c), !1), [f, e], !1);
  }
  var d = Ra([u, f]), h = vp(s, d), v = vp(l, d), p = [];
  p = p.concat(Zs(h)), p = p.concat(Zs(v));
  var g = {
    x: (t.x + e.x) / 2,
    y: (t.y + e.y) / 2
  };
  [d, h, v].forEach(function(m) {
    p = p.concat(vR(m, g).filter(function(A) {
      return is(A, s) && is(A, l);
    }));
  }), [
    {
      x: u.x,
      y: f.y
    },
    {
      x: f.x,
      y: u.y
    }
  ].forEach(function(m) {
    is(m, s) && is(m, l) && p.push(m);
  }), p.unshift(u), p.push(f), p = _f(p);
  var y = _R(p, u, f, o, a, t, e);
  return y.unshift(t), y.push(e), y.length > 2 && (y = i_(y)), _f(y);
}, bR = function(t) {
  if (t.length === 1) {
    var e = Fn(t, 1), n = e[0];
    return [n, n];
  } else {
    for (var r = t[0], i = t[1], o = ar(r.x, r.y, i.x, i.y), a = 1; a < t.length - 1; a++) {
      var s = t[a], l = t[a + 1], u = ar(s.x, s.y, l.x, l.y);
      u > o && (o = u, r = s, i = l);
    }
    return [r, i];
  }
}, bp = function(t, e, n) {
  var r = Qr(t, n), i = Qr(e, n);
  return r && i;
}, xp = function(t, e, n) {
  var r = Qr(t, n), i = Qr(e, n), o = r && i, a = r || i;
  return !o && a;
}, Ep = function(t, e, n) {
  for (var r = void 0, i = gn(n), o = Zs(i), a = 0; a < o.length; a++) {
    var s = ia(t, e, o[a], o[(a + 1) % o.length]);
    s && (r = [o[a], o[(a + 1) % o.length]]);
  }
  if (r)
    return fR(t, e, r[0], r[1]);
}, Js = function(t, e) {
  var n = void 0;
  return t.x === e.x ? n = bt.VERTICAL : t.y === e.y && (n = bt.HORIZONTAL), n;
}, ki = function(t) {
  var e = t.split(" "), n = [];
  return e && e.forEach(function(r) {
    var i = Fn(r.split(","), 2), o = i[0], a = i[1];
    n.push({
      x: Number(o),
      y: Number(a)
    });
  }), n;
}, xR = function(t, e, n, r) {
  var i = [], o = Js(t, n), a = Js(e, r);
  if (o === a)
    t.y === n.y ? (i.push({
      x: n.x,
      y: (n.y + r.y) / 2
    }), i.push({
      x: r.x,
      y: (n.y + r.y) / 2
    })) : (i.push({
      x: (n.x + r.x) / 2,
      y: n.y
    }), i.push({
      x: (n.x + r.x) / 2,
      y: r.y
    }));
  else {
    var s = {
      x: n.x,
      y: r.y
    }, l = Pa(s, t, n), u = Pa(s, e, r);
    if (l || u)
      s = {
        x: r.x,
        y: n.y
      };
    else {
      var f = wp(s, t, n), c = wp(s, e, r);
      f && c && (s = {
        x: r.x,
        y: n.y
      });
    }
    i.push(s);
  }
  return i;
}, wp = function(t, e, n) {
  return t.x === e.x && t.x === n.x || t.y === e.y && t.y === n.y;
}, o_ = function(t) {
  if (!t)
    return 0;
  for (var e = 0, n = 0; n < t.length; n++) {
    var r = t.charCodeAt(n);
    t.match(/[A-Z]/) ? e += 1.5 : r >= 1 && r <= 126 || r >= 65376 && r <= 65439 ? e += 1 : e += 2;
  }
  return e;
}, ER = function(t) {
  var e = t.start, n = t.end, r;
  if (e.x === n.x && e.y === n.y)
    r = "";
  else {
    var i = {
      start: e,
      end: n,
      offset: 10,
      verticalLength: 5
    }, o = Da(io(io({}, i), { type: "start" })), a = Da(io(io({}, i), { type: "end" }));
    r = "M".concat(o.leftX, " ").concat(o.leftY, `
    L`).concat(o.rightX, " ").concat(o.rightY, `
    L`).concat(a.rightX, " ").concat(a.rightY, `
    L`).concat(a.leftX, " ").concat(a.leftY, " z");
  }
  return {
    d: r,
    fill: "transparent",
    stroke: "transparent",
    strokeWidth: 1,
    strokeDasharray: "4, 4"
  };
}, Sp = function(t) {
  var e = t.start, n = t.end, r = t.sourceNode, i = t.targetNode, o = t.offset, a = gn(r), s = gn(i), l = Ks(a, o), u = Ks(s, o), f = qs(l, a, e), c = qs(u, s, n);
  return {
    sNext: f,
    ePre: c
  };
}, hd = function(t) {
  var e = t.replace(/M/g, "").replace(/C/g, ",").split(","), n = os(e[0]), r = os(e[1]), i = os(e[2]), o = os(e[3]);
  return [n, r, i, o];
}, os = function(t) {
  var e = Fn(t.replace(/(^\s*)/g, "").split(" "), 2), n = e[0], r = e[1];
  return {
    x: +n,
    y: +r
  };
}, Op = function(t, e) {
  var n = Fn(t, 4), r = n[0], i = n[1], o = n[2], a = n[3], s = fL(r, i, o, a, e);
  return [s, t[3]];
}, a_ = function(t, e) {
  for (var n = t.x, r = t.y, i = ki(e), o = Number.MAX_SAFE_INTEGER, a, s = [], l = 0; l < i.length; l++)
    s.push({
      start: i[l],
      end: i[(l + 1) % i.length]
    });
  if (s.forEach(function(d) {
    var h = d.start, v = d.end;
    if (h.x === v.x) {
      var p = {
        x: h.x,
        y: r
      }, g = Pa(p, h, v);
      if (g) {
        var y = Math.abs(h.x - n);
        y < o && (o = y, a = p);
      }
    } else if (h.y === v.y) {
      var p = {
        x: n,
        y: h.y
      }, g = Pa(p, h, v);
      if (g) {
        var y = Math.abs(h.y - r);
        y < o && (o = y, a = p);
      }
    }
  }), !a) {
    var u = s[0], f = u.start, c = u.end;
    a = {
      x: f.x + (c.x - f.x) / 2,
      y: f.y + (c.y - f.y) / 2
    };
  }
  return a;
}, wR = function(t) {
  return Ti(t, [
    "id",
    "type",
    "sourceNodeId",
    "sourceAnchorId",
    "targetNodeId",
    "targetAnchorId",
    "pointsList",
    "startPoint",
    "endPoint",
    "properties"
  ]);
}, Ap = function(t, e) {
  return Math.sqrt(Math.pow(t.x - e.x, 2) + Math.pow(t.y - e.y, 2));
};
function SR(t, e) {
  return typeof e != "function" ? function(n, r, i) {
    return Object.assign({ type: t.edgeType }, i);
  } : function(n, r, i) {
    var o = e(n, r, i);
    return o ? typeof o == "string" ? Object.assign({}, i, { type: o }) : Object.assign({ type: o }, i) : { type: t.edgeType };
  };
}
var OR = function(t) {
  var e = t.rows, n = t.rowsLength, r = t.fontSize, i = 0;
  return at(e, function(o) {
    var a = o_(o);
    i = a > i ? a : i;
  }), {
    width: Math.ceil(i / 2) * r + r / 4,
    height: n * (r + 2) + r / 4
  };
}, Vi = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, as = function(t, e, n) {
  if (n || arguments.length === 2) for (var r = 0, i = e.length, o; r < i; r++)
    (o || !(r in e)) && (o || (o = Array.prototype.slice.call(e, 0, r)), o[r] = e[r]);
  return t.concat(o || Array.prototype.slice.call(e));
};
function _o(t, e, n) {
  return n && e * Math.round(t / e) || t;
}
function AR(t, e, n) {
  if (!t)
    return [];
  var r = Math.min.apply(Math, as([], Vi(t.map(function(p) {
    return p[0];
  })), !1)), i = Math.max.apply(Math, as([], Vi(t.map(function(p) {
    return p[0];
  })), !1)), o = Math.min.apply(Math, as([], Vi(t.map(function(p) {
    return p[1];
  })), !1)), a = Math.max.apply(Math, as([], Vi(t.map(function(p) {
    return p[1];
  })), !1)), s = -r, l = -o, u = t.map(function(p) {
    var g = Vi(p, 2), y = g[0], m = g[1];
    return [
      y + s,
      m + l
    ];
  }), f = i - r, c = a - o, d = e ? e / f : 1, h = n ? n / c : 1, v = Math.min(d, h);
  return u.map(function(p) {
    var g = Vi(p, 2), y = g[0], m = g[1];
    return [y * v, m * v];
  });
}
var Su = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, Ou = function(t, e, n) {
  var r = Su(t, 2), i = r[0], o = r[1], a = Su(e, 2), s = a[0], l = a[1], u = Su(n, 2), f = u[0], c = u[1];
  return i > s && i < f && o > l && o < c;
}, s_ = function(t, e) {
  var n = e.multipleSelectKey, r = !1;
  switch (n) {
    case "meta":
      r = t.metaKey;
      break;
    case "alt":
      r = t.altKey;
      break;
    case "shift":
      r = t.shiftKey;
      break;
    case "ctrl":
      r = t.ctrlKey;
      break;
    default:
      r = !1;
      break;
  }
  return r;
}, pd = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}();
function Cp(t, e) {
  return t instanceof Vt && e instanceof Vt;
}
var l_ = (
  /** @class */
  function(t) {
    pd(e, t);
    function e(n, r, i) {
      var o = t.call(this, 3) || this;
      return o[0] = n, o[1] = r, o[2] = i, o.x = n, o.y = r, o.z = i, Object.setPrototypeOf(o, e.prototype), o;
    }
    return e.prototype.add = function(n) {
      if (Cp(this, n))
        return new Vt(this.x + n.x, this.y + n.y);
      var r = this.z + n.z;
      return new xf((this.x + n.x) / r, (this.y + n.y) / r);
    }, e.prototype.subtract = function(n) {
      if (Cp(this, n))
        return new Vt(this.x - n.x, this.y - n.y);
      var r = this.z - n.z;
      return r === 0 ? new Vt(this.x - n.x, this.y - n.y) : new xf((this.x - n.x) / r, (this.y - n.y) / r);
    }, e;
  }(Array)
), Vt = (
  /** @class */
  function(t) {
    pd(e, t);
    function e(n, r, i) {
      var o = t.call(this, n, r, i ?? 0) || this;
      return Object.setPrototypeOf(o, e.prototype), o;
    }
    return e.prototype.toString = function() {
      return "Vector";
    }, e.prototype.dot = function(n) {
      var r = this;
      return n.reduce(function(i, o, a) {
        return i + o * r[a];
      });
    }, e.prototype.cross = function(n) {
      return new e(this.y * n.z - this.z * n.y, this.z * n.x - this.x * n.z, this.x * n.y - this.y * n.x);
    }, e.prototype.getLength = function() {
      return Math.hypot(this.x, this.y);
    }, e.prototype.normalize = function() {
      var n = this.getLength();
      return new e(this.x / n, this.y / n);
    }, e.prototype.crossZ = function(n) {
      return this.x * n.y - this.y * n.x;
    }, e.prototype.angle = function(n) {
      var r = this.crossZ(n), i = Math.acos(this.normalize().dot(n.normalize()));
      return r >= 0 ? i : -i;
    }, e;
  }(l_)
), xf = (
  /** @class */
  function(t) {
    pd(e, t);
    function e(n, r) {
      var i = t.call(this, n, r, 1) || this;
      return Object.setPrototypeOf(i, e.prototype), i;
    }
    return e.prototype.toString = function() {
      return "Point";
    }, e;
  }(l_)
), ou = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), Ki = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, Au = function(t, e, n) {
  if (n || arguments.length === 2) for (var r = 0, i = e.length, o; r < i; r++)
    (o || !(r in e)) && (o || (o = Array.prototype.slice.call(e, 0, r)), o[r] = e[r]);
  return t.concat(o || Array.prototype.slice.call(e));
}, au = (
  /** @class */
  function(t) {
    ou(e, t);
    function e() {
      for (var n = [], r = 0; r < arguments.length; r++)
        n[r] = arguments[r];
      var i = t.call(this, n.length) || this;
      return i.fill(new Array(3)), n.forEach(function(o, a) {
        i[a] = o;
      }), i.columns = n[0].length, i.rows = n.length, Object.setPrototypeOf(i, e.prototype), i;
    }
    return e.prototype.getRow = function(n) {
      return this[n];
    }, e.prototype.getColumn = function(n) {
      return Au([], Ki(this.map(function(r) {
        return r[n];
      })), !1);
    }, e.prototype.transpose = function() {
      for (var n = [], r = 0; r < this.columns; r++)
        n.push(this.getColumn(r));
      return new (e.bind.apply(e, Au([void 0], Ki(n), !1)))();
    }, e.prototype.cross = function(n) {
      var r = new Array(this.rows).fill("").map(function() {
        return [];
      });
      if (this.columns === n.rows)
        for (var i = 0; i < this.rows; i++)
          for (var o = this.getRow(i), a = function(l) {
            var u = n.getColumn(l);
            r[i][l] = o.reduce(function(f, c, d) {
              return f + c * u[d];
            }, 0);
          }, s = 0; s < n.columns; s++)
            a(s);
      return new (e.bind.apply(e, Au([void 0], Ki(r), !1)))();
    }, e.prototype.to2D = function() {
      return this.map(function(n) {
        return [n[0], n[1]];
      });
    }, e.prototype.toPoints = function() {
      return this.map(function(n) {
        return new xf(n[0], n[1]);
      });
    }, e.prototype.toString = function() {
      var n = Ki(this[0], 2), r = n[0], i = n[1], o = Ki(this[1], 2), a = o[0], s = o[1], l = Ki(this[2], 2), u = l[0], f = l[1];
      return "matrix(".concat(r, " ").concat(i, " ").concat(a, " ").concat(s, " ").concat(u, " ").concat(f, ")");
    }, e.prototype.translate = function(n, r) {
      return this.cross(new su(n, r));
    }, e.prototype.rotate = function(n) {
      return this.cross(new CR(n));
    }, e.prototype.scale = function(n, r) {
      return this.cross(new TR(n, r));
    }, e;
  }(Array)
), CR = (
  /** @class */
  function(t) {
    ou(e, t);
    function e(n) {
      var r = t.call(this, new Vt(+Math.cos(n).toFixed(2), +Math.sin(n).toFixed(2), 0), new Vt(-Math.sin(n).toFixed(2), +Math.cos(n).toFixed(2), 0), new Vt(0, 0, 1)) || this;
      return Object.setPrototypeOf(r, e.prototype), r;
    }
    return e.prototype.inverse = function() {
      return this.transpose();
    }, e;
  }(au)
), TR = (
  /** @class */
  function(t) {
    ou(e, t);
    function e(n, r) {
      var i = t.call(this, new Vt(n, 0, 0), new Vt(0, r, 0), new Vt(0, 0, 1)) || this;
      return i.sx = n, i.sy = r, Object.setPrototypeOf(i, e.prototype), i;
    }
    return e.prototype.inverse = function() {
      return new e(1 / this.sx, 1 / this.sy);
    }, e;
  }(au)
), su = (
  /** @class */
  function(t) {
    ou(e, t);
    function e(n, r) {
      var i = t.call(this, new Vt(1, 0, 0), new Vt(0, 1, 0), new Vt(n, r, 1)) || this;
      return i.tx = n, i.ty = r, Object.setPrototypeOf(i, e.prototype), i;
    }
    return e.prototype.inverse = function() {
      return new e(-this.tx, -this.ty);
    }, e;
  }(au)
);
G0({});
var Qs = function() {
  return Qs = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Qs.apply(this, arguments);
}, Ef = function(t) {
  var e = t.anchors;
  return e;
}, el = function(t, e) {
  for (var n = e.nodes, r, i = n.length - 1; i >= 0; i--) {
    var o = n[i], a = PR(t, o);
    if (a) {
      var s = o.getTargetAnchor(t);
      if (s) {
        var l = {
          node: o,
          anchorIndex: s.index,
          anchor: s.anchor
        };
        (!r || NR(o, r.node, e)) && (r = l);
      }
    }
  }
  return r;
}, NR = function(t, e, n) {
  return t.zIndex > e.zIndex ? !0 : n.nodesMap[t.id].index > n.nodesMap[e.id].index;
}, MR = function(t, e) {
  for (var n = Ef(e), r, i = Number.MAX_SAFE_INTEGER, o = 0; o < n.length; o++) {
    var a = ar(t.x, t.y, n[o].x, n[o].y);
    a < i && (i = a, r = {
      index: o,
      anchor: Qs(Qs({}, n[o]), { x: n[o].x, y: n[o].y, id: n[o].id })
    });
  }
  return r;
}, ar = function(t, e, n, r) {
  return Math.hypot(t - n, e - r);
}, Qr = function(t, e) {
  var n = !1, r = 0, i = gn(e);
  return t.x >= i.minX - r && t.x <= i.maxX + r && t.y >= i.minY - r && t.y <= i.maxY + r && (n = !0), n;
}, PR = function(t, e) {
  var n = !1, r = 5, i = gn(e);
  return t.x >= i.minX - r && t.x <= i.maxX + r && t.y >= i.minY - r && t.y <= i.maxY + r && (n = !0), n;
}, gn = function(t) {
  var e = t.x, n = t.y, r = t.width, i = t.height;
  return {
    minX: e - r / 2,
    minY: n - i / 2,
    maxX: e + r / 2,
    maxY: n + i / 2,
    x: e,
    y: n,
    width: r,
    height: i,
    centerX: e,
    centerY: n
  };
}, DR = function(t) {
  var e = t, n = e.x, r = e.y, i = e.width, o = e.height, a = e.radius;
  return [
    {
      x: n - i / 2 + a,
      y: r - o / 2 + a,
      r: a
    },
    {
      x: n + i / 2 - a,
      y: r - o / 2 + a,
      r: a
    },
    {
      x: n - i / 2 + a,
      y: r + o / 2 - a,
      r: a
    },
    {
      x: n + i / 2 - a,
      y: r + o / 2 - a,
      r: a
    }
  ];
}, Tp = function(t, e, n) {
  var r = DR(n), i, o = Number.MAX_SAFE_INTEGER;
  return r.forEach(function(a) {
    var s = ar(t.x, t.y, a.x, a.y);
    s < o && (o = s, i = a);
  }), wf(t, e, i);
}, wf = function(t, e, n) {
  var r, i = n.x, o = n.y, a = n.r;
  if (e === bt.HORIZONTAL) {
    var s = i - Math.sqrt(a * a - (t.y - o) * (t.y - o)), l = i + Math.sqrt(a * a - (t.y - o) * (t.y - o)), u = Math.abs(s - t.x) < Math.abs(l - t.x) ? s : l;
    r = {
      x: u,
      y: t.y
    };
  } else if (e === bt.VERTICAL) {
    var f = o - Math.sqrt(a * a - (t.x - i) * (t.x - i)), c = o + Math.sqrt(a * a - (t.x - i) * (t.x - i)), d = Math.abs(f - t.y) < Math.abs(c - t.y) ? f : c;
    r = {
      x: t.x,
      y: d
    };
  }
  return r;
}, Np = function(t, e) {
  var n = e, r = !1, i = n.x, o = n.y, a = n.width, s = n.height, l = n.radius, u = {
    minX: i - a / 2 + l,
    maxX: i + a / 2 - l,
    minY: o - s / 2 + l,
    maxY: o + s / 2 - l
  };
  return t.y === o + s / 2 || t.y === o - s / 2 ? r = t.x > u.minX && t.x < u.maxX : (t.x === i + a / 2 || t.x === i - a / 2) && (r = t.y > u.minY && t.y < u.maxY), r;
}, Mp = function(t, e, n) {
  var r, i = n, o = i.x, a = i.y, s = i.rx, l = i.ry;
  if (e === bt.HORIZONTAL) {
    var u = o - Math.sqrt(s * s - (t.y - a) * (t.y - a) * s * s / (l * l)), f = o + Math.sqrt(s * s - (t.y - a) * (t.y - a) * s * s / (l * l)), c = Math.abs(u - t.x) < Math.abs(f - t.x) ? u : f;
    r = {
      x: c,
      y: t.y
    };
  } else if (e === bt.VERTICAL) {
    var d = a - Math.sqrt(l * l - (t.x - o) * (t.x - o) * l * l / (s * s)), h = a + Math.sqrt(l * l - (t.x - o) * (t.x - o) * l * l / (s * s)), v = Math.abs(d - t.y) < Math.abs(h - t.y) ? d : h;
    r = {
      x: t.x,
      y: v
    };
  }
  return r;
}, ss = function(t, e, n) {
  for (var r = n.pointsPosition, i = Number.MAX_SAFE_INTEGER, o, a = [], s = 0; s < r.length; s++)
    a.push({
      start: r[s],
      end: r[(s + 1) % r.length]
    });
  return a.forEach(function(l) {
    var u = l.start, f = l.end, c = u, d = f;
    u.x > f.x && (c = f, d = u);
    var h = {
      x: t.x,
      y: t.y
    };
    if (c.x === d.x && e === bt.HORIZONTAL && (h = {
      x: c.x,
      y: t.y
    }), c.y === d.y && e === bt.VERTICAL && (h = {
      x: t.x,
      y: c.y
    }), c.x !== d.x && c.y !== d.y) {
      var v = (d.y - c.y) / (d.x - c.x), p = (c.x * d.y - d.x * c.y) / (c.x - d.x);
      e === bt.HORIZONTAL ? h = {
        x: (t.y - p) / v,
        y: t.y
      } : e === bt.VERTICAL && (h = {
        x: t.x,
        y: v * t.x + p
      });
    }
    var g = Pa(h, u, f);
    if (g) {
      var y = ar(h.x, h.y, t.x, t.y);
      y < i && (i = y, o = h);
    }
  }), o;
}, RR = function(t) {
  var e = Ti(t, [
    "id",
    "type",
    "x",
    "y",
    "text",
    "label",
    "properties",
    "virtual",
    // 区域节点是否为dnd添加的虚拟节点
    "rotate",
    // TODO: 确认是否可以加到此处
    "resizable",
    "rotatable"
  ]);
  return e;
}, Pp = function(t, e, n, r) {
  var i = t.x, o = t.y;
  return e.x > t.x ? i = t.x + n / 2 : e.x < t.x && (i = t.x - n / 2), e.y > t.y ? o = t.y + r / 2 : e.y < t.y && (o = t.y - r / 2), {
    x: i,
    y: o
  };
}, u_ = function(t) {
  var e = t.rows, n = t.style, r = t.rowsLength, i = t.className, o = document.createElement("div");
  o.className = i, o.style.fontSize = "".concat(n.fontSize), o.style.width = "".concat(n.width), o.style.lineHeight = "".concat(n.lineHeight), o.style.padding = "".concat(n.padding), n.fontFamily && (o.style.fontFamily = "".concat(n.fontFamily)), r > 1 ? e.forEach(function(s) {
    var l = document.createElement("div");
    l.textContent = s, o.appendChild(l);
  }) : o.textContent = e[0], document.body.appendChild(o);
  var a = o.clientHeight;
  return document.body.removeChild(o), a;
}, Dp = function(t) {
  var e = t.rows, n = t.rowsLength, r = t.fontSize, i = 0;
  return e && e.forEach(function(o) {
    var a = o_(o);
    i = a > i ? a : i;
  }), {
    width: Math.ceil(i / 2) * r + r / 4,
    height: n * (r + 2) + r / 4
  };
}, tl = function(t) {
  return typeof t != "object" ? {
    isAllPass: !!t,
    msg: t ? "" : "不允许连接"
  } : t;
};
let ls;
const LR = new Uint8Array(16);
function IR() {
  if (!ls && (ls = typeof crypto < "u" && crypto.getRandomValues && crypto.getRandomValues.bind(crypto), !ls))
    throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");
  return ls(LR);
}
const Gt = [];
for (let t = 0; t < 256; ++t)
  Gt.push((t + 256).toString(16).slice(1));
function jR(t, e = 0) {
  return Gt[t[e + 0]] + Gt[t[e + 1]] + Gt[t[e + 2]] + Gt[t[e + 3]] + "-" + Gt[t[e + 4]] + Gt[t[e + 5]] + "-" + Gt[t[e + 6]] + Gt[t[e + 7]] + "-" + Gt[t[e + 8]] + Gt[t[e + 9]] + "-" + Gt[t[e + 10]] + Gt[t[e + 11]] + Gt[t[e + 12]] + Gt[t[e + 13]] + Gt[t[e + 14]] + Gt[t[e + 15]];
}
const kR = typeof crypto < "u" && crypto.randomUUID && crypto.randomUUID.bind(crypto), Rp = {
  randomUUID: kR
};
function BR(t, e, n) {
  if (Rp.randomUUID && !t)
    return Rp.randomUUID();
  t = t || {};
  const r = t.random || (t.rng || IR)();
  return r[6] = r[6] & 15 | 64, r[8] = r[8] & 63 | 128, jR(r);
}
var ti = function() {
  return BR();
}, la = /* @__PURE__ */ new Map(), f_ = function(t) {
  var e = ti();
  function n() {
    t();
    var i = la.get(e);
    if (i) {
      var o = window.requestAnimationFrame(n);
      la.set(e, o);
    }
  }
  var r = window.requestAnimationFrame(n);
  return la.set(e, r), e;
}, nl = function(t) {
  var e = la.get(t);
  e && (window.cancelAnimationFrame(e), la.delete(t));
}, La = function() {
  return La = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, La.apply(this, arguments);
}, FR = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
};
function c_(t) {
  var e = t.x, n = e === void 0 ? 0 : e, r = t.y, i = r === void 0 ? 0 : r, o = t.value, a = t.fontSize, s = a === void 0 ? 12 : a, l = t.fill, u = l === void 0 ? "currentColor" : l, f = t.overflowMode, c = f === void 0 ? "default" : f, d = t.textWidth, h = d === void 0 ? void 0 : d, v = t.model, p = {
    x: n,
    y: i,
    fill: u,
    fontSize: s,
    textAnchor: "middle",
    dominantBaseline: "central"
    // ...props,
  };
  if (at(Xr(t), function(k) {
    var C = FR(k, 2), S = C[0], I = C[1];
    typeof I != "object" && (p[S] = I);
  }), o) {
    var g = String(o).split(/[\r\n]/g), y = g.length;
    if (c !== "default") {
      var m = v.BaseType, A = v.modelType;
      if (m === At.NODE && A !== $e.TEXT_NODE || m === At.EDGE && h)
        return $R(t);
    }
    if (y > 1) {
      var T = g.map(function(k, C) {
        var S = s + 2, I = (C - (y - 1) / 2) * S;
        return B("tspan", { className: "lf-text-tspan", x: n, y: i + I, children: k });
      });
      return B("text", La({}, p, { children: T }));
    }
    return B("text", La({}, p, { children: o }));
  }
  return null;
}
function $R(t) {
  var e = t.x, n = t.y, r = t.value, i = t.model, o = t.textWidth, a = t.fontSize, s = a === void 0 ? 12 : a, l = t.lineHeight, u = t.fontFamily, f = u === void 0 ? "" : u, c = t.wrapPadding, d = c === void 0 ? "0, 0" : c, h = t.overflowMode, v = i.width, p = i.height, g = i.textHeight, y = o || v, m = String(r).split(/[\r\n]/g), A = m.length, T = u_({
    rows: m,
    style: {
      fontSize: "".concat(s, "px"),
      width: "".concat(y, "px"),
      fontFamily: f,
      lineHeight: l,
      padding: d
    },
    rowsLength: A,
    className: "lf-get-text-height"
  }), k = p > T ? p : T;
  g && (k = g);
  var C = h === "ellipsis";
  return C && (k = s + 2), B("g", { children: B("foreignObject", { width: y, height: k, x: e - y / 2, y: n - k / 2, style: { overflow: "visible", textAlign: "left" }, children: B("div", { className: "lf-node-text-auto-wrap", style: {
    minHeight: k,
    width: y,
    padding: d
  }, children: B("div", { className: C ? "lf-node-text-ellipsis-content" : "lf-node-text-auto-wrap-content", title: C ? m.join("") : "", style: La({}, t), children: m.map(function(S) {
    return B("div", { className: "lf-node-text--auto-wrap-inner", children: S });
  }) }) }) }) });
}
var Sf = function() {
  return Sf = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Sf.apply(this, arguments);
}, HR = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
};
function bo(t) {
  var e = {
    // default
    x1: 10,
    y1: 10,
    x2: 20,
    y2: 20,
    stroke: "black"
    // ...props
  };
  return at(Xr(t), function(n) {
    var r = HR(n, 2), i = r[0], o = r[1];
    (i === "style" || typeof o != "object") && (e[i] = o);
  }), B("line", Sf({}, e));
}
var Of = function() {
  return Of = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Of.apply(this, arguments);
}, WR = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
};
function $n(t) {
  var e = t.x, n = t.y, r = t.width, i = t.height, o = t.className, a = t.strokeWidth, s = t.radius, l = s === void 0 ? 0 : s, u = e - r / 2, f = n - i / 2, c = {};
  return c["stroke-width"] = a, at(Xr(t), function(d) {
    var h = WR(d, 2), v = h[0], p = h[1];
    typeof p != "object" && (c[v] = p);
  }), o ? c.className = "lf-basic-shape ".concat(o) : c.className = "lf-basic-shape", l && (c.rx = l, c.ry = l), c.x = u, c.y = f, B("rect", Of({}, c));
}
var Af = function() {
  return Af = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Af.apply(this, arguments);
}, zR = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
};
function Ia(t) {
  var e = {
    d: ""
  };
  return at(Xr(t), function(n) {
    var r = zR(n, 2), i = r[0], o = r[1];
    (i === "style" || typeof o != "object") && (e[i] = o);
  }), B("path", Af({}, e));
}
var Cf = function() {
  return Cf = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Cf.apply(this, arguments);
}, XR = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
};
function xo(t) {
  var e = t.x, n = e === void 0 ? 0 : e, r = t.y, i = r === void 0 ? 0 : r, o = t.r, a = o === void 0 ? 4 : o, s = t.className, l = {
    cx: n,
    cy: i,
    r: a,
    fill: "transparent",
    fillOpacity: 1,
    strokeWidth: 1,
    stroke: "#000",
    strokeOpacity: 1
  };
  return at(Xr(t), function(u) {
    var f = XR(u, 2), c = f[0], d = f[1];
    typeof d != "object" && (l[c] = d);
  }), s ? l.className = "lf-basic-shape ".concat(s) : l.className = "lf-basic-shape", B("circle", Cf({}, l));
}
var Tf = function() {
  return Tf = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Tf.apply(this, arguments);
}, GR = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
};
function UR(t) {
  var e = t.x, n = e === void 0 ? 0 : e, r = t.y, i = r === void 0 ? 0 : r, o = t.rx, a = o === void 0 ? 4 : o, s = t.ry, l = s === void 0 ? 4 : s, u = t.className, f = {
    cx: n,
    cy: i,
    rx: a,
    ry: l,
    fill: "transparent",
    fillOpacity: 1,
    strokeWidth: 1,
    stroke: "#000",
    strokeOpacity: 1
  };
  return at(Xr(t), function(c) {
    var d = GR(c, 2), h = d[0], v = d[1];
    typeof v != "object" && (f[h] = v);
  }), u ? f.className = "lf-basic-shape ".concat(u) : f.className = "lf-basic-shape", B("ellipse", Tf({}, f));
}
var Nf = function() {
  return Nf = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Nf.apply(this, arguments);
}, YR = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
};
function vd(t) {
  var e = t.points, n = e === void 0 ? [] : e, r = t.className, i = {
    fill: "transparent",
    fillOpacity: 1,
    strokeWidth: 1,
    stroke: "#000",
    strokeOpacity: 1,
    points: ""
  };
  return at(Xr(t), function(o) {
    var a = YR(o, 2), s = a[0], l = a[1];
    typeof l != "object" && (i[s] = l);
  }), r ? i.classNmae = "lf-basic-shape ".concat(r) : i.className = "lf-basic-shape", i.points = n.map(function(o) {
    return o.join(",");
  }).join(" "), B("polygon", Nf({}, i));
}
var Mf = function() {
  return Mf = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Mf.apply(this, arguments);
}, VR = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
};
function KR(t) {
  var e = t.className, n = {
    points: "",
    fill: "none"
  };
  return at(Xr(t), function(r) {
    var i = VR(r, 2), o = i[0], a = i[1];
    (o === "style" || typeof a != "object") && (n[o] = a);
  }), e && (n.className = "".concat(e)), B("polyline", Mf({}, n));
}
var d_ = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), ja = function() {
  return ja = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, ja.apply(this, arguments);
}, qR = function(t, e) {
  var n = {};
  for (var r in t) Object.prototype.hasOwnProperty.call(t, r) && e.indexOf(r) < 0 && (n[r] = t[r]);
  if (t != null && typeof Object.getOwnPropertySymbols == "function")
    for (var i = 0, r = Object.getOwnPropertySymbols(t); i < r.length; i++)
      e.indexOf(r[i]) < 0 && Object.prototype.propertyIsEnumerable.call(t, r[i]) && (n[r[i]] = t[r[i]]);
  return n;
}, ZR = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, ht;
(function(t) {
  t[t.LEFT_TOP = 0] = "LEFT_TOP", t[t.RIGHT_TOP = 1] = "RIGHT_TOP", t[t.RIGHT_BOTTOM = 2] = "RIGHT_BOTTOM", t[t.LEFT_BOTTOM = 3] = "LEFT_BOTTOM";
})(ht || (ht = {}));
var JR = (
  /** @class */
  function(t) {
    d_(e, t);
    function e(n) {
      var r = t.call(this) || this;
      r.updateEdgePointByAnchors = function() {
        var s = r.nodeModel, l = s.id, u = s.anchors, f = r.graphModel.getNodeEdges(l);
        at(f, function(c) {
          if (c.sourceNodeId === l) {
            var d = ai(u, function(h) {
              return h.id === c.sourceAnchorId;
            });
            d && c.updateStartPoint({
              x: d.x,
              y: d.y
            });
          } else if (c.targetNodeId === l) {
            var d = ai(u, function(v) {
              return v.id === c.targetAnchorId;
            });
            d && c.updateEndPoint({
              x: d.x,
              y: d.y
            });
          }
        });
      }, r.triggerResizeEvent = function(s, l, u, f, c, d) {
        r.graphModel.eventCenter.emit(pe.NODE_RESIZE, {
          preData: s,
          data: l,
          deltaX: u,
          deltaY: f,
          index: c,
          model: d
        });
      }, r.recalcResizeInfo = function(s, l, u, f, c) {
        u === void 0 && (u = 1), f === void 0 && (f = !1), c === void 0 && (c = !1);
        var d = Fe(l), h = d.deltaX, v = d.deltaY, p = d.width, g = d.height, y = d.PCTResizeInfo;
        if (y) {
          var m = 4, A = 0, T = 0;
          switch (s) {
            case ht.LEFT_TOP:
              T = (h * -1 - v) / m;
              break;
            case ht.RIGHT_TOP:
              T = (h - v) / m;
              break;
            case ht.RIGHT_BOTTOM:
              T = (h + v) / m;
              break;
            case ht.LEFT_BOTTOM:
              T = (h * -1 + v) / m;
              break;
          }
          T !== 0 && (A = Math.round(T / y.ResizeBasis.basisHeight * 1e5) / 1e3), y.ResizePCT.widthPCT = Math.max(Math.min(y.ResizePCT.widthPCT + A, y.ScaleLimit.maxScaleLimit), y.ScaleLimit.minScaleLimit), y.ResizePCT.heightPCT = Math.max(Math.min(y.ResizePCT.heightPCT + A, y.ScaleLimit.maxScaleLimit), y.ScaleLimit.minScaleLimit);
          var k = Math.round(y.ResizePCT.widthPCT * y.ResizeBasis.basisWidth / 100), C = Math.round(y.ResizePCT.heightPCT * y.ResizeBasis.basisHeight / 100);
          switch (s) {
            case ht.LEFT_TOP:
              h = p - k, v = g - C;
              break;
            case ht.RIGHT_TOP:
              h = k - p, v = g - C;
              break;
            case ht.RIGHT_BOTTOM:
              h = k - p, v = C - g;
              break;
            case ht.LEFT_BOTTOM:
              h = p - k, v = C - g;
              break;
          }
          return d;
        }
        switch (s) {
          case ht.LEFT_TOP:
            d.width = f ? p : p - h * u, d.height = c ? g : g - v * u;
            break;
          case ht.RIGHT_TOP:
            d.width = f ? p : p + h * u, d.height = c ? g : g - v * u;
            break;
          case ht.RIGHT_BOTTOM:
            d.width = f ? p : p + h * u, d.height = c ? g : g + v * u;
            break;
          case ht.LEFT_BOTTOM:
            d.width = f ? p : p - h * u, d.height = c ? g : g + v * u;
            break;
        }
        return d;
      }, r.resizeNode = function(s) {
        var l = s.deltaX, u = s.deltaY, f = r.index, c = r.props, d = c.model, h = c.graphModel, v = c.x, p = c.y;
        h_({
          x: v,
          y: p,
          deltaX: l,
          deltaY: u,
          index: f,
          nodeModel: d,
          graphModel: h,
          cancelCallback: function() {
            r.dragHandler.cancelDrag();
          }
        });
      }, r.onDragging = function(s) {
        var l = s.deltaX, u = s.deltaY, f = r.graphModel.transformModel, c = ZR(f.fixDeltaXY(l, u), 2), d = c[0], h = c[1];
        r.resizeNode({
          deltaX: d,
          deltaY: h
        });
      }, r.onDragEnd = function() {
        var s = r.nodeModel.x, l = r.nodeModel.y;
        r.nodeModel.moveTo(s, l), r.updateEdgePointByAnchors();
      };
      var i = n.index, o = n.model, a = n.graphModel;
      return r.index = i, r.nodeModel = o, r.graphModel = a, r.dragHandler = new Kn({
        onDragging: r.onDragging,
        onDragEnd: r.onDragEnd,
        step: a.gridSize
      }), r;
    }
    return e.prototype.componentWillUnmount = function() {
      this.dragHandler.destroy();
    }, e.prototype.render = function() {
      var n = this.props, r = n.x, i = n.y, o = n.direction, a = n.model, s = a.getResizeControlStyle(), l = s.width, u = s.height, f = qR(s, ["width", "height"]);
      return B("g", { className: "lf-resize-control lf-resize-control-".concat(o), children: [B($n, ja({ className: "lf-resize-control-content", x: r, y: i, width: l ?? 7, height: u ?? 7 }, f)), B($n, { className: "lf-resize-control-content", x: r, y: i, width: 25, height: 25, fill: "transparent", stroke: "transparent", onMouseDown: this.dragHandler.handleMouseDown })] });
    }, e;
  }(Ye)
), QR = (
  /** @class */
  function(t) {
    d_(e, t);
    function e() {
      return t.call(this) || this;
    }
    return e.prototype.getResizeControl = function() {
      var n = this.props, r = n.model, i = n.graphModel, o = gn(r), a = o.minX, s = o.minY, l = o.maxX, u = o.maxY, f = [
        {
          index: ht.LEFT_TOP,
          direction: "nw",
          x: a,
          y: s
        },
        // 左上角
        {
          index: ht.RIGHT_TOP,
          direction: "ne",
          x: l,
          y: s
        },
        // 右上角
        {
          index: ht.RIGHT_BOTTOM,
          direction: "se",
          x: l,
          y: u
        },
        // 右下角
        {
          index: ht.LEFT_BOTTOM,
          direction: "sw",
          x: a,
          y: u
        }
        // 左下角
      ];
      return Dn(f, function(c) {
        return B(JR, ja({}, c, { model: r, graphModel: i }));
      });
    }, e.prototype.getResizeOutline = function() {
      var n = this.props.model, r = n.x, i = n.y, o = n.width, a = n.height, s = n.getResizeOutlineStyle();
      return B($n, ja({}, s, { x: r, y: i, width: o, height: a }));
    }, e.prototype.render = function() {
      return B("g", { className: "lf-resize-control-group", children: [this.getResizeOutline(), this.getResizeControl()] });
    }, e;
  }(Ye)
);
function eL(t, e) {
  var n = t.x, r = t.y, i = e.x, o = e.y, a = {
    x: n + (i - n) / 2,
    y: r + (o - r) / 2
  };
  return a;
}
function oa(t, e, n) {
  var r = tL(n), i = t.x - e.x, o = t.y - e.y, a = i * Math.cos(r) - o * Math.sin(r) + e.x, s = i * Math.sin(r) + o * Math.cos(r) + e.y;
  return {
    x: a,
    y: s
  };
}
function tL(t) {
  return t * Math.PI / 180;
}
function nL(t) {
  return t / Math.PI * 180;
}
function rL(t, e, n, r, i, o, a, s, l) {
  s === void 0 && (s = !1), l === void 0 && (l = !1);
  var u = e.deltaX, f = e.deltaY, c = e.width, d = e.height, h = nL(n), v = {
    x: r,
    // control锚点的坐标x
    y: i
    // control锚点的坐标y
  }, p = { x: o, y: a }, g = oa(v, p, h), y = {
    x: g.x + u,
    y: g.y + f
  }, m = sL(g, y, p, h, s, l, c, d), A = m.width, T = m.height, k = m.center;
  return e.width = A * t, e.height = T * t, e.deltaX = (k.x - p.x) * 2, e.deltaY = (k.y - p.y) * 2, e;
}
var iL = function(t, e, n, r, i, o, a, s, l, u) {
  n === void 0 && (n = 1), r === void 0 && (r = !1), i === void 0 && (i = !1), o === void 0 && (o = 0);
  var f = Fe(e), c = f.deltaX, d = f.deltaY, h = f.width, v = f.height, p = f.PCTResizeInfo;
  if (p) {
    var g = 4, y = 0, m = 0;
    switch (t) {
      case ht.LEFT_TOP:
        m = (c * -1 - d) / g;
        break;
      case ht.RIGHT_TOP:
        m = (c - d) / g;
        break;
      case ht.RIGHT_BOTTOM:
        m = (c + d) / g;
        break;
      case ht.LEFT_BOTTOM:
        m = (c * -1 + d) / g;
        break;
    }
    m !== 0 && (y = Math.round(m / p.ResizeBasis.basisHeight * 1e5) / 1e3), p.ResizePCT.widthPCT = Math.max(Math.min(p.ResizePCT.widthPCT + y, p.ScaleLimit.maxScaleLimit), p.ScaleLimit.minScaleLimit), p.ResizePCT.heightPCT = Math.max(Math.min(p.ResizePCT.heightPCT + y, p.ScaleLimit.maxScaleLimit), p.ScaleLimit.minScaleLimit);
    var A = Math.round(p.ResizePCT.widthPCT * p.ResizeBasis.basisWidth / 100), T = Math.round(p.ResizePCT.heightPCT * p.ResizeBasis.basisHeight / 100);
    switch (t) {
      case ht.LEFT_TOP:
        c = h - A, d = v - T;
        break;
      case ht.RIGHT_TOP:
        c = A - h, d = v - T;
        break;
      case ht.RIGHT_BOTTOM:
        c = A - h, d = T - v;
        break;
      case ht.LEFT_BOTTOM:
        c = h - A, d = T - v;
        break;
    }
    return f;
  }
  if (o % (2 * Math.PI) !== 0 && a !== void 0 && s !== void 0)
    return rL(n, f, o, a, s, l, u, r, i);
  switch (t) {
    case ht.LEFT_TOP:
      f.width = r ? h : h - c * n, f.height = i ? v : v - d * n;
      break;
    case ht.RIGHT_TOP:
      f.width = r ? h : h + c * n, f.height = i ? v : v - d * n;
      break;
    case ht.RIGHT_BOTTOM:
      f.width = r ? h : h + c * n, f.height = i ? v : v + d * n;
      break;
    case ht.LEFT_BOTTOM:
      f.width = r ? h : h - c * n, f.height = i ? v : v + d * n;
      break;
  }
  return f;
}, oL = function(t, e) {
  var n = t.id, r = t.anchors, i = e.getNodeEdges(n);
  at(i, function(o) {
    if (o.sourceNodeId === n) {
      var a = ai(r, function(s) {
        return s.id === o.sourceAnchorId;
      });
      a && o.updateStartPoint({
        x: a.x,
        y: a.y
      });
    } else if (o.targetNodeId === n) {
      var a = ai(r, function(l) {
        return l.id === o.targetAnchorId;
      });
      a && o.updateEndPoint({
        x: a.x,
        y: a.y
      });
    }
  });
}, aL = function(t, e, n, r, i, o, a) {
  a.eventCenter.emit(pe.NODE_RESIZE, {
    preData: t,
    data: e,
    deltaX: n,
    deltaY: r,
    index: i,
    model: o
  });
}, h_ = function(t) {
  var e = t.x, n = t.y, r = t.deltaX, i = t.deltaY, o = t.index, a = t.nodeModel, s = t.graphModel, l = t.cancelCallback, u = a.r, f = a.rx, c = a.ry, d = a.width, h = a.height, v = a.PCTResizeInfo, p = a.minWidth, g = a.minHeight, y = a.maxWidth, m = a.maxHeight, A = a.rotate, T = a.x, k = a.y, C = p === y, S = g === m, I = {
    width: u || f || d,
    height: u || c || h,
    deltaX: r,
    deltaY: i,
    PCTResizeInfo: v
  }, X = u || f && c ? 1 / 2 : 1, Q = e, ue = n, de = iL(o, I, X, C, S, A, Q, ue, T, k);
  if (de.width < p || de.width > y || de.height < g || de.height > m) {
    l == null || l();
    return;
  }
  (A % (2 * Math.PI) == 0 || v || Q === void 0 || ue === void 0) && (de.deltaX = C ? 0 : de.deltaX, de.deltaY = S ? 0 : de.deltaY);
  var w = a.getData(), D = a.resize(de);
  w.x === D.x && w.y === D.y || (oL(a, s), aL(w, D, r, i, o, a, s));
};
function sL(t, e, n, r, i, o, a, s) {
  i === void 0 && (i = !1), o === void 0 && (o = !1);
  var l = {
    x: n.x - (t.x - n.x),
    y: n.y - (t.y - n.y)
  }, u = eL(l, e), f = oa(e, u, -r), c = oa(l, u, -r);
  if (i) {
    var d = Math.abs(f.x - c.x), h = d - a;
    u.x > f.x ? u.x = u.x + h / 2 : u.x = u.x - h / 2;
  }
  if (o) {
    var v = Math.abs(f.y - c.y), p = v - s;
    u.y > f.y ? u.y = u.y + p / 2 : u.y = u.y - p / 2;
  }
  if (i || o) {
    var g = oa(c, u, r), y = g.x - l.x, m = g.y - l.y;
    u.x = u.x - y, u.y = u.y - m, c = oa(l, u, -r), f = {
      x: u.x - (c.x - u.x),
      y: u.y - (c.y - u.y)
    };
  }
  var A = Math.abs(f.x - c.x), T = Math.abs(f.y - c.y);
  return i && (A = a), o && (T = s), {
    width: A,
    height: T,
    center: u
  };
}
var lL = 100, uL = {
  x: 1,
  y: 0
};
function fL(t, e, n, r, i) {
  for (var o = function(h) {
    if (h < 0 || h > 1)
      throw new RangeError('The value range of parameter "t" is [0,1]');
    return {
      x: t.x * Math.pow(1 - h, 3) + 3 * e.x * h * Math.pow(1 - h, 2) + 3 * n.x * Math.pow(h, 2) * (1 - h) + r.x * Math.pow(h, 3),
      y: t.y * Math.pow(1 - h, 3) + 3 * e.y * h * Math.pow(1 - h, 2) + 3 * n.y * Math.pow(h, 2) * (1 - h) + r.y * Math.pow(h, 3)
    };
  }, a = 0, s = 2, l = r.x, u = r.y, f = r; a < i && s < 50; ) {
    f = o(1 - s / lL);
    var c = f.x, d = f.y;
    a = ar(l, u, c, d), s++;
  }
  return f;
}
function cL(t, e) {
  return t.x * e.y - t.y * e.x;
}
function dL(t, e) {
  var n = [t.x, t.y, t.z], r = [e.x, e.y, e.z];
  return r.reduce(function(i, o, a) {
    return i + o * n[a];
  });
}
function hL(t, e) {
  var n = cL(t, e), r = Math.acos(dL(Lp(t), Lp(e)));
  return n >= 0 ? r : -r;
}
function Lp(t) {
  var e = Math.hypot(t.x, t.y);
  return {
    x: t.x / e,
    y: t.y / e,
    z: 0
  };
}
function pL(t) {
  return hL(uL, t);
}
function vL(t) {
  return t * (180 / Math.PI);
}
var gL = {
  baseNode: {
    fill: "#fff",
    stroke: "#000",
    strokeWidth: 2
  },
  baseEdge: {
    stroke: "#000",
    strokeWidth: 2
  },
  rect: {},
  circle: {},
  diamond: {},
  ellipse: {},
  polygon: {},
  text: {
    color: "#000",
    stroke: "none",
    fontSize: 12,
    background: {
      fill: "transparent"
    }
  },
  anchor: {
    stroke: "#000",
    fill: "#fff",
    r: 4,
    hover: {
      r: 10,
      fill: "#949494",
      fillOpacity: 0.5,
      stroke: "#949494"
    }
  },
  anchorLine: {
    stroke: "#000",
    strokeWidth: 2,
    strokeDasharray: "3,2"
  },
  nodeText: {
    color: "#000",
    overflowMode: "default",
    fontSize: 12,
    lineHeight: 1.2
  },
  edgeText: {
    textWidth: 100,
    overflowMode: "default",
    fontSize: 12,
    background: {
      fill: "#fff"
    }
  },
  line: {},
  polyline: {},
  bezier: {
    fill: "none",
    adjustLine: {
      stroke: "#949494"
    },
    adjustAnchor: {
      r: 4,
      fill: "#949494",
      fillOpacity: 1,
      stroke: "#949494"
    }
  },
  arrow: {
    offset: 10,
    verticalLength: 5
    // 箭头垂直于边的距离
  },
  snapline: {
    stroke: "#949494",
    strokeWidth: 1
  },
  edgeAdjust: {
    r: 4,
    fill: "#fff",
    stroke: "#949494",
    strokeWidth: 2
  },
  outline: {
    fill: "transparent",
    stroke: "#949494",
    strokeDasharray: "3,3",
    hover: {
      stroke: "#949494"
    }
  },
  edgeAnimation: {
    stroke: "red",
    strokeDasharray: "10,10",
    strokeDashoffset: "100%",
    animationName: "lf_animate_dash",
    animationDuration: "20s",
    animationIterationCount: "infinite",
    animationTimingFunction: "linear",
    animationDirection: "normal"
  },
  rotateControl: {
    stroke: "#000",
    fill: "#fff",
    strokeWidth: 1.5
  },
  resizeControl: {
    width: 7,
    height: 7,
    fill: "#fff",
    stroke: "#000"
  },
  resizeOutline: {
    fill: "none",
    stroke: "transparent",
    // 矩形默认不显示调整边框
    strokeWidth: 1,
    strokeDasharray: "3,3"
  }
}, p_ = function(t) {
  var e = Fe(gL);
  return t && (e = mo(e, t)), e;
}, yL = p_, mL = 1e3, _L = 999, gd = function() {
  return ++mL;
}, bL = function() {
  return --_L;
}, Pt = function() {
  return Pt = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Pt.apply(this, arguments);
}, xe = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, lu = (
  /** @class */
  function() {
    function t(e, n) {
      var r;
      this.BaseType = At.EDGE, this.id = "", this.type = "", this.sourceNodeId = "", this.targetNodeId = "", this.textMode = zn.TEXT, this.text = {
        value: "",
        x: 0,
        y: 0,
        draggable: !1,
        editable: !0
      }, this.points = "", this.pointsList = [], this.virtual = !1, this.isSelected = !1, this.isHovered = !1, this.isHitable = !0, this.isHittable = !0, this.draggable = !0, this.visible = !0, this.isAnimation = !1, this.isShowAdjustPoint = !1, this.zIndex = 0, this.state = Qe.DEFAULT, this.modelType = $e.EDGE, this.customTextPosition = !1, this.style = {}, this.arrowConfig = {
        markerEnd: "url(#marker-end-".concat(this.id, ")"),
        markerStart: "url(#marker-start-".concat(this.id, ")")
      }, this.graphModel = n, this.properties = (r = e.properties) !== null && r !== void 0 ? r : {}, this.initEdgeData(e), this.setAttributes();
    }
    return t.prototype.initEdgeData = function(e) {
      if (e.properties || (e.properties = {}), !e.id) {
        var n = this.graphModel.idGenerator, r = n && n(e.type), i = this.createId();
        e.id = i || r || ti();
      }
      this.arrowConfig.markerEnd = "url(#marker-end-".concat(e.id, ")"), this.arrowConfig.markerStart = "url(#marker-start-".concat(e.id, ")");
      var o = this.graphModel.editConfigModel.adjustEdgeStartAndEnd;
      this.isShowAdjustPoint = o, ut(this, wR(e));
      var a = this.graphModel.overlapMode;
      a === or.INCREASE && (this.zIndex = e.zIndex || gd()), this.setAnchors(), this.initPoints(), this.formatText(e);
    }, t.prototype.setAttributes = function() {
    }, t.prototype.createId = function() {
      return null;
    }, t.prototype.getEdgeStyle = function() {
      return Pt(Pt({}, this.graphModel.theme.baseEdge), this.style);
    }, t.prototype.getAdjustPointStyle = function() {
      return Pt({}, this.graphModel.theme.edgeAdjust);
    }, t.prototype.getTextStyle = function() {
      var e = this.graphModel.theme.edgeText;
      return Fe(e);
    }, t.prototype.getEdgeAnimationStyle = function() {
      var e = this.graphModel.theme.edgeAnimation;
      return Fe(e);
    }, t.prototype.getArrowStyle = function() {
      var e = this.getEdgeStyle(), n = this.getEdgeAnimationStyle(), r = this.graphModel.theme.arrow, i = this.isAnimation ? n.stroke : e.stroke;
      return Pt(Pt(Pt({}, e), { fill: i, stroke: i }), r);
    }, t.prototype.getOutlineStyle = function() {
      var e = this.graphModel, n = e.theme.outline;
      return Fe(n);
    }, t.prototype.getTextPosition = function() {
      return {
        x: 0,
        y: 0
      };
    }, Object.defineProperty(t.prototype, "sourceNode", {
      /**
       * 边的前一个节点
       */
      get: function() {
        var e, n;
        return (n = (e = this.graphModel) === null || e === void 0 ? void 0 : e.nodesMap[this.sourceNodeId]) === null || n === void 0 ? void 0 : n.model;
      },
      enumerable: !1,
      configurable: !0
    }), Object.defineProperty(t.prototype, "targetNode", {
      /**
       * 边的后一个节点
       */
      get: function() {
        var e, n;
        return (n = (e = this.graphModel) === null || e === void 0 ? void 0 : e.nodesMap[this.targetNodeId]) === null || n === void 0 ? void 0 : n.model;
      },
      enumerable: !1,
      configurable: !0
    }), Object.defineProperty(t.prototype, "textPosition", {
      get: function() {
        return this.getTextPosition();
      },
      enumerable: !1,
      configurable: !0
    }), t.prototype.getBeginAnchor = function(e, n, r) {
      var i, o, a = Ef(e);
      if (r) {
        if (i = ai(a, function(s) {
          return s.id === r;
        }), i)
          return i;
        console.warn("未在节点上找到指定的起点锚点".concat(r, "，已使用默认锚点作为起点"));
      }
      return a.forEach(function(s) {
        var l = Ap(s, n);
        (o === void 0 || l < o) && (o = l, i = s);
      }), i;
    }, t.prototype.getEndAnchor = function(e, n) {
      var r = this, i, o, a = Ef(e);
      if (n) {
        if (i = ai(a, function(s) {
          return s.id === n;
        }), i)
          return i;
        console.warn("未在节点上找到指定的终点锚点".concat(n, "，已使用默认锚点作为终点"));
      }
      return a.forEach(function(s) {
        if (r.startPoint) {
          var l = Ap(s, r.startPoint);
          (o === void 0 || l < o) && (o = l, i = s);
        }
      }), i;
    }, t.prototype.getProperties = function() {
      return tr(this.properties);
    }, t.prototype.getData = function() {
      var e = this.properties;
      ni(e) && (e = tr(e));
      var n = {
        id: this.id,
        type: this.type,
        properties: e,
        sourceNodeId: this.sourceNodeId,
        targetNodeId: this.targetNodeId,
        sourceAnchorId: this.sourceAnchorId,
        targetAnchorId: this.targetAnchorId,
        startPoint: ut({}, this.startPoint),
        endPoint: ut({}, this.endPoint)
      };
      this.graphModel.overlapMode === or.INCREASE && (n.zIndex = this.zIndex);
      var r = this.text, i = r.x, o = r.y, a = r.value;
      return a && (n.text = {
        x: i,
        y: o,
        value: a
      }), n;
    }, t.prototype.getHistoryData = function() {
      return this.getData();
    }, t.prototype.setProperty = function(e, n) {
      vc(this.properties, e, en(n)), this.setAttributes();
    }, t.prototype.deleteProperty = function(e) {
      delete this.properties[e], this.setAttributes();
    }, t.prototype.setProperties = function(e) {
      this.properties = Pt(Pt({}, tr(this.properties)), en(e)), this.setAttributes();
    }, t.prototype.changeEdgeId = function(e) {
      var n = this.arrowConfig, r = n.markerEnd, i = n.markerStart;
      i && i === "url(#marker-start-".concat(this.id, ")") && (this.arrowConfig.markerStart = "url(#marker-start-".concat(e, ")")), r && r === "url(#marker-end-".concat(this.id, ")") && (this.arrowConfig.markerEnd = "url(#marker-end-".concat(e, ")")), this.id = e;
    }, t.prototype.setStyle = function(e, n) {
      var r;
      this.style = Pt(Pt({}, this.style), (r = {}, r[e] = en(n), r));
    }, t.prototype.setStyles = function(e) {
      this.style = Pt(Pt({}, this.style), en(e));
    }, t.prototype.updateStyles = function(e) {
      this.style = Pt({}, en(e));
    }, t.prototype.setTextMode = function(e) {
      this.textMode = e;
    }, t.prototype.formatText = function(e) {
      var n, r, i, o = this.graphModel.editConfigModel, a = o.edgeTextDraggable, s = o.edgeTextEdit, l = this.textPosition, u = l.x, f = l.y, c = e.text, d = {
        value: "",
        x: u,
        y: f,
        draggable: a,
        editable: s
      };
      c && (typeof c == "string" ? d = Pt(Pt({}, d), { value: c }) : (d = Pt(Pt({}, d), { x: (n = c.x) !== null && n !== void 0 ? n : u, y: (r = c.y) !== null && r !== void 0 ? r : f, value: (i = c.value) !== null && i !== void 0 ? i : "" }), ji(c.draggable) || (d.draggable = c.draggable), ji(c.editable) || (d.editable = c.editable))), this.text = d;
    }, t.prototype.resetTextPosition = function() {
      var e = this.textPosition, n = e.x, r = e.y;
      this.text.x = n, this.text.y = r;
    }, t.prototype.moveText = function(e, n) {
      var r = this.text, i = r.x, o = r.y, a = r.value, s = r.draggable, l = r.editable;
      this.text = {
        value: a,
        editable: l,
        draggable: s,
        x: i + e,
        y: o + n
      };
    }, t.prototype.setText = function(e) {
      e && ut(this.text, e);
    }, t.prototype.updateText = function(e) {
      this.text = Pt(Pt({}, tr(this.text)), { value: e });
    }, t.prototype.setAnchors = function() {
      if (!this.sourceAnchorId || !this.startPoint) {
        var e = this.getBeginAnchor(this.sourceNode, this.targetNode, this.sourceAnchorId);
        if (!e)
          throw new Error("无法获取beginAnchor，请检查anchors相关逻辑，anchors不能为空");
        this.startPoint || (this.startPoint = {
          x: e.x,
          y: e.y
        }), this.sourceAnchorId || (this.sourceAnchorId = e.id);
      }
      if (!this.targetAnchorId || !this.endPoint) {
        var e = this.getEndAnchor(this.targetNode, this.targetAnchorId);
        if (!e)
          throw new Error("无法获取endAnchor，请检查anchors相关逻辑，anchors不能为空");
        this.endPoint || (this.endPoint = {
          x: e.x,
          y: e.y
        }), this.targetAnchorId || (this.targetAnchorId = e.id);
      }
    }, t.prototype.setSelected = function(e) {
      e === void 0 && (e = !0), this.isSelected = e;
    }, t.prototype.setHovered = function(e) {
      e === void 0 && (e = !0), this.isHovered = e;
    }, t.prototype.setHitable = function(e) {
      e === void 0 && (e = !0), this.isHitable = e;
    }, t.prototype.setHittable = function(e) {
      e === void 0 && (e = !0), this.isHittable = e;
    }, t.prototype.openEdgeAnimation = function() {
      this.isAnimation = !0;
    }, t.prototype.closeEdgeAnimation = function() {
      this.isAnimation = !1;
    }, t.prototype.setElementState = function(e, n) {
      this.state = e, this.additionStateData = n;
    }, t.prototype.updateStartPoint = function(e) {
      this.startPoint = e;
    }, t.prototype.moveStartPoint = function(e, n) {
      this.startPoint && (this.startPoint.x += e, this.startPoint.y += n);
    }, t.prototype.updateEndPoint = function(e) {
      this.endPoint = e;
    }, t.prototype.moveEndPoint = function(e, n) {
      this.endPoint && (this.endPoint.x += e, this.endPoint.y += n);
    }, t.prototype.setZIndex = function(e) {
      e === void 0 && (e = 0), this.zIndex = e;
    }, t.prototype.initPoints = function() {
    }, t.prototype.updateAttributes = function(e) {
      ut(this, e);
    }, t.prototype.getAdjustStart = function() {
      return this.startPoint;
    }, t.prototype.getAdjustEnd = function() {
      return this.endPoint;
    }, t.prototype.updateAfterAdjustStartAndEnd = function(e) {
      var n = e.startPoint, r = e.endPoint;
      this.updateStartPoint({ x: n.x, y: n.y }), this.updateEndPoint({ x: r.x, y: r.y });
    }, t.BaseType = At.EDGE, xe([
      H
    ], t.prototype, "type", void 0), xe([
      H
    ], t.prototype, "sourceNodeId", void 0), xe([
      H
    ], t.prototype, "targetNodeId", void 0), xe([
      H
    ], t.prototype, "startPoint", void 0), xe([
      H
    ], t.prototype, "endPoint", void 0), xe([
      H
    ], t.prototype, "textMode", void 0), xe([
      H
    ], t.prototype, "text", void 0), xe([
      H
    ], t.prototype, "properties", void 0), xe([
      H
    ], t.prototype, "points", void 0), xe([
      H
    ], t.prototype, "pointsList", void 0), xe([
      H
    ], t.prototype, "isSelected", void 0), xe([
      H
    ], t.prototype, "isHovered", void 0), xe([
      H
    ], t.prototype, "isHitable", void 0), xe([
      H
    ], t.prototype, "isHittable", void 0), xe([
      H
    ], t.prototype, "draggable", void 0), xe([
      H
    ], t.prototype, "visible", void 0), xe([
      H
    ], t.prototype, "isAnimation", void 0), xe([
      H
    ], t.prototype, "isShowAdjustPoint", void 0), xe([
      H
    ], t.prototype, "zIndex", void 0), xe([
      H
    ], t.prototype, "state", void 0), xe([
      H
    ], t.prototype, "style", void 0), xe([
      H
    ], t.prototype, "arrowConfig", void 0), xe([
      yt
    ], t.prototype, "sourceNode", null), xe([
      yt
    ], t.prototype, "targetNode", null), xe([
      yt
    ], t.prototype, "textPosition", null), xe([
      F
    ], t.prototype, "setProperty", null), xe([
      F
    ], t.prototype, "deleteProperty", null), xe([
      F
    ], t.prototype, "setProperties", null), xe([
      F
    ], t.prototype, "changeEdgeId", null), xe([
      F
    ], t.prototype, "setStyle", null), xe([
      F
    ], t.prototype, "setStyles", null), xe([
      F
    ], t.prototype, "updateStyles", null), xe([
      F
    ], t.prototype, "setTextMode", null), xe([
      F
    ], t.prototype, "formatText", null), xe([
      F
    ], t.prototype, "resetTextPosition", null), xe([
      F
    ], t.prototype, "moveText", null), xe([
      F
    ], t.prototype, "setText", null), xe([
      F
    ], t.prototype, "updateText", null), xe([
      F
    ], t.prototype, "setAnchors", null), xe([
      F
    ], t.prototype, "setSelected", null), xe([
      F
    ], t.prototype, "setHovered", null), xe([
      F
    ], t.prototype, "setHitable", null), xe([
      F
    ], t.prototype, "setHittable", null), xe([
      F
    ], t.prototype, "openEdgeAnimation", null), xe([
      F
    ], t.prototype, "closeEdgeAnimation", null), xe([
      F
    ], t.prototype, "setElementState", null), xe([
      F
    ], t.prototype, "updateStartPoint", null), xe([
      F
    ], t.prototype, "moveStartPoint", null), xe([
      F
    ], t.prototype, "updateEndPoint", null), xe([
      F
    ], t.prototype, "moveEndPoint", null), xe([
      F
    ], t.prototype, "setZIndex", null), xe([
      F
    ], t.prototype, "initPoints", null), xe([
      F
    ], t.prototype, "updateAttributes", null), xe([
      F
    ], t.prototype, "getAdjustStart", null), xe([
      F
    ], t.prototype, "getAdjustEnd", null), xe([
      F
    ], t.prototype, "updateAfterAdjustStartAndEnd", null), t;
  }()
), xL = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), Si = function() {
  return Si = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Si.apply(this, arguments);
}, Zn = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, Cu = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, Ip = (
  /** @class */
  function(t) {
    xL(e, t);
    function e(n, r) {
      var i = t.call(this, n, r) || this;
      return i.modelType = $e.BEZIER_EDGE, i.path = "", i.initEdgeData(n), i.setAttributes(), i;
    }
    return e.prototype.initEdgeData = function(n) {
      this.offset = 100, t.prototype.initEdgeData.call(this, n);
    }, e.prototype.getEdgeStyle = function() {
      var n = this.graphModel.theme.bezier, r = t.prototype.getEdgeStyle.call(this), i = this.properties.style, o = i === void 0 ? {} : i;
      return Si(Si(Si({}, r), Fe(n)), Fe(o));
    }, e.prototype.getTextPosition = function() {
      if (this.pointsList && this.pointsList.length > 0) {
        var n = 0, r = 0;
        return this.pointsList.forEach(function(i) {
          var o = i.x, a = i.y;
          n += o, r += a;
        }), {
          x: n / this.pointsList.length,
          y: r / this.pointsList.length
        };
      }
      return {
        x: (this.startPoint.x + this.endPoint.x) / 2,
        y: (this.startPoint.y + this.endPoint.y) / 2
      };
    }, e.prototype.getData = function() {
      var n = t.prototype.getData.call(this), r = this.pointsList.map(function(i) {
        var o = i.x, a = i.y;
        return { x: o, y: a };
      });
      return Si(Si({}, n), { pointsList: r });
    }, e.prototype.getControls = function() {
      var n = this.startPoint, r = this.endPoint, i = Sp({
        start: n,
        end: r,
        sourceNode: this.sourceNode,
        targetNode: this.targetNode,
        offset: this.offset
      });
      return i;
    }, e.prototype.getPath = function(n) {
      var r = Cu(n, 4), i = r[0], o = r[1], a = r[2], s = r[3];
      return "M ".concat(i.x, " ").concat(i.y, `
    C `).concat(o.x, " ").concat(o.y, `,
    `).concat(a.x, " ").concat(a.y, `,
    `).concat(s.x, " ").concat(s.y);
    }, e.prototype.initPoints = function() {
      this.pointsList.length > 0 ? this.path = this.getPath(this.pointsList) : this.updatePoints();
    }, e.prototype.updatePoints = function() {
      var n = this.getControls(), r = n.sNext, i = n.ePre;
      this.updatePath(r, i);
    }, e.prototype.updatePath = function(n, r) {
      n = Fe(n), r = Fe(r);
      var i = {
        x: this.startPoint.x,
        y: this.startPoint.y
      }, o = {
        x: this.endPoint.x,
        y: this.endPoint.y
      };
      if (!n || !r) {
        var a = this.getControls();
        n = a.sNext, r = a.ePre;
      }
      this.pointsList = [i, n, r, o], this.path = this.getPath(this.pointsList);
    }, e.prototype.updateStartPoint = function(n) {
      this.startPoint = Object.assign({}, n), this.updatePoints();
    }, e.prototype.updateEndPoint = function(n) {
      this.endPoint = Object.assign({}, n), this.updatePoints();
    }, e.prototype.moveStartPoint = function(n, r) {
      this.startPoint.x += n, this.startPoint.y += r;
      var i = Cu(this.pointsList, 3), o = i[1], a = i[2];
      o.x += n, o.y += r, this.updatePath(o, a);
    }, e.prototype.moveEndPoint = function(n, r) {
      this.endPoint.x += n, this.endPoint.y += r;
      var i = Cu(this.pointsList, 3), o = i[1], a = i[2];
      a.x += n, a.y += r, this.updatePath(o, a);
    }, e.prototype.updateAdjustAnchor = function(n, r) {
      var i;
      r === "sNext" ? this.pointsList[1] = n : r === "ePre" && (this.pointsList[2] = n), this.path = this.getPath(this.pointsList), !((i = this.text) === null || i === void 0) && i.value && this.setText(ut({}, this.text, this.textPosition));
    }, e.prototype.getAdjustStart = function() {
      return this.pointsList[0] || this.startPoint;
    }, e.prototype.getAdjustEnd = function() {
      var n = this.pointsList;
      return n[n.length - 1] || this.endPoint;
    }, e.prototype.updateAfterAdjustStartAndEnd = function(n) {
      var r = n.startPoint, i = n.endPoint, o = n.sourceNode, a = n.targetNode, s = Sp({
        start: r,
        end: i,
        sourceNode: o,
        targetNode: a,
        offset: this.offset
      }), l = s.sNext, u = s.ePre;
      this.pointsList = [r, l, u, i], this.initPoints();
    }, Zn([
      H
    ], e.prototype, "path", void 0), Zn([
      F
    ], e.prototype, "initPoints", null), Zn([
      F
    ], e.prototype, "updatePoints", null), Zn([
      F
    ], e.prototype, "updateStartPoint", null), Zn([
      F
    ], e.prototype, "updateEndPoint", null), Zn([
      F
    ], e.prototype, "moveStartPoint", null), Zn([
      F
    ], e.prototype, "moveEndPoint", null), Zn([
      F
    ], e.prototype, "updateAdjustAnchor", null), Zn([
      F
    ], e.prototype, "getAdjustStart", null), Zn([
      F
    ], e.prototype, "getAdjustEnd", null), Zn([
      F
    ], e.prototype, "updateAfterAdjustStartAndEnd", null), e;
  }(lu)
), EL = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), ua = function() {
  return ua = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, ua.apply(this, arguments);
}, jp = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, wL = function(t, e, n) {
  if (n || arguments.length === 2) for (var r = 0, i = e.length, o; r < i; r++)
    (o || !(r in e)) && (o || (o = Array.prototype.slice.call(e, 0, r)), o[r] = e[r]);
  return t.concat(o || Array.prototype.slice.call(e));
}, kp = (
  /** @class */
  function(t) {
    EL(e, t);
    function e() {
      var n = t.apply(this, wL([], jp(arguments), !1)) || this;
      return n.modelType = $e.LINE_EDGE, n;
    }
    return e.prototype.getEdgeStyle = function() {
      var n = this.graphModel.theme.line, r = t.prototype.getEdgeStyle.call(this), i = this.properties.style, o = i === void 0 ? {} : i;
      return ua(ua(ua({}, r), Fe(n)), Fe(o));
    }, e.prototype.initEdgeData = function(n) {
      t.prototype.initEdgeData.call(this, n), this.points = this.getPath([this.startPoint, this.endPoint]);
    }, e.prototype.getPath = function(n) {
      var r = jp(n, 2), i = r[0], o = r[1];
      return "".concat(i.x, ",").concat(i.y, " ").concat(o.x, ",").concat(o.y);
    }, e.prototype.getTextPosition = function() {
      return {
        x: (this.startPoint.x + this.endPoint.x) / 2,
        y: (this.startPoint.y + this.endPoint.y) / 2
      };
    }, e;
  }(lu)
), SL = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), fa = function() {
  return fa = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, fa.apply(this, arguments);
}, Zt = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, Bp = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, OL = function(t, e, n) {
  if (n || arguments.length === 2) for (var r = 0, i = e.length, o; r < i; r++)
    (o || !(r in e)) && (o || (o = Array.prototype.slice.call(e, 0, r)), o[r] = e[r]);
  return t.concat(o || Array.prototype.slice.call(e));
}, Eo = (
  /** @class */
  function(t) {
    SL(e, t);
    function e() {
      var n = t.apply(this, OL([], Bp(arguments), !1)) || this;
      return n.modelType = $e.POLYLINE_EDGE, n.draggingPointList = [], n;
    }
    return e.prototype.initEdgeData = function(n) {
      this.offset = 30, n.pointsList && (this.pointsList = n.pointsList), t.prototype.initEdgeData.call(this, n);
    }, e.prototype.getEdgeStyle = function() {
      var n = this.graphModel.theme.polyline, r = t.prototype.getEdgeStyle.call(this), i = this.properties.style, o = i === void 0 ? {} : i;
      return fa(fa(fa({}, r), Fe(n)), Fe(o));
    }, e.prototype.getTextPosition = function() {
      var n, r = (n = this.text) === null || n === void 0 ? void 0 : n.value;
      if (this.dbClickPosition && !r) {
        var i = this.dbClickPosition, o = i.x, a = i.y;
        return { x: o, y: a };
      }
      var s = ki(this.points), l = Bp(bR(s), 2), u = l[0], f = l[1];
      return {
        x: (u.x + f.x) / 2,
        y: (u.y + f.y) / 2
      };
    }, e.prototype.getAfterAnchor = function(n, r, i) {
      var o, a;
      return i.forEach(function(s) {
        var l;
        n === bt.HORIZONTAL ? l = Math.abs(r.y - s.y) : n === bt.VERTICAL && (l = Math.abs(r.x - s.x)), (!a || a > l) && (a = l, o = s);
      }), o;
    }, e.prototype.getCrossPoint = function(n, r, i) {
      var o;
      return n === bt.HORIZONTAL ? o = {
        x: i.x,
        y: r.y
      } : n === bt.VERTICAL && (o = {
        x: r.x,
        y: i.y
      }), o;
    }, e.prototype.removeCrossPoints = function(n, r, i) {
      var o = i.map(function(y) {
        return y;
      });
      if (n === 1) {
        var a = o[n], s = o[r], l = o[n - 1], u = bp(l, a, this.sourceNode);
        if (u) {
          var f = xp(a, s, this.sourceNode);
          if (f) {
            var c = Ep(a, s, this.sourceNode);
            c && (o[n] = c, o.splice(n - 1, 1), n--, r--);
          }
        } else {
          var d = this.sourceNode.anchors;
          d.forEach(function(y) {
            if (y.x === l.x && y.x === a.x || y.y === l.y && y.y === a.y) {
              var m = ar(y.x, y.y, a.x, a.y), A = ar(l.x, l.y, a.x, a.y);
              m < A && (o[n - 1] = y);
            }
          });
        }
      }
      if (r === i.length - 2) {
        var h = o[n], v = o[r], p = o[r + 1], g = bp(v, p, this.targetNode);
        if (g) {
          var f = xp(h, v, this.targetNode);
          if (f) {
            var c = Ep(h, v, this.targetNode);
            c && (o[r] = c, o.splice(r + 1, 1));
          }
        } else {
          var d = this.targetNode.anchors;
          d.forEach(function(m) {
            if (m.x === p.x && m.x === v.x || m.y === p.y && m.y === v.y) {
              var A = ar(m.x, m.y, v.x, v.y), T = ar(p.x, p.y, v.x, v.y);
              A < T && (o[r + 1] = m);
            }
          });
        }
      }
      return o;
    }, e.prototype.getDraggingPoints = function(n, r, i, o, a) {
      var s = a.map(function(f) {
        return f;
      }), l = this.getAfterAnchor(n, i, o), u = this.getCrossPoint(n, i, l);
      return r === "start" ? (s.unshift(u), s.unshift(l)) : (s.push(u), s.push(l)), s;
    }, e.prototype.updateCrossPoints = function(n) {
      var r = n.map(function(m) {
        return m;
      }), i = n[0], o = n[1], a = n[r.length - 2], s = n[r.length - 1], l = this, u = l.sourceNode, f = l.targetNode, c = u.modelType, d = f.modelType, h = Js(i, o), v = r[0];
      switch (c) {
        case $e.RECT_NODE:
          if (u.radius !== 0) {
            var p = Np(i, u);
            p || (v = Tp(i, h, u));
          }
          break;
        case $e.CIRCLE_NODE:
          v = wf(i, h, u);
          break;
        case $e.ELLIPSE_NODE:
          v = Mp(i, h, u);
          break;
        case $e.DIAMOND_NODE:
          v = ss(i, h, u);
          break;
        case $e.POLYGON_NODE:
          v = ss(i, h, u);
          break;
      }
      v && (r[0] = v);
      var g = Js(a, s), y = r[r.length - 1];
      switch (d) {
        case $e.RECT_NODE:
          if (f.radius !== 0) {
            var p = Np(s, f);
            p || (y = Tp(s, g, f));
          }
          break;
        case $e.CIRCLE_NODE:
          y = wf(s, g, f);
          break;
        case $e.ELLIPSE_NODE:
          y = Mp(s, g, f);
          break;
        case $e.DIAMOND_NODE:
          y = ss(s, g, f);
          break;
        case $e.POLYGON_NODE:
          y = ss(s, g, f);
          break;
      }
      return y && (r[r.length - 1] = y), r;
    }, e.prototype.updatePath = function(n) {
      this.pointsList = n, this.points = this.getPath(this.pointsList);
    }, e.prototype.getData = function() {
      var n = t.prototype.getData.call(this), r = this.pointsList.map(function(i) {
        var o = i.x, a = i.y;
        return {
          x: o,
          y: a
        };
      });
      return Object.assign({}, n, {
        pointsList: r
      });
    }, e.prototype.getPath = function(n) {
      return n.map(function(r) {
        return "".concat(r.x, ",").concat(r.y);
      }).join(" ");
    }, e.prototype.initPoints = function() {
      this.pointsList.length > 0 ? this.points = this.getPath(this.pointsList) : this.updatePoints();
    }, e.prototype.updatePoints = function() {
      var n = _p({
        x: this.startPoint.x,
        y: this.startPoint.y
      }, {
        x: this.endPoint.x,
        y: this.endPoint.y
      }, this.sourceNode, this.targetNode, this.offset || 0);
      this.pointsList = n, this.points = n.map(function(r) {
        return "".concat(r.x, ",").concat(r.y);
      }).join(" ");
    }, e.prototype.updateStartPoint = function(n) {
      this.startPoint = Object.assign({}, n), this.updatePoints();
    }, e.prototype.moveStartPoint = function(n, r) {
      this.startPoint.x += n, this.startPoint.y += r, this.updatePoints();
    }, e.prototype.updateEndPoint = function(n) {
      this.endPoint = Object.assign({}, n), this.updatePoints();
    }, e.prototype.moveEndPoint = function(n, r) {
      this.endPoint.x += n, this.endPoint.y += r, this.updatePoints();
    }, e.prototype.updatePointsList = function(n, r) {
      this.pointsList.forEach(function(a) {
        a.x += n, a.y += r;
      });
      var i = this.pointsList[0];
      this.startPoint = Object.assign({}, i);
      var o = this.pointsList[this.pointsList.length - 1];
      this.endPoint = Object.assign({}, o), this.initPoints();
    }, e.prototype.dragAppendStart = function() {
      this.draggingPointList = this.pointsList.map(function(n) {
        return n;
      });
    }, e.prototype.dragAppendSimple = function(n, r) {
      var i;
      this.isDragging = !0;
      var o = n.start, a = n.end, s = n.startIndex, l = n.endIndex, u = n.direction, f = this.pointsList, c = f;
      return u === bt.HORIZONTAL ? (f[s] = {
        x: o.x,
        y: o.y + r.y
      }, f[l] = {
        x: a.x,
        y: a.y + r.y
      }, c = this.pointsList.map(function(d) {
        return d;
      })) : u === bt.VERTICAL && (f[s] = {
        x: o.x + r.x,
        y: o.y
      }, f[l] = {
        x: a.x + r.x,
        y: a.y
      }, c = this.pointsList.map(function(d) {
        return d;
      })), this.updatePointsAfterDrag(c), this.draggingPointList = c, !((i = this.text) === null || i === void 0) && i.value && this.setText(ut({}, this.text, this.textPosition)), {
        start: ut({}, f[s]),
        end: ut({}, f[l]),
        startIndex: s,
        endIndex: l,
        direction: u
      };
    }, e.prototype.dragAppend = function(n, r) {
      var i;
      this.isDragging = !0;
      var o = n.start, a = n.end, s = n.startIndex, l = n.endIndex, u = n.direction, f = this.pointsList;
      if (u === bt.HORIZONTAL) {
        f[s] = {
          x: o.x,
          y: o.y + r.y
        }, f[l] = {
          x: a.x,
          y: a.y + r.y
        };
        var c = this.pointsList.map(function(g) {
          return g;
        });
        if (s !== 0 && l !== this.pointsList.length - 1 && (c = this.removeCrossPoints(s, l, c)), s === 0) {
          var d = {
            x: o.x,
            y: o.y + r.y
          }, h = Qr(d, this.sourceNode);
          if (!h) {
            var v = this.sourceNode.anchors;
            c = this.getDraggingPoints(u, "start", d, v, c);
          }
        }
        if (l === this.pointsList.length - 1) {
          var p = {
            x: a.x,
            y: a.y + r.y
          }, h = Qr(p, this.targetNode);
          if (!h) {
            var v = this.targetNode.anchors;
            c = this.getDraggingPoints(u, "end", p, v, c);
          }
        }
        this.updatePointsAfterDrag(c), this.draggingPointList = c;
      } else if (u === bt.VERTICAL) {
        f[s] = {
          x: o.x + r.x,
          y: o.y
        }, f[l] = {
          x: a.x + r.x,
          y: a.y
        };
        var c = this.pointsList.map(function(y) {
          return y;
        });
        if (s !== 0 && l !== this.pointsList.length - 1 && (c = this.removeCrossPoints(s, l, c)), s === 0) {
          var d = {
            x: o.x + r.x,
            y: o.y
          }, h = Qr(d, this.sourceNode);
          if (!h) {
            var v = this.sourceNode.anchors;
            c = this.getDraggingPoints(u, "start", d, v, c);
          }
        }
        if (l === this.pointsList.length - 1) {
          var p = {
            x: a.x + r.x,
            y: a.y
          }, h = Qr(p, this.targetNode);
          if (!h) {
            var v = this.targetNode.anchors;
            c = this.getDraggingPoints(u, "end", p, v, c);
          }
        }
        this.updatePointsAfterDrag(c), this.draggingPointList = c;
      }
      return !((i = this.text) === null || i === void 0) && i.value && this.setText(ut({}, this.text, this.textPosition)), {
        start: ut({}, f[s]),
        end: ut({}, f[l]),
        startIndex: s,
        endIndex: l,
        direction: u
      };
    }, e.prototype.dragAppendEnd = function() {
      if (this.draggingPointList) {
        var n = i_(ki(this.points));
        this.pointsList = n.map(function(o) {
          return o;
        }), this.draggingPointList = [];
        var r = n[0];
        this.startPoint = ut({}, r);
        var i = n[n.length - 1];
        this.endPoint = ut({}, i);
      }
      this.isDragging = !1;
    }, e.prototype.updatePointsAfterDrag = function(n) {
      var r = this.updateCrossPoints(n);
      this.points = r.map(function(i) {
        return "".concat(i.x, ",").concat(i.y);
      }).join(" ");
    }, e.prototype.getAdjustStart = function() {
      return this.pointsList[0] || this.startPoint;
    }, e.prototype.getAdjustEnd = function() {
      var n = this.pointsList;
      return n[n.length - 1] || this.endPoint;
    }, e.prototype.updateAfterAdjustStartAndEnd = function(n) {
      var r = n.startPoint, i = n.endPoint, o = n.sourceNode, a = n.targetNode;
      this.pointsList = _p({
        x: r.x,
        y: r.y
      }, {
        x: i.x,
        y: i.y
      }, o, a, this.offset || 0), this.initPoints();
    }, Zt([
      H
    ], e.prototype, "dbClickPosition", void 0), Zt([
      F
    ], e.prototype, "initPoints", null), Zt([
      F
    ], e.prototype, "updatePoints", null), Zt([
      F
    ], e.prototype, "updateStartPoint", null), Zt([
      F
    ], e.prototype, "moveStartPoint", null), Zt([
      F
    ], e.prototype, "updateEndPoint", null), Zt([
      F
    ], e.prototype, "moveEndPoint", null), Zt([
      F
    ], e.prototype, "updatePointsList", null), Zt([
      F
    ], e.prototype, "dragAppendStart", null), Zt([
      F
    ], e.prototype, "dragAppendSimple", null), Zt([
      F
    ], e.prototype, "dragAppend", null), Zt([
      F
    ], e.prototype, "dragAppendEnd", null), Zt([
      F
    ], e.prototype, "updatePointsAfterDrag", null), Zt([
      F
    ], e.prototype, "getAdjustStart", null), Zt([
      F
    ], e.prototype, "getAdjustEnd", null), Zt([
      F
    ], e.prototype, "updateAfterAdjustStartAndEnd", null), e;
  }(lu)
), jt = function() {
  return jt = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, jt.apply(this, arguments);
}, Ne = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, Fp = function(t) {
  var e = typeof Symbol == "function" && Symbol.iterator, n = e && t[e], r = 0;
  if (n) return n.call(t);
  if (t && typeof t.length == "number") return {
    next: function() {
      return t && r >= t.length && (t = void 0), { value: t && t[r++], done: !t };
    }
  };
  throw new TypeError(e ? "Object is not iterable." : "Symbol.iterator is not defined.");
}, AL = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, pi = (
  /** @class */
  function() {
    function t(e, n) {
      var r;
      this.BaseType = At.NODE, this.id = "", this.type = "", this.x = 0, this.y = 0, this.textMode = zn.TEXT, this.text = {
        value: "",
        x: 0,
        y: 0,
        draggable: !1,
        editable: !0
      }, this._width = 100, this._height = 80, this.minWidth = 30, this.minHeight = 30, this.maxWidth = 2e3, this.maxHeight = 2e3, this.anchorsOffset = [], this.virtual = !1, this.isSelected = !1, this.isHovered = !1, this.isShowAnchor = !1, this.isDragging = !1, this.isHitable = !0, this.isHittable = !0, this.draggable = !0, this.visible = !0, this.rotatable = !0, this.resizable = !0, this.zIndex = 1, this.state = Qe.DEFAULT, this.autoToFront = !0, this.style = {}, this._rotate = 0, this.modelType = $e.NODE, this.additionStateData = {}, this.targetRules = [], this.sourceRules = [], this.moveRules = [], this.resizeRules = [], this.hasSetTargetRules = !1, this.hasSetSourceRules = !1, this.graphModel = n, this.properties = (r = e.properties) !== null && r !== void 0 ? r : {}, this.initNodeData(e), this.setAttributes();
    }
    return Object.defineProperty(t.prototype, "width", {
      get: function() {
        return this._width;
      },
      set: function(e) {
        this._width = e;
      },
      enumerable: !1,
      configurable: !0
    }), Object.defineProperty(t.prototype, "height", {
      get: function() {
        return this._height;
      },
      set: function(e) {
        this._height = e;
      },
      enumerable: !1,
      configurable: !0
    }), Object.defineProperty(t.prototype, "rotate", {
      get: function() {
        return this._rotate;
      },
      set: function(e) {
        this._rotate = e;
        var n = this, r = n.x, i = r === void 0 ? 0 : r, o = n.y, a = o === void 0 ? 0 : o;
        this.transform = new su(-i, -a).rotate(e).translate(i, a).toString();
      },
      enumerable: !1,
      configurable: !0
    }), Object.defineProperty(t.prototype, "incoming", {
      /**
       * 获取进入当前节点的边和节点
       */
      get: function() {
        return {
          nodes: this.graphModel.getNodeIncomingNode(this.id),
          edges: this.graphModel.getNodeIncomingEdge(this.id)
        };
      },
      enumerable: !1,
      configurable: !0
    }), Object.defineProperty(t.prototype, "outgoing", {
      /*
       * 获取离开当前节点的边和节点
       */
      get: function() {
        return {
          nodes: this.graphModel.getNodeOutgoingNode(this.id),
          edges: this.graphModel.getNodeOutgoingEdge(this.id)
        };
      },
      enumerable: !1,
      configurable: !0
    }), t.prototype.initNodeData = function(e) {
      if (e.properties || (e.properties = {}), !e.id) {
        var n = this.graphModel.idGenerator, r = n && n(e.type), i = this.createId();
        e.id = i || r || ti();
      }
      this.formatText(e), ut(this, RR(e));
      var o = this.graphModel.overlapMode;
      o === or.INCREASE && (this.zIndex = e.zIndex || gd());
    }, t.prototype.setAttributes = function() {
    }, t.prototype.createId = function() {
      return null;
    }, t.prototype.setTextMode = function(e) {
      this.textMode = e;
    }, t.prototype.formatText = function(e) {
      var n, r, i, o = this.graphModel.editConfigModel, a = o.nodeTextDraggable, s = o.nodeTextEdit, l = e.x, u = e.y, f = e.text, c = {
        value: "",
        x: l,
        y: u,
        draggable: a,
        editable: s
      };
      f && (typeof f == "string" ? c.value = f : (c = jt(jt({}, c), { x: (n = f.x) !== null && n !== void 0 ? n : l, y: (r = f.y) !== null && r !== void 0 ? r : u, value: (i = f.value) !== null && i !== void 0 ? i : "" }), ji(f.draggable) || (c.draggable = f.draggable), ji(f.editable) || (c.editable = f.editable))), e.text = c;
    }, t.prototype.resize = function(e) {
      var n = e.width, r = e.height, i = e.deltaX, o = e.deltaY, a = this.isAllowResizeNode(i, o, n, r);
      return a ? (this.move(i / 2, o / 2), this.width = n, this.height = r, this.setProperties({
        width: n,
        height: r
      }), this.getData()) : this.getData();
    }, t.prototype.proportionalResize = function() {
    }, t.prototype.getData = function() {
      var e = this.text, n = e.x, r = e.y, i = e.value, o = this.properties;
      ni(o) && (o = tr(o)), Bn(o.width) && (o.width = this.width), Bn(o.height) && (o.height = this.height);
      var a = {
        id: this.id,
        type: this.type,
        x: this.x,
        y: this.y,
        properties: o
      };
      return this.rotate && (a.rotate = this.rotate), this.graphModel.overlapMode === or.INCREASE && (a.zIndex = this.zIndex), i && (a.text = {
        x: n,
        y: r,
        value: i
      }), a;
    }, t.prototype.getHistoryData = function() {
      return this.getData();
    }, t.prototype.getProperties = function() {
      return tr(this.properties);
    }, t.prototype.getOuterGAttributes = function() {
      return {
        className: ""
      };
    }, t.prototype.getNodeStyle = function() {
      return jt(jt({}, this.graphModel.theme.baseNode), this.style);
    }, t.prototype.getTextStyle = function() {
      var e = this.graphModel.theme.nodeText, n = this.properties.textStyle, r = n === void 0 ? {} : n;
      return jt(jt({}, Fe(e)), Fe(r));
    }, t.prototype.getRotateControlStyle = function() {
      var e = this.graphModel.theme.rotateControl;
      return Fe(e);
    }, t.prototype.getResizeControlStyle = function() {
      var e = this.graphModel.theme.resizeControl;
      return Fe(e);
    }, t.prototype.getResizeOutlineStyle = function() {
      var e = this.graphModel.theme.resizeOutline;
      return Fe(e);
    }, t.prototype.getAnchorStyle = function(e) {
      var n = this.graphModel.theme.anchor;
      return Fe(n);
    }, t.prototype.getAnchorLineStyle = function(e) {
      var n = this.graphModel.theme.anchorLine;
      return Fe(n);
    }, t.prototype.getOutlineStyle = function() {
      var e = this.graphModel.theme.outline;
      return Fe(e);
    }, t.prototype.isAllowConnectedAsSource = function(e, n, r, i) {
      var o = this.hasSetSourceRules ? this.sourceRules : this.getConnectedSourceRules();
      this.hasSetSourceRules = !0;
      for (var a = !0, s = "", l = 0; l < o.length; l++) {
        var u = o[l];
        if (!u.validate.call(this, this, e, n, r, i)) {
          a = !1, s = u.message;
          break;
        }
      }
      return {
        isAllPass: a,
        msg: s
      };
    }, t.prototype.getConnectedSourceRules = function() {
      return this.sourceRules;
    }, t.prototype.isAllowConnectedAsTarget = function(e, n, r, i) {
      var o = this.hasSetTargetRules ? this.targetRules : this.getConnectedTargetRules();
      this.hasSetTargetRules = !0;
      for (var a = !0, s = "", l = 0; l < o.length; l++) {
        var u = o[l];
        if (!u.validate.call(this, e, this, n, r, i)) {
          a = !1, s = u.message;
          break;
        }
      }
      return {
        isAllPass: a,
        msg: s
      };
    }, t.prototype.isAllowMoveNode = function(e, n) {
      var r, i, o = !0, a = !0, s = this.moveRules.concat(this.graphModel.nodeMoveRules);
      try {
        for (var l = Fp(s), u = l.next(); !u.done; u = l.next()) {
          var f = u.value, c = f(this, e, n);
          if (!c)
            return !1;
          if (typeof c == "object") {
            var d = c;
            if (!d.x && !d.y)
              return !1;
            o = o && d.x, a = a && d.y;
          }
        }
      } catch (h) {
        r = { error: h };
      } finally {
        try {
          u && !u.done && (i = l.return) && i.call(l);
        } finally {
          if (r) throw r.error;
        }
      }
      return {
        x: o,
        y: a
      };
    }, t.prototype.getConnectedTargetRules = function() {
      return this.targetRules;
    }, t.prototype.getAnchorsByOffset = function() {
      var e = this, n = e.anchorsOffset, r = e.id, i = e.x, o = e.y;
      return n && n.length > 0 ? n.map(function(a, s) {
        return a.length ? (a = a, {
          id: "".concat(r, "_").concat(s),
          x: i + a[0],
          y: o + a[1]
        }) : (a = a, jt(jt({}, a), { x: i + a.x, y: o + a.y, id: a.id || "".concat(r, "_").concat(s) }));
      }) : this.getDefaultAnchor();
    }, t.prototype.getDefaultAnchor = function() {
      return [];
    }, t.prototype.getTargetAnchor = function(e) {
      return MR(e, this);
    }, t.prototype.getBounds = function() {
      return {
        minX: this.x - this.width / 2,
        minY: this.y - this.height / 2,
        maxX: this.x + this.width / 2,
        maxY: this.y + this.height / 2
      };
    }, Object.defineProperty(t.prototype, "anchors", {
      get: function() {
        var e = this.getAnchorsByOffset(), n = this, r = n.x, i = n.y, o = n.rotate;
        return e.forEach(function(a) {
          var s = a.x, l = a.y, u = AL(new au([s, l, 1]).translate(-r, -i).rotate(o).translate(r, i)[0], 2), f = u[0], c = u[1];
          a.x = f, a.y = c;
        }), e;
      },
      enumerable: !1,
      configurable: !0
    }), t.prototype.getAnchorInfo = function(e) {
      if (!Bn(e))
        for (var n = 0; n < this.anchors.length; n++) {
          var r = this.anchors[n];
          if (r.id === e)
            return r;
        }
    }, t.prototype.addNodeMoveRules = function(e) {
      this.moveRules.includes(e) || this.moveRules.push(e);
    }, t.prototype.isAllowMoveByXORY = function(e, n, r) {
      var i, o;
      if (r)
        i = !0, o = !0;
      else {
        var a = this.isAllowMoveNode(e, n);
        typeof a == "boolean" ? (i = a, o = a) : (i = a.x, o = a.y);
      }
      return {
        isAllowMoveX: i,
        isAllowMoveY: o
      };
    }, t.prototype.move = function(e, n, r) {
      r === void 0 && (r = !1);
      var i = this.isAllowMoveByXORY(e, n, r), o = i.isAllowMoveX, a = i.isAllowMoveY;
      return o && (this.x = this.x + e, this.text && this.moveText(e, 0)), a && (this.y = this.y + n, this.text && this.moveText(0, n)), (o || a) && (this.rotate = this._rotate), o || a;
    }, t.prototype.getMoveDistance = function(e, n, r) {
      r === void 0 && (r = !1);
      var i = this.isAllowMoveByXORY(e, n, r), o = i.isAllowMoveX, a = i.isAllowMoveY, s = 0, l = 0;
      return o && e && (this.x = this.x + e, this.text && this.moveText(e, 0), s = e), a && n && (this.y = this.y + n, this.text && this.moveText(0, n), l = n), [s, l];
    }, t.prototype.moveTo = function(e, n, r) {
      r === void 0 && (r = !1);
      var i = e - this.x, o = n - this.y;
      return !r && !this.isAllowMoveNode(i, o) ? !1 : (this.text && this.moveText(i, o), this.x = e, this.y = n, !0);
    }, t.prototype.moveText = function(e, n) {
      var r = this.text, i = r.x, o = r.y, a = r.value, s = r.draggable, l = r.editable;
      this.text = {
        value: a,
        editable: l,
        draggable: s,
        x: i + e,
        y: o + n
      };
    }, t.prototype.updateText = function(e) {
      this.text = jt(jt({}, tr(this.text)), { value: e });
    }, t.prototype.addNodeResizeRules = function(e) {
      this.resizeRules.includes(e) || this.resizeRules.push(e);
    }, t.prototype.isAllowResizeNode = function(e, n, r, i) {
      var o, a, s = this.resizeRules.concat(this.graphModel.nodeResizeRules);
      try {
        for (var l = Fp(s), u = l.next(); !u.done; u = l.next()) {
          var f = u.value, c = f(this, e, n, r, i);
          if (!c)
            return !1;
        }
      } catch (d) {
        o = { error: d };
      } finally {
        try {
          u && !u.done && (a = l.return) && a.call(l);
        } finally {
          if (o) throw o.error;
        }
      }
      return !0;
    }, t.prototype.setSelected = function(e) {
      e === void 0 && (e = !0), this.isSelected = e;
    }, t.prototype.setHovered = function(e) {
      e === void 0 && (e = !0), this.isHovered = e, this.setIsShowAnchor(e);
    }, t.prototype.setIsShowAnchor = function(e) {
      e === void 0 && (e = !0), this.isShowAnchor = e;
    }, t.prototype.setRotatable = function(e) {
      e === void 0 && (e = !0), this.rotatable = e;
    }, t.prototype.setResizable = function(e) {
      e === void 0 && (e = !0), this.resizable = e;
    }, t.prototype.setHitable = function(e) {
      e === void 0 && (e = !0), this.isHitable = e;
    }, t.prototype.setHittable = function(e) {
      e === void 0 && (e = !0), this.isHittable = e;
    }, t.prototype.setElementState = function(e, n) {
      this.state = e, this.additionStateData = n;
    }, t.prototype.updateProperties = function(e, n) {
      var r = tr(this.properties);
      this.properties = e, this.setAttributes(), this.graphModel.eventCenter.emit(pe.NODE_PROPERTIES_CHANGE, {
        id: this.id,
        keys: n,
        preProperties: r,
        properties: e
      });
    }, t.prototype.setProperty = function(e, n) {
      var r = tr(this.properties), i = Fe(r);
      zm(i, e, en(n)), this.updateProperties(i, [e]);
    }, t.prototype.setProperties = function(e) {
      var n = tr(this.properties), r = jt(jt({}, n), en(e)), i = [];
      wm(e, function(o, a) {
        (Us(n, a) && n[a] !== o || !Us(n, a)) && i.push(a);
      }), this.updateProperties(r, i);
    }, t.prototype.deleteProperty = function(e) {
      delete this.properties[e], this.setAttributes();
    }, t.prototype.setStyle = function(e, n) {
      var r;
      this.style = jt(jt({}, this.style), (r = {}, r[e] = en(n), r));
    }, t.prototype.setStyles = function(e) {
      this.style = jt(jt({}, this.style), en(e));
    }, t.prototype.updateStyles = function(e) {
      this.style = jt({}, en(e));
    }, t.prototype.setZIndex = function(e) {
      e === void 0 && (e = 1), this.zIndex = e;
    }, t.prototype.updateAttributes = function(e) {
      ut(this, e);
    }, t.BaseType = At.NODE, Ne([
      H
    ], t.prototype, "type", void 0), Ne([
      H
    ], t.prototype, "x", void 0), Ne([
      H
    ], t.prototype, "y", void 0), Ne([
      H
    ], t.prototype, "textMode", void 0), Ne([
      H
    ], t.prototype, "text", void 0), Ne([
      H
    ], t.prototype, "properties", void 0), Ne([
      H
    ], t.prototype, "_width", void 0), Ne([
      H
    ], t.prototype, "_height", void 0), Ne([
      H
    ], t.prototype, "anchorsOffset", void 0), Ne([
      H
    ], t.prototype, "isSelected", void 0), Ne([
      H
    ], t.prototype, "isHovered", void 0), Ne([
      H
    ], t.prototype, "isShowAnchor", void 0), Ne([
      H
    ], t.prototype, "isDragging", void 0), Ne([
      H
    ], t.prototype, "isHitable", void 0), Ne([
      H
    ], t.prototype, "isHittable", void 0), Ne([
      H
    ], t.prototype, "draggable", void 0), Ne([
      H
    ], t.prototype, "visible", void 0), Ne([
      H
    ], t.prototype, "rotatable", void 0), Ne([
      H
    ], t.prototype, "resizable", void 0), Ne([
      H
    ], t.prototype, "zIndex", void 0), Ne([
      H
    ], t.prototype, "state", void 0), Ne([
      H
    ], t.prototype, "autoToFront", void 0), Ne([
      H
    ], t.prototype, "style", void 0), Ne([
      H
    ], t.prototype, "transform", void 0), Ne([
      H
    ], t.prototype, "_rotate", void 0), Ne([
      yt
    ], t.prototype, "incoming", null), Ne([
      yt
    ], t.prototype, "outgoing", null), Ne([
      F
    ], t.prototype, "setTextMode", null), Ne([
      F
    ], t.prototype, "addNodeMoveRules", null), Ne([
      F
    ], t.prototype, "move", null), Ne([
      F
    ], t.prototype, "getMoveDistance", null), Ne([
      F
    ], t.prototype, "moveTo", null), Ne([
      F
    ], t.prototype, "moveText", null), Ne([
      F
    ], t.prototype, "updateText", null), Ne([
      F
    ], t.prototype, "addNodeResizeRules", null), Ne([
      F
    ], t.prototype, "setSelected", null), Ne([
      F
    ], t.prototype, "setHovered", null), Ne([
      F
    ], t.prototype, "setIsShowAnchor", null), Ne([
      F
    ], t.prototype, "setRotatable", null), Ne([
      F
    ], t.prototype, "setResizable", null), Ne([
      F
    ], t.prototype, "setHitable", null), Ne([
      F
    ], t.prototype, "setHittable", null), Ne([
      F
    ], t.prototype, "setElementState", null), Ne([
      F
    ], t.prototype, "setProperty", null), Ne([
      F
    ], t.prototype, "setProperties", null), Ne([
      F
    ], t.prototype, "deleteProperty", null), Ne([
      F
    ], t.prototype, "setStyle", null), Ne([
      F
    ], t.prototype, "setStyles", null), Ne([
      F
    ], t.prototype, "updateStyles", null), Ne([
      F
    ], t.prototype, "setZIndex", null), Ne([
      F
    ], t.prototype, "updateAttributes", null), t;
  }()
), CL = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), ca = function() {
  return ca = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, ca.apply(this, arguments);
}, Tu = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, wo = (
  /** @class */
  function(t) {
    CL(e, t);
    function e(n, r) {
      var i = t.call(this, n, r) || this;
      return i.modelType = $e.CIRCLE_NODE, i.r = 50, i.initNodeData(n), i.setAttributes(), i;
    }
    return Object.defineProperty(e.prototype, "width", {
      get: function() {
        return this.r * 2;
      },
      enumerable: !1,
      configurable: !0
    }), Object.defineProperty(e.prototype, "height", {
      get: function() {
        return this.r * 2;
      },
      enumerable: !1,
      configurable: !0
    }), e.prototype.setAttributes = function() {
      t.prototype.setAttributes.call(this);
      var n = this.properties.r;
      n && (this.r = n);
    }, e.prototype.getNodeStyle = function() {
      var n = t.prototype.getNodeStyle.call(this), r = this.graphModel.theme.circle, i = this.properties.style, o = i === void 0 ? {} : i;
      return ca(ca(ca({}, n), Fe(r)), Fe(o));
    }, e.prototype.getDefaultAnchor = function() {
      var n = this, r = n.x, i = n.y, o = n.r;
      return [
        { x: r, y: i - o, id: "".concat(this.id, "_0") },
        { x: r + o, y: i, id: "".concat(this.id, "_1") },
        { x: r, y: i + o, id: "".concat(this.id, "_2") },
        { x: r - o, y: i, id: "".concat(this.id, "_3") }
      ];
    }, e.prototype.resize = function(n) {
      var r = n.width, i = n.deltaX, o = n.deltaY;
      return this.move(i / 2, o / 2), this.r = r, this.setProperties({
        r
      }), this.getData();
    }, Tu([
      H
    ], e.prototype, "r", void 0), Tu([
      yt
    ], e.prototype, "width", null), Tu([
      yt
    ], e.prototype, "height", null), e;
  }(pi)
), TL = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), da = function() {
  return da = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, da.apply(this, arguments);
}, qi = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, us = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, Pf = (
  /** @class */
  function(t) {
    TL(e, t);
    function e(n, r) {
      var i = t.call(this, n, r) || this;
      return i.modelType = $e.DIAMOND_NODE, i.rx = 30, i.ry = 50, i.initNodeData(n), i.setAttributes(), i;
    }
    return e.prototype.setAttributes = function() {
      t.prototype.setAttributes.call(this);
      var n = this.properties, r = n.rx, i = n.ry;
      r && (this.rx = r), i && (this.ry = i);
    }, e.prototype.getNodeStyle = function() {
      var n = t.prototype.getNodeStyle.call(this), r = this.graphModel.theme.diamond, i = this.properties.style, o = i === void 0 ? {} : i;
      return da(da(da({}, n), Fe(r)), Fe(o));
    }, Object.defineProperty(e.prototype, "points", {
      get: function() {
        var n = this, r = n.x, i = n.y, o = n.rx, a = n.ry;
        return [
          [r, i - a],
          [r + o, i],
          [r, i + a],
          [r - o, i]
        ];
      },
      enumerable: !1,
      configurable: !0
    }), Object.defineProperty(e.prototype, "pointsPosition", {
      get: function() {
        return Dn(this.points, function(n) {
          var r = us(n, 2), i = r[0], o = r[1];
          return { x: i, y: o };
        });
      },
      enumerable: !1,
      configurable: !0
    }), Object.defineProperty(e.prototype, "width", {
      get: function() {
        var n = Number.MAX_SAFE_INTEGER, r = Number.MIN_SAFE_INTEGER;
        return at(this.points, function(i) {
          var o = us(i, 1), a = o[0];
          a < n && (n = a), a > r && (r = a);
        }), r - n;
      },
      enumerable: !1,
      configurable: !0
    }), Object.defineProperty(e.prototype, "height", {
      get: function() {
        var n = Number.MAX_SAFE_INTEGER, r = Number.MIN_SAFE_INTEGER;
        return at(this.points, function(i) {
          var o = us(i, 2), a = o[1];
          a < n && (n = a), a > r && (r = a);
        }), r - n;
      },
      enumerable: !1,
      configurable: !0
    }), e.prototype.getDefaultAnchor = function() {
      var n = this;
      return Dn(this.points, function(r, i) {
        var o = us(r, 2), a = o[0], s = o[1];
        return {
          x: a,
          y: s,
          id: "".concat(n.id, "_").concat(i)
        };
      });
    }, e.prototype.resize = function(n) {
      var r = n.width, i = n.height, o = n.deltaX, a = n.deltaY;
      return this.move(o / 2, a / 2), this.rx = r, this.ry = i, this.setProperties({
        rx: r,
        ry: i
      }), this.getData();
    }, qi([
      H
    ], e.prototype, "rx", void 0), qi([
      H
    ], e.prototype, "ry", void 0), qi([
      yt
    ], e.prototype, "points", null), qi([
      yt
    ], e.prototype, "pointsPosition", null), qi([
      yt
    ], e.prototype, "width", null), qi([
      yt
    ], e.prototype, "height", null), e;
  }(pi)
), NL = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), ha = function() {
  return ha = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, ha.apply(this, arguments);
}, fs = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, Df = (
  /** @class */
  function(t) {
    NL(e, t);
    function e(n, r) {
      var i = t.call(this, n, r) || this;
      return i.modelType = $e.ELLIPSE_NODE, i.rx = 30, i.ry = 45, i.initNodeData(n), i.setAttributes(), i;
    }
    return e.prototype.setAttributes = function() {
      t.prototype.setAttributes.call(this);
      var n = this.properties, r = n.rx, i = n.ry;
      r && (this.rx = r), i && (this.ry = i);
    }, e.prototype.getNodeStyle = function() {
      var n = t.prototype.getNodeStyle.call(this), r = this.graphModel.theme.ellipse, i = this.properties.style, o = i === void 0 ? {} : i;
      return ha(ha(ha({}, n), Fe(r)), Fe(o));
    }, Object.defineProperty(e.prototype, "width", {
      get: function() {
        return this.rx * 2;
      },
      enumerable: !1,
      configurable: !0
    }), Object.defineProperty(e.prototype, "height", {
      get: function() {
        return this.ry * 2;
      },
      enumerable: !1,
      configurable: !0
    }), e.prototype.getDefaultAnchor = function() {
      var n = this, r = n.x, i = n.y, o = n.rx, a = n.ry;
      return [
        { x: r, y: i - a, id: "".concat(this.id, "_0") },
        { x: r + o, y: i, id: "".concat(this.id, "_1") },
        { x: r, y: i + a, id: "".concat(this.id, "_2") },
        { x: r - o, y: i, id: "".concat(this.id, "_3") }
      ];
    }, e.prototype.resize = function(n) {
      var r = n.width, i = n.height, o = n.deltaX, a = n.deltaY;
      return this.move(o / 2, a / 2), this.rx = r, this.ry = i, this.setProperties({
        rx: r,
        ry: i
      }), this.getData();
    }, fs([
      H
    ], e.prototype, "rx", void 0), fs([
      H
    ], e.prototype, "ry", void 0), fs([
      yt
    ], e.prototype, "width", null), fs([
      yt
    ], e.prototype, "height", null), e;
  }(pi)
), ML = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), pa = function() {
  return pa = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, pa.apply(this, arguments);
}, cs = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, ds = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, rl = (
  /** @class */
  function(t) {
    ML(e, t);
    function e(n, r) {
      var i = t.call(this, n, r) || this;
      return i.modelType = $e.POLYGON_NODE, i.points = [
        [50, 0],
        [100, 50],
        [50, 100],
        [0, 50]
        // 菱形
        // [0,100], [50,25], [50,75], [100,0] // 闪电
        // [100, 10],
        // [40, 198],
        // [190, 78],
        // [10, 78],
        // [160, 198], // 五角星
      ], i.initNodeData(n), i.setAttributes(), i;
    }
    return e.prototype.setAttributes = function() {
      t.prototype.setAttributes.call(this);
      var n = this.properties, r = n.points, i = n.width, o = n.height, a = r || this.points;
      this.points = AR(a, i, o);
    }, e.prototype.getNodeStyle = function() {
      var n = t.prototype.getNodeStyle.call(this), r = this.graphModel.theme.polygon, i = this.properties.style, o = i === void 0 ? {} : i;
      return pa(pa(pa({}, n), Fe(r)), Fe(o));
    }, Object.defineProperty(e.prototype, "pointsPosition", {
      /**
       * 由于大多数情况下，我们初始化拿到的多边形坐标都是基于原点的（例如绘图工具到处的svg）。
       * 在logicflow中对多边形进行移动，我们不需要去更新points，
       * 而是去更新多边形中心点即可。
       */
      get: function() {
        var n = this, r = n.x, i = n.y, o = n.width, a = n.height;
        return this.points.map(function(s) {
          return {
            x: s[0] + r - o / 2,
            y: s[1] + i - a / 2
          };
        });
      },
      enumerable: !1,
      configurable: !0
    }), Object.defineProperty(e.prototype, "width", {
      get: function() {
        var n = Number.MAX_SAFE_INTEGER, r = Number.MIN_SAFE_INTEGER;
        return this.points.forEach(function(i) {
          var o = ds(i, 1), a = o[0];
          a < n && (n = a), a > r && (r = a);
        }), r - n;
      },
      enumerable: !1,
      configurable: !0
    }), Object.defineProperty(e.prototype, "height", {
      get: function() {
        var n = Number.MAX_SAFE_INTEGER, r = Number.MIN_SAFE_INTEGER;
        return this.points.forEach(function(i) {
          var o = ds(i, 2), a = o[1];
          a < n && (n = a), a > r && (r = a);
        }), r - n;
      },
      enumerable: !1,
      configurable: !0
    }), e.prototype.getDefaultAnchor = function() {
      var n = this, r = this, i = r.x, o = r.y, a = r.width, s = r.height, l = r.points;
      return l.map(function(u, f) {
        var c = ds(u, 2), d = c[0], h = c[1];
        return {
          x: i + d - a / 2,
          y: o + h - s / 2,
          id: "".concat(n.id, "_").concat(f)
        };
      });
    }, e.prototype.resize = function(n) {
      var r = this, i = n.width, o = n.height, a = n.deltaX, s = n.deltaY;
      this.move(a / 2, s / 2);
      var l = Dn(this.points, function(u) {
        var f = ds(u, 2), c = f[0], d = f[1];
        return [
          c * i / r.width,
          d * o / r.height
        ];
      });
      return this.points = l, this.properties.points = l, this.getData();
    }, cs([
      H
    ], e.prototype, "points", void 0), cs([
      yt
    ], e.prototype, "pointsPosition", null), cs([
      yt
    ], e.prototype, "width", null), cs([
      yt
    ], e.prototype, "height", null), e;
  }(pi)
), PL = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), va = function() {
  return va = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, va.apply(this, arguments);
}, DL = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, Or = (
  /** @class */
  function(t) {
    PL(e, t);
    function e(n, r) {
      var i = t.call(this, n, r) || this;
      return i.modelType = $e.RECT_NODE, i.radius = 0, i.initNodeData(n), i.setAttributes(), i;
    }
    return e.prototype.setAttributes = function() {
      t.prototype.setAttributes.call(this);
      var n = this.properties, r = n.width, i = n.height, o = n.radius;
      Bn(r) || (this.width = r), Bn(i) || (this.height = i), Bn(o) || (this.radius = o);
    }, e.prototype.getDefaultAnchor = function() {
      var n = this, r = n.x, i = n.y, o = n.width, a = n.height;
      return [
        { x: r, y: i - a / 2, id: "".concat(this.id, "_0") },
        { x: r + o / 2, y: i, id: "".concat(this.id, "_1") },
        { x: r, y: i + a / 2, id: "".concat(this.id, "_2") },
        { x: r - o / 2, y: i, id: "".concat(this.id, "_3") }
      ];
    }, e.prototype.getNodeStyle = function() {
      var n = t.prototype.getNodeStyle.call(this), r = this.graphModel.theme.rect, i = this.properties.style, o = i === void 0 ? {} : i;
      return va(va(va({}, n), Fe(r)), Fe(o));
    }, DL([
      H
    ], e.prototype, "radius", void 0), e;
  }(pi)
), RL = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), ga = function() {
  return ga = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, ga.apply(this, arguments);
}, $p = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, LL = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, IL = function(t, e, n) {
  if (n || arguments.length === 2) for (var r = 0, i = e.length, o; r < i; r++)
    (o || !(r in e)) && (o || (o = Array.prototype.slice.call(e, 0, r)), o[r] = e[r]);
  return t.concat(o || Array.prototype.slice.call(e));
}, Hp = (
  /** @class */
  function(t) {
    RL(e, t);
    function e() {
      var n = t.apply(this, IL([], LL(arguments), !1)) || this;
      return n.modelType = $e.TEXT_NODE, n;
    }
    return e.prototype.getTextStyle = function() {
      var n = t.prototype.getTextStyle.call(this), r = this.graphModel.theme.text, i = this.properties.textStyle;
      return ga(ga(ga({}, n), Fe(r)), Fe(i));
    }, Object.defineProperty(e.prototype, "width", {
      get: function() {
        var n = String(this.text.value).split(/[\r\n]/g), r = this.getTextStyle().fontSize, i = Dp({
          rows: n,
          fontSize: r,
          rowsLength: n.length
        }).width;
        return i;
      },
      enumerable: !1,
      configurable: !0
    }), Object.defineProperty(e.prototype, "height", {
      get: function() {
        var n = String(this.text.value).split(/[\r\n]/g), r = this.getTextStyle().fontSize, i = Dp({
          rows: n,
          fontSize: r,
          rowsLength: n.length
        }).height;
        return i;
      },
      enumerable: !1,
      configurable: !0
    }), $p([
      yt
    ], e.prototype, "width", null), $p([
      yt
    ], e.prototype, "height", null), e;
  }(pi)
), jL = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), Rf = (
  /** @class */
  function(t) {
    jL(e, t);
    function e(n, r) {
      var i = t.call(this, n, r) || this;
      return i.modelType = $e.HTML_NODE, i.setAttributes(), i;
    }
    return e.prototype.setAttributes = function() {
      t.prototype.setAttributes.call(this);
      var n = this.properties, r = n.width, i = n.height;
      r && (this.width = r), i && (this.height = i);
    }, e.prototype.getDefaultAnchor = function() {
      var n = this, r = n.x, i = n.y, o = n.width, a = n.height;
      return [
        { x: r, y: i - a / 2, id: "".concat(this.id, "_0") },
        { x: r + o / 2, y: i, id: "".concat(this.id, "_1") },
        { x: r, y: i + a / 2, id: "".concat(this.id, "_2") },
        { x: r - o / 2, y: i, id: "".concat(this.id, "_3") }
      ];
    }, e;
  }(pi)
), it = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, kL = {
  // SilentMode 下允许用户操作画布
  stopZoomGraph: !1,
  stopScrollGraph: !1,
  stopMoveGraph: !1,
  // 节点 & 边相关配置
  adjustEdge: !1,
  adjustEdgeStartAndEnd: !1,
  adjustNodePosition: !1,
  hideAnchors: !0,
  allowRotate: !1,
  allowResize: !1,
  nodeSelectedOutline: !0,
  // 文本相关配置
  textEdit: !1,
  nodeTextEdit: !1,
  edgeTextEdit: !1,
  textDraggable: !1,
  nodeTextDraggable: !1,
  edgeTextDraggable: !1
}, hs = [
  "isSilentMode",
  // 是否为静默模式
  "stopZoomGraph",
  // 禁止缩放画布
  "stopScrollGraph",
  // 禁止鼠标滚动移动画布
  "stopMoveGraph",
  // 禁止拖动画布
  "snapGrid",
  // 是否开启网格对齐
  "adjustEdge",
  // 允许调整边
  "adjustEdgeMiddle",
  // 允许调整边中点
  "adjustEdgeStartAndEnd",
  // 允许调整边起点和终点
  "adjustEdgeStart",
  // 允许调整边起点
  "adjustEdgeEnd",
  // 允许调整边终点
  "adjustNodePosition",
  // 允许拖动节点
  "hideAnchors",
  // 隐藏节点所有锚点
  "allowRotate",
  // 是否允许节点旋转
  "allowResize",
  // 是否允许节点缩放
  "autoExpand",
  // 是否自动展开
  "hoverOutline",
  // 显示节点悬浮时的外框
  "nodeSelectedOutline",
  // 节点被选中时是否显示 outline
  "edgeSelectedOutline",
  // 边被选中时是否显示 outline
  "textEdit",
  // 是否允许文本可编辑（全局）
  "nodeTextEdit",
  // 允许节点文本可以编辑
  "edgeTextEdit",
  // 允许边文本可以编辑
  "textDraggable",
  // 是否允许文本可拖拽（全局）
  "nodeTextDraggable",
  // 允许节点文本可以拖拽
  "edgeTextDraggable",
  // 允许边文本可以拖拽
  "multipleSelectKey",
  // 多选按键
  // 2.0.0 新增配置
  "textMode",
  // 文本模式（全局）
  "nodeTextMode",
  // 节点文本模式
  "edgeTextMode",
  // 边文本模式
  "nodeTextMultiple",
  // 是否支持多个节点文本
  "edgeTextMultiple",
  // 是否支持多个边文本
  "nodeTextVertical",
  // 节点文本是否纵向显示
  "edgeTextVertical"
  // 边文本是否纵向显示
], BL = (
  /** @class */
  function() {
    function t(e) {
      this.isSilentMode = !1, this.stopZoomGraph = !1, this.stopMoveGraph = !1, this.stopScrollGraph = !1, this.snapGrid = !1, this.textMode = zn.TEXT, this.textEdit = !0, this.textDraggable = !1, this.nodeTextEdit = !0, this.nodeTextDraggable = !1, this.nodeTextMultiple = !1, this.nodeTextVertical = !1, this.nodeTextMode = zn.TEXT, this.edgeTextMode = zn.TEXT, this.edgeTextEdit = !0, this.edgeTextDraggable = !1, this.edgeTextMultiple = !1, this.edgeTextVertical = !1, this.hideAnchors = !1, this.allowRotate = !1, this.allowResize = !1, this.hoverOutline = !0, this.nodeSelectedOutline = !0, this.adjustNodePosition = !0, this.autoExpand = !1, this.adjustEdge = !0, this.adjustEdgeMiddle = !1, this.adjustEdgeStartAndEnd = !1, this.adjustEdgeStart = !1, this.adjustEdgeEnd = !1, this.edgeSelectedOutline = !0, this.multipleSelectKey = "", ut(this, this.computeConfig(e));
    }
    return t.prototype.updateEditConfig = function(e) {
      var n = this.computeConfig(e);
      ut(this, n);
    }, t.prototype.computeConfig = function(e) {
      var n = e.isSilentMode, r = e.textDraggable, i = e.textMode, o = e.textEdit, a = e.adjustEdgeStartAndEnd, s = {};
      if (n === !1 && ut(s, this.stagedConfig), n === !0 && n !== this.isSilentMode) {
        var l = Ti(kL, hs);
        this.stagedConfig = Ti(this, hs), ut(s, l);
      }
      ji(o) || ut(s, {
        nodeTextEdit: o,
        edgeTextEdit: o
      }), ji(r) || ut(s, {
        nodeTextDraggable: r,
        edgeTextDraggable: r
      }), i && ut(s, {
        nodeTextMode: i,
        edgeTextMode: i
      }), Ys(a) && ut(s, {
        adjustEdgeStart: a,
        adjustEdgeEnd: a
      });
      var u = Ti(e, hs);
      return ut(s, u);
    }, t.prototype.updateTextMode = function(e) {
      this.textMode = e, this.edgeTextMode = e, this.nodeTextMode = e;
    }, t.prototype.getConfig = function() {
      return Ti(this, hs);
    }, it([
      H
    ], t.prototype, "isSilentMode", void 0), it([
      H
    ], t.prototype, "stopZoomGraph", void 0), it([
      H
    ], t.prototype, "stopMoveGraph", void 0), it([
      H
    ], t.prototype, "stopScrollGraph", void 0), it([
      H
    ], t.prototype, "snapGrid", void 0), it([
      H
    ], t.prototype, "textMode", void 0), it([
      H
    ], t.prototype, "textEdit", void 0), it([
      H
    ], t.prototype, "textDraggable", void 0), it([
      H
    ], t.prototype, "nodeTextEdit", void 0), it([
      H
    ], t.prototype, "nodeTextDraggable", void 0), it([
      H
    ], t.prototype, "nodeTextMultiple", void 0), it([
      H
    ], t.prototype, "nodeTextVertical", void 0), it([
      H
    ], t.prototype, "nodeTextMode", void 0), it([
      H
    ], t.prototype, "edgeTextMode", void 0), it([
      H
    ], t.prototype, "edgeTextEdit", void 0), it([
      H
    ], t.prototype, "edgeTextDraggable", void 0), it([
      H
    ], t.prototype, "edgeTextMultiple", void 0), it([
      H
    ], t.prototype, "edgeTextVertical", void 0), it([
      H
    ], t.prototype, "hideAnchors", void 0), it([
      H
    ], t.prototype, "allowRotate", void 0), it([
      H
    ], t.prototype, "allowResize", void 0), it([
      H
    ], t.prototype, "hoverOutline", void 0), it([
      H
    ], t.prototype, "nodeSelectedOutline", void 0), it([
      H
    ], t.prototype, "adjustNodePosition", void 0), it([
      H
    ], t.prototype, "autoExpand", void 0), it([
      H
    ], t.prototype, "adjustEdge", void 0), it([
      H
    ], t.prototype, "adjustEdgeMiddle", void 0), it([
      H
    ], t.prototype, "adjustEdgeStartAndEnd", void 0), it([
      H
    ], t.prototype, "adjustEdgeStart", void 0), it([
      H
    ], t.prototype, "adjustEdgeEnd", void 0), it([
      H
    ], t.prototype, "edgeSelectedOutline", void 0), it([
      F
    ], t.prototype, "updateEditConfig", null), it([
      F
    ], t.prototype, "updateTextMode", null), t;
  }()
), FL = "*", $L = (
  /** @class */
  function() {
    function t() {
      this._events = {};
    }
    return t.prototype.on = function(e, n, r) {
      var i = this;
      e == null || e.split(",").forEach(function(o) {
        o = o.trim(), i._events[o] || (i._events[o] = []), i._events[o].push({
          callback: n,
          once: !!r
        });
      });
    }, t.prototype.once = function(e, n) {
      var r = this;
      e == null || e.split(",").forEach(function(i) {
        i = i.trim(), r.on(i, n, !0);
      });
    }, t.prototype.emit = function(e, n) {
      var r = this;
      e == null || e.split(",").forEach(function(i) {
        var o = r._events[i] || [], a = r._events[FL] || [], s = function(l) {
          for (var u = l.length, f = 0; f < u; f++)
            if (l[f]) {
              var c = l[f], d = c.callback, h = c.once;
              h && (l.splice(f, 1), l.length === 0 && delete r._events[i], u--, f--), d.apply(r, [n]);
            }
        };
        s(o), s(a);
      });
    }, t.prototype.off = function(e, n) {
      var r = this;
      e || (this._events = {}), e.split(",").forEach(function(i) {
        if (!n)
          delete r._events[i];
        else {
          for (var o = r._events[i] || [], a = o.length, s = 0; s < a; s++)
            o[s].callback === n && (o.splice(s, 1), a--, s--);
          o.length === 0 && delete r._events[i];
        }
      });
    }, t.prototype.getEvents = function() {
      return this._events;
    }, t.prototype.destroy = function() {
      this._events = {};
    }, t;
  }()
), HL = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), Lf = function() {
  return Lf = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Lf.apply(this, arguments);
}, WL = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, zL = (
  /** @class */
  function(t) {
    HL(e, t);
    function e(n) {
      var r = t.call(this) || this;
      r.stepScrollX = 0, r.stepScrollY = 0, r.onDragging = function(s) {
        var l = s.deltaX, u = s.deltaY;
        r.setState({
          isDragging: !0
        });
        var f = r.props.graphModel, c = f.transformModel, d = f.editConfigModel;
        d.stopMoveGraph !== !0 && c.translate(l, u);
      }, r.onDragEnd = function() {
        r.setState({
          isDragging: !1
        });
      }, r.zoomHandler = function(s) {
        var l = r.props, u = l.graphModel, f = u.editConfigModel, c = u.transformModel, d = u.gridSize, h = l.graphModel, v = s.deltaX, p = s.deltaY, g = f.stopScrollGraph, y = f.stopZoomGraph;
        if (!g && !s.ctrlKey && !s.metaKey) {
          if (s.preventDefault(), r.stepScrollX += v, r.stepScrollY += p, Math.abs(r.stepScrollX) >= d) {
            var m = r.stepScrollX % d, A = r.stepScrollX - m;
            c.translate(-A * c.SCALE_X, 0), r.stepScrollX = m;
          }
          if (Math.abs(r.stepScrollY) >= d) {
            var T = r.stepScrollY % d, k = r.stepScrollY - T;
            c.translate(0, -k * c.SCALE_Y), r.stepScrollY = T;
          }
          return;
        }
        if (!y) {
          s.preventDefault();
          var C = h.getPointByClient({
            x: s.clientX,
            y: s.clientY
          }), S = C.canvasOverlayPosition, I = S.x, X = S.y;
          c.zoom(s.deltaY < 0, [I, X]);
        }
      }, r.clickHandler = function(s) {
        var l = s.target;
        if (l.getAttribute("name") === "canvas-overlay") {
          var u = r.props.graphModel, f = u.selectElements;
          f.size > 0 && u.clearSelectElements(), u.eventCenter.emit(pe.BLANK_CLICK, { e: s });
        }
      }, r.handleContextMenu = function(s) {
        var l = s.target;
        if (l.getAttribute("name") === "canvas-overlay") {
          s.preventDefault();
          var u = r.props.graphModel, f = u.getPointByClient({
            x: s.clientX,
            y: s.clientY
          });
          u.eventCenter.emit(pe.BLANK_CONTEXTMENU, {
            e: s,
            position: f
          });
        }
      }, r.mouseDownHandler = function(s) {
        var l = r.props.graphModel, u = l.eventCenter, f = l.editConfigModel, c = l.transformModel.SCALE_X, d = l.gridSize, h = f.adjustEdge, v = f.adjustNodePosition, p = f.stopMoveGraph, g = s.target, y = !h && !v;
        (g.getAttribute("name") === "canvas-overlay" || y) && (p !== !0 ? (r.stepDrag.setStep(d * c), r.stepDrag.handleMouseDown(s)) : u.emit(pe.BLANK_MOUSEDOWN, { e: s }), r.clickHandler(s));
      };
      var i = n.graphModel, o = i.gridSize, a = i.eventCenter;
      return r.stepDrag = new Kn({
        onDragging: r.onDragging,
        onDragEnd: r.onDragEnd,
        step: o,
        eventType: "BLANK",
        isStopPropagation: !1,
        eventCenter: a,
        model: void 0
      }), r.state = {
        isDragging: !1
      }, r;
    }
    return e.prototype.render = function() {
      var n = this.props.graphModel.transformModel, r = n.getTransformStyle().transform, i = this.props, o = i.children, a = i.dnd, s = this.state.isDragging;
      return B("svg", Lf({ xmlns: "http://www.w3.org/2000/svg", width: "100%", height: "100%", name: "canvas-overlay", onWheel: this.zoomHandler, onMouseDown: this.mouseDownHandler, onContextMenu: this.handleContextMenu, className: s ? "lf-canvas-overlay lf-dragging" : "lf-canvas-overlay lf-drag-able" }, a.eventMap(), { children: B("g", { transform: r, children: o }) }));
    }, e = WL([
      sn
    ], e), e;
  }(Ye)
), v_ = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), ka = function() {
  return ka = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, ka.apply(this, arguments);
}, XL = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, GL = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, Wp = (
  /** @class */
  function(t) {
    v_(e, t);
    function e() {
      var n = t.call(this) || this;
      return n.onDragging = function(r) {
        var i = r.event, o = n.props, a = o.graphModel, s = o.bezierModel, l = o.type, u = a.getPointByClient({
          x: i.clientX,
          y: i.clientY
        }).canvasOverlayPosition, f = u.x, c = u.y;
        s.updateAdjustAnchor({
          x: f,
          y: c
        }, l), a.eventCenter.emit(pe.EDGE_ADJUST, {
          data: s.getData()
        });
      }, n.onDragEnd = function() {
        var r = n.props.bezierModel;
        r.isDragging = !1;
      }, n.dragHandler = new Kn({
        onDragging: n.onDragging,
        onDragEnd: n.onDragEnd
      }), n;
    }
    return e.prototype.render = function() {
      var n = this, r = this.props.position, i = r.x, o = r.y, a = this.props.bezierModel, s = a.getEdgeStyle().adjustAnchor;
      return B(xo, ka({ className: "lf-bezier-adjust-anchor", x: i, y: o }, s, { onMouseDown: function(l) {
        n.dragHandler.handleMouseDown(l);
      } }));
    }, e;
  }(Ye)
), UL = (
  /** @class */
  function(t) {
    v_(e, t);
    function e() {
      return t !== null && t.apply(this, arguments) || this;
    }
    return e.prototype.getBezierAdjust = function(n, r) {
      var i = n.path, o = n.id, a = hd(i), s = GL(a, 4), l = s[0], u = s[1], f = s[2], c = s[3], d = n.getEdgeStyle().adjustLine, h = [];
      return h.push(B(bo, ka({ x1: l.x, y1: l.y, x2: u.x, y2: u.y }, d))), h.push(B(Wp, { position: u, bezierModel: n, graphModel: r, type: "sNext" }, "".concat(o, "_ePre"))), h.push(B(bo, ka({ x1: c.x, y1: c.y, x2: f.x, y2: f.y }, d))), h.push(B(Wp, { position: f, bezierModel: n, graphModel: r, type: "ePre" }, "".concat(o, "_sNext"))), h;
    }, e.prototype.selectedBezierEdge = function() {
      for (var n = this.props.graphModel, r = n.edges, i = [], o = 0; o < r.length; o++) {
        var a = r[o];
        a.isSelected && a.modelType === $e.BEZIER_EDGE && a.draggable && i.push(this.getBezierAdjust(a, n));
      }
      return i;
    }, e.prototype.render = function() {
      return B("g", { className: "lf-bezier-adjust", children: this.selectedBezierEdge() });
    }, e = XL([
      sn
    ], e), e;
  }(Ye)
), YL = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), VL = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, KL = (
  /** @class */
  function(t) {
    YL(e, t);
    function e() {
      return t !== null && t.apply(this, arguments) || this;
    }
    return e.prototype.render = function() {
      var n = this.props.background;
      return B("div", { className: "lf-background", children: B("div", { style: Tt(n) ? n : {}, className: "lf-background-area" }) });
    }, e = VL([
      sn
    ], e), e;
  }(Ye)
), qL = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), ZL = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, il = (
  /** @class */
  function(t) {
    qL(e, t);
    function e(n) {
      var r = t.call(this, n) || this;
      return r.id = ti(), r.gridOptions = r.props.graphModel.grid, r;
    }
    return e.prototype.renderDot = function() {
      var n = this.gridOptions, r = n.config, i = n.size, o = i === void 0 ? 1 : i, a = n.visible, s = r ?? {}, l = s.color, u = s.thickness, f = u === void 0 ? 2 : u, c = Math.min(Math.max(2, f), o / 4), d = a ? 1 : 0;
      return B("g", { fill: l, opacity: d, children: [B("circle", { cx: 0, cy: 0, r: c / 2 }), B("circle", { cx: 0, cy: o, r: c / 2 }), B("circle", { cx: o, cy: 0, r: c / 2 }), B("circle", { cx: o, cy: o, r: c / 2 })] });
    }, e.prototype.renderMesh = function() {
      var n = this.gridOptions, r = n.config, i = n.size, o = i === void 0 ? 1 : i, a = n.visible, s = r ?? {}, l = s.color, u = s.thickness, f = u === void 0 ? 1 : u, c = Math.min(Math.max(1, f), o / 2), d = "M 0 0 H ".concat(o, " V ").concat(o, " H 0 Z"), h = a ? 1 : 0;
      return B("path", { d, stroke: l, strokeWidth: c / 2, opacity: h, fill: "transparent" });
    }, e.prototype.render = function() {
      var n = this.props.graphModel.transformModel, r = this.gridOptions, i = r.type, o = r.size, a = o === void 0 ? 1 : o, s = n.SCALE_X, l = n.SKEW_Y, u = n.SKEW_X, f = n.SCALE_Y, c = n.TRANSLATE_X, d = n.TRANSLATE_Y, h = [
        s,
        l,
        u,
        f,
        c,
        d
      ].join(","), v = "matrix(".concat(h, ")");
      return B("div", { className: "lf-grid", children: B("svg", { xmlns: "http://www.w3.org/2000/svg", version: "1.1", width: "100%", height: "100%", children: [B("defs", { children: B("pattern", { id: this.id, patternUnits: "userSpaceOnUse", patternTransform: v, x: "0", y: "0", width: a, height: a, children: [i === "dot" && this.renderDot(), i === "mesh" && this.renderMesh()] }) }), B("rect", { width: "100%", height: "100%", fill: "url(#".concat(this.id, ")") })] }) });
    }, e = ZL([
      sn
    ], e), e;
  }(Ye)
);
(function(t) {
  t.defaultProps = {
    size: rR,
    visible: !0,
    type: "dot",
    config: {
      color: "#ababab",
      thickness: 1
    }
  };
  function e(n) {
    var r = Fe(t.defaultProps);
    return typeof n == "number" ? ut(r, { size: n }) : typeof n == "boolean" ? ut(r, { visible: n }) : ut(r, n);
  }
  t.getGridOptions = e;
})(il || (il = {}));
var JL = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), QL = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, eI = (
  /** @class */
  function(t) {
    JL(e, t);
    function e() {
      return t !== null && t.apply(this, arguments) || this;
    }
    return e.prototype.render = function() {
      var n = this.props.graphModel.transformModel, r = n.getTransformStyle().transform, i = this.props.children;
      return B("svg", { xmlns: "http://www.w3.org/2000/svg", version: "1.1", width: "100%", height: "100%", className: "modification-overlay", children: B("g", { transform: r, children: i }) });
    }, e = QL([
      sn
    ], e), e;
  }(Ye)
), tI = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), Yr = function() {
  return Yr = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Yr.apply(this, arguments);
}, nI = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, rI = (
  /** @class */
  function(t) {
    tI(e, t);
    function e() {
      return t !== null && t.apply(this, arguments) || this;
    }
    return e.prototype.getNodesOutline = function() {
      var n = this.props.graphModel, r = n.nodes, i = n.editConfigModel, o = i.hoverOutline, a = i.nodeSelectedOutline, s = [];
      return r.forEach(function(l) {
        if (l.isHovered || l.isSelected) {
          var u = l.isHovered, f = l.isSelected, c = l.x, d = l.y, h = l.width, v = l.height;
          if (a && f || o && u) {
            var p = l.getOutlineStyle(), g = {};
            if (Object.keys(p).forEach(function(m) {
              m !== "hover" && (g[m] = p[m]);
            }), u) {
              var y = p.hover;
              g = Yr(Yr({}, g), y);
            }
            s.push(B($n, Yr({
              transform: l.transform,
              className: "lf-outline-node",
              x: c,
              y: d,
              // width: width + 10,
              // height: height + 10,
              width: h + 10,
              height: v + 10
            }, g)));
          }
        }
      }), s;
    }, e.prototype.getEdgeOutline = function() {
      for (var n = this.props.graphModel, r = n.edges, i = n.editConfigModel, o = i.edgeSelectedOutline, a = i.hoverOutline, s = [], l = 0; l < r.length; l++) {
        var u = r[l];
        (o && u.isSelected || a && u.isHovered) && (u.modelType === $e.LINE_EDGE ? s.push(this.getLineOutline(u)) : u.modelType === $e.POLYLINE_EDGE ? s.push(this.getPolylineOutline(u)) : u.modelType === $e.BEZIER_EDGE && s.push(this.getBezierOutline(u)));
      }
      return s;
    }, e.prototype.getLineOutline = function(n) {
      var r = n.startPoint, i = n.endPoint, o = (r.x + i.x) / 2, a = (r.y + i.y) / 2, s = Math.abs(r.x - i.x) + 10, l = Math.abs(r.y - i.y) + 10, u = n.getOutlineStyle();
      return B($n, Yr({ className: "lf-outline-edge", x: o, y: a, width: s, height: l }, u));
    }, e.prototype.getPolylineOutline = function(n) {
      var r = n.points, i = ki(r), o = Ra(i, 8), a = o.x, s = o.y, l = o.width, u = o.height, f = n.getOutlineStyle();
      return B($n, Yr({ className: "lf-outline", x: a, y: s, width: l, height: u }, f));
    }, e.prototype.getBezierOutline = function(n) {
      var r = n.path, i = hd(r), o = Ra(i, 8), a = o.x, s = o.y, l = o.width, u = o.height, f = n.getOutlineStyle();
      return B($n, Yr({ className: "lf-outline", x: a, y: s, width: l, height: u }, f));
    }, e.prototype.render = function() {
      return B("g", { className: "lf-outline", children: [this.getNodesOutline(), this.getEdgeOutline()] });
    }, e = nI([
      sn
    ], e), e;
  }(Ye)
), iI = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), Vr = function() {
  return Vr = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Vr.apply(this, arguments);
}, oI = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, aI = (
  /** @class */
  function(t) {
    iI(e, t);
    function e() {
      return t !== null && t.apply(this, arguments) || this;
    }
    return e.prototype.render = function() {
      var n = this.props.snaplineModel, r = n ?? {}, i = r.position, o = r.isShowHorizontal, a = r.isShowVertical, s = n == null ? void 0 : n.getStyle(), l = i ?? {}, u = l.x, f = u === void 0 ? 0 : u, c = l.y, d = c === void 0 ? 0 : c, h = Vr(Vr({ x1: -1e5, y1: d, x2: 1e5, y2: d }, s), { stroke: o ? s == null ? void 0 : s.stroke : "none" }), v = Vr(Vr({ x1: f, y1: -1e5, x2: f, y2: 1e5 }, s), { stroke: a ? s == null ? void 0 : s.stroke : "none" });
      return B("g", { className: "lf-snapline", children: [B(bo, Vr({}, h)), B(bo, Vr({}, v))] });
    }, e = oI([
      sn
    ], e), e;
  }(Ye)
), sI = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), lI = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, uI = (
  /** @class */
  function(t) {
    sI(e, t);
    function e() {
      return t !== null && t.apply(this, arguments) || this;
    }
    return e.prototype.componentDidMount = function() {
      this.triggerToolRender();
    }, e.prototype.componentDidUpdate = function() {
      this.triggerToolRender();
    }, e.prototype.getTools = function() {
      var n = this.props, r = n.tool, i = n.graphModel, o = i.textEditElement, a = r.getTools(), s = a.map(function(l) {
        return ae(l, {
          textEditElement: o,
          graphModel: i,
          lf: r.instance
        });
      });
      return r.components = s, s;
    }, e.prototype.triggerToolRender = function() {
      var n = this.props, r = n.tool, i = n.graphModel, o = document.querySelector("#ToolOverlay_".concat(i.flowId)), a = r.getInstance();
      a.components.forEach(function(s) {
        return s(a, o);
      }), a.components = [];
    }, e.prototype.render = function() {
      var n = this.props.graphModel;
      return B("div", { className: "lf-tool-overlay", id: "ToolOverlay_".concat(n.flowId), children: this.getTools() });
    }, e = lI([
      sn
    ], e), e;
  }(Ye)
), Kr = function() {
  return Kr = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Kr.apply(this, arguments);
}, ce = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, fI = function(t) {
  var e = typeof Symbol == "function" && Symbol.iterator, n = e && t[e], r = 0;
  if (n) return n.call(t);
  if (t && typeof t.length == "number") return {
    next: function() {
      return t && r >= t.length && (t = void 0), { value: t && t[r++], done: !t };
    }
  };
  throw new TypeError(e ? "Object is not iterable." : "Symbol.iterator is not defined.");
}, Bt = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, Ln = function(t, e, n) {
  if (n || arguments.length === 2) for (var r = 0, i = e.length, o; r < i; r++)
    (o || !(r in e)) && (o || (o = Array.prototype.slice.call(e, 0, r)), o[r] = e[r]);
  return t.concat(o || Array.prototype.slice.call(e));
}, cI = (
  /** @class */
  function() {
    function t(e) {
      var n = this, r, i;
      this.modelMap = /* @__PURE__ */ new Map(), this.nodeModelMap = /* @__PURE__ */ new Map(), this.edgeModelMap = /* @__PURE__ */ new Map(), this.elementsModelMap = /* @__PURE__ */ new Map(), this.nodeMoveRules = [], this.nodeResizeRules = [], this.nodes = [], this.edges = [], this.overlapMode = or.DEFAULT, this.gridSize = 1, this.partial = !1, this.waitCleanEffects = [];
      var o = e.container, a = e.partial, s = e.background, l = s === void 0 ? {} : s, u = e.grid, f = e.idGenerator, c = e.edgeGenerator, d = e.animation, h = e.customTrajectory;
      this.rootEl = o, this.partial = !!a, this.background = l, typeof u == "object" && e.snapGrid && (this.gridSize = u.size || 1), this.theme = p_(e.style), this.grid = il.getGridOptions(u ?? !1), this.edgeType = e.edgeType || "polyline", this.animation = eR(d), this.overlapMode = e.overlapMode || or.DEFAULT, this.width = (r = e.width) !== null && r !== void 0 ? r : this.rootEl.getBoundingClientRect().width, this.isContainerWidth = Bn(e.width), this.height = (i = e.height) !== null && i !== void 0 ? i : this.rootEl.getBoundingClientRect().height, this.isContainerHeight = Bn(e.height);
      var v = new ResizeObserver(Yl(function(p) {
        var g, y;
        try {
          for (var m = fI(p), A = m.next(); !A.done; A = m.next()) {
            var T = A.value;
            T.target === n.rootEl && (n.resize(), n.eventCenter.emit("graph:resize", {
              target: n.rootEl,
              contentRect: T.contentRect
            }));
          }
        } catch (k) {
          g = { error: k };
        } finally {
          try {
            A && !A.done && (y = m.return) && y.call(m);
          } finally {
            if (g) throw g.error;
          }
        }
      }, 16));
      v.observe(this.rootEl), this.waitCleanEffects.push(function() {
        v.disconnect();
      }), this.eventCenter = new $L(), this.editConfigModel = new BL(e), this.transformModel = new pI(this.eventCenter, e), this.flowId = ti(), this.idGenerator = f, this.edgeGenerator = SR(this, c), this.customTrajectory = h;
    }
    return Object.defineProperty(t.prototype, "nodesMap", {
      get: function() {
        return this.nodes.reduce(function(e, n, r) {
          return e[n.id] = {
            index: r,
            model: n
          }, e;
        }, {});
      },
      enumerable: !1,
      configurable: !0
    }), Object.defineProperty(t.prototype, "edgesMap", {
      get: function() {
        return this.edges.reduce(function(e, n, r) {
          return e[n.id] = {
            index: r,
            model: n
          }, e;
        }, {});
      },
      enumerable: !1,
      configurable: !0
    }), Object.defineProperty(t.prototype, "modelsMap", {
      get: function() {
        return Ln(Ln([], Bt(this.nodes), !1), Bt(this.edges), !1).reduce(function(e, n) {
          return e[n.id] = n, e;
        }, {});
      },
      enumerable: !1,
      configurable: !0
    }), Object.defineProperty(t.prototype, "sortElements", {
      /**
       * 基于zIndex对元素进行排序。
       * todo: 性能优化
       */
      get: function() {
        for (var e = Ln(Ln([], Bt(this.nodes), !1), Bt(this.edges), !1).sort(function(s, l) {
          return s.zIndex - l.zIndex;
        }), n = [], r = [
          -200,
          -200
        ], i = [
          this.width + pp,
          this.height + pp
        ], o = 0; o < e.length; o++) {
          var a = e[o];
          a.visible && (!this.partial || a.isSelected || this.isElementInArea(a, r, i, !1, !1)) && n.push(a);
        }
        return n;
      },
      enumerable: !1,
      configurable: !0
    }), Object.defineProperty(t.prototype, "textEditElement", {
      /**
       * 当前编辑的元素，低频操作，先循环找。
       */
      get: function() {
        var e = this.nodes.find(function(r) {
          return r.state === Qe.TEXT_EDIT;
        }), n = this.edges.find(function(r) {
          return r.state === Qe.TEXT_EDIT;
        });
        return e || n;
      },
      enumerable: !1,
      configurable: !0
    }), Object.defineProperty(t.prototype, "selectElements", {
      /**
       * 当前画布所有被选中的元素
       */
      get: function() {
        var e = /* @__PURE__ */ new Map();
        return this.nodes.forEach(function(n) {
          n.isSelected && e.set(n.id, n);
        }), this.edges.forEach(function(n) {
          n.isSelected && e.set(n.id, n);
        }), e;
      },
      enumerable: !1,
      configurable: !0
    }), Object.defineProperty(t.prototype, "selectNodes", {
      get: function() {
        var e = [];
        return this.nodes.forEach(function(n) {
          n.isSelected && e.push(n);
        }), e;
      },
      enumerable: !1,
      configurable: !0
    }), t.prototype.getAreaElement = function(e, n, r, i, o) {
      var a = this;
      r === void 0 && (r = !0), i === void 0 && (i = !0), o === void 0 && (o = !1);
      var s = [];
      return at(Ln(Ln([], Bt(this.nodes), !1), Bt(this.edges), !1), function(l) {
        var u = a.isElementInArea(l, e, n, r, i);
        (!o || l.visible) && u && s.push(l);
      }), s;
    }, t.prototype.getModel = function(e) {
      return this.modelMap.get(e);
    }, t.prototype.getNodeModelById = function(e) {
      var n;
      return this.fakeNode && e === this.fakeNode.id ? this.fakeNode : (n = this.nodesMap[e]) === null || n === void 0 ? void 0 : n.model;
    }, t.prototype.getPointByClient = function(e) {
      var n = e.x, r = e.y, i = this.rootEl.getBoundingClientRect(), o = {
        x: n - i.left,
        y: r - i.top
      }, a = Bt(this.transformModel.HtmlPointToCanvasPoint([
        o.x,
        o.y
      ]), 2), s = a[0], l = a[1], u = { x: s, y: l };
      return {
        domOverlayPosition: o,
        canvasOverlayPosition: u
      };
    }, t.prototype.isElementInArea = function(e, n, r, i, o) {
      var a;
      if (i === void 0 && (i = !0), o === void 0 && (o = !0), e.BaseType === At.NODE) {
        e = e;
        for (var s = gn(e), l = s.minX, u = s.minY, f = s.maxX, c = s.maxY, d = [
          {
            x: l,
            y: u
          },
          {
            x: f,
            y: u
          },
          {
            x: f,
            y: c
          },
          {
            x: l,
            y: c
          }
        ], h = o, v = 0; v < d.length; v++) {
          var p = d[v], g = p.x, y = p.y;
          if (a = Bt(this.transformModel.CanvasPointToHtmlPoint([g, y]), 2), g = a[0], y = a[1], Ou([g, y], n, r) !== o) {
            h = !o;
            break;
          }
        }
        return h;
      }
      if (e.BaseType === At.EDGE) {
        e = e;
        var m = e.startPoint, A = e.endPoint, T = this.transformModel.CanvasPointToHtmlPoint([
          m.x,
          m.y
        ]), k = this.transformModel.CanvasPointToHtmlPoint([
          A.x,
          A.y
        ]), C = Ou(T, n, r), S = Ou(k, n, r);
        return i ? C && S : C || S;
      }
      return !1;
    }, t.prototype.graphDataToModel = function(e) {
      var n = this;
      if (!e) {
        this.clearData();
        return;
      }
      if (this.elementsModelMap.clear(), this.nodeModelMap.clear(), this.edgeModelMap.clear(), e.nodes ? this.nodes = Dn(e.nodes, function(i) {
        var o = n.getModelAfterSnapToGrid(i);
        return n.elementsModelMap.set(o.id, o), n.nodeModelMap.set(o.id, o), o;
      }) : this.nodes = [], e.edges) {
        var r = this.edgeType;
        this.edges = Dn(e.edges, function(i) {
          var o, a = n.getModel((o = i.type) !== null && o !== void 0 ? o : r);
          if (!a)
            throw new Error("找不到".concat(i.type, "对应的边。"));
          var s = new a(i, n);
          return n.edgeModelMap.set(s.id, s), n.elementsModelMap.set(s.id, s), s;
        });
      } else
        this.edges = [];
    }, t.prototype.modelToGraphData = function() {
      var e = [];
      this.edges.forEach(function(r) {
        var i = r.getData();
        i && !r.virtual && e.push(i);
      });
      var n = [];
      return this.nodes.forEach(function(r) {
        var i = r.getData();
        i && !r.virtual && n.push(i);
      }), {
        nodes: n,
        edges: e
      };
    }, t.prototype.modelToHistoryData = function() {
      for (var e = !1, n = [], r = 0; r < this.nodes.length; r++) {
        var i = this.nodes[r];
        if (i.isDragging) {
          e = !0;
          break;
        } else
          n.push(i.getHistoryData());
      }
      if (e)
        return !1;
      for (var o = !1, a = [], s = 0; s < this.edges.length; s++) {
        var l = this.edges[s];
        if (l.isDragging) {
          o = !0;
          break;
        } else
          a.push(l.getHistoryData());
      }
      return o ? !1 : {
        nodes: n,
        edges: a
      };
    }, t.prototype.getEdgeModelById = function(e) {
      var n;
      return (n = this.edgesMap[e]) === null || n === void 0 ? void 0 : n.model;
    }, t.prototype.getElement = function(e) {
      return this.modelsMap[e];
    }, t.prototype.getNodeEdges = function(e) {
      for (var n = [], r = 0; r < this.edges.length; r++) {
        var i = this.edges[r], o = i.sourceNodeId === e, a = i.targetNodeId === e;
        (o || a) && n.push(i);
      }
      return n;
    }, t.prototype.getSelectElements = function(e) {
      e === void 0 && (e = !0);
      var n = this.selectElements, r = {
        nodes: [],
        edges: []
      };
      return n.forEach(function(i) {
        if (i.BaseType === At.NODE && r.nodes.push(i.getData()), i.BaseType === At.EDGE) {
          var o = i.getData(), a = n.get(o.sourceNodeId) && n.get(o.targetNodeId);
          (e || a) && r.edges.push(o);
        }
      }), r;
    }, t.prototype.updateAttributes = function(e, n) {
      var r = this.getElement(e);
      r == null || r.updateAttributes(n);
    }, t.prototype.changeNodeId = function(e, n) {
      return n || (n = ti()), this.nodesMap[n] ? (console.warn("当前流程图已存在节点".concat(n, ", 修改失败")), "") : this.nodesMap[e] ? (this.edges.forEach(function(r) {
        r.sourceNodeId === e && (r.sourceNodeId = n), r.targetNodeId === e && (r.targetNodeId = n);
      }), this.nodesMap[e].model.id = n, this.nodesMap[n] = this.nodesMap[e], n) : (console.warn("当前流程图找不到节点".concat(e, ", 修改失败")), "");
    }, t.prototype.changeEdgeId = function(e, n) {
      return n || (n = ti()), this.edgesMap[n] ? (console.warn("当前流程图已存在边: ".concat(n, ", 修改失败")), "") : this.edgesMap[e] ? (this.edges.forEach(function(r) {
        r.id === e && r.changeEdgeId(n);
      }), n) : (console.warn("当前流程图找不到边: ".concat(n, ", 修改失败")), "");
    }, t.prototype.getTextModel = function(e) {
      var n = this.editConfigModel, r = n.textMode, i = n.nodeTextMode, o = n.edgeTextMode;
      if (e.BaseType === At.NODE)
        return e.textMode || i || r || zn.TEXT;
      if (e.BaseType === At.EDGE)
        return e.textMode || o || r || zn.TEXT;
    }, t.prototype.setTextMode = function(e, n) {
      this.editConfigModel.updateEditConfig({ textMode: e });
    }, t.prototype.setFakeNode = function(e) {
      this.fakeNode = e;
    }, t.prototype.removeFakeNode = function() {
      this.fakeNode = null;
    }, t.prototype.setModel = function(e, n) {
      return this.modelMap.set(e, n);
    }, t.prototype.toFront = function(e) {
      var n, r, i, o = ((n = this.nodesMap[e]) === null || n === void 0 ? void 0 : n.model) || ((r = this.edgesMap[e]) === null || r === void 0 ? void 0 : r.model);
      o && (this.overlapMode === or.DEFAULT && ((i = this.topElement) === null || i === void 0 || i.setZIndex(), o.setZIndex(nR), this.topElement = o), this.overlapMode === or.INCREASE && this.setElementZIndex(e, "top"));
    }, t.prototype.setElementZIndex = function(e, n) {
      var r, i, o = ((r = this.nodesMap[e]) === null || r === void 0 ? void 0 : r.model) || ((i = this.edgesMap[e]) === null || i === void 0 ? void 0 : i.model);
      if (o) {
        var a = void 0;
        typeof n == "number" ? a = n : (n === "top" && (a = gd()), n === "bottom" && (a = bL())), o.setZIndex(a);
      }
    }, t.prototype.deleteNode = function(e) {
      var n = this.nodesMap[e].model, r = n.getData();
      this.deleteEdgeBySource(e), this.deleteEdgeByTarget(e), this.nodes.splice(this.nodesMap[e].index, 1), this.eventCenter.emit(pe.NODE_DELETE, {
        data: r,
        model: n
      });
    }, t.prototype.addNode = function(e, n, r) {
      n === void 0 && (n = pe.NODE_ADD);
      var i = en(e), o = i.id;
      o && this.nodesMap[o] && delete i.id;
      var a = this.getModelAfterSnapToGrid(i);
      this.nodes.push(a);
      var s = a.getData(), l = { data: s };
      return r && (l.e = r), this.eventCenter.emit(n, l), a;
    }, t.prototype.getModelAfterSnapToGrid = function(e) {
      var n = this.getModel(e.type), r = this.editConfigModel.snapGrid;
      if (!n)
        throw new Error("找不到".concat(e.type, "对应的节点，请确认是否已注册此类型节点。"));
      var i = e.x, o = e.y;
      i && o && (e.x = _o(i, this.gridSize, r), e.y = _o(o, this.gridSize, r), typeof e.text == "object" && e.text !== null && (e.text.x += e.x - i, e.text.y += e.y - o));
      var a = new n(e, this);
      return this.nodeModelMap.set(a.id, a), this.elementsModelMap.set(a.id, a), a;
    }, t.prototype.cloneNode = function(e) {
      var n = this.getNodeModelById(e), r = n == null ? void 0 : n.getData();
      if (r) {
        r.x += 30, r.y += 30, r.id = "", typeof r.text == "object" && r.text !== null && (r.text.x += 30, r.text.y += 30);
        var i = this.addNode(r);
        return i.setSelected(!0), n == null || n.setSelected(!1), i.getData();
      }
    }, t.prototype.moveNode = function(e, n, r, i) {
      var o;
      i === void 0 && (i = !1);
      var a = this.nodesMap[e];
      if (!a) {
        console.warn("不存在id为".concat(e, "的节点"));
        return;
      }
      var s = a.model;
      o = Bt(s.getMoveDistance(n, r, i), 2), n = o[0], r = o[1], this.moveEdge(e, n, r);
    }, t.prototype.moveNode2Coordinate = function(e, n, r, i) {
      i === void 0 && (i = !1);
      var o = this.nodesMap[e];
      if (!o) {
        console.warn("不存在id为".concat(e, "的节点"));
        return;
      }
      var a = o.model, s = a.x, l = a.y, u = n - s, f = r - l;
      this.moveNode(e, u, f, i);
    }, t.prototype.editText = function(e) {
      this.setElementStateById(e, Qe.TEXT_EDIT);
    }, t.prototype.addEdge = function(e) {
      var n = en(e), r = n.type;
      r || (r = this.edgeType), n.id && this.edgesMap[n.id] && delete n.id;
      var i = this.getModel(r);
      if (!i)
        throw new Error("找不到".concat(r, "对应的边，请确认是否已注册此类型边。"));
      var o = new i(Kr(Kr({}, n), { type: r }), this);
      this.edgeModelMap.set(o.id, o), this.elementsModelMap.set(o.id, o);
      var a = o.getData();
      return this.edges.push(o), this.eventCenter.emit(pe.EDGE_ADD, { data: a }), o;
    }, t.prototype.moveEdge = function(e, n, r) {
      for (var i = 0; i < this.edges.length; i++) {
        var o = this.edges[i], a = o.textPosition, s = a.x, l = a.y, u = this.edges[i].sourceNodeId === e, f = this.edges[i].targetNodeId === e;
        u && o.moveStartPoint(n, r), f && o.moveEndPoint(n, r), (u || f) && this.handleEdgeTextMove(o, s, l);
      }
    }, t.prototype.handleEdgeTextMove = function(e, n, r) {
      var i;
      if (e.customTextPosition) {
        e.resetTextPosition();
        return;
      }
      if (e.modelType === $e.POLYLINE_EDGE && (!((i = e.text) === null || i === void 0) && i.value)) {
        var o = e.text, a = a_(o, e.points);
        e.moveText(a.x - o.x, a.y - o.y);
      }
      var s = e.textPosition, l = s.x, u = s.y;
      e.moveText(l - n, u - r);
    }, t.prototype.deleteEdgeBySourceAndTarget = function(e, n) {
      for (var r = 0; r < this.edges.length; r++)
        if (this.edges[r].sourceNodeId === e && this.edges[r].targetNodeId === n) {
          var i = this.edges[r].getData();
          this.edges.splice(r, 1), r--, this.eventCenter.emit(pe.EDGE_DELETE, { data: i });
        }
    }, t.prototype.deleteEdgeById = function(e) {
      var n = this.edgesMap[e];
      if (n) {
        var r = this.edgesMap[e].index, i = this.edgesMap[e].model.getData();
        this.edges.splice(r, 1), this.eventCenter.emit(pe.EDGE_DELETE, { data: i });
      }
    }, t.prototype.deleteEdgeBySource = function(e) {
      for (var n = 0; n < this.edges.length; n++)
        if (this.edges[n].sourceNodeId === e) {
          var r = this.edges[n].getData();
          this.edges.splice(n, 1), n--, this.eventCenter.emit(pe.EDGE_DELETE, { data: r });
        }
    }, t.prototype.deleteEdgeByTarget = function(e) {
      for (var n = 0; n < this.edges.length; n++)
        if (this.edges[n].targetNodeId === e) {
          var r = this.edges[n].getData();
          this.edges.splice(n, 1), n--, this.eventCenter.emit(pe.EDGE_DELETE, { data: r });
        }
    }, t.prototype.setElementStateById = function(e, n, r) {
      this.nodes.forEach(function(i) {
        i.id === e ? i.setElementState(n, r) : i.setElementState(Qe.DEFAULT);
      }), this.edges.forEach(function(i) {
        i.id === e ? i.setElementState(n, r) : i.setElementState(Qe.DEFAULT);
      });
    }, t.prototype.updateText = function(e, n) {
      var r = ai(Ln(Ln([], Bt(this.nodes), !1), Bt(this.edges), !1), function(i) {
        return i.id === e;
      });
      r == null || r.updateText(n);
    }, t.prototype.selectNodeById = function(e, n) {
      var r;
      n === void 0 && (n = !1), n || this.clearSelectElements();
      var i = (r = this.nodesMap[e]) === null || r === void 0 ? void 0 : r.model;
      i == null || i.setSelected(!0);
    }, t.prototype.selectEdgeById = function(e, n) {
      var r;
      n === void 0 && (n = !1), n || this.clearSelectElements();
      var i = (r = this.edgesMap[e]) === null || r === void 0 ? void 0 : r.model;
      i == null || i.setSelected(!0);
    }, t.prototype.selectElementById = function(e, n) {
      n === void 0 && (n = !1), n || this.clearSelectElements();
      var r = this.getElement(e);
      r == null || r.setSelected(!0);
    }, t.prototype.clearSelectElements = function() {
      var e;
      this.selectElements.forEach(function(n) {
        n == null || n.setSelected(!1);
      }), this.selectElements.clear(), this.overlapMode === or.DEFAULT && ((e = this.topElement) === null || e === void 0 || e.setZIndex());
    }, t.prototype.moveNodes = function(e, n, r, i) {
      var o, a, s, l = this;
      i === void 0 && (i = !1);
      for (var u = e.reduce(function(A, T) {
        var k, C = (k = l.nodesMap[T]) === null || k === void 0 ? void 0 : k.model;
        return C && (A[T] = C.getMoveDistance(n, r, i)), A;
      }, {}), f = 0; f < this.edges.length; f++) {
        var c = this.edges[f], d = c.textPosition, h = d.x, v = d.y, p = u[c.sourceNodeId], g = u[c.targetNodeId], y = void 0, m = void 0;
        p && g && c.modelType === $e.POLYLINE_EDGE ? (o = Bt(p, 2), y = o[0], m = o[1], c.updatePointsList(y, m)) : (p && (a = Bt(p, 2), y = a[0], m = a[1], c.moveStartPoint(y, m)), g && (s = Bt(g, 2), y = s[0], m = s[1], c.moveEndPoint(y, m))), (p || g) && this.handleEdgeTextMove(c, h, v);
      }
    }, t.prototype.addNodeMoveRules = function(e) {
      this.nodeMoveRules.includes(e) || this.nodeMoveRules.push(e);
    }, t.prototype.addNodeResizeRules = function(e) {
      this.nodeResizeRules.includes(e) || this.nodeResizeRules.push(e);
    }, t.prototype.setDefaultEdgeType = function(e) {
      this.edgeType = e;
    }, t.prototype.changeNodeType = function(e, n) {
      var r = this.getNodeModelById(e);
      if (!r) {
        console.warn("找不到id为".concat(e, "的节点"));
        return;
      }
      var i = r.getData();
      i.type = n;
      var o = this.getModel(n);
      if (!o)
        throw new Error("找不到".concat(n, "对应的节点，请确认是否已注册此类型节点。"));
      var a = new o(i, this);
      this.nodes.splice(this.nodesMap[e].index, 1, a);
      var s = this.getNodeEdges(e);
      s.forEach(function(l) {
        if (l.sourceNodeId === e) {
          var u = Pp(a, l.startPoint, a.width, a.height);
          l.updateStartPoint(u);
        }
        if (l.targetNodeId === e) {
          var u = Pp(a, l.endPoint, a.width, a.height);
          l.updateEndPoint(u);
        }
      });
    }, t.prototype.changeEdgeType = function(e, n) {
      var r = this.getEdgeModelById(e);
      if (!r) {
        console.warn("找不到id为".concat(e, "的边"));
        return;
      }
      if (r.type !== n) {
        var i = r.getData();
        i.type = n;
        var o = this.getModel(n);
        if (!o)
          throw new Error("找不到".concat(n, "对应的节点，请确认是否已注册此类型节点。"));
        delete i.pointsList;
        var a = new o(i, this);
        this.edges.splice(this.edgesMap[e].index, 1, a);
      }
    }, t.prototype.getNodeIncomingEdge = function(e) {
      var n = [];
      return this.edges.forEach(function(r) {
        r.targetNodeId === e && n.push(r);
      }), n;
    }, t.prototype.getNodeOutgoingEdge = function(e) {
      var n = [];
      return this.edges.forEach(function(r) {
        r.sourceNodeId === e && n.push(r);
      }), n;
    }, t.prototype.getAnchorIncomingEdge = function(e) {
      var n = [];
      return this.edges.forEach(function(r) {
        r.targetAnchorId === e && n.push(r);
      }), n;
    }, t.prototype.getAnchorOutgoingEdge = function(e) {
      var n = [];
      return this.edges.forEach(function(r) {
        r.sourceAnchorId === e && n.push(r);
      }), n;
    }, t.prototype.getNodeIncomingNode = function(e) {
      var n = this, r = [];
      return this.edges.forEach(function(i) {
        var o;
        i.targetNodeId === e && r.push((o = n.nodesMap[i.sourceNodeId]) === null || o === void 0 ? void 0 : o.model);
      }), r;
    }, t.prototype.getNodeOutgoingNode = function(e) {
      var n = this, r = [];
      return this.edges.forEach(function(i) {
        i.sourceNodeId === e && r.push(n.nodesMap[i.targetNodeId].model);
      }), r;
    }, t.prototype.setTheme = function(e) {
      this.theme = yL(Kr(Kr({}, this.theme), e));
    }, t.prototype.updateGridOptions = function(e) {
      mo(this.grid, e);
    }, t.prototype.updateGridSize = function(e) {
      this.gridSize = e;
    }, t.prototype.updateBackgroundOptions = function(e) {
      Ys(e) || Ys(this.background) ? this.background = e : this.background = Kr(Kr({}, this.background), e);
    }, t.prototype.resize = function(e, n) {
      this.width = e ?? this.rootEl.getBoundingClientRect().width, this.isContainerWidth = Bn(e), this.height = n ?? this.rootEl.getBoundingClientRect().height, this.isContainerHeight = Bn(n), (!this.width || !this.height) && console.warn("渲染画布的时候无法获取画布宽高，请确认在container已挂载到DOM。@see https://github.com/didi/LogicFlow/issues/675");
    }, t.prototype.clearData = function() {
      this.nodes = [], this.edges = [], this.edgeModelMap.clear(), this.nodeModelMap.clear(), this.elementsModelMap.clear();
    }, t.prototype.getVirtualRectSize = function() {
      var e = this.nodes, n = [], r = [];
      e.forEach(function(d) {
        var h = d.x, v = d.y, p = d.width, g = d.height, y = d.getNodeStyle().strokeWidth, m = y === void 0 ? 0 : y, A = h + p / 2 + m, T = h - p / 2 - m, k = v + g / 2 + m, C = v - g / 2 - m;
        n = n.concat([A, T].filter(function(S) {
          return !Number.isNaN(S);
        })), r = r.concat([k, C].filter(function(S) {
          return !Number.isNaN(S);
        }));
      });
      var i = Math.min.apply(Math, Ln([], Bt(n), !1)), o = Math.max.apply(Math, Ln([], Bt(n), !1)), a = Math.min.apply(Math, Ln([], Bt(r), !1)), s = Math.max.apply(Math, Ln([], Bt(r), !1)), l = o - i || 0, u = s - a || 0, f = i + l / 2, c = a + u / 2;
      return {
        width: l,
        height: u,
        x: f,
        y: c
      };
    }, t.prototype.translateCenter = function() {
      var e = this, n = e.nodes, r = e.width, i = e.height, o = e.rootEl, a = e.transformModel;
      if (n.length) {
        var s = r || o.clientWidth, l = i || o.clientHeight, u = this.getVirtualRectSize(), f = u.x, c = u.y;
        a.focusOn(f, c, s, l);
      }
    }, t.prototype.fitView = function(e, n) {
      e === void 0 && (e = 20), n === void 0 && (n = 20);
      var r = this, i = r.nodes, o = r.width, a = r.height, s = r.rootEl, l = r.transformModel;
      if (i.length) {
        var u = o || s.clientWidth, f = a || s.clientHeight, c = this.getVirtualRectSize(), d = c.width, h = c.height, v = c.x, p = c.y, g = (d + n) / u, y = (h + e) / f, m = 1 / Math.max(g, y), A = [u / 2, f / 2];
        l.zoom(m, A), l.focusOn(v, p, u, f);
      }
    }, t.prototype.openEdgeAnimation = function(e) {
      var n = this.getEdgeModelById(e);
      n == null || n.openEdgeAnimation();
    }, t.prototype.closeEdgeAnimation = function(e) {
      var n = this.getEdgeModelById(e);
      n == null || n.closeEdgeAnimation();
    }, t.prototype.getPartial = function() {
      return this.partial;
    }, t.prototype.setPartial = function(e) {
      this.partial = e;
    }, t.prototype.destroy = function() {
      try {
        this.waitCleanEffects.forEach(function(e) {
          e();
        });
      } catch (e) {
        console.warn("error on destroy GraphModel", e);
      }
      this.waitCleanEffects.length = 0, this.eventCenter.destroy();
    }, ce([
      H
    ], t.prototype, "width", void 0), ce([
      H
    ], t.prototype, "height", void 0), ce([
      H
    ], t.prototype, "grid", void 0), ce([
      H
    ], t.prototype, "edgeType", void 0), ce([
      H
    ], t.prototype, "nodes", void 0), ce([
      H
    ], t.prototype, "edges", void 0), ce([
      H
    ], t.prototype, "fakeNode", void 0), ce([
      H
    ], t.prototype, "overlapMode", void 0), ce([
      H
    ], t.prototype, "background", void 0), ce([
      H
    ], t.prototype, "gridSize", void 0), ce([
      H
    ], t.prototype, "transformModel", void 0), ce([
      H
    ], t.prototype, "editConfigModel", void 0), ce([
      H
    ], t.prototype, "partial", void 0), ce([
      yt
    ], t.prototype, "nodesMap", null), ce([
      yt
    ], t.prototype, "edgesMap", null), ce([
      yt
    ], t.prototype, "modelsMap", null), ce([
      yt
    ], t.prototype, "sortElements", null), ce([
      yt
    ], t.prototype, "textEditElement", null), ce([
      yt
    ], t.prototype, "selectElements", null), ce([
      yt
    ], t.prototype, "selectNodes", null), ce([
      F
    ], t.prototype, "setTextMode", null), ce([
      F
    ], t.prototype, "setFakeNode", null), ce([
      F
    ], t.prototype, "removeFakeNode", null), ce([
      F
    ], t.prototype, "setModel", null), ce([
      F
    ], t.prototype, "toFront", null), ce([
      F
    ], t.prototype, "setElementZIndex", null), ce([
      F
    ], t.prototype, "deleteNode", null), ce([
      F
    ], t.prototype, "addNode", null), ce([
      F
    ], t.prototype, "cloneNode", null), ce([
      F
    ], t.prototype, "moveNode", null), ce([
      F
    ], t.prototype, "moveNode2Coordinate", null), ce([
      F
    ], t.prototype, "editText", null), ce([
      F
    ], t.prototype, "addEdge", null), ce([
      F
    ], t.prototype, "moveEdge", null), ce([
      F
    ], t.prototype, "deleteEdgeBySourceAndTarget", null), ce([
      F
    ], t.prototype, "deleteEdgeById", null), ce([
      F
    ], t.prototype, "deleteEdgeBySource", null), ce([
      F
    ], t.prototype, "deleteEdgeByTarget", null), ce([
      F
    ], t.prototype, "setElementStateById", null), ce([
      F
    ], t.prototype, "updateText", null), ce([
      F
    ], t.prototype, "selectNodeById", null), ce([
      F
    ], t.prototype, "selectEdgeById", null), ce([
      F
    ], t.prototype, "selectElementById", null), ce([
      F
    ], t.prototype, "clearSelectElements", null), ce([
      F
    ], t.prototype, "moveNodes", null), ce([
      F
    ], t.prototype, "setDefaultEdgeType", null), ce([
      F
    ], t.prototype, "changeNodeType", null), ce([
      F
    ], t.prototype, "changeEdgeType", null), ce([
      F
    ], t.prototype, "getNodeIncomingEdge", null), ce([
      F
    ], t.prototype, "getNodeOutgoingEdge", null), ce([
      F
    ], t.prototype, "getAnchorIncomingEdge", null), ce([
      F
    ], t.prototype, "getAnchorOutgoingEdge", null), ce([
      F
    ], t.prototype, "getNodeIncomingNode", null), ce([
      F
    ], t.prototype, "getNodeOutgoingNode", null), ce([
      F
    ], t.prototype, "setTheme", null), ce([
      F
    ], t.prototype, "resize", null), ce([
      F
    ], t.prototype, "clearData", null), ce([
      F
    ], t.prototype, "translateCenter", null), ce([
      F
    ], t.prototype, "fitView", null), ce([
      F
    ], t.prototype, "openEdgeAnimation", null), ce([
      F
    ], t.prototype, "closeEdgeAnimation", null), ce([
      F
    ], t.prototype, "setPartial", null), t;
  }()
), Oi = function() {
  return Oi = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Oi.apply(this, arguments);
}, Ko = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, dI = (
  /** @class */
  function() {
    function t(e) {
      this.isShowHorizontal = !1, this.isShowVertical = !1, this.position = {
        x: 0,
        y: 0
      }, this.graphModel = e;
    }
    return t.prototype.getStyle = function() {
      return Oi({}, this.graphModel.theme.snapline);
    }, t.prototype.getCenterSnapLine = function(e, n) {
      for (var r = e.x, i = e.y, o = !1, a = !1, s = 0; s < n.length; s++) {
        var l = n[s];
        if (l.id !== e.id && (r === l.x && (o = !0), i === l.y && (a = !0), o && a))
          break;
      }
      return {
        isShowVertical: o,
        isShowHorizontal: a,
        position: {
          x: r,
          y: i
        }
      };
    }, t.prototype.getHorizontalSnapline = function(e, n) {
      var r = !1, i = 0, o = e.id, a;
      if (o) {
        var s = this.graphModel.fakeNode;
        if (s && s.id === o)
          a = gn(s);
        else {
          var l = this.graphModel.getNodeModelById(o);
          l && (a = gn(l));
        }
      }
      for (var u = 0; u < n.length; u++) {
        var f = n[u];
        if (f.id !== e.id) {
          var c = gn(f);
          if (c.minY === (a == null ? void 0 : a.minY) || c.maxY === (a == null ? void 0 : a.minY)) {
            r = !0, i = a.minY;
            break;
          }
          if (c.minY === (a == null ? void 0 : a.maxY) || c.maxY === (a == null ? void 0 : a.maxY)) {
            r = !0, i = a.maxY;
            break;
          }
        }
      }
      return {
        isShowHorizontal: r,
        isShowVertical: this.isShowVertical,
        position: Oi(Oi({}, this.position), { y: i })
      };
    }, t.prototype.getVerticalSnapline = function(e, n) {
      var r = !1, i = 0, o = e.id, a;
      if (o) {
        var s = this.graphModel.fakeNode;
        if (s && s.id === o)
          a = gn(s);
        else {
          var l = this.graphModel.getNodeModelById(o);
          l && (a = gn(l));
        }
      }
      for (var u = 0; u < n.length; u++) {
        var f = n[u];
        if (f.id !== e.id) {
          var c = gn(f);
          if (c.minX === (a == null ? void 0 : a.minX) || c.maxX === (a == null ? void 0 : a.minX)) {
            r = !0, i = a.minX;
            break;
          }
          if (c.minX === (a == null ? void 0 : a.maxX) || c.maxX === (a == null ? void 0 : a.maxX)) {
            r = !0, i = a.maxX;
            break;
          }
        }
      }
      return {
        isShowHorizontal: this.isShowHorizontal,
        isShowVertical: r,
        position: Oi(Oi({}, this.position), { x: i })
      };
    }, t.prototype.getSnapLinePosition = function(e, n) {
      var r = this.getCenterSnapLine(e, n), i = r.isShowHorizontal, o = r.isShowVertical;
      if (!i) {
        var a = this.getHorizontalSnapline(e, n);
        a.isShowHorizontal && (r.isShowHorizontal = a.isShowHorizontal, r.position.y = a.position.y);
      }
      if (!o) {
        var s = this.getVerticalSnapline(e, n);
        s.isShowVertical && (r.isShowVertical = s.isShowVertical, r.position.x = s.position.x);
      }
      return r;
    }, t.prototype.setSnaplineInfo = function(e) {
      var n = e.isShowHorizontal, r = e.isShowVertical, i = e.position;
      this.position = i, this.isShowHorizontal = n, this.isShowVertical = r;
    }, t.prototype.clearSnapline = function() {
      this.position = {
        x: 0,
        y: 0
      }, this.isShowHorizontal = !1, this.isShowVertical = !1;
    }, t.prototype.setNodeSnapLine = function(e) {
      var n = this.graphModel.nodes, r = this.getSnapLinePosition(e, n);
      this.setSnaplineInfo(r);
    }, Ko([
      H
    ], t.prototype, "isShowHorizontal", void 0), Ko([
      H
    ], t.prototype, "isShowVertical", void 0), Ko([
      H
    ], t.prototype, "position", void 0), Ko([
      F
    ], t.prototype, "clearSnapline", null), Ko([
      F
    ], t.prototype, "setNodeSnapLine", null), t;
  }()
), Jn = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, Zi = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, hI = {
  false: [-1 / 0, -1 / 0, 1 / 0, 1 / 0],
  true: [-1 / 0, -1 / 0, 1 / 0, 1 / 0],
  vertical: [-1 / 0, 0, 1 / 0, 0],
  horizontal: [0, -1 / 0, 0, 1 / 0]
}, pI = (
  /** @class */
  function() {
    function t(e, n) {
      this.MINI_SCALE_SIZE = 0.2, this.MAX_SCALE_SIZE = 16, this.SCALE_X = 1, this.SKEW_Y = 0, this.SKEW_X = 0, this.SCALE_Y = 1, this.TRANSLATE_X = 0, this.TRANSLATE_Y = 0, this.ZOOM_SIZE = 0.04, this.translateLimitMinX = -1 / 0, this.translateLimitMinY = -1 / 0, this.translateLimitMaxX = 1 / 0, this.translateLimitMaxY = 1 / 0, this.eventCenter = e;
      var r = n.stopMoveGraph, i = r === void 0 ? !1 : r;
      this.updateTranslateLimits(i);
    }
    return t.prototype.setZoomMiniSize = function(e) {
      this.MINI_SCALE_SIZE = e;
    }, t.prototype.setZoomMaxSize = function(e) {
      this.MAX_SCALE_SIZE = e;
    }, t.prototype.HtmlPointToCanvasPoint = function(e) {
      var n = Zi(e, 2), r = n[0], i = n[1];
      return [
        (r - this.TRANSLATE_X) / this.SCALE_X,
        (i - this.TRANSLATE_Y) / this.SCALE_Y
      ];
    }, t.prototype.CanvasPointToHtmlPoint = function(e) {
      var n = Zi(e, 2), r = n[0], i = n[1];
      return [
        r * this.SCALE_X + this.TRANSLATE_X,
        i * this.SCALE_Y + this.TRANSLATE_Y
      ];
    }, t.prototype.moveCanvasPointByHtml = function(e, n, r) {
      var i = Zi(e, 2), o = i[0], a = i[1];
      return [o + n / this.SCALE_X, a + r / this.SCALE_Y];
    }, t.prototype.fixDeltaXY = function(e, n) {
      return [e / this.SCALE_X, n / this.SCALE_Y];
    }, t.prototype.getTransformStyle = function() {
      var e = [
        this.SCALE_X,
        this.SKEW_Y,
        this.SKEW_X,
        this.SCALE_Y,
        this.TRANSLATE_X,
        this.TRANSLATE_Y
      ].join(",");
      return {
        transform: "matrix(".concat(e, ")")
      };
    }, t.prototype.zoom = function(e, n) {
      e === void 0 && (e = !1);
      var r = this.SCALE_X, i = this.SCALE_Y;
      return typeof e == "number" ? (r = e, i = e) : e ? (r += this.ZOOM_SIZE, i += this.ZOOM_SIZE) : (r -= this.ZOOM_SIZE, i -= this.ZOOM_SIZE), r < this.MINI_SCALE_SIZE || r > this.MAX_SCALE_SIZE ? "".concat(this.SCALE_X * 100, "%") : (n && (this.TRANSLATE_X -= (r - this.SCALE_X) * n[0], this.TRANSLATE_Y -= (i - this.SCALE_Y) * n[1]), this.SCALE_X = r, this.SCALE_Y = i, this.emitGraphTransform("zoom"), "".concat(this.SCALE_X * 100, "%"));
    }, t.prototype.emitGraphTransform = function(e) {
      this.eventCenter.emit(pe.GRAPH_TRANSFORM, {
        type: e,
        transform: {
          SCALE_X: this.SCALE_X,
          SKEW_Y: this.SKEW_Y,
          SKEW_X: this.SKEW_X,
          SCALE_Y: this.SCALE_Y,
          TRANSLATE_X: this.TRANSLATE_X,
          TRANSLATE_Y: this.TRANSLATE_Y
        }
      });
    }, t.prototype.resetZoom = function() {
      this.SCALE_X = 1, this.SCALE_Y = 1, this.emitGraphTransform("resetZoom");
    }, t.prototype.translate = function(e, n) {
      this.TRANSLATE_X + e <= this.translateLimitMaxX && this.TRANSLATE_X + e >= this.translateLimitMinX && (this.TRANSLATE_X += e), this.TRANSLATE_Y + n <= this.translateLimitMaxY && this.TRANSLATE_Y + n >= this.translateLimitMinY && (this.TRANSLATE_Y += n), this.emitGraphTransform("translate");
    }, t.prototype.focusOn = function(e, n, r, i) {
      var o = Zi(this.CanvasPointToHtmlPoint([e, n]), 2), a = o[0], s = o[1], l = Zi([r / 2 - a, i / 2 - s], 2), u = l[0], f = l[1];
      this.TRANSLATE_X += u, this.TRANSLATE_Y += f, this.emitGraphTransform("focusOn");
    }, t.prototype.updateTranslateLimits = function(e) {
      var n;
      n = Zi(Array.isArray(e) && e.length === 4 ? e : hI[e.toString()], 4), this.translateLimitMinX = n[0], this.translateLimitMinY = n[1], this.translateLimitMaxX = n[2], this.translateLimitMaxY = n[3];
    }, Jn([
      H
    ], t.prototype, "SCALE_X", void 0), Jn([
      H
    ], t.prototype, "SKEW_Y", void 0), Jn([
      H
    ], t.prototype, "SKEW_X", void 0), Jn([
      H
    ], t.prototype, "SCALE_Y", void 0), Jn([
      H
    ], t.prototype, "TRANSLATE_X", void 0), Jn([
      H
    ], t.prototype, "TRANSLATE_Y", void 0), Jn([
      H
    ], t.prototype, "ZOOM_SIZE", void 0), Jn([
      F
    ], t.prototype, "zoom", null), Jn([
      F
    ], t.prototype, "resetZoom", null), Jn([
      F
    ], t.prototype, "translate", null), Jn([
      F
    ], t.prototype, "focusOn", null), t;
  }()
), vI = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), gI = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, yI = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, mI = function(t, e, n) {
  if (n || arguments.length === 2) for (var r = 0, i = e.length, o; r < i; r++)
    (o || !(r in e)) && (o || (o = Array.prototype.slice.call(e, 0, r)), o[r] = e[r]);
  return t.concat(o || Array.prototype.slice.call(e));
}, _I = (
  /** @class */
  function(t) {
    vI(e, t);
    function e() {
      var n = t.apply(this, mI([], yI(arguments), !1)) || this;
      return n.handleResize = function() {
        var r = n.props, i = r.graphModel, o = r.options, a = i.width, s = i.height, l = i.isContainerWidth, u = i.isContainerHeight, f = a, c = s, d = !1;
        l && (f = void 0, d = !0), u && (c = void 0, d = !0), d && i.resize(f, c), o.width = a, o.height = s;
      }, n.throttleResize = Ym(n.handleResize, 200), n;
    }
    return e.prototype.componentDidMount = function() {
      window.addEventListener("resize", this.throttleResize);
    }, e.prototype.componentDidUpdate = function() {
      var n = this.props.graphModel.modelToGraphData();
      this.props.graphModel.eventCenter.emit(pe.GRAPH_UPDATED, { data: n });
    }, e.prototype.componentWillUnmount = function() {
      window.removeEventListener("resize", this.throttleResize);
    }, e.prototype.getComponent = function(n, r, i) {
      i === void 0 && (i = "canvas-overlay");
      var o = this.props.getView, a = o(n.type);
      return a ? B(a, { model: n, graphModel: r, overlay: i }, n.id) : null;
    }, e.prototype.render = function() {
      var n = this, r = this.props, i = r.graphModel, o = r.tool, a = r.options, s = r.dnd, l = r.snaplineModel, u = {};
      a.width && (u.width = "".concat(i.width, "px")), a.height && (u.height = "".concat(i.height, "px"));
      var f = i.fakeNode, c = i.editConfigModel, d = i.background, h = c.adjustEdge;
      return B("div", { className: "lf-graph", "flow-id": i.flowId, style: u, children: [B(zL, { graphModel: i, dnd: s, children: [B("g", { className: "lf-base", children: Dn(i.sortElements, function(v) {
        return n.getComponent(v, i);
      }) }), f ? this.getComponent(f, i) : ""] }), B(eI, { graphModel: i, children: [B(rI, { graphModel: i }), h ? B(UL, { graphModel: i }) : "", a.snapline !== !1 ? B(aI, { snaplineModel: l }) : ""] }), B(uI, { graphModel: i, tool: o }), d && B(KL, { background: d }), B(il, { graphModel: i })] });
    }, e = gI([
      sn
    ], e), e;
  }(Ye)
), bI = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), br = function() {
  return br = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, br.apply(this, arguments);
}, xI = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, EI = (
  /** @class */
  function(t) {
    bI(e, t);
    function e() {
      var n = t.call(this) || this;
      return n.onDragStart = function(r) {
        var i = r.event, o = n.props, a = o.anchorData, s = o.nodeModel, l = o.graphModel;
        l.selectNodeById(s.id), s.autoToFront && l.toFront(s.id), l.eventCenter.emit(pe.ANCHOR_DRAGSTART, {
          data: a,
          e: i,
          nodeModel: s
        }), n.setState({
          startX: a.x,
          startY: a.y,
          endX: a.x,
          endY: a.y
        });
      }, n.onDragging = function(r) {
        var i = r.event, o = n.props, a = o.graphModel, s = o.nodeModel, l = o.anchorData, u = a.transformModel, f = a.eventCenter, c = a.width, d = a.height, h = a.editConfigModel, v = h.autoExpand, p = h.stopMoveGraph;
        if (i) {
          var g = i.clientX, y = i.clientY, m = a.getPointByClient({
            x: g,
            y
          }), A = m.domOverlayPosition, T = A.x, k = A.y, C = m.canvasOverlayPosition, S = C.x, I = C.y;
          n.t && nl(n.t);
          var X = [], Q = 10;
          T < 10 ? X = [Q, 0] : T + 10 > c ? X = [-10, 0] : k < 10 ? X = [0, Q] : k + 10 > d && (X = [0, -10]), n.setState({
            endX: S,
            endY: I,
            dragging: !0
          }), n.moveAnchorEnd(S, I), X.length > 0 && !p && v && (n.t = f_(function() {
            var ue = xI(X, 2), de = ue[0], w = ue[1];
            u.translate(de, w);
            var D = n.state, R = D.endX, K = D.endY;
            n.setState({
              endX: R - de,
              endY: K - w
            }), n.moveAnchorEnd(R - de, K - w);
          })), f.emit(pe.ANCHOR_DRAG, {
            data: l,
            e: i,
            nodeModel: s
          });
        }
      }, n.onDragEnd = function(r) {
        var i = r.event;
        n.t && nl(n.t);
        var o = n.checkEnd(i);
        n.setState({
          startX: 0,
          startY: 0,
          endX: 0,
          endY: 0,
          dragging: !1
        }), n.sourceRuleResults.clear(), n.targetRuleResults.clear();
        var a = n.props, s = a.graphModel, l = a.nodeModel, u = a.anchorData;
        s.eventCenter.emit(pe.ANCHOR_DRAGEND, {
          data: u,
          e: i,
          nodeModel: l,
          edgeModel: o ?? void 0
        });
      }, n.checkEnd = function(r) {
        var i, o = n.props, a = o.graphModel, s = o.nodeModel, l = o.anchorData, u = l.x, f = l.y, c = l.id, d = n.state, h = d.endX, v = d.endY, p = d.dragging, g = el({
          x: h,
          y: v
        }, a);
        if (n.preTargetNode && n.preTargetNode.state !== Qe.DEFAULT && n.preTargetNode.setElementState(Qe.DEFAULT), !!p && g && g.node) {
          var y = g.node, m = g.anchor.id, A = "".concat(s.id, "_").concat(y.id, "_").concat(m, "_").concat(c), T = n.sourceRuleResults.get(A) || {}, k = T.isAllPass, C = T.msg, S = n.targetRuleResults.get(A) || {}, I = S.isAllPass, X = S.msg;
          if (k && I) {
            y.setElementState(Qe.DEFAULT);
            var Q = a.getNodeModelById(g.node.id), ue = (i = a.edgeGenerator) === null || i === void 0 ? void 0 : i.call(a, s.getData(), Q == null ? void 0 : Q.getData()), de = a.addEdge(br(br({}, ue), { sourceNodeId: s.id, sourceAnchorId: c, startPoint: {
              x: u,
              y: f
            }, targetNodeId: g.node.id, targetAnchorId: g.anchor.id, endPoint: {
              x: g.anchor.x,
              y: g.anchor.y
            } })), w = n.props.anchorData;
            return a.eventCenter.emit(pe.ANCHOR_DROP, {
              data: w,
              e: r,
              nodeModel: s,
              edgeModel: de
            }), de;
          }
          var D = y.getData();
          return a.eventCenter.emit(pe.CONNECTION_NOT_ALLOWED, {
            data: D,
            msg: X || C || "不允许添加连线"
          }), null;
        }
      }, n.sourceRuleResults = /* @__PURE__ */ new Map(), n.targetRuleResults = /* @__PURE__ */ new Map(), n.state = {
        startX: 0,
        startY: 0,
        endX: 0,
        endY: 0,
        dragging: !1
      }, n.dragHandler = new Kn({
        onDragStart: n.onDragStart,
        onDragging: n.onDragging,
        onDragEnd: n.onDragEnd
      }), n;
    }
    return e.prototype.getAnchorShape = function() {
      var n = this.props, r = n.anchorData, i = n.style, o = n.node, a = o.getAnchorShape(r);
      if (a)
        return a;
      var s = r.x, l = r.y, u = br(br({}, i), i == null ? void 0 : i.hover);
      return B("g", { children: [B(xo, br({ className: "lf-node-anchor-hover" }, u, { x: s, y: l })), B(xo, br({ className: "lf-node-anchor" }, i, { x: s, y: l }))] });
    }, Object.defineProperty(e.prototype, "customTrajectory", {
      get: function() {
        var n = this.props.graphModel.customTrajectory;
        return n;
      },
      enumerable: !1,
      configurable: !0
    }), Object.defineProperty(e.prototype, "relateEdges", {
      get: function() {
        var n = this.props, r = n.graphModel, i = r.getAnchorIncomingEdge, o = r.getAnchorOutgoingEdge, a = n.anchorData.id;
        return {
          incomingEdgeList: i(a),
          outgoingEdgeList: o(a)
        };
      },
      enumerable: !1,
      configurable: !0
    }), e.prototype.moveAnchorEnd = function(n, r) {
      var i, o, a = this.props, s = a.graphModel, l = a.nodeModel, u = a.anchorData, f = el({
        x: n,
        y: r
      }, s);
      if (f) {
        var c = f.node, d = f.anchor.id;
        if (this.preTargetNode && this.preTargetNode !== f.node && this.preTargetNode.setElementState(Qe.DEFAULT), u.id === d)
          return;
        this.preTargetNode = c;
        var h = "".concat(l.id, "_").concat(c.id, "_").concat(d, "_").concat(u.id);
        if (!this.targetRuleResults.has(h)) {
          var v = f.anchor, p = l.isAllowConnectedAsSource(c, u, v), g = c.isAllowConnectedAsTarget(l, u, v);
          this.sourceRuleResults.set(h, tl(p)), this.targetRuleResults.set(h, tl(g));
        }
        var y = ((i = this.sourceRuleResults.get(h)) !== null && i !== void 0 ? i : {}).isAllPass, m = ((o = this.targetRuleResults.get(h)) !== null && o !== void 0 ? o : {}).isAllPass;
        y && m ? c.setElementState(Qe.ALLOW_CONNECT) : c.setElementState(Qe.NOT_ALLOW_CONNECT);
      } else this.preTargetNode && this.preTargetNode.state !== Qe.DEFAULT && this.preTargetNode.setElementState(Qe.DEFAULT);
    }, e.prototype.isShowLine = function() {
      var n = this.state, r = n.startX, i = n.startY, o = n.endX, a = n.endY, s = ar(r, i, o, a);
      return s > 10;
    }, e.prototype.render = function() {
      var n = this, r = this.state, i = r.startX, o = r.startY, a = r.endX, s = r.endY, l = this.props, u = l.anchorData.edgeAddable, f = l.edgeStyle;
      return (
        // className="lf-anchor" 作为下载时，需要将锚点删除的依据，不要修改类名
        B("g", { className: "lf-anchor", children: [B("g", { onMouseDown: function(c) {
          u !== !1 && n.dragHandler.handleMouseDown(c);
        }, children: this.getAnchorShape() }), this.isShowLine() && (this.customTrajectory ? this.customTrajectory(br({ sourcePoint: {
          x: i,
          y: o
        }, targetPoint: {
          x: a,
          y: s
        } }, f)) : B(bo, br({ x1: i, y1: o, x2: a, y2: s }, f, { "pointer-events": "none" })))] })
      );
    }, e;
  }(Ye)
), wI = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), If = function() {
  return If = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, If.apply(this, arguments);
}, SI = (
  /** @class */
  function(t) {
    wI(e, t);
    function e(n) {
      var r = t.call(this, n) || this;
      return r.style = {}, r.onDragging = function(i) {
        var o, a = i.event, s = r.props, l = s.graphModel, u = s.nodeModel, f = s.eventCenter, c = l.selectNodes, d = u.x, h = u.y, v = a.clientX, p = a.clientY, g = l.getPointByClient({
          x: v,
          y: p
        }).canvasOverlayPosition, y = g.x, m = g.y, A = new Vt(y - d, m - h), T = ((o = r.normal) === null || o === void 0 ? void 0 : o.angle(A)) - r.defaultAngle, k = new su(-d, -h).rotate(T).translate(d, h).toString();
        u.transform = k, u.rotate = T;
        var C = Dn(c, function(I) {
          return I.id;
        });
        C.indexOf(u.id) === -1 && (C = [u.id]);
        var S = Hm(C, function(I, X) {
          var Q = l.getNodeModelById(X);
          return I[X] = Q == null ? void 0 : Q.getMoveDistance(0, 0, !1), I;
        }, {});
        C.forEach(function(I) {
          var X = l.getNodeEdges(I);
          X.forEach(function(Q) {
            if (S[Q.sourceNodeId]) {
              var ue = l.getNodeModelById(Q.sourceNodeId), de = ue.anchors.find(function(w) {
                return w.id === Q.sourceAnchorId;
              });
              Q.updateStartPoint(de);
            }
            if (S[Q.targetNodeId]) {
              var ue = l.getNodeModelById(Q.targetNodeId), de = ue.anchors.find(function(R) {
                return R.id === Q.targetAnchorId;
              });
              Q.updateEndPoint(de);
            }
          });
        }), f.emit(pe.NODE_ROTATE, {
          e: a,
          model: u,
          data: u.getData()
        });
      }, r.style = n.style, r.stepperDrag = new Kn({
        onDragging: r.onDragging
      }), r;
    }
    return e.prototype.render = function() {
      var n = this, r = this.props.nodeModel, i = r.x, o = r.y, a = r.width, s = r.height, l = i + a / 2 + 20, u = o - s / 2 - 20;
      return this.normal = new Vt(1, 0), this.defaultAngle = this.normal.angle(new Vt(l - i, u - o)), r.defaultAngle = this.defaultAngle, B("g", { className: "lf-rotate-control", children: B("g", { onMouseDown: function(f) {
        n.stepperDrag.handleMouseDown(f);
      }, children: B(xo, If({}, this.style, { cx: l, cy: u })) }) });
    }, e;
  }(Ye)
);
function uu(t) {
  return t && t.__esModule && Object.prototype.hasOwnProperty.call(t, "default") ? t.default : t;
}
var Nu = { exports: {} };
/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/
var zp;
function OI() {
  return zp || (zp = 1, function(t) {
    (function() {
      var e = {}.hasOwnProperty;
      function n() {
        for (var o = "", a = 0; a < arguments.length; a++) {
          var s = arguments[a];
          s && (o = i(o, r(s)));
        }
        return o;
      }
      function r(o) {
        if (typeof o == "string" || typeof o == "number")
          return o;
        if (typeof o != "object")
          return "";
        if (Array.isArray(o))
          return n.apply(null, o);
        if (o.toString !== Object.prototype.toString && !o.toString.toString().includes("[native code]"))
          return o.toString();
        var a = "";
        for (var s in o)
          e.call(o, s) && o[s] && (a = i(a, s));
        return a;
      }
      function i(o, a) {
        return a ? o ? o + " " + a : o + a : o;
      }
      t.exports ? (n.default = n, t.exports = n) : window.classNames = n;
    })();
  }(Nu)), Nu.exports;
}
var AI = OI();
const jf = /* @__PURE__ */ uu(AI);
var CI = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), kf = function() {
  return kf = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, kf.apply(this, arguments);
}, TI = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, g_ = (
  /** @class */
  function(t) {
    CI(e, t);
    function e(n) {
      var r = t.call(this) || this;
      r.mouseDownHandler = function(o) {
        var a = r.props, s = a.draggable, l = a.model, u = a.graphModel, f = u.editConfigModel.nodeTextDraggable;
        (s ?? f) && (o.stopPropagation(), r.stepperDrag.model = l, r.stepperDrag.handleMouseDown(o));
      }, r.onDragging = function(o) {
        var a = o.deltaX, s = o.deltaY, l = r.props, u = l.model, f = l.graphModel.transformModel;
        if (a || s) {
          var c = TI(f.fixDeltaXY(a, s), 2), d = c[0], h = c[1];
          u.moveText(d, h);
        }
      }, r.dbClickHandler = function() {
        var o = r.props, a = o.editable, s = o.graphModel.eventCenter, l = o.model;
        a && l.setElementState(Qe.TEXT_EDIT), s.emit(pe.TEXT_DBCLICK, {
          data: l.text,
          model: l
        });
      };
      var i = n.draggable;
      return r.stepperDrag = new Kn({
        onDragging: r.onDragging,
        step: 1,
        // model,
        eventType: "TEXT",
        isStopPropagation: i
      }), r;
    }
    return e.prototype.getShape = function() {
      var n = this.props, r = n.model, i = n.graphModel, o = i.editConfigModel, a = r.text, s = a.value, l = a.x, u = a.y, f = a.editable, c = a.draggable, d = {
        x: l,
        y: u,
        className: "",
        value: s
      }, h = r.getTextStyle(), v = o.nodeTextDraggable || c;
      return B(c_, kf({}, d, h, { className: jf({
        "lf-element-text": f,
        "lf-text-draggable": !f && v,
        "lf-text-disabled": !f && !v
      }), model: r }));
    }, e.prototype.render = function() {
      var n = this.props.model.text;
      if (n)
        return B("g", { onMouseDown: this.mouseDownHandler, onDblClick: this.dbClickHandler, children: this.getShape() });
    }, e;
  }(Ye)
), NI = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), Qn = function() {
  return Qn = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Qn.apply(this, arguments);
}, ps = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, MI = (
  /** @class */
  function(t) {
    NI(e, t);
    function e(n) {
      var r = t.call(this, n) || this;
      return r.setHoverOn = function() {
        r.setState({
          isHovered: !0
        });
      }, r.setHoverOff = function() {
        r.setState({
          isHovered: !1
        });
      }, r.state = {
        isHovered: !1
      }, r;
    }
    return e.prototype.getBackground = function() {
      var n = this.state.isHovered, r = this.props.model, i = r.text, o = r.getTextStyle(), a = o.background || {};
      if (n && o.hover && o.hover.background && (a = Qn(Qn({}, a), o.hover.background)), i != null && i.value && (a == null ? void 0 : a.fill) !== "transparent") {
        var s = o.fontSize, l = o.textWidth, u = o.lineHeight, f = o.overflowMode, c = a.wrapPadding, d = i == null ? void 0 : i.value.split(/[\r\n]/g), h = d.length, v = i.x, p = i.y, g = {};
        if (f === "autoWrap" && l) {
          var y = u_({
            rows: d,
            style: {
              fontSize: "".concat(s, "px"),
              width: "".concat(l, "px"),
              lineHeight: u,
              padding: c
            },
            rowsLength: h,
            className: "lf-get-text-height"
          });
          g = Qn(Qn({}, a), { x: v, y: p, width: l, height: y });
        } else {
          var m = OR({ rows: d, rowsLength: h, fontSize: s }), A = m.width, T = m.height;
          if (f === "ellipsis" && (A = l, T = s + 2), typeof a.wrapPadding == "string") {
            var k = a.wrapPadding.split(",").filter(function(nt) {
              return nt.trim();
            }).map(function(nt) {
              return parseFloat(nt.trim());
            });
            if (k.length > 0 && k.length <= 4) {
              if (k.length === 1) {
                var C = ps(k, 1), S = C[0];
                k = [S, S, S, S];
              } else if (k.length === 2) {
                var I = ps(k, 2), X = I[0], Q = I[1];
                k = [X, Q, X, Q];
              } else if (k.length === 3) {
                var ue = ps(k, 3), de = ue[0], Q = ue[1], w = ue[2];
                k = [de, Q, w, Q];
              }
              var D = ps(k, 4), R = D[0], K = D[1], ye = D[2], Oe = D[3];
              A += K + Oe, T += R + ye, v = v + (K - Oe) / 2, p = p + (ye - R) / 2;
            }
          }
          g = Qn(Qn({}, a), { x: v - 1, y: p - 1, width: A, height: T });
        }
        return B($n, Qn({}, g));
      }
      return null;
    }, e.prototype.getShape = function() {
      var n = this.props.model, r = n.text, i = r.x, o = r.y, a = r.value;
      if (!a)
        return null;
      var s = n.getTextStyle(), l = Qn({ x: i, y: o, value: a, model: n, className: "lf-element-text" }, s);
      return B("g", { className: "lf-line-text", onMouseEnter: this.setHoverOn, onMouseLeave: this.setHoverOff, children: [this.getBackground(), B(c_, Qn({}, l))] });
    }, e;
  }(g_)
), PI = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), ol = function() {
  return ol = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, ol.apply(this, arguments);
}, DI = function(t, e) {
  var n = {};
  for (var r in t) Object.prototype.hasOwnProperty.call(t, r) && e.indexOf(r) < 0 && (n[r] = t[r]);
  if (t != null && typeof Object.getOwnPropertySymbols == "function")
    for (var i = 0, r = Object.getOwnPropertySymbols(t); i < r.length; i++)
      e.indexOf(r[i]) < 0 && Object.prototype.propertyIsEnumerable.call(t, r[i]) && (n[r[i]] = t[r[i]]);
  return n;
}, vs = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, vi = (
  /** @class */
  function(t) {
    PI(e, t);
    function e(n) {
      var r = t.call(this) || this;
      r.onDragStart = function(l) {
        var u = l.event, f = r.props, c = f.model, d = f.graphModel;
        if (u) {
          var h = d.getPointByClient({
            x: u.clientX,
            y: u.clientY
          }).canvasOverlayPosition, v = h.x, p = h.y;
          r.moveOffset = {
            dx: c.x - v,
            dy: c.y - p
          };
        }
      }, r.onDragging = function(l) {
        var u, f, c, d, h = l.event, v = r.props, p = v.model, g = v.graphModel, y = g.editConfigModel, m = y.stopMoveGraph, A = y.autoExpand, T = y.snapGrid, k = g.transformModel, C = g.selectNodes, S = g.width, I = g.height, X = g.gridSize;
        p.isDragging = !0;
        var Q = h, ue = Q.clientX, de = Q.clientY, w = g.getPointByClient({
          x: ue,
          y: de
        }).canvasOverlayPosition, D = w.x, R = w.y, K = vs(k.CanvasPointToHtmlPoint([D, R]), 2), ye = K[0], Oe = K[1];
        if (D = D + ((f = (u = r.moveOffset) === null || u === void 0 ? void 0 : u.dx) !== null && f !== void 0 ? f : 0), R = R + ((d = (c = r.moveOffset) === null || c === void 0 ? void 0 : c.dy) !== null && d !== void 0 ? d : 0), D = _o(D, X, T), R = _o(R, X, T), !S || !I) {
          g.moveNode2Coordinate(p.id, D, R);
          return;
        }
        var nt = ye < 0 || Oe < 0 || ye > S || Oe > I;
        if (!(A && !m && nt)) {
          var rt = vs(k.CanvasPointToHtmlPoint([
            D - p.width / 2,
            R - p.height / 2
          ]), 2), me = rt[0], ke = rt[1], ze = vs(k.CanvasPointToHtmlPoint([
            D + p.width / 2,
            R + p.height / 2
          ]), 2), Te = ze[0], Xe = ze[1], M = Math.max(X, 20), W = [];
          me < 0 ? W = [M, 0] : Te > g.width ? W = [-M, 0] : ke < 0 ? W = [0, M] : Xe > g.height && (W = [0, -M]), r.t && nl(r.t), p.transform = new su(-D, -R).rotate(p.rotate).translate(D, R).toString();
          var G = C.map(function(ee) {
            return ee.id;
          });
          G.indexOf(p.id) === -1 && (G = [p.id]), W.length > 0 && !m && A ? r.t = f_(function() {
            var ee = vs(W, 2), re = ee[0], ge = ee[1];
            k.translate(re ?? 0, ge ?? 0);
            var we = -(re ?? 0) / k.SCALE_X, ct = -(ge ?? 0) / k.SCALE_X;
            g.moveNodes(G, we, ct);
          }) : g.moveNodes(G, D - p.x, R - p.y);
        }
      }, r.onDragEnd = function() {
        r.t && nl(r.t);
        var l = r.props.model;
        l.isDragging = !1;
      }, r.onMouseOut = function(l) {
        tR() && r.setHoverOff(l);
      }, r.handleMouseUp = function() {
        var l = r.props.model;
        r.mouseUpDrag = l.isDragging;
      }, r.handleClick = function(l) {
        var u = r.mouseUpDrag === !1;
        if (r.startTime) {
          var f = r.props, c = f.model, d = f.graphModel;
          if (u) {
            var h = c.getData(), v = d.getPointByClient({
              x: l.clientX,
              y: l.clientY
            }), p = {
              data: h,
              e: l,
              position: v,
              isSelected: !1,
              isMultiple: !1
            }, g = l.button === 2, y = l.detail === 2;
            if (!g) {
              var m = d.editConfigModel, A = s_(l, m);
              p.isMultiple = A, c.isSelected && !y && A ? (p.isSelected = !1, c.setSelected(!1)) : (d.selectNodeById(c.id, A), p.isSelected = !0, m.isSilentMode || r.toFront()), y ? (m.nodeTextEdit && c.text.editable && m.textMode === zn.TEXT && (c.setSelected(!1), d.setElementStateById(c.id, Qe.TEXT_EDIT)), d.eventCenter.emit(pe.NODE_DBCLICK, p)) : (d.eventCenter.emit(pe.ELEMENT_CLICK, p), d.eventCenter.emit(pe.NODE_CLICK, p));
            }
          }
        }
      }, r.handleContextMenu = function(l) {
        l.preventDefault();
        var u = r.props, f = u.model, c = u.graphModel, d = c.editConfigModel, h = f.getData(), v = c.getPointByClient({
          x: l.clientX,
          y: l.clientY
        });
        c.setElementStateById(f.id, Qe.SHOW_MENU, v.domOverlayPosition), f.isSelected || c.selectNodeById(f.id), c.eventCenter.emit(pe.NODE_CONTEXTMENU, {
          data: h,
          e: l,
          position: v
        }), d.isSilentMode || r.toFront();
      }, r.handleMouseDown = function(l) {
        var u = r.props, f = u.model, c = u.graphModel;
        r.startTime = (/* @__PURE__ */ new Date()).getTime();
        var d = c.editConfigModel;
        d.adjustNodePosition && f.draggable && r.stepDrag && r.stepDrag.handleMouseDown(l);
      }, r.handleFocus = function() {
        var l = r.props, u = l.model, f = l.graphModel;
        f.eventCenter.emit(pe.NODE_FOCUS, {
          data: u.getData()
        });
      }, r.handleBlur = function() {
        var l = r.props, u = l.model, f = l.graphModel;
        f.eventCenter.emit(pe.NODE_BLUR, {
          data: u.getData()
        });
      }, r.setHoverOn = function(l) {
        var u = r.props, f = u.model, c = u.graphModel;
        if (!f.isHovered) {
          var d = f.getData();
          f.setHovered(!0), c.eventCenter.emit(pe.NODE_MOUSEENTER, {
            data: d,
            e: l
          });
        }
      }, r.setHoverOff = function(l) {
        var u = r.props, f = u.model, c = u.graphModel, d = f.getData();
        f.isHovered && (f.setHovered(!1), c.eventCenter.emit(pe.NODE_MOUSELEAVE, {
          data: d,
          e: l
        }));
      };
      var i = n.graphModel, o = i.gridSize, a = i.eventCenter, s = n.model;
      return r.stepDrag = new Kn({
        onDragStart: r.onDragStart,
        onDragging: r.onDragging,
        onDragEnd: r.onDragEnd,
        step: o,
        eventType: "NODE",
        isStopPropagation: !1,
        eventCenter: a,
        model: s
      }), r.modelDisposer = cg(function() {
        return r.props;
      }, function(l) {
        l && l.model && r.stepDrag.setModel(l.model);
      }), r;
    }
    return e.prototype.componentWillUnmount = function() {
      this.modelDisposer && this.modelDisposer(), this.render.$mobx && this.render.$mobx.dispose();
    }, e.prototype.componentDidMount = function() {
    }, e.prototype.componentDidUpdate = function() {
    }, e.prototype.getAnchorShape = function(n) {
      return null;
    }, e.prototype.getAnchors = function() {
      var n = this, r = this.props, i = r.model, o = r.graphModel, a = i.isSelected, s = i.isHitable, l = i.isDragging, u = i.isShowAnchor;
      return s && (a || u) && !l ? Dn(i.anchors, function(f, c) {
        var d = i.getAnchorLineStyle(f), h = i.getAnchorStyle(f);
        return B(EI, { anchorData: f, node: n, style: h, edgeStyle: d, anchorIndex: c, nodeModel: i, graphModel: o, setHoverOff: n.setHoverOff });
      }) : [];
    }, e.prototype.getRotateControl = function() {
      var n = this.props, r = n.model, i = n.graphModel, o = i.editConfigModel, a = o.isSilentMode, s = o.allowRotate, l = r.isSelected, u = r.isHitable, f = r.rotatable, c = r.isHovered, d = s && f, h = r.getRotateControlStyle();
      if (!a && u && (l || c) && d)
        return B(SI, { graphModel: i, nodeModel: r, eventCenter: i.eventCenter, style: h });
    }, e.prototype.getResizeControl = function() {
      var n = this.props, r = n.model, i = n.graphModel, o = i.editConfigModel, a = o.isSilentMode, s = o.allowResize, l = r.isSelected, u = r.isHitable, f = r.resizable, c = r.isHovered, d = s && f, h = r.getResizeControlStyle();
      return !a && u && (l || c) && d ? B(QR, { style: h, model: r, graphModel: i }) : null;
    }, e.prototype.getText = function() {
      var n, r = this.props, i = r.model, o = r.graphModel, a = o.editConfigModel;
      if (a.nodeTextMode !== zn.TEXT || i.state === Qe.TEXT_EDIT)
        return null;
      if (i.text) {
        var s = !1;
        return a.nodeTextDraggable && i.text.draggable && (s = !0), B(g_, { editable: a.nodeTextEdit && ((n = i.text.editable) !== null && n !== void 0 ? n : !0), model: i, graphModel: o, draggable: s });
      }
      return null;
    }, e.prototype.getStateClassName = function() {
      var n = this.props.model, r = n.state, i = n.isDragging, o = n.isSelected, a = "lf-node";
      switch (r) {
        case Qe.ALLOW_CONNECT:
          a += " lf-node-allow";
          break;
        case Qe.NOT_ALLOW_CONNECT:
          a += " lf-node-not-allow";
          break;
        default:
          a += " lf-node-default";
          break;
      }
      return i && (a += " lf-dragging"), o && (a += " lf-node-selected"), a;
    }, e.prototype.toFront = function() {
      var n = this.props, r = n.model, i = n.graphModel;
      r.autoToFront && i.toFront(r.id);
    }, e.prototype.render = function() {
      var n = this.props, r = n.model, i = n.graphModel, o = i.editConfigModel, a = o.hideAnchors, s = o.adjustNodePosition, l = o.allowRotate, u = o.allowResize, f = i.gridSize, c = i.transformModel.SCALE_X, d = r.isHitable, h = r.draggable, v = r.transform, p = r.getOuterGAttributes(), g = p.className, y = g === void 0 ? "" : g, m = DI(p, ["className"]), A = B("g", { className: "lf-node-content", children: [B("g", { transform: v, children: [this.getShape(), this.getText(), l && this.getRotateControl(), u && this.getResizeControl()] }), !a && this.getAnchors()] }), T;
      return d ? (s && h && this.stepDrag.setStep(f * c), T = B("g", ol({ className: "".concat(this.getStateClassName(), " ").concat(y), onMouseDown: this.handleMouseDown, onMouseUp: this.handleMouseUp, onClick: this.handleClick, onMouseEnter: this.setHoverOn, onMouseOver: this.setHoverOn, onMouseLeave: this.setHoverOff, onMouseOut: this.onMouseOut, onContextMenu: this.handleContextMenu, onFocus: this.handleFocus, onBlur: this.handleBlur }, m, { children: A }))) : T = B("g", ol({ className: "".concat(this.getStateClassName(), " ").concat(y) }, m, { children: A })), T;
    }, e.isObserved = !1, e;
  }(Ye)
), RI = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), Bf = function() {
  return Bf = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Bf.apply(this, arguments);
}, pr = (
  /** @class */
  function(t) {
    RI(e, t);
    function e() {
      return t !== null && t.apply(this, arguments) || this;
    }
    return e.prototype.getShape = function() {
      var n = this.props.model, r = n.getNodeStyle();
      return B($n, Bf({}, r, { x: n.x, y: n.y, width: n.width, height: n.height, radius: n.radius }));
    }, e;
  }(vi)
), LI = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), Ff = function() {
  return Ff = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Ff.apply(this, arguments);
}, So = (
  /** @class */
  function(t) {
    LI(e, t);
    function e() {
      return t !== null && t.apply(this, arguments) || this;
    }
    return e.prototype.getShape = function() {
      var n = this.props.model, r = n.x, i = n.y, o = n.r, a = n.getNodeStyle();
      return B(xo, Ff({}, a, { x: r, y: i, r: o }));
    }, e;
  }(vi)
), II = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), al = function() {
  return al = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, al.apply(this, arguments);
}, sl = (
  /** @class */
  function(t) {
    II(e, t);
    function e() {
      return t !== null && t.apply(this, arguments) || this;
    }
    return e.prototype.getShape = function() {
      var n = this.props.model, r = n, i = r.x, o = r.y, a = r.width, s = r.height, l = r.points, u = n.getNodeStyle(), f = {
        transform: "matrix(1 0 0 1 ".concat(i - a / 2, " ").concat(o - s / 2, ")")
      };
      return B("g", al({}, f, { children: B(vd, al({}, u, { points: l, x: i, y: o })) }));
    }, e;
  }(vi)
), jI = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), $f = function() {
  return $f = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, $f.apply(this, arguments);
}, Hf = (
  /** @class */
  function(t) {
    jI(e, t);
    function e() {
      return t !== null && t.apply(this, arguments) || this;
    }
    return e.prototype.getShape = function() {
      var n = this.props.model, r = n.getNodeStyle();
      return B("g", { children: B(vd, $f({}, r, { points: n.points, x: n.x, y: n.y })) });
    }, e;
  }(vi)
), kI = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), Wf = function() {
  return Wf = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Wf.apply(this, arguments);
}, zf = (
  /** @class */
  function(t) {
    kI(e, t);
    function e() {
      return t !== null && t.apply(this, arguments) || this;
    }
    return e.prototype.getShape = function() {
      var n = this.props.model, r = n.getNodeStyle();
      return B(UR, Wf({}, r, { x: n.x, y: n.y, rx: n.rx, ry: n.ry }));
    }, e;
  }(vi)
), BI = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), ya = function() {
  return ya = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, ya.apply(this, arguments);
}, Xp = (
  /** @class */
  function(t) {
    BI(e, t);
    function e() {
      return t !== null && t.apply(this, arguments) || this;
    }
    return e.prototype.getBackground = function() {
      var n = this.props.model, r = n.getTextStyle(), i = n.width, o = n.height, a = n.x, s = n.y, l = ya(ya({}, r.background), { x: a, y: s, width: i, height: o });
      return B($n, ya({}, l));
    }, e.prototype.getResizeControl = function() {
      return null;
    }, e.prototype.getShape = function() {
      return B("g", { children: this.getBackground() });
    }, e;
  }(vi)
), FI = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), Xf = function() {
  return Xf = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Xf.apply(this, arguments);
}, $I = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, HI = function(t, e, n) {
  if (n || arguments.length === 2) for (var r = 0, i = e.length, o; r < i; r++)
    (o || !(r in e)) && (o || (o = Array.prototype.slice.call(e, 0, r)), o[r] = e[r]);
  return t.concat(o || Array.prototype.slice.call(e));
}, Gf = (
  /** @class */
  function(t) {
    FI(e, t);
    function e() {
      var n = t.apply(this, HI([], $I(arguments), !1)) || this;
      return n.ref = Tl(), n;
    }
    return Object.defineProperty(e.prototype, "rootEl", {
      get: function() {
        return this.ref.current;
      },
      enumerable: !1,
      configurable: !0
    }), e.prototype.setHtml = function(n) {
      n.appendChild(document.createElement("div"));
    }, e.prototype.confirmUpdate = function(n) {
      this.setHtml(n);
    }, e.prototype.shouldUpdate = function() {
      return this.preProperties && this.preProperties === this.currentProperties ? !1 : (this.preProperties = this.currentProperties, !0);
    }, e.prototype.componentDidMount = function() {
      this.shouldUpdate() && this.rootEl && this.setHtml(this.rootEl);
    }, e.prototype.componentDidUpdate = function() {
      this.shouldUpdate() && this.rootEl && this.confirmUpdate(this.rootEl);
    }, e.prototype.componentWillUnmount = function() {
      t.prototype.componentWillUnmount.call(this), this.rootEl.innerHTML = "";
    }, e.prototype.getShape = function() {
      var n = this.props.model, r = n.x, i = n.y, o = n.height, a = n.width, s = n.getNodeStyle();
      return this.currentProperties = JSON.stringify(n.properties), B("foreignObject", Xf({}, s, { x: r - a / 2, y: i - o / 2, width: a, height: o, ref: this.ref }));
    }, e;
  }(vi)
), WI = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), er = function() {
  return er = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, er.apply(this, arguments);
}, zI = function(t, e) {
  var n = {};
  for (var r in t) Object.prototype.hasOwnProperty.call(t, r) && e.indexOf(r) < 0 && (n[r] = t[r]);
  if (t != null && typeof Object.getOwnPropertySymbols == "function")
    for (var i = 0, r = Object.getOwnPropertySymbols(t); i < r.length; i++)
      e.indexOf(r[i]) < 0 && Object.prototype.propertyIsEnumerable.call(t, r[i]) && (n[r[i]] = t[r[i]]);
  return n;
}, XI = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, Er;
(function(t) {
  t.SOURCE = "SOURCE", t.TARGET = "TARGET";
})(Er || (Er = {}));
var Gp = (
  /** @class */
  function(t) {
    WI(e, t);
    function e(n) {
      var r = t.call(this) || this;
      r.handleMouseDown = function(l) {
        r.stepDrag && r.stepDrag.handleMouseDown(l);
      }, r.onDragStart = function() {
        var l = r.props, u = l.x, f = l.y, c = l.edgeModel, d = c.startPoint, h = c.endPoint, v = c.pointsList;
        r.oldEdge = {
          startPoint: d,
          endPoint: h,
          pointsList: v
        }, r.setState({
          endX: u,
          endY: f,
          dragging: !0
        });
      }, r.onDragging = function(l) {
        var u = l.deltaX, f = l.deltaY, c = r.state, d = c.endX, h = c.endY, v = r.props, p = v.graphModel, g = v.type, y = p.transformModel, m = p.editConfigModel, A = XI(y.moveCanvasPointByHtml([d, h], u, f), 2), T = A[0], k = A[1];
        r.setState({
          endX: T,
          endY: k,
          dragging: !0
        });
        var C = r.props.edgeModel, S = el({
          x: d,
          y: h
        }, p);
        if (S && S.node && r.isAllowAdjust(S).pass) {
          var I = C.startPoint, X = C.endPoint, Q = C.sourceNode, ue = C.targetNode, de = g === Er.SOURCE ? {
            startPoint: {
              x: S.anchor.x,
              y: S.anchor.y
            },
            endPoint: {
              x: X.x,
              y: X.y
            },
            sourceNode: S.node,
            targetNode: ue
          } : {
            startPoint: {
              x: I.x,
              y: I.y
            },
            endPoint: {
              x: S.anchor.x,
              y: S.anchor.y
            },
            sourceNode: Q,
            targetNode: S.node
          };
          C.updateAfterAdjustStartAndEnd(de);
        } else
          g === Er.SOURCE ? C.updateStartPoint({ x: T, y: k }) : C.updateEndPoint({ x: T, y: k });
        C.text.value && m.adjustEdge && C.setText(Object.assign({}, C.text, C.textPosition));
      }, r.onDragEnd = function(l) {
        var u, f, c, d = l.event;
        try {
          r.setState({
            dragging: !1
          });
          var h = r.props, v = h.graphModel, p = h.edgeModel, g = h.type, y = r.state, m = y.endX, A = y.endY, T = y.dragging, k = el({
            x: m,
            y: A
          }, v);
          if (!T)
            return;
          var C = !1, S = void 0;
          if (k && k.node) {
            var I = r.isAllowAdjust(k), X = I.pass, Q = I.msg, ue = I.newTargetNode;
            if (X) {
              var de = p.getData(), w = de.text, D = de.sourceAnchorId, R = D === void 0 ? "" : D, K = de.targetAnchorId, ye = K === void 0 ? "" : K, Oe = zI(de, ["text", "sourceAnchorId", "targetAnchorId"]);
              if (S = er(er({ sourceAnchorId: R, targetAnchorId: ye }, Oe), { text: (w == null ? void 0 : w.value) || "" }), g === Er.SOURCE) {
                var nt = v.getNodeModelById(k.node.id), rt = v.getNodeModelById(p.targetNodeId), me = (u = v.edgeGenerator) === null || u === void 0 ? void 0 : u.call(v, nt == null ? void 0 : nt.getData(), rt == null ? void 0 : rt.getData(), S);
                S = er(er({}, me), { sourceNodeId: k.node.id, sourceAnchorId: k.anchor.id, startPoint: {
                  x: k.anchor.x,
                  y: k.anchor.y
                }, targetNodeId: p.targetNodeId, endPoint: er({}, p.endPoint) }), p.sourceNodeId === k.node.id && p.sourceAnchorId === k.anchor.id && (C = !0);
              } else if (g === Er.TARGET) {
                var nt = v.getNodeModelById(p.sourceNodeId), rt = v.getNodeModelById(k.node.id), me = (f = v.edgeGenerator) === null || f === void 0 ? void 0 : f.call(v, nt == null ? void 0 : nt.getData(), rt == null ? void 0 : rt.getData(), S);
                S = er(er({}, me), { sourceNodeId: p.sourceNodeId, startPoint: er({}, p.startPoint), targetNodeId: k.node.id, targetAnchorId: k.anchor.id, endPoint: {
                  x: k.anchor.x,
                  y: k.anchor.y
                } }), p.targetNodeId === k.node.id && p.targetAnchorId === k.anchor.id && (C = !0);
              }
            } else {
              C = !0;
              var ke = ue.getData();
              v.eventCenter.emit(pe.CONNECTION_NOT_ALLOWED, {
                data: ke,
                msg: Q
              });
            }
          } else
            C = !0;
          if (C)
            r.recoveryEdge();
          else {
            var ze = p.getData();
            v.deleteEdgeById(p.id);
            var Te = v.addEdge(er({}, S));
            v.eventCenter.emit(pe.EDGE_EXCHANGE_NODE, {
              data: {
                newEdge: Te.getData(),
                oldEdge: ze
              }
            });
          }
          (c = r.preTargetNode) === null || c === void 0 || c.setElementState(Qe.DEFAULT);
        } finally {
          var v = r.props.graphModel;
          v.eventCenter.emit(pe.ADJUST_POINT_DRAGEND, {
            e: d,
            data: r.stepDragData
          });
        }
      }, r.recoveryEdge = function() {
        var l = r.props.edgeModel, u = r.oldEdge, f = u.startPoint, c = u.endPoint, d = u.pointsList;
        l.updateStartPoint(f), l.updateEndPoint(c), l.modelType !== $e.LINE_EDGE && (l.pointsList = d ?? [], l.initPoints());
      }, r.getAdjustPointStyle = function() {
        var l = r.props.graphModel.theme, u = l.edgeAdjust;
        return u;
      }, r.state = {
        dragging: !1,
        endX: 0,
        endY: 0
      }, r.targetRuleResults = /* @__PURE__ */ new Map(), r.sourceRuleResults = /* @__PURE__ */ new Map();
      var i = n.type, o = n.edgeModel, a = n.graphModel, s = a.eventCenter;
      return r.stepDragData = {
        type: i,
        edgeData: o.getData()
      }, r.stepDrag = new Kn({
        onDragStart: r.onDragStart,
        onDragging: r.onDragging,
        onDragEnd: r.onDragEnd,
        eventType: "ADJUST_POINT",
        isStopPropagation: !1,
        eventCenter: s,
        data: r.stepDragData
      }), r;
    }
    return e.prototype.isAllowAdjust = function(n) {
      var r = this.props, i = r.edgeModel, o = i.id, a = i.sourceNode, s = i.targetNode, l = i.sourceAnchorId, u = i.targetAnchorId, f = r.type, c, d, h, v;
      if (f === Er.SOURCE ? (c = n.node, d = s, h = n.anchor, v = s.getAnchorInfo(u)) : (c = a, d = n.node, v = n.anchor, h = a.getAnchorInfo(l)), this.preTargetNode && this.preTargetNode !== n.node && this.preTargetNode.setElementState(Qe.DEFAULT), this.preTargetNode = n.node, v.id === h.id)
        return {
          pass: !1,
          msg: "",
          newTargetNode: d
        };
      var p = "".concat(c.id, "_").concat(d.id, "_").concat(h.id, "_").concat(v.id);
      if (!this.targetRuleResults.has(p)) {
        var g = c.isAllowConnectedAsSource(d, h, v, o), y = d.isAllowConnectedAsTarget(c, h, v, o);
        this.sourceRuleResults.set(p, tl(g)), this.targetRuleResults.set(p, tl(y));
      }
      var m = this.sourceRuleResults.get(p), A = m.isAllPass, T = m.msg, k = this.targetRuleResults.get(p), C = k.isAllPass, S = k.msg, I = A && C ? Qe.ALLOW_CONNECT : Qe.NOT_ALLOW_CONNECT;
      return f === Er.SOURCE ? c.setElementState(I) : d.setElementState(I), {
        pass: A && C,
        msg: S || T,
        newTargetNode: d
      };
    }, e.prototype.render = function() {
      var n = this.props, r = n.x, i = n.y, o = n.getAdjustPointShape, a = n.edgeModel, s = this.state.dragging;
      return B("g", { pointerEvents: s ? "none" : "", onMouseDown: this.handleMouseDown, children: s ? "" : o(r, i, a) });
    }, e;
  }(Ye)
), GI = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), Uf = function() {
  return Uf = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Uf.apply(this, arguments);
};
(function(t) {
  GI(e, t);
  function e() {
    return t !== null && t.apply(this, arguments) || this;
  }
  return e.prototype.getArrowAttributes = function() {
    var n = this.props, r = n.arrowInfo, i = n.style, o = r.start, a = r.end, s = {
      start: o,
      end: a,
      offset: i.offset,
      verticalLength: i.verticalLength,
      type: "end"
    }, l = Da(s), u = l.leftX, f = l.leftY, c = l.rightX, d = l.rightY;
    return Uf({ d: "M".concat(u, " ").concat(f, " L").concat(a.x, " ").concat(a.y, " L").concat(c, " ").concat(d, " z") }, i);
  }, e.prototype.getShape = function() {
    var n = this.getArrowAttributes(), r = n.d, i = n.strokeWidth, o = n.stroke, a = n.fill;
    return B(Ia, { d: r, fill: a, strokeWidth: i, stroke: o });
  }, e.prototype.render = function() {
    return B("g", { className: "lf-arrow", children: this.getShape() });
  }, e;
})(Ye);
var UI = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), ma = function() {
  return ma = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, ma.apply(this, arguments);
}, YI = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, fu = (
  /** @class */
  function(t) {
    UI(e, t);
    function e() {
      var n = t.call(this) || this;
      return n.textRef = Tl(), n.handleHover = function(r, i) {
        var o = n.props, a = o.model, s = o.graphModel.eventCenter;
        a.setHovered(r);
        var l = r ? pe.EDGE_MOUSEENTER : pe.EDGE_MOUSELEAVE, u = a.getData();
        s.emit(l, {
          data: u,
          e: i
        });
      }, n.setHoverOn = function(r) {
        var i = n.props.model.isHovered;
        i || (n.textRef && n.textRef.current && n.textRef.current.setHoverOn(), n.handleHover(!0, r));
      }, n.setHoverOff = function(r) {
        var i = n.props.model.isHovered;
        i && (n.textRef && n.textRef.current && n.textRef.current.setHoverOff(), n.handleHover(!1, r));
      }, n.handleContextMenu = function(r) {
        r.preventDefault(), n.contextMenuTime = (/* @__PURE__ */ new Date()).getTime(), n.clickTimer && clearTimeout(n.clickTimer);
        var i = n.props, o = i.model, a = i.graphModel, s = a.editConfigModel, l = a.getPointByClient({
          x: r.clientX,
          y: r.clientY
        });
        a.setElementStateById(o.id, Qe.SHOW_MENU, l.domOverlayPosition), s.isSilentMode || n.toFront(), o.isSelected || a.selectEdgeById(o.id);
        var u = o == null ? void 0 : o.getData();
        a.eventCenter.emit(pe.EDGE_CONTEXTMENU, {
          data: u,
          e: r,
          position: l
        });
      }, n.handleMouseDown = function(r) {
        r.stopPropagation(), n.startTime = (/* @__PURE__ */ new Date()).getTime();
      }, n.handleMouseUp = function() {
        var r = n.props.model;
        n.mouseUpDrag = r.isDragging;
      }, n.handleClick = function(r) {
        if (n.startTime && !n.mouseUpDrag) {
          var i = r.button === 2;
          if (!i) {
            var o = r.detail === 2, a = n.props, s = a.model, l = a.graphModel, u = s == null ? void 0 : s.getData(), f = l.getPointByClient({
              x: r.clientX,
              y: r.clientY
            });
            if (o) {
              var c = l.editConfigModel, d = l.textEditElement, h = s.id, v = s.text, p = s.modelType;
              if (d && d.id === h && l.setElementStateById(h, Qe.DEFAULT), c.edgeTextEdit && v.editable && (s.setSelected(!1), l.setElementStateById(h, Qe.TEXT_EDIT)), p === $e.POLYLINE_EDGE) {
                var g = s, y = l.getPointByClient({
                  x: r.x,
                  y: r.y
                }).canvasOverlayPosition, m = y.x, A = y.y;
                g.dbClickPosition = a_({
                  x: m,
                  y: A
                }, g.points);
              }
              l.eventCenter.emit(pe.EDGE_DBCLICK, {
                data: u,
                e: r,
                position: f
              });
            } else
              l.eventCenter.emit(pe.ELEMENT_CLICK, {
                data: u,
                e: r,
                position: f
              }), l.eventCenter.emit(pe.EDGE_CLICK, {
                data: u,
                e: r,
                position: f
              });
            var T = l.editConfigModel;
            l.selectEdgeById(s.id, s_(r, T)), T.isSilentMode || n.toFront();
          }
        }
      }, n.handleFocus = function() {
        var r = n.props, i = r.model, o = r.graphModel;
        o.eventCenter.emit(pe.EDGE_FOCUS, {
          data: i.getData()
        });
      }, n.handleBlur = function() {
        var r = n.props, i = r.model, o = r.graphModel;
        o.eventCenter.emit(pe.EDGE_BLUR, {
          data: i.getData()
        });
      }, n;
    }
    return e.prototype.getShape = function() {
      return B("g", { children: this.getEdge() });
    }, e.prototype.getTextStyle = function() {
    }, e.prototype.getText = function() {
      var n, r = this.props, i = r.model, o = r.graphModel, a = o.editConfigModel;
      if (a.edgeTextMode !== zn.TEXT || i.state === Qe.TEXT_EDIT)
        return null;
      if (i.text) {
        var s = !1;
        return a.edgeTextDraggable && i.text.draggable && (s = !0), B(MI, { ref: this.textRef, editable: a.edgeTextEdit && ((n = i.text.editable) !== null && n !== void 0 ? n : !0), model: i, graphModel: o, draggable: s });
      }
      return null;
    }, e.prototype.getArrowInfo = function() {
      var n = this.props.model, r = n.startPoint, i = n.endPoint, o = n.isSelected, a = this.state.hover;
      return {
        start: r,
        end: i,
        hover: a,
        isSelected: o
      };
    }, e.prototype.getLastTwoPoints = function() {
      var n = this.props.model, r = n.startPoint, i = n.endPoint;
      return [r, i];
    }, e.prototype.getArrowStyle = function() {
      return console.error("getArrowStyle is deprecated in 1.2.0, please use model.getArrowStyle"), null;
    }, e.prototype.getArrow = function() {
      var n = this.props.model, r = n.id, i = n.getArrowStyle(), o = i.refY, a = o === void 0 ? 0 : o, s = i.refX, l = s === void 0 ? 2 : s, u = YI(this.getLastTwoPoints(), 2), f = u[0], c = u[1], d = "auto";
      return f !== null && c !== null && (d = vL(pL({
        x: c.x - f.x,
        y: c.y - f.y
      }))), B("g", { children: B("defs", { children: [B("marker", { id: "marker-start-".concat(r), refX: -l, refY: a, overflow: "visible", orient: "auto", markerUnits: "userSpaceOnUse", children: this.getStartArrow() }), B("marker", { id: "marker-end-".concat(r), refX: l, refY: a, overflow: "visible", orient: d, markerUnits: "userSpaceOnUse", children: this.getEndArrow() })] }) });
    }, e.prototype.getStartArrow = function() {
      return B("path", {});
    }, e.prototype.getEndArrow = function() {
      var n = this.props.model, r = n.getArrowStyle(), i = r.stroke, o = r.strokeWidth, a = r.offset, s = r.verticalLength;
      return B("path", { stroke: i, fill: i, strokeWidth: o, transform: "rotate(180)", d: "M 0 0 L ".concat(a, " -").concat(s, " L ").concat(a, " ").concat(s, " Z") });
    }, e.prototype.getAdjustPointShape = function(n, r, i) {
      var o = i.getAdjustPointStyle();
      return B(xo, ma({ className: "lf-edge-adjust-point" }, o, { x: n, y: r }));
    }, e.prototype.getAdjustPoints = function() {
      var n = this.props, r = n.model, i = n.graphModel, o = i.editConfigModel, a = o.adjustEdgeStartAndEnd, s = o.adjustEdgeStart, l = o.adjustEdgeEnd, u = r.getAdjustStart(), f = r.getAdjustEnd();
      return B("g", { children: [a && s && B(Gp, ma({ type: Er.SOURCE }, u, { getAdjustPointShape: this.getAdjustPointShape, edgeModel: r, graphModel: i })), a && l && B(Gp, ma({ type: Er.TARGET }, f, { getAdjustPointShape: this.getAdjustPointShape, edgeModel: r, graphModel: i }))] });
    }, e.prototype.getAnimation = function() {
      console.error("getAnimation is deprecated in 1.2.0, please use model.getEdgeAnimationStyle");
    }, e.prototype.getAppendWidth = function() {
      return B("g", {});
    }, e.prototype.getAppend = function() {
      return B("g", { className: "lf-edge-append", children: this.getAppendWidth() });
    }, e.prototype.getEdge = function() {
      return null;
    }, e.prototype.toFront = function() {
      var n = this.props, r = n.graphModel, i = n.model;
      r.toFront(i.id);
    }, e.prototype.render = function() {
      var n = this.props.model, r = n.isSelected, i = n.isHitable, o = n.isShowAdjustPoint;
      return B("g", { children: [B("g", { className: [
        "lf-edge",
        !i && "pointer-none",
        r && "lf-edge-selected"
      ].filter(Boolean).join(" "), onMouseDown: this.handleMouseDown, onMouseUp: this.handleMouseUp, onClick: this.handleClick, onContextMenu: this.handleContextMenu, onMouseOver: this.setHoverOn, onMouseEnter: this.setHoverOn, onMouseLeave: this.setHoverOff, onFocus: this.handleFocus, onBlur: this.handleBlur, children: [this.getShape(), this.getAppend(), this.getText(), this.getArrow()] }), o && r ? this.getAdjustPoints() : ""] });
    }, e.isObserved = !1, e;
  }(Ye)
), VI = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), Yf = function() {
  return Yf = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Yf.apply(this, arguments);
}, KI = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, Up = (
  /** @class */
  function(t) {
    VI(e, t);
    function e() {
      return t !== null && t.apply(this, arguments) || this;
    }
    return e.prototype.getEdge = function() {
      var n = this.props.model, r = n.getEdgeStyle(), i = n, o = i.path, a = i.isAnimation, s = i.arrowConfig, l = n.getEdgeAnimationStyle(), u = l.strokeDasharray, f = l.stroke, c = l.strokeDashoffset, d = l.animationName, h = l.animationDuration, v = l.animationIterationCount, p = l.animationTimingFunction, g = l.animationDirection;
      return B(Ia, Yf({ d: o }, r, s, a ? {
        strokeDasharray: u,
        stroke: f,
        style: {
          strokeDashoffset: c,
          animationName: d,
          animationDuration: h,
          animationIterationCount: v,
          animationTimingFunction: p,
          animationDirection: g
        }
      } : {}));
    }, e.prototype.getAppendWidth = function() {
      var n = this.props.model.path;
      return B(Ia, { d: n, strokeWidth: 10, stroke: "transparent", fill: "none" });
    }, e.prototype.getArrowInfo = function() {
      var n = this.props.model, r = this.state.hover, i = n.isSelected, o = n.getArrowStyle().offset, a = n.pointsList.map(function(c) {
        return {
          x: c.x,
          y: c.y
        };
      }), s = KI(Op(a, o), 2), l = s[0], u = s[1], f = {
        start: l,
        end: u,
        hover: r,
        isSelected: i
      };
      return f;
    }, e.prototype.getLastTwoPoints = function() {
      var n = this.props.model, r = n.getArrowStyle().offset, i = n.pointsList.map(function(o) {
        return {
          x: o.x,
          y: o.y
        };
      });
      return Op(i, r);
    }, e;
  }(fu)
), qI = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), Vf = function() {
  return Vf = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Vf.apply(this, arguments);
}, Yp = (
  /** @class */
  function(t) {
    qI(e, t);
    function e() {
      return t !== null && t.apply(this, arguments) || this;
    }
    return e.prototype.getEdge = function() {
      var n = this.props.model, r = n.startPoint, i = n.endPoint, o = n.isAnimation, a = n.arrowConfig, s = n.getEdgeStyle(), l = n.getEdgeAnimationStyle(), u = l.strokeDasharray, f = l.stroke, c = l.strokeDashoffset, d = l.animationName, h = l.animationDuration, v = l.animationIterationCount, p = l.animationTimingFunction, g = l.animationDirection;
      return B(bo, Vf({}, s, { x1: r.x, y1: r.y, x2: i.x, y2: i.y }, a, o ? {
        strokeDasharray: u,
        stroke: f,
        style: {
          strokeDashoffset: c,
          animationName: d,
          animationDuration: h,
          animationIterationCount: v,
          animationTimingFunction: p,
          animationDirection: g
        }
      } : {}));
    }, e.prototype.getAppendWidth = function() {
      var n = this.props.model, r = n.startPoint, i = n.endPoint, o = {
        start: r,
        end: i
      }, a = ER(o), s = a.d, l = a.strokeWidth, u = a.fill, f = a.strokeDasharray, c = a.stroke;
      return B(Ia, { d: s, fill: u, strokeWidth: l, stroke: c, strokeDasharray: f });
    }, e;
  }(fu)
), ZI = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), Ai = function() {
  return Ai = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Ai.apply(this, arguments);
}, JI = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, Oo = (
  /** @class */
  function(t) {
    ZI(e, t);
    function e() {
      var n = t.call(this) || this;
      return n.onDragStart = function() {
        var r = n.props.model;
        r.dragAppendStart(), n.isShowAdjustPointTemp = r.isShowAdjustPoint, r.isShowAdjustPoint = !1;
      }, n.onDragging = function(r) {
        var i = r.deltaX, o = r.deltaY, a = n.props, s = a.model, l = a.graphModel;
        n.isDragging = !0;
        var u = l.transformModel, f = l.editConfigModel, c = JI(u.fixDeltaXY(i, o), 2), d = c[0], h = c[1], v = s, p = f.adjustEdgeMiddle;
        p ? n.appendInfo = v.dragAppendSimple(n.appendInfo, {
          x: d,
          y: h
        }) : n.appendInfo = v.dragAppend(n.appendInfo, {
          x: d,
          y: h
        });
      }, n.onDragEnd = function() {
        var r, i = n.props, o = i.model, a = i.graphModel.eventCenter, s = o;
        s.dragAppendEnd(), n.isDragging = !1, s.isShowAdjustPoint = (r = n.isShowAdjustPointTemp) !== null && r !== void 0 ? r : !1, n.appendInfo = void 0, a.emit(pe.EDGE_ADJUST, { data: s.getData() });
      }, n.beforeDragStart = function(r, i) {
        i.draggable && n.drag.handleMouseDown(r), n.appendInfo = i;
      }, n.drag = new Kn({
        onDragStart: n.onDragStart,
        onDragging: n.onDragging,
        onDragEnd: n.onDragEnd,
        isStopPropagation: !1
      }), n;
    }
    return e.prototype.getEdge = function() {
      var n = this.props.model, r = n.points, i = n.isAnimation, o = n.arrowConfig, a = n.getEdgeStyle(), s = n.getEdgeAnimationStyle(), l = s.strokeDasharray, u = s.stroke, f = s.strokeDashoffset, c = s.animationName, d = s.animationDuration, h = s.animationIterationCount, v = s.animationTimingFunction, p = s.animationDirection;
      return B(KR, Ai({ points: r }, a, o, i ? {
        strokeDasharray: l,
        stroke: u,
        style: {
          strokeDashoffset: f,
          animationName: c,
          animationDuration: d,
          animationIterationCount: h,
          animationTimingFunction: v,
          animationDirection: p
        }
      } : {}));
    }, e.prototype.getArrowInfo = function() {
      var n = this.props.model, r = n.points, i = n.isSelected, o = this.state.hover, a = ki(r), s = a[0], l = a[0];
      return a.length >= 2 && (s = a[a.length - 2], l = a[a.length - 1]), {
        start: s,
        end: l,
        hover: o,
        isSelected: i
      };
    }, e.prototype.getLastTwoPoints = function() {
      var n = this.props.model, r = n.points, i = ki(r), o = i[0], a = i[0];
      return i.length >= 2 && (o = i[i.length - 2], a = i[i.length - 1]), [o, a];
    }, e.prototype.getAppendAttributes = function(n) {
      var r = n.start, i = n.end, o;
      if (r.x === i.x && r.y === i.y)
        o = "";
      else {
        var a = {
          start: r,
          end: i,
          offset: 10,
          verticalLength: 5
        }, s = Da(Ai(Ai({}, a), { type: "start" })), l = Da(Ai(Ai({}, a), { type: "end" }));
        o = "M".concat(s.leftX, " ").concat(s.leftY, `
      L`).concat(s.rightX, " ").concat(s.rightY, `
      L`).concat(l.rightX, " ").concat(l.rightY, `
      L`).concat(l.leftX, " ").concat(l.leftY, " z");
      }
      return {
        d: o,
        fill: "transparent",
        stroke: "transparent",
        strokeWidth: 1,
        strokeDasharray: "4, 4"
      };
    }, e.prototype.getAppendShape = function(n) {
      var r = this.getAppendAttributes(n), i = r.d, o = r.strokeWidth, a = r.fill, s = r.strokeDasharray, l = r.stroke;
      return B(Ia, { d: i, fill: a, strokeWidth: o, stroke: l, strokeDasharray: s });
    }, e.prototype.getAppendWidth = function() {
      for (var n = this, r = this.props, i = r.model, o = r.graphModel, a = i.pointsList, s = i.draggable, l = [], u = a.length, f = function(h) {
        var v = "lf-polyline-append", p = {
          start: {
            x: a[h].x,
            y: a[h].y
          },
          end: {
            x: a[h + 1].x,
            y: a[h + 1].y
          },
          startIndex: h,
          endIndex: h + 1,
          direction: bt.HORIZONTAL,
          draggable: !0
        }, g = B("g", { className: v, children: c.getAppendShape(p) }), y = o.editConfigModel, m = y.adjustEdge, A = y.adjustEdgeMiddle;
        if (m && s) {
          var T = p.startIndex, k = p.endIndex, C = A && (T === 0 || k === u - 1);
          p.draggable = !C, p.start.x === p.end.x ? (p.draggable && (v += "-ew-resize"), p.direction = bt.VERTICAL) : p.start.y === p.end.y && (p.draggable && (v += "-ns-resize"), p.direction = bt.HORIZONTAL), g = B("g", { className: c.isDragging ? "lf-dragging" : "lf-drag-able", onMouseDown: function(S) {
            return n.beforeDragStart(S, p);
          }, children: B("g", { className: v, children: c.getAppendShape(p) }) });
        }
        l.push(g);
      }, c = this, d = 0; d < u - 1; d++)
        f(d);
      return B("g", { children: l });
    }, e;
  }(fu)
), oo = function() {
  return oo = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, oo.apply(this, arguments);
}, QI = (
  /** @class */
  function() {
    function t(e) {
      var n = this;
      this.nodeConfig = null, this.fakeNode = null, this.stopDrag = function() {
        n.nodeConfig = null, window.document.removeEventListener("mouseup", n.stopDrag);
      }, this.dragEnter = function(i) {
        !n.nodeConfig || n.fakeNode || (n.fakeNode = n.lf.createFakeNode(oo(oo({}, n.nodeConfig), n.clientToLocalPoint({
          x: i.clientX,
          y: i.clientY
        }))));
      }, this.onDragOver = function(i) {
        if (i.preventDefault(), n.fakeNode) {
          var o = n.clientToLocalPoint({
            x: i.clientX,
            y: i.clientY
          }), a = o.x, s = o.y;
          n.fakeNode.moveTo(a, s);
          var l = n.fakeNode.getData();
          n.lf.setNodeSnapLine(l), n.lf.graphModel.eventCenter.emit(pe.NODE_DND_DRAG, {
            data: l,
            e: i
          });
        }
        return !1;
      }, this.onDragLeave = function() {
        n.fakeNode && (n.lf.removeNodeSnapLine(), n.lf.graphModel.removeFakeNode(), n.fakeNode = null);
      }, this.onDrop = function(i) {
        !n.lf.graphModel || !i || !n.nodeConfig || (n.lf.addNode(oo(oo({}, n.nodeConfig), n.clientToLocalPoint({
          x: i.clientX,
          y: i.clientY
        })), pe.NODE_DND_ADD, i), i.preventDefault(), i.stopPropagation(), n.nodeConfig = null, n.lf.removeNodeSnapLine(), n.lf.graphModel.removeFakeNode(), n.fakeNode = null);
      };
      var r = e.lf;
      this.lf = r;
    }
    return t.prototype.clientToLocalPoint = function(e) {
      var n = e.x, r = e.y, i = Io(this.lf.options, ["grid", "size"]), o = this.lf.graphModel.getPointByClient({
        x: n,
        y: r
      }), a = o.canvasOverlayPosition, s = a.x, l = a.y, u = this.lf.graphModel.editConfigModel.snapGrid;
      return {
        x: _o(s, i, u),
        y: _o(l, i, u)
      };
    }, t.prototype.startDrag = function(e) {
      var n = this.lf.graphModel.editConfigModel;
      n != null && n.isSilentMode || (this.nodeConfig = e, window.document.addEventListener("mouseup", this.stopDrag));
    }, t.prototype.eventMap = function() {
      return {
        onMouseEnter: this.dragEnter,
        onMouseOver: this.dragEnter,
        // IE11
        onMouseMove: this.onDragOver,
        onMouseLeave: this.onDragLeave,
        // onMouseOut: this.onDragLeave, // IE11
        onMouseUp: this.onDrop
      };
    }, t;
  }()
);
function e3(t, e) {
  t.on("node:mousemove", function(n) {
    var r = n.data;
    e.setNodeSnapLine(r);
  }), t.on("node:mouseup", function() {
    e.clearSnapline();
  });
}
var t3 = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), Lr = function() {
  return Lr = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Lr.apply(this, arguments);
}, n3 = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, r3 = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, i3 = (
  /** @class */
  function(t) {
    t3(e, t);
    function e(n) {
      var r = t.call(this, n) || this;
      return r.ref = Tl(), r.__prevText = {
        type: "",
        text: "",
        id: ""
      }, r.keyupHandler = function(i) {
        var o = r.props.graphModel.textEditElement;
        i.key === "Enter" && i.altKey && (o == null || o.setElementState(Qe.DEFAULT));
      }, r.inputHandler = function(i) {
        var o = i.target.innerText, a = r.props.graphModel.textEditElement;
        a && (r.__prevText = {
          type: a.type,
          text: o.replace(/(\r\n)+$|(\n)+$/, ""),
          // fix #488: 文本后面的换行符不保留
          id: a.id
        });
      }, r.keydownHandler = function(i) {
        i.stopPropagation();
      }, r.state = {
        style: {
          left: 0,
          top: 0
        }
      }, r;
    }
    return e.getDerivedStateFromProps = function(n) {
      var r, i = n.textEditElement, o = n.graphModel, a = o.transformModel, s = o.theme, l = s.inputText, u;
      if (i) {
        if (!(!((r = i.text) === null || r === void 0) && r.value) && i.BaseType === At.EDGE) {
          var f = i.text, c = i.textPosition, d = c.x, h = c.y;
          f.x = d, f.y = h, i.setText(f);
        }
        var v = {
          resize: "auto",
          whiteSpace: "normal",
          wordBreak: "break-all"
        };
        if (i.BaseType === At.EDGE) {
          var p = s.edgeText, g = p.overflowMode, y = p.lineHeight, m = p.wrapPadding, A = p.textWidth;
          A && g === "autoWrap" && (u = Lr(Lr({}, v), { width: A, minWidth: A, lineHeight: y, padding: m }));
        } else if (i.BaseType === At.NODE) {
          var T = s.nodeText, g = T.overflowMode, y = T.lineHeight, m = T.wrapPadding, A = T.textWidth, k = i.width, C = i.modelType, S = i.textWidth, I = S || A || k;
          (C !== $e.TEXT_NODE && g === "autoWrap" || C === $e.TEXT_NODE && A) && (u = Lr(Lr({}, v), { width: I, minWidth: I, lineHeight: y, padding: m }));
        }
        var X = i.text, Q = X.x, ue = X.y, de = r3(a.CanvasPointToHtmlPoint([Q, ue]), 2), w = de[0], D = de[1];
        return {
          style: Lr(Lr({ left: w, top: D }, u), l)
        };
      }
      return null;
    }, e.prototype.componentDidUpdate = function() {
      var n = this.props.graphModel;
      if (this.ref.current && (this.ref.current.focus(), this.placeCaretAtEnd(this.ref.current)), this.__prevText.id !== "") {
        var r = this.__prevText, i = r.text, o = r.id;
        n.updateText(o, i), n.eventCenter.emit(pe.TEXT_UPDATE, {
          data: Lr({}, this.__prevText)
        }), this.__prevText.id = "", this.__prevText.text = "", this.__prevText.type = "";
      }
    }, e.prototype.placeCaretAtEnd = function(n) {
      if (window.getSelection !== void 0 && document.createRange !== void 0) {
        var r = document.createRange();
        r.selectNodeContents(n), r.collapse(!1);
        var i = window.getSelection();
        i == null || i.removeAllRanges(), i == null || i.addRange(r);
      }
    }, e.prototype.render = function() {
      var n, r = this.props.graphModel.textEditElement, i = this.state.style;
      return r ? B("div", { contentEditable: !0, className: "lf-text-input", style: i, ref: this.ref, onKeyUp: this.keyupHandler, onKeyDown: this.keydownHandler, onKeyPress: this.keydownHandler, onInput: this.inputHandler, children: (n = r.text) === null || n === void 0 ? void 0 : n.value }, r.id) : null;
    }, e.toolName = "text-edit-tool", e = n3([
      sn
    ], e), e;
  }(Ye)
), o3 = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), a3 = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, Mu = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, s3 = function(t, e, n) {
  if (n || arguments.length === 2) for (var r = 0, i = e.length, o; r < i; r++)
    (o || !(r in e)) && (o || (o = Array.prototype.slice.call(e, 0, r)), o[r] = e[r]);
  return t.concat(o || Array.prototype.slice.call(e));
}, l3 = (
  /** @class */
  function(t) {
    o3(e, t);
    function e(n) {
      var r = t.call(this, n) || this;
      r.handleMouseDown = function(s) {
        r.stepDrag.handleMouseDown(s);
      }, r.handleWheelEvent = function(s) {
        var l, u;
        s.preventDefault();
        var f = s.deltaX, c = s.deltaY, d = s.clientX, h = s.clientY, v = s.ctrlKey, p = new WheelEvent("wheel", {
          deltaX: f,
          deltaY: c,
          clientX: d,
          clientY: h,
          ctrlKey: v
        });
        (u = (l = r.props.lf.container) === null || l === void 0 ? void 0 : l.querySelector('.lf-canvas-overlay[name="canvas-overlay"]')) === null || u === void 0 || u.dispatchEvent(p);
      }, r.onDragging = function(s) {
        var l = s.deltaX, u = s.deltaY, f = r.props, c = f.graphModel, d = f.lf, h = d.getTransform(), v = h.SCALE_X, p = h.SCALE_Y, g = c.getSelectElements(!0);
        c.moveNodes(g.nodes.map(function(y) {
          return y.id;
        }), l / v, u / p);
      }, r.handleContextMenu = function(s) {
        s.preventDefault();
        var l = r.props, u = l.graphModel, f = l.graphModel, c = f.eventCenter, d = f.selectElements, h = u.getPointByClient({
          x: s.clientX,
          y: s.clientY
        }), v = {
          nodes: [],
          edges: []
        }, p = s3([], Mu(d.values()), !1);
        p.forEach(function(g) {
          g.BaseType === At.NODE && v.nodes.push(g.getData()), g.BaseType === At.EDGE && v.edges.push(g.getData());
        }), c.emit(pe.SELECTION_CONTEXTMENU, {
          data: v,
          e: s,
          position: h
        });
      };
      var i = n.graphModel, o = i.gridSize, a = i.eventCenter;
      return r.stepDrag = new Kn({
        onDragging: r.onDragging,
        step: o,
        eventType: "SELECTION",
        eventCenter: a
      }), r;
    }
    return e.prototype.render = function() {
      var n, r, i = this.props.graphModel, o = i.selectElements, a = i.transformModel, s = this.props.lf.getTransform(), l = s.SCALE_X, u = s.SCALE_Y;
      if (!(o.size <= 1)) {
        var f = Number.MAX_SAFE_INTEGER, c = Number.MAX_SAFE_INTEGER, d = Number.MIN_SAFE_INTEGER, h = Number.MIN_SAFE_INTEGER;
        o.forEach(function(p) {
          var g;
          p.BaseType === At.NODE && (g = oR(p)), p.BaseType === At.EDGE && (g = uR(p)), g !== void 0 && (f = Math.min(f, g.x), c = Math.min(c, g.y), d = Math.max(d, g.x1), h = Math.max(h, g.y1));
        }), n = Mu(a.CanvasPointToHtmlPoint([f, c]), 2), f = n[0], c = n[1], r = Mu(a.CanvasPointToHtmlPoint([d, h]), 2), d = r[0], h = r[1];
        var v = {
          left: "".concat(f - 20 * l / 2, "px"),
          top: "".concat(c - 20 * u / 2, "px"),
          width: "".concat(d - f + 20 * l, "px"),
          height: "".concat(h - c + 20 * u, "px"),
          "border-width": "".concat(2 * l, "px")
        };
        return B("div", { className: "lf-multiple-select", style: v, onMouseDown: this.handleMouseDown, onContextMenu: this.handleContextMenu, onWheel: this.handleWheelEvent });
      }
    }, e.toolName = "multiple-select-tool", e = a3([
      sn
    ], e), e;
  }(Ye)
), Pu = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, u3 = [i3, l3], f3 = (
  /** @class */
  function() {
    function t(e) {
      var n = this;
      this.toolMap = /* @__PURE__ */ new Map(), this.disabledToolMap = /* @__PURE__ */ new Map(), this.instance = e, at(u3, function(o) {
        n.isDisabled(o.toolName) || n.registerTool(o.toolName, o);
      });
      var r = e.graphModel, i = r.eventCenter;
      i.on("".concat(pe.GRAPH_TRANSFORM, ",").concat(pe.NODE_CLICK, ",").concat(pe.BLANK_CLICK, " "), function() {
        var o, a = r.textEditElement, s = r.editConfigModel, l = s.edgeTextEdit, u = s.nodeTextEdit;
        (l || u) && a && ((o = r.textEditElement) === null || o === void 0 || o.setElementState(Qe.DEFAULT));
      });
    }
    return t.prototype.isDisabled = function(e) {
      var n;
      return ((n = this.instance.options.disabledTools) === null || n === void 0 ? void 0 : n.indexOf(e)) !== -1;
    }, t.prototype.registerTool = function(e, n) {
      this.toolMap.set(e, n);
    }, t.prototype.disableTool = function(e) {
      var n = this.toolMap.get(e);
      if (n)
        return this.disabledToolMap.set(e, n), this.toolMap.delete(e), !0;
      throw new Error("禁用失败，不存在名为 ${tool} 的工具");
    }, t.prototype.enableTool = function(e) {
      var n = this.disabledToolMap.get(e);
      if (n)
        return this.toolMap.set(e, n), this.disabledToolMap.delete(e), !0;
      throw new Error("不存在名为 ${tool} 的工具");
    }, t.prototype.getTools = function() {
      return Array.from(this.toolMap.values());
    }, t.prototype.getInstance = function() {
      return this.instance;
    }, t.prototype.destroy = function() {
      this.toolMap.clear(), this.disabledToolMap.clear();
    }, Pu([
      H
    ], t.prototype, "toolMap", void 0), Pu([
      F
    ], t.prototype, "disableTool", null), Pu([
      F
    ], t.prototype, "enableTool", null), t;
  }()
);
function c3(t) {
  throw new Error("[mobx-utils] " + t);
}
function ll(t, e) {
  e === void 0 && (e = "Illegal state"), t || c3(e);
}
var y_ = function(t) {
  return t && t !== Object.prototype && Object.getOwnPropertyNames(t).concat(y_(Object.getPrototypeOf(t)) || []);
}, d3 = function(t) {
  var e = y_(t), n = e.filter(function(r, i) {
    return e.indexOf(r) === i;
  });
  return n;
}, h3 = function(t) {
  return d3(t).filter(function(e) {
    return e !== "constructor" && !~e.indexOf("__");
  });
}, m_ = "pending", ul = "fulfilled", yd = "rejected";
function p3(t) {
  switch (this.state) {
    case m_:
      return t.pending && t.pending(this.value);
    case yd:
      return t.rejected && t.rejected(this.value);
    case ul:
      return t.fulfilled ? t.fulfilled(this.value) : this.value;
  }
}
function Vp(t, e) {
  if (ll(arguments.length <= 2, "fromPromise expects up to two arguments"), ll(typeof t == "function" || typeof t == "object" && t && typeof t.then == "function", "Please pass a promise or function to fromPromise"), t.isPromiseBasedObservable === !0)
    return t;
  typeof t == "function" && (t = new Promise(t));
  var n = t;
  t.then(F("observableFromPromise-resolve", function(i) {
    n.value = i, n.state = ul;
  }), F("observableFromPromise-reject", function(i) {
    n.value = i, n.state = yd;
  })), n.isPromiseBasedObservable = !0, n.case = p3;
  var r = e && e.state === ul ? e.value : void 0;
  return Qu(n, {
    value: r,
    state: m_
  }, {}, { deep: !1 }), n;
}
(function(t) {
  t.reject = F("fromPromise.reject", function(n) {
    var r = t(Promise.reject(n));
    return r.state = yd, r.value = n, r;
  });
  function e(n) {
    n === void 0 && (n = void 0);
    var r = t(Promise.resolve(n));
    return r.state = ul, r.value = n, r;
  }
  t.resolve = F("fromPromise.resolve", e);
})(Vp || (Vp = {}));
var gs = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
};
(function() {
  function t(e, n) {
    var r = this;
    F0(function() {
      r.current = n, r.subscription = e.subscribe(r);
    });
  }
  return t.prototype.dispose = function() {
    this.subscription && this.subscription.unsubscribe();
  }, t.prototype.next = function(e) {
    this.current = e;
  }, t.prototype.complete = function() {
    this.dispose();
  }, t.prototype.error = function(e) {
    this.current = e, this.dispose();
  }, gs([
    H.ref
  ], t.prototype, "current", void 0), gs([
    F.bound
  ], t.prototype, "next", null), gs([
    F.bound
  ], t.prototype, "complete", null), gs([
    F.bound
  ], t.prototype, "error", null), t;
})();
var fl = function() {
  return fl = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, fl.apply(this, arguments);
}, qo = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, v3 = ["model", "reset", "submit", "isDirty", "isPropertyDirty", "resetProperty"];
(function() {
  function t(e) {
    var n = this;
    this.model = e, this.localValues = H.map({}), this.localComputedValues = H.map({}), this.isPropertyDirty = function(r) {
      return n.localValues.has(r);
    }, ll(vr(e), "createViewModel expects an observable object"), h3(e).forEach(function(r) {
      if (!(r === Me || r === "__mobxDidRunLazyInitializers")) {
        if (ll(v3.indexOf(r) === -1, "The propertyname " + r + " is reserved and cannot be used with viewModels"), Ld(e, r)) {
          var i = Rl(e, r).derivation;
          n.localComputedValues.set(r, yt(i.bind(n)));
        }
        var o = Object.getOwnPropertyDescriptor(e, r), a = o ? { enumerable: o.enumerable } : {};
        Object.defineProperty(n, r, fl(fl({}, a), { configurable: !0, get: function() {
          return Ld(e, r) ? n.localComputedValues.get(r).get() : n.isPropertyDirty(r) ? n.localValues.get(r) : n.model[r];
        }, set: F(function(s) {
          s !== n.model[r] ? n.localValues.set(r, s) : n.localValues.delete(r);
        }) }));
      }
    });
  }
  return Object.defineProperty(t.prototype, "isDirty", {
    get: function() {
      return this.localValues.size > 0;
    },
    enumerable: !1,
    configurable: !0
  }), Object.defineProperty(t.prototype, "changedValues", {
    get: function() {
      return this.localValues.toJS();
    },
    enumerable: !1,
    configurable: !0
  }), t.prototype.submit = function() {
    var e = this;
    yo(this.localValues).forEach(function(n) {
      var r = e.localValues.get(n), i = e.model[n];
      Cr(i) ? i.replace(r) : un(i) ? (i.clear(), i.merge(r)) : mg(r) || (e.model[n] = r);
    }), this.localValues.clear();
  }, t.prototype.reset = function() {
    this.localValues.clear();
  }, t.prototype.resetProperty = function(e) {
    this.localValues.delete(e);
  }, qo([
    yt
  ], t.prototype, "isDirty", null), qo([
    yt
  ], t.prototype, "changedValues", null), qo([
    F.bound
  ], t.prototype, "submit", null), qo([
    F.bound
  ], t.prototype, "reset", null), qo([
    F.bound
  ], t.prototype, "resetProperty", null), t;
})();
function Du(t) {
  if (!t)
    return "ROOT";
  for (var e = []; t.parent; )
    e.push(t.path), t = t.parent;
  return e.reverse().join("/");
}
function Ru(t) {
  return vr(t) || Cr(t) || un(t);
}
function g3(t, e) {
  var n = /* @__PURE__ */ new WeakMap();
  function r(s) {
    var l = n.get(s.object);
    i(s, l), e(s, Du(l), t);
  }
  function i(s, l) {
    switch (s.type) {
      // Object changes
      case "add":
        o(s.newValue, l, s.name);
        break;
      case "update":
        a(s.oldValue), o(s.newValue, l, s.name || "" + s.index);
        break;
      case "remove":
      // object
      case "delete":
        a(s.oldValue);
        break;
      // Array changes
      case "splice":
        s.removed.map(a), s.added.forEach(function(c, d) {
          return o(c, l, "" + (s.index + d));
        });
        for (var u = s.index + s.addedCount; u < s.object.length; u++)
          if (Ru(s.object[u])) {
            var f = n.get(s.object[u]);
            f && (f.path = "" + u);
          }
        break;
    }
  }
  function o(s, l, u) {
    if (Ru(s)) {
      var f = n.get(s);
      if (f) {
        if (f.parent !== l || f.path !== u)
          throw new Error("The same observable object cannot appear twice in the same tree," + (" trying to assign it to '" + Du(l) + "/" + u + "',") + (" but it already exists at '" + Du(f.parent) + "/" + f.path + "'"));
      } else {
        var c = {
          parent: l,
          path: u,
          dispose: _g(s, r)
        };
        n.set(s, c), K0(s).forEach(function(d) {
          var h = d[0], v = d[1];
          return o(v, c, h);
        });
      }
    }
  }
  function a(s) {
    if (Ru(s)) {
      var l = n.get(s);
      if (!l)
        return;
      n.delete(s), l.dispose(), V0(s).forEach(a);
    }
  }
  return o(t, void 0, ""), function() {
    a(t);
  };
}
var y3 = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) i.hasOwnProperty(o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}();
(function(t) {
  y3(e, t);
  function e(n, r, i) {
    var o = i === void 0 ? {} : i, a = o.name, s = a === void 0 ? "ogm" + (Math.random() * 1e3 | 0) : a, l = o.keyToName, u = l === void 0 ? function(d) {
      return "" + d;
    } : l, f = t.call(this) || this;
    f._keyToName = u, f._groupBy = r, f._ogmInfoKey = Symbol("ogmInfo" + s), f._base = n;
    for (var c = 0; c < n.length; c++)
      f._addItem(n[c]);
    return f._disposeBaseObserver = _g(f._base, function(d) {
      if (d.type === "splice")
        ir(function() {
          for (var h = 0, v = d.removed; h < v.length; h++) {
            var p = v[h];
            f._removeItem(p);
          }
          for (var g = 0, y = d.added; g < y.length; g++) {
            var m = y[g];
            f._addItem(m);
          }
        });
      else if (d.type === "update")
        ir(function() {
          f._removeItem(d.oldValue), f._addItem(d.newValue);
        });
      else
        throw new Error("illegal state");
    }), f;
  }
  return e.prototype.clear = function() {
    throw new Error("not supported");
  }, e.prototype.delete = function(n) {
    throw new Error("not supported");
  }, e.prototype.set = function(n, r) {
    throw new Error("not supported");
  }, e.prototype.dispose = function() {
    this._disposeBaseObserver();
    for (var n = 0; n < this._base.length; n++) {
      var r = this._base[n], i = r[this._ogmInfoKey];
      i.reaction(), delete r[this._ogmInfoKey];
    }
  }, e.prototype._getGroupArr = function(n) {
    var r = t.prototype.get.call(this, n);
    return r === void 0 && (r = H([], { name: "GroupArray[" + this._keyToName(n) + "]", deep: !1 }), t.prototype.set.call(this, n, r)), r;
  }, e.prototype._removeFromGroupArr = function(n, r) {
    var i = t.prototype.get.call(this, n);
    i.length === 1 ? t.prototype.delete.call(this, n) : (r === i.length - 1 || (i[r] = i[i.length - 1], i[r][this._ogmInfoKey].groupArrIndex = r), i.length--);
  }, e.prototype._addItem = function(n) {
    var r = this, i = this._groupBy(n), o = this._getGroupArr(i), a = {
      groupByValue: i,
      groupArrIndex: o.length,
      reaction: cg(function() {
        return r._groupBy(n);
      }, function(s, l) {
        var u = n[r._ogmInfoKey];
        r._removeFromGroupArr(u.groupByValue, u.groupArrIndex);
        var f = r._getGroupArr(s), c = f.length;
        f.push(n), u.groupByValue = s, u.groupArrIndex = c;
      })
    };
    Object.defineProperty(n, this._ogmInfoKey, {
      configurable: !0,
      enumerable: !1,
      value: a
    }), o.push(n);
  }, e.prototype._removeItem = function(n) {
    var r = n[this._ogmInfoKey];
    this._removeFromGroupArr(r.groupByValue, r.groupArrIndex), r.reaction(), delete n[this._ogmInfoKey];
  }, e;
})(gc);
Promise.resolve(), typeof queueMicrotask < "u" || typeof process < "u" && process.nextTick;
var Kf = function() {
  return Kf = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Kf.apply(this, arguments);
}, m3 = (
  /** @class */
  function() {
    function t(e) {
      this.undos = [], this.redos = [], this.callbacks = [], this.stopWatch = null, this.curData = null, this.maxSize = 50, this.waitTime = 100, this.eventCenter = e;
    }
    return t.prototype.add = function(e) {
      hf(Pn(this.undos), e) || (this.undos.push(e), hf(this.curData, e) || (this.redos = []), this.eventCenter.emit(pe.HISTORY_CHANGE, {
        data: {
          undos: this.undos,
          redos: this.redos,
          undoAble: this.undoAble(),
          redoAble: this.redoAble()
        }
      }), this.undos.length > this.maxSize && this.undos.shift());
    }, t.prototype.undoAble = function() {
      return this.undos.length > 1;
    }, t.prototype.undo = function() {
      if (this.undoAble()) {
        var e = this.undos.pop();
        this.redos.push(e);
        var n = this.undos.pop();
        return this.curData = Fe(n), n;
      }
    }, t.prototype.redoAble = function() {
      return this.redos.length > 0;
    }, t.prototype.redo = function() {
      if (this.redoAble()) {
        var e = this.redos.pop();
        return this.curData = Fe(e), e;
      }
    }, t.prototype.watch = function(e) {
      var n = this;
      this.stopWatch && this.stopWatch(), this.undos.push(e.modelToGraphData()), this.stopWatch = g3(
        // TODO：避免用户触发「The same observable object cannot appear twice in the same tree」 错误
        // 例如：在自定义节点的 setAttributes 方法中，将 nodeModel 属性赋值给另一个 observable 属性
        // eg:
        // setAttributes() {
        //   this.width = 120
        //   this.height = 50
        //
        //   if (this.text) {
        //     this.properties.text = this.text;
        //     this.text.value = '';
        //   }
        // }
        // 解决方案：使用 cloneDeep 方法，将 observable 对象克隆一份。需要测试下面操作是否会造成其它问题
        // https://stackoverflow.com/questions/55328504/a-node-cannot-exists-twice-in-the-state-tree-mobx-state-tree
        // cloneDeep(model),
        e,
        Yl(function() {
          var r = e.modelToHistoryData();
          r && n.add(Kf({}, r));
        }, this.waitTime)
      );
    }, t.prototype.destroy = function() {
      this.undos = [], this.redos = [], this.curData = null, this.stopWatch && this.stopWatch();
    }, t;
  }()
), Lu = { exports: {} }, Kp;
function _3() {
  return Kp || (Kp = 1, function(t) {
    (function(e, n, r) {
      if (!e)
        return;
      for (var i = {
        8: "backspace",
        9: "tab",
        13: "enter",
        16: "shift",
        17: "ctrl",
        18: "alt",
        20: "capslock",
        27: "esc",
        32: "space",
        33: "pageup",
        34: "pagedown",
        35: "end",
        36: "home",
        37: "left",
        38: "up",
        39: "right",
        40: "down",
        45: "ins",
        46: "del",
        91: "meta",
        93: "meta",
        224: "meta"
      }, o = {
        106: "*",
        107: "+",
        109: "-",
        110: ".",
        111: "/",
        186: ";",
        187: "=",
        188: ",",
        189: "-",
        190: ".",
        191: "/",
        192: "`",
        219: "[",
        220: "\\",
        221: "]",
        222: "'"
      }, a = {
        "~": "`",
        "!": "1",
        "@": "2",
        "#": "3",
        $: "4",
        "%": "5",
        "^": "6",
        "&": "7",
        "*": "8",
        "(": "9",
        ")": "0",
        _: "-",
        "+": "=",
        ":": ";",
        '"': "'",
        "<": ",",
        ">": ".",
        "?": "/",
        "|": "\\"
      }, s = {
        option: "alt",
        command: "meta",
        return: "enter",
        escape: "esc",
        plus: "+",
        mod: /Mac|iPod|iPhone|iPad/.test(navigator.platform) ? "meta" : "ctrl"
      }, l, u = 1; u < 20; ++u)
        i[111 + u] = "f" + u;
      for (u = 0; u <= 9; ++u)
        i[u + 96] = u.toString();
      function f(S, I, X) {
        if (S.addEventListener) {
          S.addEventListener(I, X, !1);
          return;
        }
        S.attachEvent("on" + I, X);
      }
      function c(S) {
        if (S.type == "keypress") {
          var I = String.fromCharCode(S.which);
          return S.shiftKey || (I = I.toLowerCase()), I;
        }
        return i[S.which] ? i[S.which] : o[S.which] ? o[S.which] : String.fromCharCode(S.which).toLowerCase();
      }
      function d(S, I) {
        return S.sort().join(",") === I.sort().join(",");
      }
      function h(S) {
        var I = [];
        return S.shiftKey && I.push("shift"), S.altKey && I.push("alt"), S.ctrlKey && I.push("ctrl"), S.metaKey && I.push("meta"), I;
      }
      function v(S) {
        if (S.preventDefault) {
          S.preventDefault();
          return;
        }
        S.returnValue = !1;
      }
      function p(S) {
        if (S.stopPropagation) {
          S.stopPropagation();
          return;
        }
        S.cancelBubble = !0;
      }
      function g(S) {
        return S == "shift" || S == "ctrl" || S == "alt" || S == "meta";
      }
      function y() {
        if (!l) {
          l = {};
          for (var S in i)
            S > 95 && S < 112 || i.hasOwnProperty(S) && (l[i[S]] = S);
        }
        return l;
      }
      function m(S, I, X) {
        return X || (X = y()[S] ? "keydown" : "keypress"), X == "keypress" && I.length && (X = "keydown"), X;
      }
      function A(S) {
        return S === "+" ? ["+"] : (S = S.replace(/\+{2}/g, "+plus"), S.split("+"));
      }
      function T(S, I) {
        var X, Q, ue, de = [];
        for (X = A(S), ue = 0; ue < X.length; ++ue)
          Q = X[ue], s[Q] && (Q = s[Q]), I && I != "keypress" && a[Q] && (Q = a[Q], de.push("shift")), g(Q) && de.push(Q);
        return I = m(Q, de, I), {
          key: Q,
          modifiers: de,
          action: I
        };
      }
      function k(S, I) {
        return S === null || S === n ? !1 : S === I ? !0 : k(S.parentNode, I);
      }
      function C(S) {
        var I = this;
        if (S = S || n, !(I instanceof C))
          return new C(S);
        I.target = S, I._callbacks = {}, I._directMap = {};
        var X = {}, Q, ue = !1, de = !1, w = !1;
        function D(me) {
          me = me || {};
          var ke = !1, ze;
          for (ze in X) {
            if (me[ze]) {
              ke = !0;
              continue;
            }
            X[ze] = 0;
          }
          ke || (w = !1);
        }
        function R(me, ke, ze, Te, Xe, M) {
          var W, G, ee = [], re = ze.type;
          if (!I._callbacks[me])
            return [];
          for (re == "keyup" && g(me) && (ke = [me]), W = 0; W < I._callbacks[me].length; ++W)
            if (G = I._callbacks[me][W], !(!Te && G.seq && X[G.seq] != G.level) && re == G.action && (re == "keypress" && !ze.metaKey && !ze.ctrlKey || d(ke, G.modifiers))) {
              var ge = !Te && G.combo == Xe, we = Te && G.seq == Te && G.level == M;
              (ge || we) && I._callbacks[me].splice(W, 1), ee.push(G);
            }
          return ee;
        }
        function K(me, ke, ze, Te) {
          I.stopCallback(ke, ke.target || ke.srcElement, ze, Te) || me(ke, ze) === !1 && (v(ke), p(ke));
        }
        I._handleKey = function(me, ke, ze) {
          var Te = R(me, ke, ze), Xe, M = {}, W = 0, G = !1;
          for (Xe = 0; Xe < Te.length; ++Xe)
            Te[Xe].seq && (W = Math.max(W, Te[Xe].level));
          for (Xe = 0; Xe < Te.length; ++Xe) {
            if (Te[Xe].seq) {
              if (Te[Xe].level != W)
                continue;
              G = !0, M[Te[Xe].seq] = 1, K(Te[Xe].callback, ze, Te[Xe].combo, Te[Xe].seq);
              continue;
            }
            G || K(Te[Xe].callback, ze, Te[Xe].combo);
          }
          var ee = ze.type == "keypress" && de;
          ze.type == w && !g(me) && !ee && D(M), de = G && ze.type == "keydown";
        };
        function ye(me) {
          typeof me.which != "number" && (me.which = me.keyCode);
          var ke = c(me);
          if (ke) {
            if (me.type == "keyup" && ue === ke) {
              ue = !1;
              return;
            }
            I.handleKey(ke, h(me), me);
          }
        }
        function Oe() {
          clearTimeout(Q), Q = setTimeout(D, 1e3);
        }
        function nt(me, ke, ze, Te) {
          X[me] = 0;
          function Xe(re) {
            return function() {
              w = re, ++X[me], Oe();
            };
          }
          function M(re) {
            K(ze, re, me), Te !== "keyup" && (ue = c(re)), setTimeout(D, 10);
          }
          for (var W = 0; W < ke.length; ++W) {
            var G = W + 1 === ke.length, ee = G ? M : Xe(Te || T(ke[W + 1]).action);
            rt(ke[W], ee, Te, me, W);
          }
        }
        function rt(me, ke, ze, Te, Xe) {
          I._directMap[me + ":" + ze] = ke, me = me.replace(/\s+/g, " ");
          var M = me.split(" "), W;
          if (M.length > 1) {
            nt(me, M, ke, ze);
            return;
          }
          W = T(me, ze), I._callbacks[W.key] = I._callbacks[W.key] || [], R(W.key, W.modifiers, { type: W.action }, Te, me, Xe), I._callbacks[W.key][Te ? "unshift" : "push"]({
            callback: ke,
            modifiers: W.modifiers,
            action: W.action,
            seq: Te,
            level: Xe,
            combo: me
          });
        }
        I._bindMultiple = function(me, ke, ze) {
          for (var Te = 0; Te < me.length; ++Te)
            rt(me[Te], ke, ze);
        }, f(S, "keypress", ye), f(S, "keydown", ye), f(S, "keyup", ye);
      }
      C.prototype.bind = function(S, I, X) {
        var Q = this;
        return S = S instanceof Array ? S : [S], Q._bindMultiple.call(Q, S, I, X), Q;
      }, C.prototype.unbind = function(S, I) {
        var X = this;
        return X.bind.call(X, S, function() {
        }, I);
      }, C.prototype.trigger = function(S, I) {
        var X = this;
        return X._directMap[S + ":" + I] && X._directMap[S + ":" + I]({}, S), X;
      }, C.prototype.reset = function() {
        var S = this;
        return S._callbacks = {}, S._directMap = {}, S;
      }, C.prototype.stopCallback = function(S, I) {
        var X = this;
        if ((" " + I.className + " ").indexOf(" mousetrap ") > -1 || k(I, X.target))
          return !1;
        if ("composedPath" in S && typeof S.composedPath == "function") {
          var Q = S.composedPath()[0];
          Q !== S.target && (I = Q);
        }
        return I.tagName == "INPUT" || I.tagName == "SELECT" || I.tagName == "TEXTAREA" || I.isContentEditable;
      }, C.prototype.handleKey = function() {
        var S = this;
        return S._handleKey.apply(S, arguments);
      }, C.addKeycodes = function(S) {
        for (var I in S)
          S.hasOwnProperty(I) && (i[I] = S[I]);
        l = null;
      }, C.init = function() {
        var S = C(n);
        for (var I in S)
          I.charAt(0) !== "_" && (C[I] = /* @__PURE__ */ function(X) {
            return function() {
              return S[X].apply(S, arguments);
            };
          }(I));
      }, C.init(), e.Mousetrap = C, t.exports && (t.exports = C);
    })(typeof window < "u" ? window : null, typeof window < "u" ? document : null);
  }(Lu)), Lu.exports;
}
var b3 = _3();
const x3 = /* @__PURE__ */ uu(b3);
var mr = null;
function qp(t, e) {
  return t.x += e, t.y += e, Qc(t.text) || (t.text.x += e, t.text.y += e), t;
}
function Zp(t, e) {
  return t.startPoint && (t.startPoint.x += e, t.startPoint.y += e), t.endPoint && (t.endPoint.x += e, t.endPoint.y += e), t.pointsList && t.pointsList.length > 0 && t.pointsList.forEach(function(n) {
    n.x += e, n.y += e;
  }), Qc(t.text) || (t.text.x += e, t.text.y += e), t;
}
var Ji = 40, ys = 40;
function E3(t, e) {
  var n = t.keyboard, r = n.options.keyboard;
  n.on(["cmd + c", "ctrl + c"], function() {
    if (ys = Ji, !(r != null && r.enabled) || e.textEditElement)
      return !0;
    var i = t.options.guards, o = e.getSelectElements(!1), a = i && i.beforeClone ? i.beforeClone(o) : !0;
    return !a || o.nodes.length === 0 && o.edges.length === 0 ? (mr = null, !0) : (mr = o, mr.nodes.forEach(function(s) {
      return qp(s, Ji);
    }), mr.edges.forEach(function(s) {
      return Zp(s, Ji);
    }), !1);
  }), n.on(["cmd + v", "ctrl + v"], function() {
    if (!(r != null && r.enabled) || e.textEditElement)
      return !0;
    if (mr && (mr.nodes || mr.edges)) {
      t.clearSelectElements();
      var i = t.addElements(mr, ys);
      if (!i)
        return !0;
      i.nodes.forEach(function(o) {
        return t.selectElementById(o.id, !0);
      }), i.edges.forEach(function(o) {
        return t.selectElementById(o.id, !0);
      }), mr.nodes.forEach(function(o) {
        return qp(o, Ji);
      }), mr.edges.forEach(function(o) {
        return Zp(o, Ji);
      }), ys = ys + Ji;
    }
    return !1;
  }), n.on(["cmd + z", "ctrl + z"], function() {
    return !(r != null && r.enabled) || e.textEditElement ? !0 : (t.undo(), !1);
  }), n.on(["cmd + y", "ctrl + y"], function() {
    return !(r != null && r.enabled) || e.textEditElement ? !0 : (t.redo(), !1);
  }), n.on(["backspace"], function() {
    if (!(r != null && r.enabled) || e.textEditElement)
      return !0;
    var i = e.getSelectElements(!0);
    return t.clearSelectElements(), i.edges.forEach(function(o) {
      return o.id && t.deleteEdge(o.id);
    }), i.nodes.forEach(function(o) {
      return o.id && t.deleteNode(o.id);
    }), !1;
  });
}
var w3 = (
  /** @class */
  function() {
    function t(e) {
      e.keyboard || (e.keyboard = { enabled: !1 }), this.options = e;
      var n = e.lf;
      this.target = n.container, this.mousetrap = new x3(this.target), e.keyboard.enabled && !n.options.isSilentMode && this.enable(!0);
    }
    return t.prototype.initShortcuts = function() {
      var e = this, n, r = ((n = this.options.keyboard) !== null && n !== void 0 ? n : {}).shortcuts;
      if (r)
        if (Ie(r))
          r.forEach(function(s) {
            var l = s.keys, u = s.callback, f = s.action;
            return e.on(l, u, f);
          });
        else {
          var i = r.keys, o = r.callback, a = r.action;
          this.on(i, o, a);
        }
    }, t.prototype.on = function(e, n, r) {
      this.mousetrap.bind(this.getKeys(e), n, r);
    }, Object.defineProperty(t.prototype, "disabled", {
      get: function() {
        var e, n;
        return ((n = (e = this.options) === null || e === void 0 ? void 0 : e.keyboard) === null || n === void 0 ? void 0 : n.enabled) !== !0;
      },
      enumerable: !1,
      configurable: !0
    }), t.prototype.off = function(e, n) {
      this.mousetrap.unbind(this.getKeys(e), n);
    }, t.prototype.enable = function(e) {
      (this.disabled || e) && (this.options.keyboard && (this.options.keyboard.enabled = !0), this.target instanceof HTMLElement && (this.target.setAttribute("tabindex", "-1"), this.target.style.outline = "none"));
    }, t.prototype.disable = function() {
      this.disabled || (this.options.keyboard && (this.options.keyboard.enabled = !1), this.target instanceof HTMLElement && this.target.removeAttribute("tabindex"));
    }, t.prototype.destroy = function() {
      this.mousetrap.reset();
    }, t.prototype.getKeys = function(e) {
      var n = this;
      return (Array.isArray(e) ? e : [e]).map(function(r) {
        return n.formatKey(r);
      });
    }, t.prototype.formatKey = function(e) {
      return e.toLowerCase().replace(/\s/g, "").replace("delete", "del").replace("cmd", "command");
    }, t;
  }()
), qr = function() {
  return qr = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, qr.apply(this, arguments);
}, ms = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, Iu = function(t, e, n) {
  if (n || arguments.length === 2) for (var r = 0, i = e.length, o; r < i; r++)
    (o || !(r in e)) && (o || (o = Array.prototype.slice.call(e, 0, r)), o[r] = e[r]);
  return t.concat(o || Array.prototype.slice.call(e));
}, ju = Symbol("plugin registered by Logicflow.use"), qf = (
  /** @class */
  function() {
    function t(e) {
      var n = this, r;
      this.viewMap = /* @__PURE__ */ new Map(), this.components = [], this.extension = {}, this.setView = function(u, f) {
        return n.viewMap.set(u, f);
      }, this.getView = function(u) {
        return n.viewMap.get(u);
      };
      var i = Ma.get(e), o = i.container, a = i.width, s = i.height;
      this.options = i, this.container = this.initContainer(o, a, s), this.graphModel = new cI(qr(qr({}, i), { container: this.container })), this.plugins = (r = i.plugins) !== null && r !== void 0 ? r : [];
      var l = this.graphModel.eventCenter;
      this.tool = new f3(this), this.dnd = new QI({ lf: this }), this.history = new m3(l), this.keyboard = new w3({
        lf: this,
        keyboard: i.keyboard
      }), i.snapline !== !1 && (this.snaplineModel = new dI(this.graphModel), e3(l, this.snaplineModel)), i.isSilentMode || (E3(this, this.graphModel), this.keyboard.initShortcuts()), this.defaultRegister(), this.installPlugins(i.disabledPlugins);
    }
    return t.prototype.initContainer = function(e, n, r) {
      var i = document.createElement("div");
      return i.style.position = "relative", i.style.width = n ? "".concat(n, "px") : "100%", i.style.height = r ? "".concat(r, "px") : "100%", e.innerHTML = "", e.appendChild(i), i;
    }, Object.defineProperty(t.prototype, Symbol.toStringTag, {
      get: function() {
        return t.toStringTag;
      },
      enumerable: !1,
      configurable: !0
    }), t.prototype.register = function(e, n, r) {
      if (r === void 0 && (r = !0), typeof e != "string") {
        this.registerElement(e);
        return;
      }
      var i = {
        BaseEdge: fu,
        BaseEdgeModel: lu,
        BaseNode: vi,
        BaseNodeModel: pi,
        RectNode: pr,
        RectNodeModel: Or,
        CircleNode: So,
        CircleNodeModel: wo,
        PolygonNode: sl,
        PolygonNodeModel: rl,
        TextNode: Xp,
        TextNodeModel: Hp,
        LineEdge: Yp,
        LineEdgeModel: kp,
        DiamondNode: Hf,
        DiamondNodeModel: Pf,
        PolylineEdge: Oo,
        PolylineEdgeModel: Eo,
        BezierEdge: Up,
        BezierEdgeModel: Ip,
        EllipseNode: zf,
        EllipseNodeModel: Df,
        HtmlNode: Gf,
        HtmlNodeModel: Rf,
        // mobx,
        h: ae,
        type: e
      };
      if (this.viewMap.forEach(function(u) {
        var f = u.extendKey;
        f && (i[f] = u);
      }), this.graphModel.modelMap.forEach(function(u) {
        var f = u.extendKey;
        f && (i[f] = u);
      }), n) {
        var o = n(i), a = o.view, s = o.model, l = a;
        r && !l.isObserved && (l.isObserved = !0, l = sn(l)), this.setView(e, l), this.graphModel.setModel(e, s);
      }
    }, t.prototype.registerElement = function(e) {
      var n = e.view;
      e.isObserverView !== !1 && !n.isObserved && (n.isObserved = !0, n = sn(n)), this.setView(e.type, n), this.graphModel.setModel(e.type, e.model);
    }, t.prototype.batchRegister = function(e) {
      var n = this;
      e === void 0 && (e = []), at(e, function(r) {
        n.registerElement(r);
      });
    }, t.prototype.defaultRegister = function() {
      var e = [
        // Node
        {
          type: "rect",
          view: pr,
          model: Or
        },
        {
          type: "circle",
          view: So,
          model: wo
        },
        {
          type: "polygon",
          view: sl,
          model: rl
        },
        {
          type: "text",
          view: Xp,
          model: Hp
        },
        {
          type: "ellipse",
          view: zf,
          model: Df
        },
        {
          type: "diamond",
          view: Hf,
          model: Pf
        },
        {
          type: "html",
          view: Gf,
          model: Rf
        },
        // Edge
        {
          type: "line",
          view: Yp,
          model: kp
        },
        {
          type: "polyline",
          view: Oo,
          model: Eo
        },
        {
          type: "bezier",
          view: Up,
          model: Ip
        }
      ];
      this.batchRegister(e);
    }, t.prototype.addNode = function(e, n, r) {
      return n === void 0 && (n = pe.NODE_ADD), this.graphModel.addNode(e, n, r);
    }, t.prototype.deleteNode = function(e) {
      var n = this.graphModel.getNodeModelById(e);
      if (!n)
        return !1;
      var r = n.getData(), i = this.options.guards, o = i != null && i.beforeDelete ? i.beforeDelete(r) : !0;
      return o && this.graphModel.deleteNode(e), o;
    }, t.prototype.cloneNode = function(e) {
      var n = this.graphModel.getNodeModelById(e), r = n == null ? void 0 : n.getData();
      if (r) {
        var i = this.options.guards, o = i != null && i.beforeClone ? i.beforeClone(r) : !0;
        if (o)
          return this.graphModel.cloneNode(e);
      }
    }, t.prototype.changeNodeId = function(e, n) {
      return this.graphModel.changeNodeId(e, n);
    }, t.prototype.changeNodeType = function(e, n) {
      this.graphModel.changeNodeType(e, n);
    }, t.prototype.getNodeModelById = function(e) {
      return this.graphModel.getNodeModelById(e);
    }, t.prototype.getNodeDataById = function(e) {
      var n = this.getNodeModelById(e);
      return n == null ? void 0 : n.getData();
    }, t.prototype.getNodeIncomingEdge = function(e) {
      return this.graphModel.getNodeIncomingEdge(e);
    }, t.prototype.getNodeOutgoingEdge = function(e) {
      return this.graphModel.getNodeOutgoingEdge(e);
    }, t.prototype.getNodeIncomingNode = function(e) {
      return this.graphModel.getNodeIncomingNode(e);
    }, t.prototype.getNodeOutgoingNode = function(e) {
      return this.graphModel.getNodeOutgoingNode(e);
    }, t.prototype.createFakeNode = function(e) {
      var n = this.graphModel.modelMap.get(e.type);
      if (!n)
        return console.warn("不存在为".concat(e.type, "类型的节点")), null;
      var r = new n(qr(qr({}, e), { virtual: !0 }), this.graphModel);
      return this.graphModel.setFakeNode(r), r;
    }, t.prototype.removeFakeNode = function() {
      this.graphModel.removeFakeNode();
    }, t.prototype.setNodeSnapLine = function(e) {
      var n;
      (n = this.snaplineModel) === null || n === void 0 || n.setNodeSnapLine(e);
    }, t.prototype.removeNodeSnapLine = function() {
      var e;
      (e = this.snaplineModel) === null || e === void 0 || e.clearSnapline();
    }, t.prototype.setDefaultEdgeType = function(e) {
      this.graphModel.setDefaultEdgeType(e);
    }, t.prototype.addEdge = function(e) {
      return this.graphModel.addEdge(e);
    }, t.prototype.getEdgeDataById = function(e) {
      var n = this.getEdgeModelById(e);
      return n == null ? void 0 : n.getData();
    }, t.prototype.getEdgeModelById = function(e) {
      return this.graphModel.getEdgeModelById(e);
    }, t.prototype.getEdgeModels = function(e) {
      var n = e.sourceNodeId, r = e.targetNodeId, i = [], o = this.graphModel.edges;
      return n && r ? at(o, function(a) {
        a.sourceNodeId === n && a.targetNodeId === r && i.push(a);
      }) : n ? at(o, function(a) {
        a.sourceNodeId === n && i.push(a);
      }) : r && at(o, function(a) {
        a.targetNodeId === r && i.push(a);
      }), i;
    }, t.prototype.changeEdgeId = function(e, n) {
      return this.graphModel.changeEdgeId(e, n);
    }, t.prototype.changeEdgeType = function(e, n) {
      this.graphModel.changeEdgeType(e, n);
    }, t.prototype.deleteEdge = function(e) {
      var n = this.graphModel.getEdgeModelById(e);
      if (!n)
        return !1;
      var r = n.getData(), i = this.options.guards, o = i != null && i.beforeDelete ? i.beforeDelete(r) : !0;
      return o && this.graphModel.deleteEdgeById(e), o;
    }, t.prototype.deleteEdgeByNodeId = function(e) {
      var n = e.sourceNodeId, r = e.targetNodeId;
      n && r ? this.graphModel.deleteEdgeBySourceAndTarget(n, r) : n ? this.graphModel.deleteEdgeBySource(n) : r && this.graphModel.deleteEdgeByTarget(r);
    }, t.prototype.getNodeEdges = function(e) {
      return this.graphModel.getNodeEdges(e);
    }, t.prototype.addElements = function(e, n) {
      var r = this, i = e.nodes, o = e.edges;
      n === void 0 && (n = 40), console.log("distance", n);
      var a = {}, s = {
        nodes: [],
        edges: []
      };
      return at(i, function(l) {
        var u = l.id, f = r.addNode(l);
        u && (a[u] = f.id), s.nodes.push(f);
      }), at(o, function(l) {
        var u = l.sourceNodeId, f = l.targetNodeId;
        a[u] && (u = a[u]), a[f] && (f = a[f]);
        var c = r.graphModel.addEdge(qr(qr({}, l), { sourceNodeId: u, targetNodeId: f }));
        s.edges.push(c);
      }), s;
    }, t.prototype.selectElementById = function(e, n, r) {
      n === void 0 && (n = !1), r === void 0 && (r = !0), this.graphModel.selectElementById(e, n), !n && r && this.graphModel.toFront(e);
    }, t.prototype.getSelectElements = function(e) {
      return e === void 0 && (e = !0), this.graphModel.getSelectElements(e);
    }, t.prototype.clearSelectElements = function() {
      this.graphModel.clearSelectElements();
    }, t.prototype.getModelById = function(e) {
      return this.graphModel.getElement(e);
    }, t.prototype.getDataById = function(e) {
      var n;
      return (n = this.graphModel.getElement(e)) === null || n === void 0 ? void 0 : n.getData();
    }, t.prototype.deleteElement = function(e) {
      var n, r, i, o = this.getModelById(e);
      if (!o)
        return !1;
      var a = (n = {}, n[At.NODE] = this.deleteNode, n[At.EDGE] = this.deleteEdge, n);
      return (i = (r = a[o.BaseType]) === null || r === void 0 ? void 0 : r.call(this, e)) !== null && i !== void 0 ? i : !1;
    }, t.prototype.setElementZIndex = function(e, n) {
      return this.graphModel.setElementZIndex(e, n);
    }, t.prototype.getAreaElement = function(e, n, r, i, o) {
      return r === void 0 && (r = !0), i === void 0 && (i = !0), o === void 0 && (o = !1), this.graphModel.getAreaElement(e, n, r, i, o).map(function(a) {
        return a.getData();
      });
    }, t.prototype.setProperties = function(e, n) {
      var r;
      (r = this.graphModel.getElement(e)) === null || r === void 0 || r.setProperties(en(n));
    }, t.prototype.getProperties = function(e) {
      var n;
      return (n = this.graphModel.getElement(e)) === null || n === void 0 ? void 0 : n.getProperties();
    }, t.prototype.deleteProperty = function(e, n) {
      var r;
      (r = this.graphModel.getElement(e)) === null || r === void 0 || r.deleteProperty(n);
    }, t.prototype.updateAttributes = function(e, n) {
      this.graphModel.updateAttributes(e, n);
    }, t.prototype.editText = function(e) {
      this.graphModel.editText(e);
    }, t.prototype.updateText = function(e, n) {
      this.graphModel.updateText(e, n);
    }, t.prototype.updateEditConfig = function(e) {
      var n = this.graphModel, r = n.editConfigModel, i = n.transformModel, o = r.snapGrid;
      if (r.updateEditConfig(e), (e == null ? void 0 : e.stopMoveGraph) !== void 0 && i.updateTranslateLimits(e.stopMoveGraph), e != null && e.isSilentMode ? this.keyboard.disable() : this.keyboard.enable(!0), !Bn(e == null ? void 0 : e.snapGrid) && e.snapGrid !== o) {
        var a = this.graphModel.grid.size, s = a === void 0 ? 1 : a;
        this.graphModel.updateGridSize(e.snapGrid ? s : 1);
      }
    }, t.prototype.getEditConfig = function() {
      return this.graphModel.editConfigModel.getConfig();
    }, t.prototype.setTheme = function(e) {
      this.graphModel.setTheme(e);
    }, t.prototype.focusByElement = function(e) {
      var n = void 0, r = this.getNodeModelById(e);
      if (r) {
        var i = r.getData(), o = i.x, a = i.y;
        n = {
          x: o,
          y: a
        };
      }
      var s = this.getEdgeModelById(e);
      if (s) {
        var l = s.textPosition, o = l.x, a = l.y;
        n = {
          x: o,
          y: a
        };
      }
      n && this.focusByCoordinate(n);
    }, t.prototype.focusByCoordinate = function(e) {
      var n = this.graphModel, r = n.transformModel, i = n.width, o = n.height, a = e.x, s = e.y;
      r.focusOn(a, s, i, o);
    }, t.prototype.focusOn = function(e) {
      if (typeof e == "string")
        this.focusByElement(e);
      else if ("x" in e && "y" in e)
        this.focusByCoordinate(e);
      else {
        var n = e.id, r = e.coordinate;
        n && this.focusByElement(n), r && this.focusByCoordinate(r);
      }
    }, t.prototype.resize = function(e, n) {
      this.graphModel.resize(e, n), this.options.width = this.graphModel.width, this.options.height = this.graphModel.height;
    }, t.prototype.toFront = function(e) {
      this.graphModel.toFront(e);
    }, t.prototype.getPointByClient = function(e, n) {
      if (typeof e == "object")
        return this.graphModel.getPointByClient(e);
      if (typeof n == "number")
        return this.graphModel.getPointByClient({
          x: e,
          y: n
        });
    }, t.prototype.getGraphData = function() {
      for (var e = [], n = 0; n < arguments.length; n++)
        e[n] = arguments[n];
      var r = this.getGraphRawData();
      return this.adapterOut ? this.adapterOut.apply(this, Iu([r], ms(e), !1)) : r;
    }, t.prototype.getGraphRawData = function() {
      return this.graphModel.modelToGraphData();
    }, t.prototype.clearData = function() {
      this.graphModel.clearData(), this.render({});
    }, t.prototype.renderRawData = function(e) {
      this.graphModel.graphDataToModel(en(e)), this.options.history !== !1 && this.history.watch(this.graphModel), lh(B(_I, { getView: this.getView, tool: this.tool, options: this.options, dnd: this.dnd, snaplineModel: this.snaplineModel, graphModel: this.graphModel }), this.container), this.emit(pe.GRAPH_RENDERED, {
        data: this.graphModel.modelToGraphData(),
        graphModel: this.graphModel
      });
    }, t.prototype.render = function(e) {
      var n = Fe(e);
      this.adapterIn && (n = this.adapterIn(n)), this.renderRawData(n);
    }, t.prototype.undo = function() {
      if (this.history.undoAble()) {
        var e = en(this.history.undo());
        this.clearSelectElements(), this.graphModel.graphDataToModel(e);
      }
    }, t.prototype.redo = function() {
      if (this.history.redoAble()) {
        var e = en(this.history.redo());
        this.clearSelectElements(), this.graphModel.graphDataToModel(e);
      }
    }, t.prototype.zoom = function(e, n) {
      var r = this.graphModel.transformModel;
      return r.zoom(e, n);
    }, t.prototype.resetZoom = function() {
      var e = this.graphModel.transformModel;
      e.resetZoom();
    }, t.prototype.setZoomMiniSize = function(e) {
      var n = this.graphModel.transformModel;
      n.setZoomMiniSize(e);
    }, t.prototype.setZoomMaxSize = function(e) {
      var n = this.graphModel.transformModel;
      n.setZoomMaxSize(e);
    }, t.prototype.getTransform = function() {
      var e = this.graphModel.transformModel, n = e.SCALE_X, r = e.SCALE_Y, i = e.TRANSLATE_X, o = e.TRANSLATE_Y;
      return {
        SCALE_X: n,
        SCALE_Y: r,
        TRANSLATE_X: i,
        TRANSLATE_Y: o
      };
    }, t.prototype.translate = function(e, n) {
      var r = this.graphModel.transformModel;
      r.translate(e, n);
    }, t.prototype.resetTranslate = function() {
      var e = this.graphModel.transformModel, n = e.TRANSLATE_X, r = e.TRANSLATE_Y;
      this.translate(-n, -r);
    }, t.prototype.translateCenter = function() {
      this.graphModel.translateCenter();
    }, t.prototype.fitView = function(e, n) {
      n === void 0 && (n = e), this.graphModel.fitView(e, n);
    }, t.prototype.openEdgeAnimation = function(e) {
      this.graphModel.openEdgeAnimation(e);
    }, t.prototype.closeEdgeAnimation = function(e) {
      this.graphModel.closeEdgeAnimation(e);
    }, t.prototype.on = function(e, n) {
      this.graphModel.eventCenter.on(e, n);
    }, t.prototype.off = function(e, n) {
      this.graphModel.eventCenter.off(e, n);
    }, t.prototype.once = function(e, n) {
      this.graphModel.eventCenter.once(e, n);
    }, t.prototype.emit = function(e, n) {
      this.graphModel.eventCenter.emit(e, n);
    }, t.use = function(e, n) {
      var r, i = e.pluginName;
      if (!i)
        throw new Error("请给插件指定 pluginName!");
      this.extensions.set(i, (r = {}, r[ju] = ju, r.extension = e, r.props = n, r));
    }, t.prototype.installPlugins = function(e) {
      var n = this;
      e === void 0 && (e = []);
      var r = Array.from(t.extensions, function(o) {
        var a = ms(o, 2), s = a[1];
        return s;
      }), i = Iu(Iu([], ms(this.plugins), !1), ms(r), !1);
      at(i, function(o) {
        var a, s;
        ju in o ? (a = o.extension, s = o.props) : a = o;
        var l = a == null ? void 0 : a.pluginName;
        ym(e, l) === -1 && n.installPlugin(a, s);
      });
    }, t.prototype.installPlugin = function(e, n) {
      var r, i;
      if ("pluginName" in e && "install" in e) {
        var o = e.pluginName, a = e.install, s = e.render;
        o && (a && a.call(e, this, t), s && this.components.push(s.bind(e)), this.extension[o] = e);
        return;
      }
      var l = e, u = l.pluginName, f = new l({
        lf: this,
        LogicFlow: t,
        props: n,
        // TODO: 这里的 options 应该传入插件对应的 options，而不是全局的 options
        // 所以应该这么写 this.options.pluginsOptions[ExtensionCtor.pluginName] ?? {}
        options: (i = (r = this.options.pluginsOptions) === null || r === void 0 ? void 0 : r[u]) !== null && i !== void 0 ? i : {}
      });
      f.render && this.components.push(f.render.bind(f)), this.extension[u] = f;
    }, t.prototype.destroy = function() {
      this.clearData(), lh(null, this.container), this.keyboard.destroy(), this.graphModel.destroy(), this.tool.destroy(), this.history.destroy();
    }, t.extensions = /* @__PURE__ */ new Map(), t;
  }()
);
(function(t) {
  t.toStringTag = "LF.".concat(t.name);
})(qf || (qf = {}));
const Zo = qf;
function sn(t) {
  return mc(t);
}
let S3 = class extends Or {
}, O3 = class extends pr {
};
const A3 = {
  type: "custom-rect",
  view: O3,
  model: S3,
  label: "自定义",
  text: "自定义",
  icon: "/bpmn-icon/start-event.svg"
};
let C3 = class extends Or {
  getNodeStyle() {
    return super.getNodeStyle();
  }
}, T3 = class extends pr {
  getLabelShape() {
    const { model: e } = this.props, { x: n, y: r, width: i, height: o } = e, a = e.getNodeStyle();
    return ae(
      "svg",
      {
        x: n - i / 2 + 5,
        y: r - o / 2 + 5,
        width: 25,
        height: 25,
        viewBox: "0 0 1274 1024"
      },
      ae("path", {
        fill: a.stroke,
        d: "M975.657143 96.914286l-48.457143-48.457143c-1.828571-1.828571-4.114286-2.628571-6.514286-2.628572s-4.685714 0.914286-6.514285 2.628572l-86.971429 86.971428a227.737143 227.737143 0 0 0-128.114286-39.2c-58.514286 0-117.028571 22.285714-161.714285 66.971429L420.914286 279.657143a9.177143 9.177143 0 0 0 0 12.914286L731.428571 603.085714c1.828571 1.828571 4.114286 2.628571 6.514286 2.628572 2.285714 0 4.685714-0.914286 6.514286-2.628572l116.457143-116.457143c78.742857-78.857143 88-200.8 27.771428-289.714285l86.971429-86.971429c3.542857-3.657143 3.542857-9.485714 0-13.028571zM805.828571 431.657143l-67.885714 67.885714-213.485714-213.485714 67.885714-67.885714c28.457143-28.457143 66.4-44.228571 106.742857-44.228572 40.342857 0 78.171429 15.657143 106.742857 44.228572 28.457143 28.457143 44.228571 66.4 44.228572 106.742857 0 40.342857-15.771429 78.171429-44.228572 106.742857z m-217.371428 120a9.177143 9.177143 0 0 0-12.914286 0L499.428571 627.771429 396.228571 524.571429l76.228572-76.228572c3.542857-3.542857 3.542857-9.371429 0-12.914286L430.857143 393.828571a9.177143 9.177143 0 0 0-12.914286 0L341.714286 470.057143l-49.142857-49.142857a8.971429 8.971429 0 0 0-6.514286-2.628572c-2.285714 0-4.685714 0.914286-6.514286 2.628572L163.2 537.371429c-78.742857 78.857143-88 200.8-27.771429 289.714285l-86.971428 86.971429a9.177143 9.177143 0 0 0 0 12.914286l48.457143 48.457142c1.828571 1.828571 4.114286 2.628571 6.514285 2.628572s4.685714-0.914286 6.514286-2.628572l86.971429-86.971428c38.514286 26.171429 83.314286 39.2 128.114285 39.2 58.514286 0 117.028571-22.285714 161.714286-66.971429l116.457143-116.457143c3.542857-3.542857 3.542857-9.371429 0-12.914285l-49.142857-49.142857 76.228571-76.228572c3.542857-3.542857 3.542857-9.371429 0-12.914286l-41.828571-41.371428zM431.657143 805.828571a150.08 150.08 0 0 1-106.742857 44.228572c-40.342857 0-78.171429-15.657143-106.742857-44.228572a150.08 150.08 0 0 1-44.228572-106.742857c0-40.342857 15.657143-78.171429 44.228572-106.742857l67.885714-67.885714 213.485714 213.485714-67.885714 67.885714z"
      })
    );
  }
  //自定义节点外观
  getShape() {
    const { model: e } = this.props, { x: n, y: r, width: i, height: o, radius: a } = e, s = e.getNodeStyle();
    return ae("g", {}, [
      ae("rect", {
        ...s,
        x: n - i / 2,
        y: r - o / 2,
        width: i,
        height: o,
        rx: a,
        ry: a
      }),
      this.getLabelShape()
    ]);
  }
};
const N3 = {
  type: "bpmn:dataImportTask",
  view: T3,
  model: C3,
  label: "数据源",
  text: "数据源",
  icon: "/node-icon/importer.svg"
};
let M3 = class extends Or {
  getNodeStyle() {
    return super.getNodeStyle();
  }
}, P3 = class extends pr {
  getLabelShape() {
    const { model: e } = this.props, { x: n, y: r, width: i, height: o } = e, a = e.getNodeStyle();
    return ae(
      "svg",
      {
        x: n - i / 2 + 5,
        y: r - o / 2 + 5,
        width: 25,
        height: 25,
        viewBox: "0 0 1274 1024"
      },
      ae("path", {
        fill: a.stroke,
        d: "M519.68 1016.32a26.88 26.88 0 0 1-15.36-4.48l-407.68-235.52a30.08 30.08 0 0 1-16-26.88V278.4a30.08 30.08 0 0 1 16-26.88L504.32 16a30.72 30.72 0 0 1 31.36 0l407.68 235.52a30.72 30.72 0 0 1 15.36 26.88v471.04a30.72 30.72 0 0 1-15.36 26.88l-407.68 235.52a28.8 28.8 0 0 1-16 4.48z m-375.68-285.44l375.68 217.6 376.32-217.6V296.96L519.68 80 144 296.96z M519.68 540.8a28.16 28.16 0 0 1-15.36-4.48l-407.68-230.4a31.36 31.36 0 0 1-12.16-42.88 32.64 32.64 0 0 1 43.52-12.16l407.04 231.04a31.36 31.36 0 0 1-15.36 58.88z M512 545.28a31.36 31.36 0 0 1-15.36-58.88L901.12 256a31.36 31.36 0 0 1 42.88 12.16 32 32 0 0 1-12.16 42.88l-407.68 230.4a32 32 0 0 1-12.16 3.84z M519.68 1000.96a31.36 31.36 0 0 1-31.36-31.36V501.12a31.36 31.36 0 1 1 64 0v468.48a31.36 31.36 0 0 1-32.64 31.36z"
      })
    );
  }
  //自定义节点外观
  getShape() {
    const { model: e } = this.props, { x: n, y: r, width: i, height: o, radius: a } = e, s = e.getNodeStyle();
    return ae("g", {}, [
      ae("rect", {
        ...s,
        x: n - i / 2,
        y: r - o / 2,
        width: i,
        height: o,
        rx: a,
        ry: a
      }),
      this.getLabelShape()
    ]);
  }
};
const D3 = {
  type: "bpmn:dataSoruceTask",
  view: P3,
  model: M3,
  label: "数据集",
  text: "数据集",
  icon: "/node-icon/generator.svg"
};
class R3 extends Or {
  getNodeStyle() {
    return super.getNodeStyle();
  }
}
class L3 extends pr {
  getLabelShape() {
    const { model: e } = this.props, { x: n, y: r, width: i, height: o } = e, a = e.getNodeStyle();
    return ae(
      "svg",
      {
        x: n - i / 2 + 5,
        y: r - o / 2 + 5,
        width: 25,
        height: 25,
        viewBox: "0 0 1274 1024"
      },
      ae("path", {
        fill: a.stroke,
        d: "M 851.412 806.16 l -90.696 90.32 l -67.696 -67.696 l 90.508 -90.508 c 87.48 -87.48 87.48 -229.308 0 -316.784 c -87.48 -87.48 -229.304 -87.48 -316.784 0 l -90.528 90.528 l -67.88 -67.88 l 90.528 -90.532 c 124.968 -124.968 327.58 -124.968 452.548 0 c 124.968 124.968 124.968 327.58 0 452.548 ZM 172.588 217.84 l 90.696 -90.32 l 67.696 67.696 l -90.508 90.508 c -87.48 87.48 -87.48 229.308 0 316.784 c 87.48 87.48 229.304 87.48 316.784 0 l 90.528 -90.528 l 67.88 67.88 l -90.528 90.532 c -124.968 124.968 -327.58 124.968 -452.548 0 c -124.968 -124.968 -124.968 -327.58 0 -452.548 Z"
      })
    );
  }
  //自定义节点外观
  getShape() {
    const { model: e } = this.props, { x: n, y: r, width: i, height: o, radius: a } = e, s = e.getNodeStyle();
    return ae("g", {}, [
      ae("rect", {
        ...s,
        x: n - i / 2,
        y: r - o / 2,
        width: i,
        height: o,
        rx: a,
        ry: a
      }),
      this.getLabelShape()
    ]);
  }
}
const I3 = {
  type: "bpmn:processorTask",
  view: L3,
  model: R3,
  label: "处理器",
  text: "处理器",
  icon: "/node-icon/matcher.svg"
};
class j3 extends wo {
  initNodeData(e) {
    super.initNodeData(e), this.r = 40;
  }
  getNodeStyle() {
    const e = super.getNodeStyle();
    return e.stroke = "#4CAF50", e.fill = "#C8E6C9", e;
  }
}
class k3 extends So {
  getShape() {
    const { model: e } = this.props, { x: n, y: r, r: i } = e, o = e.getNodeStyle();
    return ae("g", {}, [
      ae("circle", {
        ...o,
        cx: n,
        cy: r,
        r: i
      })
    ]);
  }
}
const B3 = {
  type: "bpmn:startEvent",
  view: k3,
  model: j3,
  label: "开始",
  text: "开始",
  icon: "/bpmn-icon/start-event.svg"
};
class F3 extends wo {
  initNodeData(e) {
    super.initNodeData(e), this.r = 40;
  }
  getNodeStyle() {
    const e = super.getNodeStyle();
    return e.stroke = "#F44336", e.fill = "#FFCDD2", e;
  }
}
class $3 extends So {
  getShape() {
    const { model: e } = this.props, { x: n, y: r, r: i } = e, o = e.getNodeStyle();
    return ae("g", {}, [
      ae("circle", {
        ...o,
        cx: n,
        cy: r,
        r: i
      })
    ]);
  }
}
const H3 = {
  type: "bpmn:endEvent",
  view: $3,
  model: F3,
  label: "结束",
  text: "结束",
  icon: "/bpmn-icon/end-event.svg"
}, Qi = [B3, H3, A3, N3, D3, I3];
class W3 extends Eo {
  getEdgeStyle() {
    const e = super.getEdgeStyle();
    return e.strokeWidth = 1.5, e;
  }
}
let z3 = class extends Oo {
};
const X3 = {
  type: "bpmn:sequenceFlow",
  model: W3,
  view: z3
}, _s = [X3];
var Jp = {
  width: 40,
  height: 40
}, Qp = {
  width: 40,
  height: 40
}, ev = {
  width: 40,
  height: 40
}, tv = {
  width: 100,
  height: 80
}, nv = {
  width: 100,
  height: 80
}, G3 = (
  /** @class */
  function() {
    function t() {
      globalThis._ids = this, this._ids = /* @__PURE__ */ new Set();
    }
    return t.prototype.generateId = function() {
      return "xxxxxxx".replace(/[x]/g, function(e) {
        var n = Math.random() * 16 | 0, r = e === "x" ? n : n & 3 | 8;
        return r.toString(16);
      });
    }, t.prototype.next = function() {
      for (var e = this.generateId(); this._ids.has(e); )
        e = this.generateId();
      return this._ids.add(e), e;
    }, t;
  }()
), U3 = (globalThis == null ? void 0 : globalThis._ids) || new G3();
function $o() {
  return U3.next();
}
var __ = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}();
(function(t) {
  __(e, t);
  function e(n, r) {
    return n.id || (n.id = "Event_".concat($o())), n.text || (n.text = ""), n.text && typeof n.text == "string" && (n.text = {
      value: n.text,
      x: n.x,
      y: n.y + 40
    }), t.call(this, n, r) || this;
  }
  return e.prototype.setAttributes = function() {
    this.r = 18;
  }, e.prototype.getConnectedTargetRules = function() {
    var n = t.prototype.getConnectedTargetRules.call(this), r = {
      message: "起始节点不能作为边的终点",
      validate: function() {
        return !1;
      }
    };
    return n.push(r), n;
  }, e.extendKey = "StartEventModel", e;
})(wo);
(function(t) {
  __(e, t);
  function e() {
    return t !== null && t.apply(this, arguments) || this;
  }
  return e.extendKey = "StartEventNode", e;
})(So);
var b_ = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), cl = function() {
  return cl = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, cl.apply(this, arguments);
};
(function(t) {
  b_(e, t);
  function e(n, r) {
    return n.id || (n.id = "Event_".concat($o())), n.text || (n.text = ""), n.text && typeof n.text == "string" && (n.text = {
      value: n.text,
      x: n.x,
      y: n.y + 40
    }), t.call(this, n, r) || this;
  }
  return e.prototype.setAttributes = function() {
    this.r = 18;
  }, e.prototype.getConnectedSourceRules = function() {
    var n = t.prototype.getConnectedSourceRules.call(this), r = {
      message: "结束节点不能作为边的起点",
      validate: function() {
        return !1;
      }
    };
    return n.push(r), n;
  }, e.extendKey = "EndEventModel", e;
})(wo);
(function(t) {
  b_(e, t);
  function e() {
    return t !== null && t.apply(this, arguments) || this;
  }
  return e.prototype.getAnchorStyle = function() {
    return {
      visibility: "hidden"
    };
  }, e.prototype.getShape = function() {
    var n = this.props.model, r = n.getNodeStyle(), i = n, o = i.x, a = i.y, s = i.r, l = t.prototype.getShape.call(this);
    return ae("g", {}, l, ae("circle", cl(cl({}, r), { cx: o, cy: a, r: s - 5 })));
  }, e.extendKey = "EndEventView", e;
})(So);
var x_ = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}();
(function(t) {
  x_(e, t);
  function e(n, r) {
    return n.id || (n.id = "Flow_".concat($o())), t.call(this, n, r) || this;
  }
  return e.extendKey = "SequenceFlowModel", e;
})(Eo);
(function(t) {
  x_(e, t);
  function e() {
    return t !== null && t.apply(this, arguments) || this;
  }
  return e.extendKey = "SequenceFlowEdge", e;
})(Oo);
var E_ = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), _a = function() {
  return _a = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, _a.apply(this, arguments);
};
(function(t) {
  E_(e, t);
  function e(n, r) {
    var i = this;
    return n.id || (n.id = "Gateway_".concat($o())), n.text || (n.text = ""), n.text && typeof n.text == "string" && (n.text = {
      value: n.text,
      x: n.x,
      y: n.y + 40
    }), i = t.call(this, n, r) || this, i.points = [
      [25, 0],
      [50, 25],
      [25, 50],
      [0, 25]
    ], i;
  }
  return e.extendKey = "ExclusiveGatewayModel", e;
})(rl);
(function(t) {
  E_(e, t);
  function e() {
    return t !== null && t.apply(this, arguments) || this;
  }
  return e.prototype.getShape = function() {
    var n = this.props.model, r = n, i = r.x, o = r.y, a = r.width, s = r.height, l = r.points, u = n.getNodeStyle();
    return ae(
      "g",
      {
        transform: "matrix(1 0 0 1 ".concat(i - a / 2, " ").concat(o - s / 2, ")")
      },
      // @ts-ignore TODO: 确认 h('polygon') 报错的问题
      ae("polygon", _a(_a({}, u), { x: i, y: o, points: l })),
      ae("path", _a({ d: "m 16,15 7.42857142857143,9.714285714285715 -7.42857142857143,9.714285714285715 3.428571428571429,0 5.714285714285715,-7.464228571428572 5.714285714285715,7.464228571428572 3.428571428571429,0 -7.42857142857143,-9.714285714285715 7.42857142857143,-9.714285714285715 -3.428571428571429,0 -5.714285714285715,7.464228571428572 -5.714285714285715,-7.464228571428572 -3.428571428571429,0 z" }, u))
    );
  }, e.extendKey = "ExclusiveGatewayNode", e;
})(sl);
var w_ = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), Zf = function() {
  return Zf = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Zf.apply(this, arguments);
};
(function(t) {
  w_(e, t);
  function e(n, r) {
    return n.id || (n.id = "Activity_".concat($o())), t.call(this, n, r) || this;
  }
  return e.extendKey = "ServiceTaskModel", e;
})(Or);
(function(t) {
  w_(e, t);
  function e() {
    return t !== null && t.apply(this, arguments) || this;
  }
  return e.prototype.getLabelShape = function() {
    var n = this.props.model, r = n.x, i = n.y, o = n.width, a = n.height, s = n.getNodeStyle();
    return ae("svg", {
      x: r - o / 2 + 5,
      y: i - a / 2 + 5,
      width: 30,
      height: 30,
      viewBox: "0 0 1274 1024"
    }, ae("path", {
      fill: s.stroke,
      d: "M882.527918 434.149934c-2.234901-5.303796-7.311523-8.853645-13.059434-9.138124l-61.390185-3.009544c-6.635117-20.973684-15.521508-41.175795-26.513864-60.282968l42.051745-47.743374c4.308119-4.889357 4.955872-12.004405 1.602498-17.59268-46.384423-77.30362-103.969956-101.422947-106.400309-102.410438-5.332449-2.170432-11.432377-1.090844-15.693424 2.77009L654.674467 240.664222c-17.004279-8.654101-35.092239-15.756869-53.995775-21.210068l-3.26537-66.490344c-0.280386-5.747911-3.833305-10.824533-9.134031-13.059434-1.683339-0.709151-30.193673-12.391215-76.866668-12.051477-46.672996-0.339738-75.18333 11.342326-76.866668 12.051477-5.300726 2.234901-8.853645 7.311523-9.134031 13.059434l-3.26537 66.490344c-18.903535 5.453199-36.991496 12.555967-53.995775 21.210068l-48.450479-43.922349c-4.261047-3.860934-10.360975-4.940522-15.693424-2.77009-2.430352 0.98749-60.015885 25.106818-106.400309 102.410438-3.353374 5.588275-2.705622 12.703323 1.602498 17.59268l42.051745 47.743374c-10.992355 19.107173-19.878746 39.309284-26.513864 60.282968l-61.390185 3.009544c-5.747911 0.284479-10.824533 3.834328-13.059434 9.138124-1.01512 2.415003-24.687262 60.190871-2.822278 147.651828 1.583055 6.324032 7.072069 10.893094 13.57518 11.308557 5.892197 0.37146 11.751648 0.523933 17.419741 0.667196 14.498202 0.372483 28.193109 0.723477 40.908712 4.63353 4.212952 1.294482 6.435573 8.270361 9.349949 18.763342 1.287319 4.640694 2.617617 9.43693 4.484128 14.010085 1.794879 4.393054 3.75758 8.570189 5.66093 12.607132 1.302669 2.765997 2.529613 5.380544 3.689019 8.018627 2.986007 6.803963 2.682086 9.773598 2.578732 10.349719-3.061732 3.672646-6.391571 7.238868-9.91379 11.015891-1.810229 1.943258-3.680832 3.949962-5.523807 5.980201l-22.560832 24.8909c-3.865028 4.261047-4.940522 10.365068-2.774183 15.693424 0.991584 2.426259 25.102724 60.011792 102.414531 106.400309 5.588275 3.353374 12.703323 2.701528 17.591657-1.603521l23.476691-20.682042c2.346441-2.061962 4.64888-4.336772 6.875594-6.534833 9.05319-8.93858 14.018272-12.95608 17.73185-11.576663 3.305279 1.222851 6.907317 3.166109 10.720156 5.228071 3.325745 1.794879 6.764054 3.650133 10.465352 5.288446 6.016017 2.662643 12.120039 4.688789 18.019399 6.65149 6.827499 2.266623 13.279445 4.409426 18.819624 7.275707 1.518586 0.782829 1.926886 0.994654 2.358721 7.830339 0.726547 11.496845 1.25048 23.276123 1.753947 34.672684 0.264013 5.900384 0.528026 11.803837 0.815575 17.700127 0.284479 5.743818 3.833305 10.82044 9.138124 13.05534 1.654686 0.698918 29.371958 12.063757 74.869175 12.063757 0.328481 0 3.65832 0 3.986801 0 45.497217 0 73.214489-11.364839 74.869175-12.063757 5.304819-2.234901 8.853645-7.311523 9.138124-13.05534 0.287549-5.89629 0.551562-11.799744 0.815575-17.700127 0.503467-11.396561 1.027399-23.175839 1.753947-34.672684 0.431835-6.835685 0.840134-7.04751 2.358721-7.830339 5.54018-2.866281 11.992125-5.009084 18.819624-7.275707 5.89936-1.962701 12.003382-3.988848 18.019399-6.65149 3.701299-1.638313 7.139607-3.493567 10.465352-5.288446 3.812839-2.061962 7.414877-4.00522 10.720156-5.228071 3.713578-1.379417 8.67866 2.638083 17.73185 11.576663 2.226714 2.198062 4.529153 4.472871 6.875594 6.534833l23.476691 20.682042c4.888334 4.305049 12.003382 4.956895 17.591657 1.603521 77.311807-46.388517 101.422947-103.97405 102.414531-106.400309 2.166339-5.328355 1.090844-11.432377-2.774183-15.693424l-22.560832-24.8909c-1.842974-2.030239-3.713578-4.036943-5.523807-5.980201-3.52222-3.777023-6.852058-7.343245-9.91379-11.015891-0.103354-0.576121-0.407276-3.545756 2.578732-10.349719 1.159406-2.638083 2.38635-5.252631 3.689019-8.018627 1.90335-4.036943 3.866051-8.214079 5.66093-12.607132 1.866511-4.573155 3.196809-9.369392 4.484128-14.010085 2.914376-10.492982 5.136997-17.46886 9.349949-18.763342 12.715603-3.910053 26.41051-4.261047 40.908712-4.63353 5.668093-0.143263 11.527544-0.295735 17.419741-0.667196 6.503111-0.415462 11.992125-4.984524 13.57518-11.308557C907.21518 494.340805 883.543038 436.564937 882.527918 434.149934zM643.49894 643.761929c-35.280528 35.280528-82.191954 54.711066-132.086317 54.711066s-96.806813-19.430538-132.086317-54.711066c-35.280528-35.279504-54.711066-82.191954-54.711066-132.086317 0-49.894364 19.430538-96.80272 54.711066-132.082224 35.283598-35.284621 82.191954-54.711066 132.086317-54.711066s96.80579 19.426445 132.086317 54.711066c35.279504 35.279504 54.711066 82.187861 54.711066 132.082224C698.210006 561.569976 678.782537 608.482425 643.49894 643.761929z"
    }));
  }, e.prototype.getShape = function() {
    var n = this.props.model, r = n.x, i = n.y, o = n.width, a = n.height, s = n.radius, l = n.getNodeStyle();
    return ae("g", {}, [
      ae("rect", Zf({ x: r - o / 2, y: i - a / 2, rx: s, ry: s, width: o, height: a }, l)),
      this.getLabelShape()
    ]);
  }, e.extendKey = "ServiceTaskNode", e;
})(pr);
var S_ = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), dl = function() {
  return dl = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, dl.apply(this, arguments);
};
(function(t) {
  S_(e, t);
  function e(n, r) {
    return n.id || (n.id = "Activity_".concat($o())), t.call(this, n, r) || this;
  }
  return e.extendKey = "UserTaskModel", e;
})(Or);
(function(t) {
  S_(e, t);
  function e() {
    return t !== null && t.apply(this, arguments) || this;
  }
  return e.prototype.getLabelShape = function() {
    var n = this.props.model, r = n.x, i = n.y, o = n.width, a = n.height, s = n.getNodeStyle();
    return ae("svg", {
      x: r - o / 2 + 5,
      y: i - a / 2 + 5,
      width: 25,
      height: 25,
      viewBox: "0 0 1274 1024"
    }, ae("path", {
      fill: s.stroke,
      d: "M655.807326 287.35973m-223.989415 0a218.879 218.879 0 1 0 447.978829 0 218.879 218.879 0 1 0-447.978829 0ZM1039.955839 895.482975c-0.490184-212.177424-172.287821-384.030443-384.148513-384.030443-211.862739 0-383.660376 171.85302-384.15056 384.030443L1039.955839 895.482975z"
    }));
  }, e.prototype.getShape = function() {
    var n = this.props.model, r = n.x, i = n.y, o = n.width, a = n.height, s = n.radius, l = n.getNodeStyle();
    return ae("g", {}, [
      ae("rect", dl(dl({}, l), { x: r - o / 2, y: i - a / 2, rx: s, ry: s, width: o, height: a })),
      this.getLabelShape()
    ]);
  }, e.extendKey = "UserTaskNode", e;
})(pr);
var Y3 = (
  /** @class */
  function() {
    function t() {
      globalThis._ids = this, this._ids = /* @__PURE__ */ new Set();
    }
    return t.prototype.generateId = function() {
      return "xxxxxxx".replace(/[x]/g, function(e) {
        var n = Math.random() * 16 | 0, r = e === "x" ? n : n & 3 | 8;
        return r.toString(16);
      });
    }, t.prototype.next = function() {
      for (var e = this.generateId(); this._ids.has(e); )
        e = this.generateId();
      return this._ids.add(e), e;
    }, t;
  }()
), V3 = (globalThis == null ? void 0 : globalThis._ids) || new Y3();
function rv() {
  return V3.next();
}
function O_(t) {
  return Object.prototype.toString.call(t);
}
function K3(t) {
  return "  ".repeat(t);
}
function hl(t) {
  var e = t;
  return O_(t) === "[object Object]" ? (e = {}, Object.keys(t).forEach(function(n) {
    var r = n;
    n.charAt(0) === "-" && (r = n.substring(1)), e[r] = hl(t[n]);
  })) : Array.isArray(t) && (e = [], t.forEach(function(n, r) {
    e[r] = hl(n);
  })), e;
}
function q3(t) {
  var e = t;
  try {
    typeof e != "string" && (e = JSON.parse(t));
  } catch {
    e = JSON.stringify(hl(t)).replace(/"/g, "'");
  }
  return e;
}
var bi = `	
`;
function Ns(t, e, n) {
  var r = K3(n);
  if (t !== 0 && t !== !1 && !t)
    return bi + r + "<".concat(e, " />");
  var i = "";
  if (e === "#text")
    return bi + r + t;
  if (e === "#cdata-section")
    return bi + r + "<![CDATA[" + t + "]]>";
  if (e === "#comment")
    return bi + r + "<!--" + t + "-->";
  if ("".concat(e).charAt(0) === "-")
    return " " + e.substring(1) + '="' + q3(t) + '"';
  if (Array.isArray(t))
    t.forEach(function(l) {
      i += Ns(l, e, n + 1);
    });
  else if (O_(t) === "[object Object]") {
    var o = Object.keys(t), a = "", s = "";
    i += (n === 0 ? "" : bi + r) + "<" + e, o.forEach(function(l) {
      l.charAt(0) === "-" ? a += Ns(t[l], l, n + 1) : s += Ns(t[l], l, n + 1);
    }), i += a + (s !== "" ? ">".concat(s).concat(bi + r, "</").concat(e, ">") : " />");
  } else
    i += bi + r + "<".concat(e, ">").concat(t.toString(), "</").concat(e, ">");
  return i;
}
function Z3(t) {
  var e = "";
  for (var n in t)
    e += Ns(t[n], n, 0);
  return e;
}
var dn = function() {
};
dn.ObjTree = function() {
  return this;
};
dn.ObjTree.VERSION = "0.23";
dn.ObjTree.prototype.xmlDecl = `<?xml version="1.0" encoding="UTF-8" ?>
`;
dn.ObjTree.prototype.attr_prefix = "-";
dn.ObjTree.prototype.parseXML = function(t) {
  var e;
  if (window.DOMParser) {
    var n = new DOMParser(), r = n.parseFromString(t, "application/xml");
    if (!r)
      return;
    e = r.documentElement;
  } else window.ActiveXObject && (n = new ActiveXObject("Microsoft.XMLDOM"), n.async = !1, n.loadXML(t), e = n.documentElement);
  if (e)
    return this.parseDOM(e);
};
dn.ObjTree.prototype.parseHTTP = function(t, e, n) {
  var r = {};
  for (var i in e)
    r[i] = e[i];
  if (r.method || (typeof r.postBody > "u" && typeof r.postbody > "u" && typeof r.parameters > "u" ? r.method = "get" : r.method = "post"), n) {
    r.asynchronous = !0;
    var o = this, a = n, s = r.onComplete;
    r.onComplete = function(f) {
      var c;
      f && f.responseXML && f.responseXML.documentElement && (c = o.parseDOM(f.responseXML.documentElement)), a(c, f), s && s(f);
    };
  } else
    r.asynchronous = !1;
  var l;
  if (typeof HTTP < "u" && HTTP.Request) {
    r.uri = t;
    var u = new HTTP.Request(r);
    u && (l = u.transport);
  } else if (typeof Ajax < "u" && Ajax.Request) {
    var u = new Ajax.Request(t, r);
    u && (l = u.transport);
  }
  if (n)
    return l;
  if (l && l.responseXML && l.responseXML.documentElement)
    return this.parseDOM(l.responseXML.documentElement);
};
dn.ObjTree.prototype.parseDOM = function(t) {
  if (t) {
    if (this.__force_array = {}, this.force_array)
      for (var e = 0; e < this.force_array.length; e++)
        this.__force_array[this.force_array[e]] = 1;
    var n = this.parseElement(t);
    if (this.__force_array[t.nodeName] && (n = [n]), t.nodeType != 11) {
      var r = {};
      r[t.nodeName] = n, n = r;
    }
    return n;
  }
};
dn.ObjTree.prototype.parseElement = function(t) {
  if (t.nodeType != 7) {
    if (t.nodeType == 3 || t.nodeType == 4 || t.nodeType == 8) {
      var e = t.nodeValue.match(/[^\x00-\x20]/);
      return e == null ? void 0 : t.nodeValue;
    }
    var n = null, r = {};
    if (t.attributes && t.attributes.length) {
      n = {};
      for (var i = 0; i < t.attributes.length; i++) {
        var o = t.attributes[i].nodeName;
        if (typeof o == "string") {
          var a = t.attributes[i].nodeValue;
          try {
            a = JSON.parse(t.attributes[i].nodeValue.replace(/'/g, '"'));
          } catch {
            a = t.attributes[i].nodeValue;
          }
          a && (o = this.attr_prefix + o, typeof r[o] > "u" && (r[o] = 0), r[o]++, this.addNode(n, o, r[o], a));
        }
      }
    }
    if (t.childNodes && t.childNodes.length) {
      var s = !0;
      n && (s = !1);
      for (var i = 0; i < t.childNodes.length && s; i++) {
        var l = t.childNodes[i].nodeType;
        l == 3 || l == 4 || l == 8 || (s = !1);
      }
      if (s) {
        n || (n = "");
        for (var i = 0; i < t.childNodes.length; i++)
          n += t.childNodes[i].nodeValue;
      } else {
        n || (n = {});
        for (var i = 0; i < t.childNodes.length; i++) {
          var o = t.childNodes[i].nodeName;
          if (typeof o == "string") {
            var a = this.parseElement(t.childNodes[i]);
            a && (typeof r[o] > "u" && (r[o] = 0), r[o]++, this.addNode(n, o, r[o], a));
          }
        }
      }
    } else
      n === null && (n = {});
    return n;
  }
};
dn.ObjTree.prototype.addNode = function(t, e, n, r) {
  this.__force_array[e] ? (n == 1 && (t[e] = []), t[e][t[e].length] = r) : n == 1 ? t[e] = r : n == 2 ? t[e] = [t[e], r] : t[e][t[e].length] = r;
};
dn.ObjTree.prototype.writeXML = function(t) {
  var e = this.hash_to_xml(null, t);
  return this.xmlDecl + e;
};
dn.ObjTree.prototype.hash_to_xml = function(t, e) {
  var n = [], r = [];
  for (var i in e)
    if (e.hasOwnProperty(i)) {
      var o = e[i];
      i.charAt(0) != this.attr_prefix ? typeof o > "u" || o == null ? n[n.length] = "<" + i + " />" : typeof o == "object" && o.constructor == Array ? n[n.length] = this.array_to_xml(i, o) : typeof o == "object" ? n[n.length] = this.hash_to_xml(i, o) : n[n.length] = this.scalar_to_xml(i, o) : r[r.length] = " " + i.substring(1) + '="' + this.xml_escape(o) + '"';
    }
  var a = r.join(""), s = n.join("");
  return typeof t > "u" || t == null || (n.length > 0 ? s.match(/\n/) ? s = "<" + t + a + `>
` + s + "</" + t + `>
` : s = "<" + t + a + ">" + s + "</" + t + `>
` : s = "<" + t + a + ` />
`), s;
};
dn.ObjTree.prototype.array_to_xml = function(t, e) {
  for (var n = [], r = 0; r < e.length; r++) {
    var i = e[r];
    typeof i > "u" || i == null ? n[n.length] = "<" + t + " />" : typeof i == "object" && i.constructor == Array ? n[n.length] = this.array_to_xml(t, i) : typeof i == "object" ? n[n.length] = this.hash_to_xml(t, i) : n[n.length] = this.scalar_to_xml(t, i);
  }
  return n.join("");
};
dn.ObjTree.prototype.scalar_to_xml = function(t, e) {
  return t == "#text" ? this.xml_escape(e) : "<" + t + ">" + this.xml_escape(e) + "</" + t + `>
`;
};
dn.ObjTree.prototype.xml_escape = function(t) {
  return t.replace(/&/g, "&").replace(/</g, "<").replace(/>/g, ">").replace(/"/g, '"');
};
var J3 = function(t) {
  return new dn.ObjTree().parseXML(t);
}, Q3 = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), Jf = function() {
  return Jf = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Jf.apply(this, arguments);
}, cu = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, Ar;
(function(t) {
  t.START = "bpmn:startEvent", t.END = "bpmn:endEvent", t.GATEWAY = "bpmn:exclusiveGateway", t.USER = "bpmn:userTask", t.SYSTEM = "bpmn:serviceTask", t.FLOW = "bpmn:sequenceFlow";
})(Ar || (Ar = {}));
var A_ = [
  "-name",
  "-id",
  "bpmn:incoming",
  "bpmn:outgoing",
  "-sourceRef",
  "-targetRef"
], iv = [
  "properties",
  "startPoint",
  "endPoint",
  "pointsList"
];
function ov(t) {
  var e = t ? iv.concat(t) : iv;
  return function(n) {
    function r(i) {
      var o = {};
      return typeof i == "string" ? i : Array.isArray(i) ? i.map(function(a) {
        return r(a);
      }) : (Object.entries(i).forEach(function(a) {
        var s = cu(a, 2), l = s[0], u = s[1];
        typeof u != "object" ? l.indexOf("-") === 0 || ["#text", "#cdata-section", "#comment"].includes(l) ? o[l] = u : o["-".concat(l)] = u : e.includes(l) ? o["-".concat(l)] = r(u) : o[l] = r(u);
      }), o);
    }
    return r(n);
  };
}
function pl(t) {
  var e = {};
  return Object.entries(t).forEach(function(n) {
    var r = cu(n, 2), i = r[0], o = r[1];
    i.indexOf("-") === 0 ? e[i.substring(1)] = hl(o) : typeof o == "string" ? e[i] = o : Object.prototype.toString.call(o) === "[object Object]" ? e[i] = pl(o) : Array.isArray(o) ? e[i] = o.map(function(a) {
      return pl(a);
    }) : e[i] = o;
  }), e;
}
function e4(t, e, n) {
  var r = /* @__PURE__ */ new Map();
  e.nodes.forEach(function(o) {
    var a, s = {
      "-id": o.id
      // 如果是xml的属性，json中属性用'-'开头
    };
    if (!((a = o.text) === null || a === void 0) && a.value && (s["-name"] = o.text.value), o.properties) {
      var l = ov(n)(o.properties);
      Object.assign(s, l);
    }
    r.set(o.id, s), t[o.type] ? Array.isArray(t[o.type]) ? t[o.type].push(s) : t[o.type] = [t[o.type], s] : t[o.type] = s;
  });
  var i = e.edges.map(function(o) {
    var a, s, l = r.get(o.targetNodeId);
    l["bpmn:incoming"] ? Array.isArray(l["bpmn:incoming"]) ? l["bpmn:incoming"].push(o.id) : l["bpmn:incoming"] = [l["bpmn:incoming"], o.id] : l["bpmn:incoming"] = o.id;
    var u = {
      "-id": o.id,
      "-sourceRef": o.sourceNodeId,
      "-targetRef": o.targetNodeId
    };
    if (!((a = o.text) === null || a === void 0) && a.value && (u["-name"] = (s = o.text) === null || s === void 0 ? void 0 : s.value), o.properties) {
      var f = ov(n)(o.properties);
      Object.assign(u, f);
    }
    return u;
  });
  e.edges.forEach(function(o) {
    var a = r.get(o.sourceNodeId);
    a["bpmn:outgoing"] ? Array.isArray(a["bpmn:outgoing"]) ? a["bpmn:outgoing"].push(o.id) : a["bpmn:outgoing"] = [a["bpmn:outgoing"], o.id] : a["bpmn:outgoing"] = o.id;
  }), t[Ar.FLOW] = i;
}
function t4(t, e) {
  t["bpmndi:BPMNEdge"] = e.edges.map(function(n) {
    var r, i = n.id, o = n.pointsList.map(function(s) {
      var l = s.x, u = s.y;
      return {
        "-x": l,
        "-y": u
      };
    }), a = {
      "-id": "".concat(i, "_di"),
      "-bpmnElement": i,
      "di:waypoint": o
    };
    return !((r = n.text) === null || r === void 0) && r.value && (a["bpmndi:BPMNLabel"] = {
      "dc:Bounds": {
        "-x": n.text.x - n.text.value.length * 10 / 2,
        "-y": n.text.y - 7,
        "-width": n.text.value.length * 10,
        "-height": 14
      }
    }), a;
  }), t["bpmndi:BPMNShape"] = e.nodes.map(function(n) {
    var r, i = n.id, o = 100, a = 80, s = n.x, l = n.y, u = gi.shapeConfigMap.get(n.type);
    u && (o = u.width, a = u.height), s -= o / 2, l -= a / 2;
    var f = {
      "-id": "".concat(i, "_di"),
      "-bpmnElement": i,
      "dc:Bounds": {
        "-x": s,
        "-y": l,
        "-width": o,
        "-height": a
      }
    };
    return !((r = n.text) === null || r === void 0) && r.value && (f["bpmndi:BPMNLabel"] = {
      "dc:Bounds": {
        "-x": n.text.x - n.text.value.length * 10 / 2,
        "-y": n.text.y - 7,
        "-width": n.text.value.length * 10,
        "-height": 14
      }
    }), f;
  });
}
function n4(t) {
  var e = [], n = [], r = t["bpmn:definitions"];
  if (r) {
    var i = r["bpmn:process"];
    Object.keys(i).forEach(function(o) {
      if (o.indexOf("bpmn:") === 0) {
        var a = i[o];
        if (o === Ar.FLOW) {
          var s = r["bpmndi:BPMNDiagram"]["bpmndi:BPMNPlane"]["bpmndi:BPMNEdge"];
          n = i4(a, s);
        } else {
          var l = r["bpmndi:BPMNDiagram"]["bpmndi:BPMNPlane"]["bpmndi:BPMNShape"];
          e = e.concat(r4(a, l, o));
        }
      }
    });
  }
  return {
    nodes: e,
    edges: n
  };
}
function r4(t, e, n) {
  var r = [];
  if (Array.isArray(t))
    t.forEach(function(a) {
      var s;
      Array.isArray(e) ? s = e.find(function(u) {
        return u["-bpmnElement"] === a["-id"];
      }) : s = e;
      var l = av(s, n, a);
      r.push(l);
    });
  else {
    var i = void 0;
    Array.isArray(e) ? i = e.find(function(a) {
      return a["-bpmnElement"] === t["-id"];
    }) : i = e;
    var o = av(i, n, t);
    r.push(o);
  }
  return r;
}
function av(t, e, n) {
  var r = Number(t["dc:Bounds"]["-x"]), i = Number(t["dc:Bounds"]["-y"]), o = n["-name"], a = gi.shapeConfigMap.get(e);
  a && (r += a.width / 2, i += a.height / 2);
  var s;
  Object.entries(n).forEach(function(c) {
    var d = cu(c, 2), h = d[0], v = d[1];
    A_.indexOf(h) === -1 && (s || (s = {}), s[h] = v);
  }), s && (s = pl(s));
  var l;
  if (o && (l = {
    x: r,
    y: i,
    value: o
  }, t["bpmndi:BPMNLabel"] && t["bpmndi:BPMNLabel"]["dc:Bounds"])) {
    var u = t["bpmndi:BPMNLabel"]["dc:Bounds"];
    l.x = Number(u["-x"]) + Number(u["-width"]) / 2, l.y = Number(u["-y"]) + Number(u["-height"]) / 2;
  }
  var f = {
    id: t["-bpmnElement"],
    type: e,
    x: r,
    y: i,
    properties: s
  };
  return l && (f.text = l), f;
}
function i4(t, e) {
  var n = [];
  if (Array.isArray(t))
    t.forEach(function(i) {
      var o;
      Array.isArray(e) ? o = e.find(function(a) {
        return a["-bpmnElement"] === i["-id"];
      }) : o = e, n.push(sv(o, i));
    });
  else {
    var r = void 0;
    Array.isArray(e) ? r = e.find(function(i) {
      return i["-bpmnElement"] === t["-id"];
    }) : r = e, n.push(sv(r, t));
  }
  return n;
}
function sv(t, e) {
  var n, r = e["-name"] ? "".concat(e["-name"]) : "";
  if (r) {
    var i = t["bpmndi:BPMNLabel"]["dc:Bounds"], o = 0;
    r.split(`
`).forEach(function(l) {
      o < l.length && (o = l.length);
    }), n = {
      value: r,
      x: Number(i["-x"]) + o * 10 / 2,
      y: Number(i["-y"]) + 7
    };
  }
  var a;
  Object.entries(e).forEach(function(l) {
    var u = cu(l, 2), f = u[0], c = u[1];
    A_.indexOf(f) === -1 && (a || (a = {}), a[f] = c);
  }), a && (a = pl(a));
  var s = {
    id: e["-id"],
    type: Ar.FLOW,
    pointsList: t["di:waypoint"].map(function(l) {
      return {
        x: Number(l["-x"]),
        y: Number(l["-y"])
      };
    }),
    sourceNodeId: e["-sourceRef"],
    targetNodeId: e["-targetRef"],
    properties: a
  };
  return n && (s.text = n), s;
}
var gi = (
  /** @class */
  function() {
    function t(e) {
      var n = e.lf, r = this;
      this.adapterOut = function(i, o) {
        var a = Jf({}, r.processAttributes);
        e4(a, i, o);
        var s = {
          "-id": "BPMNPlane_1",
          "-bpmnElement": a["-id"]
        };
        t4(s, i);
        var l = r.definitionAttributes;
        l["bpmn:process"] = a, l["bpmndi:BPMNDiagram"] = {
          "-id": "BPMNDiagram_1",
          "bpmndi:BPMNPlane": s
        };
        var u = {
          "bpmn:definitions": l
        };
        return u;
      }, this.adapterIn = function(i) {
        if (i)
          return n4(i);
      }, n.adapterIn = function(i) {
        return r.adapterIn(i);
      }, n.adapterOut = function(i, o) {
        return r.adapterOut(i, o);
      }, this.processAttributes = {
        "-isExecutable": "true",
        "-id": "Process_".concat(rv())
      }, this.definitionAttributes = {
        "-id": "Definitions_".concat(rv()),
        "-xmlns:xsi": "http://www.w3.org/2001/XMLSchema-instance",
        "-xmlns:bpmn": "http://www.omg.org/spec/BPMN/20100524/MODEL",
        "-xmlns:bpmndi": "http://www.omg.org/spec/BPMN/20100524/DI",
        "-xmlns:dc": "http://www.omg.org/spec/DD/20100524/DC",
        "-xmlns:di": "http://www.omg.org/spec/DD/20100524/DI",
        "-targetNamespace": "http://logic-flow.org",
        "-exporter": "logicflow",
        "-exporterVersion": "1.2.0"
      };
    }
    return t.prototype.setCustomShape = function(e, n) {
      t.shapeConfigMap.set(e, n);
    }, t.pluginName = "bpmn-adapter", t.shapeConfigMap = /* @__PURE__ */ new Map(), t;
  }()
);
gi.shapeConfigMap.set(Ar.START, {
  width: Jp.width,
  height: Jp.height
});
gi.shapeConfigMap.set(Ar.END, {
  width: Qp.width,
  height: Qp.height
});
gi.shapeConfigMap.set(Ar.GATEWAY, {
  width: ev.width,
  height: ev.height
});
gi.shapeConfigMap.set(Ar.SYSTEM, {
  width: tv.width,
  height: tv.height
});
gi.shapeConfigMap.set(Ar.USER, {
  width: nv.width,
  height: nv.height
});
(function(t) {
  Q3(e, t);
  function e(n) {
    var r = t.call(this, n) || this;
    r.adapterXmlIn = function(o) {
      var a = J3(o);
      return r.adapterIn(a);
    }, r.adapterXmlOut = function(o, a) {
      var s = r.adapterOut(o, a);
      return Z3(s);
    };
    var i = n.lf;
    return i.adapterIn = r.adapterXmlIn, i.adapterOut = r.adapterXmlOut, r;
  }
  return e.pluginName = "bpmnXmlAdapter", e;
})(gi);
var o4 = (
  /** @class */
  function() {
    function t() {
      globalThis._ids = this, this._ids = /* @__PURE__ */ new Set();
    }
    return t.prototype.generateId = function() {
      var e = "xxxxxxx".replace(/[x]/g, function(n) {
        var r = Math.random() * 16 | 0, i = n === "x" ? r : r & 3 | 8;
        return i.toString(16);
      });
      return e;
    }, t.prototype.next = function() {
      for (var e = this.generateId(); this._ids.has(e); )
        e = this.generateId();
      return this._ids.add(e), e;
    }, t;
  }()
), a4 = (globalThis == null ? void 0 : globalThis._ids) || new o4();
function s4() {
  return a4.next();
}
ae("circle", {
  cx: 18,
  cy: 18,
  r: 11,
  style: "stroke-linecap: round;stroke-linejoin: round;stroke: rgb(34, 36, 42);stroke-width: 2px;fill: white"
}), ae("path", {
  d: "M 18,18 l 2.25,-7.5 m -2.25,7.5 l 5.25,1.5",
  style: "fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 2px;"
}), ae("path", {
  d: "M 18,18 m 0,7.5 l -0,2.25",
  transform: "rotate(0,18,18)",
  style: "fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"
}), ae("path", {
  d: "M 18,18 m 0,7.5 l -0,2.25",
  transform: "rotate(30,18,18)",
  style: "fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"
}), ae("path", {
  d: "M 18,18 m 0,7.5 l -0,2.25",
  transform: "rotate(60,18,18)",
  style: "fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"
}), ae("path", {
  d: "M 18,18 m 0,7.5 l -0,2.25",
  transform: "rotate(90,18,18)",
  style: "fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"
}), ae("path", {
  d: "M 18,18 m 0,7.5 l -0,2.25",
  transform: "rotate(120,18,18)",
  style: "fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"
}), ae("path", {
  d: "M 18,18 m 0,7.5 l -0,2.25",
  transform: "rotate(150,18,18)",
  style: "fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"
}), ae("path", {
  d: "M 18,18 m 0,7.5 l -0,2.25",
  transform: "rotate(180,18,18)",
  style: "fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"
}), ae("path", {
  d: "M 18,18 m 0,7.5 l -0,2.25",
  transform: "rotate(210,18,18)",
  style: "fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"
}), ae("path", {
  d: "M 18,18 m 0,7.5 l -0,2.25",
  transform: "rotate(240,18,18)",
  style: "fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"
}), ae("path", {
  d: "M 18,18 m 0,7.5 l -0,2.25",
  transform: "rotate(270,18,18)",
  style: "fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"
}), ae("path", {
  d: "M 18,18 m 0,7.5 l -0,2.25",
  transform: "rotate(300,18,18)",
  style: "fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"
}), ae("path", {
  d: "M 18,18 m 0,7.5 l -0,2.25",
  transform: "rotate(330,18,18)",
  style: "fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"
});
ae("circle", {
  cx: 18,
  cy: 18,
  r: 10,
  style: "stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 4px; fill: rgb(34, 36, 42);"
});
ae("circle", {
  cx: 25,
  cy: 25,
  r: 13,
  style: "stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 2.5px; fill: white;"
});
var l4 = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), Ci = function() {
  return Ci = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Ci.apply(this, arguments);
}, u4 = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, f4 = Kn, c4 = (
  /** @class */
  function(t) {
    l4(e, t);
    function e(n) {
      var r = t.call(this) || this;
      return r.updatePosition = function(i) {
        var o = i.deltaX, a = i.deltaY, s = r.nodeModel, l = s.x, u = s.y;
        r.nodeModel.x = l + o / 2, r.nodeModel.y = u + a / 2, r.nodeModel.moveText(o / 2, a / 2);
      }, r.getResize = function(i) {
        var o = i.index, a = i.deltaX, s = i.deltaY, l = i.width, u = i.height, f = i.PCTResizeInfo, c = i.pct, d = c === void 0 ? 1 : c, h = i.freezeWidth, v = h === void 0 ? !1 : h, p = i.freezeHeight, g = p === void 0 ? !1 : p, y = {
          width: l,
          height: u,
          deltaX: a,
          deltaY: s
        };
        if (f) {
          var m = 4, A = 0, T = 0;
          switch (o) {
            case 0:
              T = (a * -1 - s) / m;
              break;
            case 1:
              T = (a - s) / m;
              break;
            case 2:
              T = (a + s) / m;
              break;
            case 3:
              T = (a * -1 + s) / m;
              break;
          }
          T !== 0 && (A = Math.round(T / f.ResizeBasis.basisHeight * 1e5) / 1e3), f.ResizePCT.widthPCT = Math.max(Math.min(f.ResizePCT.widthPCT + A, f.ScaleLimit.maxScaleLimit), f.ScaleLimit.minScaleLimit), f.ResizePCT.heightPCT = Math.max(Math.min(f.ResizePCT.heightPCT + A, f.ScaleLimit.maxScaleLimit), f.ScaleLimit.minScaleLimit);
          var k = Math.round(f.ResizePCT.widthPCT * f.ResizeBasis.basisWidth / 100), C = Math.round(f.ResizePCT.heightPCT * f.ResizeBasis.basisHeight / 100);
          switch (o) {
            case 0:
              a = l - k, s = u - C;
              break;
            case 1:
              a = k - l, s = u - C;
              break;
            case 2:
              a = k - l, s = C - u;
              break;
            case 3:
              a = l - k, s = C - u;
              break;
          }
          return y.width = k, y.height = C, y.deltaX = a / d, y.deltaY = s / d, y;
        }
        switch (o) {
          case 0:
            y.width = v ? l : l - a * d, y.height = g ? u : u - s * d;
            break;
          case 1:
            y.width = v ? l : l + a * d, y.height = g ? u : u - s * d;
            break;
          case 2:
            y.width = v ? l : l + a * d, y.height = g ? u : u + s * d;
            break;
          case 3:
            y.width = v ? l : l - a * d, y.height = g ? u : u + s * d;
            break;
        }
        return y;
      }, r.updateEdgePointByAnchors = function() {
        var i = r.nodeModel, o = i.id, a = i.anchors, s = r.getNodeEdges(o);
        s.sourceEdges.forEach(function(l) {
          var u = a.find(function(f) {
            return f.id === l.sourceAnchorId;
          });
          u && l.updateStartPoint({
            x: u.x,
            y: u.y
          });
        }), s.targetEdges.forEach(function(l) {
          var u = a.find(function(f) {
            return f.id === l.targetAnchorId;
          });
          u && l.updateEndPoint({
            x: u.x,
            y: u.y
          });
        });
      }, r.updateRect = function(i) {
        var o = i.deltaX, a = i.deltaY, s = r.nodeModel, l = s.x, u = s.y, f = s.width, c = s.height, d = s.radius, h = s.PCTResizeInfo, v = r.nodeModel, p = v.minWidth, g = v.minHeight, y = v.maxWidth, m = v.maxHeight, A = r.index, T = p === y, k = g === m, C = r.getResize({
          index: A,
          deltaX: o,
          deltaY: a,
          width: f,
          height: c,
          PCTResizeInfo: h,
          pct: 1,
          freezeWidth: T,
          freezeHeight: k
        });
        if (C.width < p || C.width > y || C.height < g || C.height > m) {
          r.dragHandler.cancelDrag();
          return;
        }
        r.updatePosition({
          deltaX: T ? 0 : C.deltaX,
          deltaY: k ? 0 : C.deltaY
        }), r.nodeModel.width = C.width, r.nodeModel.height = C.height, r.nodeModel.setProperties({
          nodeSize: {
            width: C.width,
            height: C.height
          }
        });
        var S = {
          x: l,
          y: u,
          width: f,
          height: c,
          radius: d
        }, I = {
          x: r.nodeModel.x,
          y: r.nodeModel.y,
          width: r.nodeModel.width,
          height: r.nodeModel.height,
          radius: d
        };
        r.updateEdgePointByAnchors(), r.eventEmit({
          deltaX: o,
          deltaY: a,
          beforeNode: S,
          afterNode: I
        });
      }, r.updateEllipse = function(i) {
        var o = i.deltaX, a = i.deltaY, s = r.nodeModel, l = s.rx, u = s.ry, f = s.x, c = s.y, d = s.PCTResizeInfo, h = r.index, v = r.nodeModel, p = v.minWidth, g = v.minHeight, y = v.maxWidth, m = v.maxHeight, A = p === y, T = g === m, k = l, C = u, S = r.getResize({
          index: h,
          deltaX: o,
          deltaY: a,
          width: k,
          height: C,
          PCTResizeInfo: d,
          pct: 1 / 2,
          freezeWidth: A,
          freezeHeight: T
        });
        if (S.width < p / 2 || S.width > y / 2 || S.height < g / 2 || S.height > m / 2) {
          r.dragHandler.cancelDrag();
          return;
        }
        r.updatePosition({
          deltaX: A ? 0 : S.deltaX,
          deltaY: T ? 0 : S.deltaY
        }), r.nodeModel.rx = S.width, r.nodeModel.ry = S.height, r.nodeModel.setProperties({
          nodeSize: {
            rx: S.width,
            ry: S.height
          }
        });
        var I = {
          x: f,
          y: c
        }, X = {
          rx: S.width,
          ry: S.height,
          x: r.nodeModel.x,
          y: r.nodeModel.y
        };
        r.updateEdgePointByAnchors(), r.eventEmit({
          deltaX: o,
          deltaY: a,
          beforeNode: Ci(Ci({}, I), { rx: l, ry: u }),
          afterNode: X
        });
      }, r.updateDiamond = function(i) {
        var o = i.deltaX, a = i.deltaY, s = r.nodeModel, l = s.rx, u = s.ry, f = s.x, c = s.y, d = s.PCTResizeInfo, h = r.index, v = r.nodeModel, p = v.minWidth, g = v.minHeight, y = v.maxWidth, m = v.maxHeight, A = p === y, T = g === m, k = l, C = u, S = r.getResize({
          index: h,
          deltaX: o,
          deltaY: a,
          width: k,
          height: C,
          PCTResizeInfo: d,
          pct: 1 / 2,
          freezeWidth: A,
          freezeHeight: T
        });
        if (S.width < p / 2 || S.width > y / 2 || S.height < g / 2 || S.height > m / 2) {
          r.dragHandler.cancelDrag();
          return;
        }
        r.updatePosition({
          deltaX: A ? 0 : S.deltaX,
          deltaY: T ? 0 : S.deltaY
        }), r.nodeModel.rx = S.width, r.nodeModel.ry = S.height, r.nodeModel.setProperties({
          nodeSize: {
            rx: S.width,
            ry: S.height
          }
        });
        var I = {
          x: f,
          y: c,
          rx: l,
          ry: u
        }, X = {
          rx: S.width,
          ry: S.height,
          x: r.nodeModel.x,
          y: r.nodeModel.y
        };
        r.updateEdgePointByAnchors(), r.eventEmit({
          deltaX: o,
          deltaY: a,
          beforeNode: I,
          afterNode: X
        });
      }, r.eventEmit = function(i) {
        var o = i.deltaX, a = i.deltaY, s = i.beforeNode, l = i.afterNode, u = r.nodeModel, f = u.id, c = u.modelType, d = u.type, h = Ci({ id: f, modelType: c, type: d }, s), v = Ci({ id: f, modelType: c, type: d }, l);
        r.graphModel.eventCenter.emit("node:resize", {
          preData: h,
          data: v,
          deltaX: o,
          deltaY: a,
          index: r.index,
          model: r.nodeModel
        });
      }, r.onDragging = function(i) {
        var o, a = i.deltaX, s = i.deltaY, l = r.graphModel.transformModel, u = r.nodeModel.modelType;
        o = u4(l.fixDeltaXY(a, s), 2), a = o[0], s = o[1], u === $e.RECT_NODE || u === $e.HTML_NODE ? r.updateRect({
          deltaX: a,
          deltaY: s
        }) : u === $e.ELLIPSE_NODE ? r.updateEllipse({
          deltaX: a,
          deltaY: s
        }) : u === $e.DIAMOND_NODE && r.updateDiamond({
          deltaX: a,
          deltaY: s
        });
      }, r.onDragEnd = function() {
        var i = r.graphModel.gridSize, o = i === void 0 ? 1 : i, a = o * Math.round(r.nodeModel.x / o), s = o * Math.round(r.nodeModel.y / o);
        r.nodeModel.moveTo(a, s), r.updateEdgePointByAnchors();
      }, r.index = n.index, r.nodeModel = n.model, r.graphModel = n.graphModel, r.dragHandler = new f4({
        onDragging: r.onDragging,
        onDragEnd: r.onDragEnd,
        step: 1
      }), r;
    }
    return e.prototype.getNodeEdges = function(n) {
      for (var r = this.graphModel, i = r.edges, o = [], a = [], s = 0; s < i.length; s++) {
        var l = i[s];
        l.sourceNodeId === n ? o.push(l) : i[s].targetNodeId === n && a.push(l);
      }
      return {
        sourceEdges: o,
        targetEdges: a
      };
    }, e.prototype.render = function() {
      var n = this.props, r = n.x, i = n.y, o = n.index, a = n.model, s = a.getControlPointStyle();
      return B("g", { className: "lf-resize-control-".concat(o), children: B($n, Ci({ className: "lf-node-control", x: r, y: i }, s, { onMouseDown: this.dragHandler.handleMouseDown })) });
    }, e;
  }(Ye)
), d4 = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), vl = function() {
  return vl = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, vl.apply(this, arguments);
}, du = (
  /** @class */
  function(t) {
    d4(e, t);
    function e() {
      var n = t.call(this) || this;
      return n.state = {}, n;
    }
    return e.prototype.getResizeControl = function() {
      var n = this.props, r = n.model, i = n.graphModel, o = r.x, a = r.y, s = r.width, l = r.height, u = {
        minX: o - s / 2,
        minY: a - l / 2,
        maxX: o + s / 2,
        maxY: a + l / 2
      }, f = u.minX, c = u.minY, d = u.maxX, h = u.maxY, v = [
        // 左上角
        {
          x: f,
          y: c
        },
        // 右上角
        {
          x: d,
          y: c
        },
        // 右下角
        {
          x: d,
          y: h
        },
        // 左下角
        {
          x: f,
          y: h
        }
      ];
      return v.map(function(p, g) {
        return B(c4, vl({ index: g }, p, { model: r, graphModel: i }));
      });
    }, e.prototype.getGroupSolid = function() {
      var n = this.props.model, r = n.x, i = n.y, o = n.width, a = n.height, s = n.getResizeOutlineStyle();
      return B($n, vl({}, s, { x: r, y: i, width: o, height: a }));
    }, e.prototype.render = function() {
      return B("g", { className: "lf-resize-control", children: [this.getGroupSolid(), this.getResizeControl()] });
    }, e;
  }(Ye)
), C_ = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}();
(function(t) {
  C_(e, t);
  function e(n, r) {
    var i = t.call(this, n, r) || this, o = n.properties.nodeSize;
    return o && (i.rx = o.rx, i.ry = o.ry), i;
  }
  return e.prototype.initNodeData = function(n) {
    t.prototype.initNodeData.call(this, n), this.minWidth = 30, this.minHeight = 30, this.maxWidth = 2e3, this.maxHeight = 2e3;
  }, e.prototype.getOutlineStyle = function() {
    var n = t.prototype.getOutlineStyle.call(this), r = this.graphModel.editConfigModel.isSilentMode;
    return r || (n.stroke = "none", n.hover && (n.hover.stroke = "none")), n;
  }, e.prototype.getResizeOutlineStyle = function() {
    return {
      fill: "none",
      stroke: "transparent",
      strokeWidth: 1,
      strokeDasharray: "3,3"
    };
  }, e.prototype.getControlPointStyle = function() {
    return {
      width: 7,
      height: 7,
      fill: "#FFFFFF",
      stroke: "#000000"
    };
  }, e.prototype.enableProportionResize = function(n) {
    if (n === void 0 && (n = !0), n) {
      var r = {
        widthPCT: 100,
        heightPCT: 100
      }, i = {
        basisWidth: this.rx,
        basisHeight: this.ry
      }, o = {
        maxScaleLimit: Math.min(this.maxWidth / (this.rx * 2) * 100, this.maxHeight / (this.ry * 2) * 100),
        minScaleLimit: Math.max(this.minWidth / (this.rx * 2) * 100, this.minHeight / (this.ry * 2) * 100)
      };
      this.PCTResizeInfo = {
        ResizePCT: r,
        ResizeBasis: i,
        ScaleLimit: o
      };
    } else
      delete this.PCTResizeInfo;
  }, e;
})(Df);
(function(t) {
  C_(e, t);
  function e() {
    return t !== null && t.apply(this, arguments) || this;
  }
  return e.prototype.getControlGroup = function() {
    var n = this.props, r = n.model, i = n.graphModel;
    return B(du, { model: r, graphModel: i });
  }, e.prototype.getResizeShape = function() {
    return t.prototype.getShape.call(this);
  }, e.prototype.getShape = function() {
    var n = this.props, r = n.model, i = n.graphModel.editConfigModel.isSilentMode;
    return B("g", { children: [this.getResizeShape(), r.isSelected && !i ? this.getControlGroup() : ""] });
  }, e;
})(zf);
var T_ = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), Qf = function() {
  return Qf = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Qf.apply(this, arguments);
};
(function(t) {
  T_(e, t);
  function e(n, r) {
    var i = t.call(this, n, r) || this, o = n.properties.nodeSize;
    return o && (i.rx = o.rx, i.ry = o.ry), i;
  }
  return e.prototype.initNodeData = function(n) {
    t.prototype.initNodeData.call(this, n), this.minWidth = 30, this.minHeight = 30, this.maxWidth = 2e3, this.maxHeight = 2e3, this.gridSize = 1;
  }, e.prototype.getOutlineStyle = function() {
    var n = t.prototype.getOutlineStyle.call(this), r = this.graphModel.editConfigModel.isSilentMode;
    return r || (n.stroke = "none", n.hover && (n.hover.stroke = "none")), n;
  }, e.prototype.getResizeOutlineStyle = function() {
    return {
      fill: "none",
      stroke: "transparent",
      strokeWidth: 1,
      strokeDasharray: "3,3"
    };
  }, e.prototype.getControlPointStyle = function() {
    return {
      width: 7,
      height: 7,
      fill: "#FFFFFF",
      stroke: "#000000"
    };
  }, e.prototype.enableProportionResize = function(n) {
    if (n === void 0 && (n = !0), n) {
      var r = {
        widthPCT: 100,
        heightPCT: 100
      }, i = {
        basisWidth: this.rx,
        basisHeight: this.ry
      }, o = {
        maxScaleLimit: Math.min(this.maxWidth / (this.rx * 2) * 100, this.maxHeight / (this.ry * 2) * 100),
        minScaleLimit: Math.max(this.minWidth / (this.rx * 2) * 100, this.minHeight / (this.ry * 2) * 100)
      };
      this.PCTResizeInfo = {
        ResizePCT: r,
        ResizeBasis: i,
        ScaleLimit: o
      };
    } else
      delete this.PCTResizeInfo;
  }, e;
})(Pf);
(function(t) {
  T_(e, t);
  function e() {
    return t !== null && t.apply(this, arguments) || this;
  }
  return e.prototype.getControlGroup = function() {
    var n = this.props, r = n.model, i = n.graphModel;
    return B(du, { model: r, graphModel: i });
  }, e.prototype.getResizeShape = function() {
    var n = this.props.model, r = n.points, i = n.getNodeStyle();
    return B("g", { children: B(vd, Qf({}, i, { points: r })) });
  }, e.prototype.getShape = function() {
    var n = this.props, r = n.model.isSelected, i = n.graphModel.editConfigModel.isSilentMode;
    return B("g", { children: [this.getResizeShape(), r && !i ? this.getControlGroup() : ""] });
  }, e;
})(Hf);
var N_ = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}();
(function(t) {
  N_(e, t);
  function e(n, r) {
    var i = t.call(this, n, r) || this, o = n.properties.nodeSize;
    return o && (i.width = o.width, i.height = o.height), i;
  }
  return e.prototype.initNodeData = function(n) {
    t.prototype.initNodeData.call(this, n), this.minWidth = 30, this.minHeight = 30, this.maxWidth = 2e3, this.maxHeight = 2e3;
  }, e.prototype.getOutlineStyle = function() {
    var n = t.prototype.getOutlineStyle.call(this), r = this.graphModel.editConfigModel.isSilentMode;
    return r || (n.stroke = "none", n.hover && (n.hover.stroke = "none")), n;
  }, e.prototype.getResizeOutlineStyle = function() {
    return {
      fill: "none",
      stroke: "transparent",
      strokeWidth: 1,
      strokeDasharray: "3,3"
    };
  }, e.prototype.getControlPointStyle = function() {
    return {
      width: 7,
      height: 7,
      fill: "#FFFFFF",
      stroke: "#000000"
    };
  }, e.prototype.enableProportionResize = function(n) {
    if (n === void 0 && (n = !0), n) {
      var r = {
        widthPCT: 100,
        heightPCT: 100
      }, i = {
        basisWidth: this.width,
        basisHeight: this.height
      }, o = {
        maxScaleLimit: Math.min(this.maxWidth / this.width * 100, this.maxHeight / this.height * 100),
        minScaleLimit: Math.max(this.minWidth / this.width * 100, this.minHeight / this.height * 100)
      };
      this.PCTResizeInfo = {
        ResizePCT: r,
        ResizeBasis: i,
        ScaleLimit: o
      };
    } else
      delete this.PCTResizeInfo;
  }, e;
})(Rf);
(function(t) {
  N_(e, t);
  function e() {
    return t !== null && t.apply(this, arguments) || this;
  }
  return e.prototype.getControlGroup = function() {
    var n = this.props, r = n.model, i = n.graphModel;
    return B(du, { model: r, graphModel: i });
  }, e.prototype.getResizeShape = function() {
    return t.prototype.getShape.call(this);
  }, e.prototype.getShape = function() {
    var n = this.props, r = n.model.isSelected, i = n.graphModel.editConfigModel.isSilentMode;
    return B("g", { children: [this.getResizeShape(), r && !i ? this.getControlGroup() : ""] });
  }, e;
})(Gf);
var M_ = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), h4 = (
  /** @class */
  function(t) {
    M_(e, t);
    function e(n, r) {
      var i = t.call(this, n, r) || this, o = n.properties.nodeSize;
      return o && (i.width = o.width, i.height = o.height), i;
    }
    return e.prototype.initNodeData = function(n) {
      t.prototype.initNodeData.call(this, n), this.minWidth = 30, this.minHeight = 30, this.maxWidth = 2e3, this.maxHeight = 2e3;
    }, e.prototype.getOutlineStyle = function() {
      var n = t.prototype.getOutlineStyle.call(this), r = this.graphModel.editConfigModel.isSilentMode;
      return r || (n.stroke = "none", n.hover && (n.hover.stroke = "none")), n;
    }, e.prototype.getResizeOutlineStyle = function() {
      return {
        fill: "none",
        stroke: "transparent",
        // 矩形默认不显示调整边框
        strokeWidth: 1,
        strokeDasharray: "3,3"
      };
    }, e.prototype.getControlPointStyle = function() {
      return {
        width: 7,
        height: 7,
        fill: "#FFFFFF",
        stroke: "#000000"
      };
    }, e.prototype.enableProportionResize = function(n) {
      if (n === void 0 && (n = !0), n) {
        var r = {
          widthPCT: 100,
          heightPCT: 100
        }, i = {
          basisWidth: this.width,
          basisHeight: this.height
        }, o = {
          maxScaleLimit: Math.min(this.maxWidth / this.width * 100, this.maxHeight / this.height * 100),
          minScaleLimit: Math.max(this.minWidth / this.width * 100, this.minHeight / this.height * 100)
        };
        this.PCTResizeInfo = {
          ResizePCT: r,
          ResizeBasis: i,
          ScaleLimit: o
        };
      } else
        delete this.PCTResizeInfo;
    }, e;
  }(Or)
), p4 = (
  /** @class */
  function(t) {
    M_(e, t);
    function e() {
      return t !== null && t.apply(this, arguments) || this;
    }
    return e.prototype.getControlGroup = function() {
      var n = this.props, r = n.model, i = n.graphModel;
      return B(du, { model: r, graphModel: i });
    }, e.prototype.getResizeShape = function() {
      return t.prototype.getShape.call(this);
    }, e.prototype.getShape = function() {
      var n = this.props, r = n.model.isSelected, i = n.graphModel.editConfigModel.isSilentMode;
      return B("g", { children: [this.getResizeShape(), r && !i ? this.getControlGroup() : ""] });
    }, e;
  }(pr)
), P_ = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), gl = function() {
  return gl = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, gl.apply(this, arguments);
}, xi = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, Ei = function(t, e, n) {
  if (n || arguments.length === 2) for (var r = 0, i = e.length, o; r < i; r++)
    (o || !(r in e)) && (o || (o = Array.prototype.slice.call(e, 0, r)), o[r] = e[r]);
  return t.concat(o || Array.prototype.slice.call(e));
}, lv = 500, uv = 300, v4 = -1e4;
(function(t) {
  P_(e, t);
  function e() {
    var n = t.apply(this, Ei([], xi(arguments), !1)) || this;
    return n.isGroup = !0, n.isFolded = !1, n.unfoldedWidth = lv, n.unfoldedHeight = uv, n.childrenLastFoldStatus = {}, n;
  }
  return e.prototype.initNodeData = function(n) {
    var r = this;
    t.prototype.initNodeData.call(this, n);
    var i = [];
    Ie(n.children) && (i = n.children), this.children = new Set(i), this.width = lv, this.height = uv, this.foldedWidth = 80, this.foldedHeight = 60, this.zIndex = v4, this.radius = 0, this.text.editable = !1, this.text.draggable = !1, this.isRestrict = !1, this.resizable = !1, this.autoToFront = !1, this.foldable = !1, this.properties.isFolded === void 0 && (this.properties.isFolded = !1), this.isFolded = !!this.properties.isFolded, setTimeout(function() {
      r.isFolded && r.foldGroup(r.isFolded);
    });
  }, e.prototype.getResizeOutlineStyle = function() {
    var n = t.prototype.getResizeOutlineStyle.call(this);
    return n.stroke = "none", n;
  }, e.prototype.foldGroup = function(n) {
    var r = this;
    if (n !== this.isFolded) {
      this.setProperty("isFolded", n), this.isFolded = n, n ? (this.x = this.x - this.width / 2 + this.foldedWidth / 2, this.y = this.y - this.height / 2 + this.foldedHeight / 2, this.unfoldedWidth = this.width, this.unfoldedHeight = this.height, this.width = this.foldedWidth, this.height = this.foldedHeight) : (this.width = this.unfoldedWidth, this.height = this.unfoldedHeight, this.x = this.x + this.width / 2 - this.foldedWidth / 2, this.y = this.y + this.height / 2 - this.foldedHeight / 2);
      var i = Ei(Ei([], xi(this.incoming.edges), !1), xi(this.outgoing.edges), !1);
      this.children.forEach(function(o) {
        var a = r.graphModel.getElement(o);
        if (a) {
          var s = a.isFolded;
          if (a.isGroup && !a.isFolded && a.foldGroup(n), a.isGroup && !n) {
            var l = r.childrenLastFoldStatus[o];
            l !== void 0 && l !== a.isFolded && a.foldGroup(l);
          }
          r.childrenLastFoldStatus[o] = !!s, a.visible = !n;
          var u = a.incoming.edges, f = a.outgoing.edges;
          i = Ei(Ei(Ei([], xi(i), !1), xi(u), !1), xi(f), !1);
        }
      }), this.foldEdge(n, i);
    }
  }, e.prototype.getAnchorStyle = function(n) {
    var r = t.prototype.getAnchorStyle.call(this, n);
    return r.stroke = "transparent", r.fill = "transparent", r.hover.fill = "transparent", r.hover.stroke = "transparent", r;
  }, e.prototype.foldEdge = function(n, r) {
    var i = this;
    r.forEach(function(o, a) {
      var s = o.id, l = o.sourceNodeId, u = o.targetNodeId, f = o.startPoint, c = o.endPoint, d = o.type, h = o.text, v = o.getProperties(), p = {
        id: "".concat(s, "__").concat(a),
        sourceNodeId: l,
        targetNodeId: u,
        startPoint: f,
        endPoint: c,
        type: d,
        properties: v,
        text: h == null ? void 0 : h.value
      };
      o.virtual && i.graphModel.deleteEdgeById(o.id);
      var g = i.graphModel.group.getNodeGroup(u);
      g || (g = i.graphModel.getNodeModelById(u));
      var y = i.graphModel.group.getNodeGroup(l);
      y || (y = i.graphModel.getNodeModelById(l)), n && o.visible !== !1 && (i.children.has(l) || i.id === l ? (p.startPoint = void 0, p.sourceNodeId = i.id) : (p.endPoint = void 0, p.targetNodeId = i.id), (g.id !== i.id || y.id !== i.id) && i.createVirtualEdge(p), o.visible = !1), !n && o.visible === !1 && (g && g.isGroup && g.isFolded ? (p.targetNodeId = g.id, p.endPoint = void 0, i.createVirtualEdge(p)) : y && y.isGroup && y.isFolded ? (p.sourceNodeId = y.id, p.startPoint = void 0, i.createVirtualEdge(p)) : o.visible = !0);
    });
  }, e.prototype.createVirtualEdge = function(n) {
    n.pointsList = void 0;
    var r = this.graphModel.addEdge(n);
    r.virtual = !0, r.text.editable = !1, r.isFoldedEdge = !0;
  }, e.prototype.isInRange = function(n) {
    var r = n.minX, i = n.minY, o = n.maxX, a = n.maxY;
    return r >= this.x - this.width / 2 && o <= this.x + this.width / 2 && i >= this.y - this.height / 2 && a <= this.y + this.height / 2;
  }, e.prototype.isAllowMoveTo = function(n) {
    var r = n.minX, i = n.minY, o = n.maxX, a = n.maxY;
    return {
      x: r >= this.x - this.width / 2 && o <= this.x + this.width / 2,
      y: i >= this.y - this.height / 2 && a <= this.y + this.height / 2
    };
  }, e.prototype.setAllowAppendChild = function(n) {
    this.setProperty("groupAddable", n);
  }, e.prototype.addChild = function(n) {
    this.children.add(n), this.graphModel.eventCenter.emit("group:add-node", { data: this.getData() });
  }, e.prototype.removeChild = function(n) {
    this.children.delete(n), this.graphModel.eventCenter.emit("group:remove-node", {
      data: this.getData()
    });
  }, e.prototype.getAddableOutlineStyle = function() {
    return {
      stroke: "#FEB663",
      strokeWidth: 2,
      strokeDasharray: "4 4",
      fill: "transparent"
    };
  }, e.prototype.getData = function() {
    var n = this, r = t.prototype.getData.call(this);
    r.children = [], console.log("this.children", this.children), this.children.forEach(function(o) {
      var a = n.graphModel.getNodeModelById(o);
      a && !a.virtual && r.children.push(o);
    });
    var i = r.properties;
    return i == null || delete i.groupAddable, i == null || delete i.isFolded, r;
  }, e.prototype.getHistoryData = function() {
    var n = t.prototype.getData.call(this);
    n.children = Ei([], xi(this.children), !1), n.isGroup = !0;
    var r = n.properties;
    return r == null || delete r.groupAddable, r != null && r.isFolded && (n.x = n.x + this.unfoldedWidth / 2 - this.foldedWidth / 2, n.y = n.y + this.unfoldedHeight / 2 - this.foldedHeight / 2), n;
  }, e.prototype.isAllowAppendIn = function(n) {
    return console.info("_nodeData", n), !0;
  }, e.prototype.toBack = function() {
    this.zIndex--;
  }, e;
})(h4);
(function(t) {
  P_(e, t);
  function e() {
    return t !== null && t.apply(this, arguments) || this;
  }
  return e.prototype.getControlGroup = function() {
    var n = this.props.model, r = n.resizable, i = n.properties;
    return r && !i.isFolded ? t.prototype.getControlGroup.call(this) : null;
  }, e.prototype.getAddableShape = function() {
    var n = this.props.model, r = n.width, i = n.height, o = n.x, a = n.y, s = n.radius, l = n.properties, u = n.getAddableOutlineStyle;
    if (!l.groupAddable)
      return null;
    var f = this.props.model.getNodeStyle().strokeWidth, c = f === void 0 ? 0 : f, d = u(), h = r + c + 8, v = i + c + 8;
    return ae("rect", gl(gl({}, d), { width: h, height: v, x: o - h / 2, y: a - v / 2, rx: s, ry: s }));
  }, e.prototype.getFoldIcon = function() {
    var n = this.props.model, r = n.x - n.width / 2 + 5, i = n.y - n.height / 2 + 5;
    if (!n.foldable)
      return null;
    var o = ae("path", {
      fill: "none",
      stroke: "#818281",
      strokeWidth: 2,
      "pointer-events": "none",
      d: n.properties.isFolded ? "M ".concat(r + 3, ",").concat(i + 6, " ").concat(r + 11, ",").concat(i + 6, " M").concat(r + 7, ",").concat(i + 2, " ").concat(r + 7, ",").concat(i + 10) : "M ".concat(r + 3, ",").concat(i + 6, " ").concat(r + 11, ",").concat(i + 6, " ")
    });
    return ae("g", {}, [
      ae("rect", {
        height: 12,
        width: 14,
        rx: 2,
        ry: 2,
        strokeWidth: 1,
        fill: "#F4F5F6",
        stroke: "#CECECE",
        cursor: "pointer",
        x: n.x - n.width / 2 + 5,
        y: n.y - n.height / 2 + 5,
        onClick: function() {
          n.foldGroup(!n.properties.isFolded);
        }
      }),
      o
    ]);
  }, e.prototype.getResizeShape = function() {
    return ae("g", {}, [
      this.getAddableShape(),
      t.prototype.getResizeShape.call(this),
      this.getFoldIcon()
    ]);
  }, e;
})(p4);
var fv = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), ba = function() {
  return ba = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, ba.apply(this, arguments);
};
function g4(t) {
  var e = (
    /** @class */
    function(r) {
      fv(i, r);
      function i(o, a) {
        o.id || (o.id = "Flow_".concat(s4()));
        var s = ba(ba(ba({}, {}), o.properties), {
          // panels: ['condition'],
          isDefaultFlow: !1
        });
        return o.properties = s, r.call(this, o, a) || this;
      }
      return i.extendKey = "SequenceFlowModel", i;
    }(Eo)
  ), n = (
    /** @class */
    function(r) {
      fv(i, r);
      function i() {
        return r !== null && r.apply(this, arguments) || this;
      }
      return i.prototype.getStartArrow = function() {
        var o = this.props.model, a = o.properties.isDefaultFlow;
        return a ? ae("path", {
          refX: 15,
          stroke: "#000000",
          strokeWidth: 2,
          d: "M 20 5 10 -5 z"
        }) : ae("path", {
          d: ""
        });
      }, i.extendKey = "SequenceFlowEdge", i;
    }(Oo)
  );
  return {
    type: "bpmn:sequenceFlow",
    view: n,
    model: e
  };
}
g4();
var cv = {
  width: 40,
  height: 40
}, dv = {
  width: 40,
  height: 40
}, hv = {
  width: 100,
  height: 80
}, yl = {
  width: 100,
  height: 80
}, pv = {
  width: 100,
  height: 80
}, vv = {
  width: 100,
  height: 80
}, gv = {
  width: 100,
  height: 80
}, yv = {
  width: 100,
  height: 80
}, mv = {
  width: 100,
  height: 80
}, _v = {
  width: 100,
  height: 80
}, hn = function() {
};
hn.ObjTree = function() {
  return this;
};
hn.ObjTree.VERSION = "0.23";
hn.ObjTree.prototype.xmlDecl = `<?xml version="1.0" encoding="UTF-8" ?>
`;
hn.ObjTree.prototype.attr_prefix = "-";
hn.ObjTree.prototype.parseXML = function(t) {
  var e;
  if (window.DOMParser) {
    var n = new DOMParser(), r = n.parseFromString(t, "application/xml");
    if (!r)
      return;
    e = r.documentElement;
  } else window.ActiveXObject && (n = new ActiveXObject("Microsoft.XMLDOM"), n.async = !1, n.loadXML(t), e = n.documentElement);
  if (e) {
    var i = this.parseDOM(e);
    return i;
  }
};
hn.ObjTree.prototype.parseHTTP = function(t, e, n) {
  var r = {};
  for (var i in e)
    r[i] = e[i];
  if (r.method || (typeof r.postBody > "u" && typeof r.postbody > "u" && typeof r.parameters > "u" ? r.method = "get" : r.method = "post"), n) {
    r.asynchronous = !0;
    var o = this, a = n, s = r.onComplete;
    r.onComplete = function(f) {
      var c;
      f && f.responseXML && f.responseXML.documentElement && (c = o.parseDOM(f.responseXML.documentElement)), a(c, f), s && s(f);
    };
  } else
    r.asynchronous = !1;
  var l;
  if (typeof HTTP < "u" && HTTP.Request) {
    r.uri = t;
    var u = new HTTP.Request(r);
    u && (l = u.transport);
  } else if (typeof Ajax < "u" && Ajax.Request) {
    var u = new Ajax.Request(t, r);
    u && (l = u.transport);
  }
  if (n)
    return l;
  if (l && l.responseXML && l.responseXML.documentElement)
    return this.parseDOM(l.responseXML.documentElement);
};
hn.ObjTree.prototype.parseDOM = function(t) {
  if (t) {
    if (this.__force_array = {}, this.force_array)
      for (var e = 0; e < this.force_array.length; e++)
        this.__force_array[this.force_array[e]] = 1;
    var n = this.parseElement(t);
    if (this.__force_array[t.nodeName] && (n = [n]), t.nodeType !== 11) {
      var r = {};
      r[t.nodeName] = n, n = r;
    }
    return n;
  }
};
hn.ObjTree.prototype.parseElement = function(t) {
  if (t.nodeType !== 7) {
    if (t.nodeType === 3 || t.nodeType === 4 || t.nodeType === 8) {
      var e = t.nodeValue.match(/[^\x00-\x20]/);
      return e == null ? void 0 : t.nodeValue;
    }
    var n = null, r = {};
    if (t.attributes && t.attributes.length) {
      n = {};
      for (var i = 0; i < t.attributes.length; i++) {
        var o = t.attributes[i].nodeName;
        if (typeof o == "string") {
          var a = t.attributes[i].nodeValue;
          try {
            a = JSON.parse(t.attributes[i].nodeValue.replace(/'/g, '"'));
          } catch {
            a = t.attributes[i].nodeValue;
          }
          a != null && (o = this.attr_prefix + o, typeof r[o] > "u" && (r[o] = 0), r[o]++, this.addNode(n, o, r[o], a));
        }
      }
    }
    if (t.childNodes && t.childNodes.length) {
      var s = !0;
      n && (s = !1);
      for (var i = 0; i < t.childNodes.length && s; i++) {
        var l = t.childNodes[i].nodeType;
        l === 3 || l === 4 || l === 8 || (s = !1);
      }
      if (s) {
        n || (n = "");
        for (var i = 0; i < t.childNodes.length; i++)
          n += t.childNodes[i].nodeValue;
      } else {
        n || (n = {});
        for (var i = 0; i < t.childNodes.length; i++) {
          var o = t.childNodes[i].nodeName;
          if (typeof o == "string") {
            var a = this.parseElement(t.childNodes[i]);
            a && (typeof r[o] > "u" && (r[o] = 0), r[o]++, this.addNode(n, o, r[o], a));
          }
        }
      }
    } else
      n === null && (n = {});
    return n;
  }
};
hn.ObjTree.prototype.addNode = function(t, e, n, r) {
  this.__force_array[e] ? (n === 1 && (t[e] = []), t[e][t[e].length] = r) : n === 1 ? t[e] = r : n === 2 ? t[e] = [t[e], r] : t[e][t[e].length] = r;
};
hn.ObjTree.prototype.writeXML = function(t) {
  var e = this.hash_to_xml(null, t);
  return this.xmlDecl + e;
};
hn.ObjTree.prototype.hash_to_xml = function(t, e) {
  var n = [], r = [];
  for (var i in e)
    if (Us(e, i)) {
      var o = e[i];
      i.charAt(0) !== this.attr_prefix ? typeof o > "u" || o == null ? n[n.length] = "<".concat(i, " />") : typeof o == "object" && o.constructor === Array ? n[n.length] = this.array_to_xml(i, o) : typeof o == "object" ? n[n.length] = this.hash_to_xml(i, o) : n[n.length] = this.scalar_to_xml(i, o) : r[r.length] = " ".concat(i.substring(1), '="').concat(this.xml_escape(o), '"');
    }
  var a = r.join(""), s = n.join("");
  return typeof t > "u" || t == null || (n.length > 0 ? s.match(/\n/) ? s = "<".concat(t).concat(a, `>
`).concat(s, "</").concat(t, `>
`) : s = "<".concat(t).concat(a, ">").concat(s, "</").concat(t, `>
`) : s = "<".concat(t).concat(a, ` />
`)), s;
};
hn.ObjTree.prototype.array_to_xml = function(t, e) {
  for (var n = [], r = 0; r < e.length; r++) {
    var i = e[r];
    typeof i > "u" || i == null ? n[n.length] = "<".concat(t, " />") : typeof i == "object" && i.constructor === Array ? n[n.length] = this.array_to_xml(t, i) : typeof i == "object" ? n[n.length] = this.hash_to_xml(t, i) : n[n.length] = this.scalar_to_xml(t, i);
  }
  return n.join("");
};
hn.ObjTree.prototype.scalar_to_xml = function(t, e) {
  return t === "#text" ? this.xml_escape(e) : "<".concat(t, ">").concat(this.xml_escape(e), "</").concat(t, `>
`);
};
hn.ObjTree.prototype.xml_escape = function(t) {
  return t.replace(/&/g, "&").replace(/</g, "<").replace(/>/g, ">").replace(/"/g, '"');
};
var y4 = function(t) {
  return new hn.ObjTree().parseXML(t);
};
function D_(t) {
  return Object.prototype.toString.call(t);
}
function bv(t) {
  return "  ".repeat(t);
}
function ml(t) {
  return D_(t) === "[object Object]" ? Object.keys(t).reduce(function(e, n) {
    var r = n;
    return n.charAt(0) === "-" && (r = n.substring(1)), e[r] = ml(t[n]), e;
  }, {}) : Array.isArray(t) ? t.map(function(e) {
    return ml(e);
  }) : t;
}
function m4(t) {
  var e = t;
  try {
    typeof e != "string" && (e = JSON.parse(t));
  } catch {
    e = JSON.stringify(ml(t)).replace(/"/g, "'");
  }
  return e;
}
var xv = `	
`;
function Ms(t, e, n) {
  var r = bv(n), i = "", o = xv + r;
  if (e === "-json")
    return "";
  if (e === "#text")
    return o + t;
  if (e === "#cdata-section")
    return "".concat(o, "<![CDATA[").concat(t, "]]>");
  if (e === "#comment")
    return "".concat(o, "<!--").concat(t, "-->");
  if ("".concat(e).charAt(0) === "-")
    return " ".concat(e.substring(1), '="').concat(m4(t), '"');
  if (Array.isArray(t))
    i += t.map(function(u) {
      return Ms(u, e, n + 1);
    }).join("");
  else if (D_(t) === "[object Object]") {
    var a = Object.keys(t), s = "", l = t["-json"] ? xv + bv(n + 1) + t["-json"] : "";
    i += "".concat(n === 0 ? "" : o, "<").concat(e), a.forEach(function(u) {
      u.charAt(0) === "-" ? s += Ms(t[u], u, n + 1) : l += Ms(t[u], u, n + 1);
    }), i += s + (l !== "" ? ">".concat(l).concat(o, "</").concat(e, ">") : " />");
  } else
    i += "".concat(o, "<").concat(e, ">").concat(t.toString(), "</").concat(e, ">");
  return i;
}
function _4(t) {
  var e = "";
  for (var n in t)
    e += Ms(t[n], n, 0);
  return e;
}
var b4 = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), ec = function() {
  return ec = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, ec.apply(this, arguments);
}, Ev = function(t, e) {
  var n = {};
  for (var r in t) Object.prototype.hasOwnProperty.call(t, r) && e.indexOf(r) < 0 && (n[r] = t[r]);
  if (t != null && typeof Object.getOwnPropertySymbols == "function")
    for (var i = 0, r = Object.getOwnPropertySymbols(t); i < r.length; i++)
      e.indexOf(r[i]) < 0 && Object.prototype.propertyIsEnumerable.call(t, r[i]) && (n[r[i]] = t[r[i]]);
  return n;
}, md = function(t) {
  var e = typeof Symbol == "function" && Symbol.iterator, n = e && t[e], r = 0;
  if (n) return n.call(t);
  if (t && typeof t.length == "number") return {
    next: function() {
      return t && r >= t.length && (t = void 0), { value: t && t[r++], done: !t };
    }
  };
  throw new TypeError(e ? "Object is not iterable." : "Symbol.iterator is not defined.");
}, Jt = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, nr = function(t, e, n) {
  if (n || arguments.length === 2) for (var r = 0, i = e.length, o; r < i; r++)
    (o || !(r in e)) && (o || (o = Array.prototype.slice.call(e, 0, r)), o[r] = e[r]);
  return t.concat(o || Array.prototype.slice.call(e));
}, ln;
(function(t) {
  t.START = "bpmn:startEvent", t.END = "bpmn:endEvent", t.INTERMEDIATE_CATCH = "bpmn:intermediateCatchEvent", t.INTERMEDIATE_THROW = "bpmn:intermediateThrowEvent", t.BOUNDARY = "bpmn:boundaryEvent", t.PARALLEL_GATEWAY = "bpmn:parallelGateway", t.INCLUSIVE_GATEWAY = "bpmn:inclusiveGateway", t.EXCLUSIVE_GATEWAY = "bpmn:exclusiveGateway", t.USER = "bpmn:userTask", t.SYSTEM = "bpmn:serviceTask", t.FLOW = "bpmn:sequenceFlow", t.SUBPROCESS = "bpmn:subProcess";
})(ln || (ln = {}));
var R_ = [
  "-name",
  "-id",
  "bpmn:incoming",
  "bpmn:outgoing",
  "-sourceRef",
  "-targetRef",
  "-children"
], x4 = [
  "properties",
  "startPoint",
  "endPoint",
  "pointsList"
], _l = {
  in: [],
  out: [
    "properties.panels",
    "properties.nodeSize",
    "properties.definitionId",
    "properties.timerValue",
    "properties.timerType",
    "properties.definitionType",
    "properties.parent",
    "properties.isBoundaryEventTouchingTask"
  ]
}, L_ = function(t, e) {
  var n = Object.keys(e || {});
  return n.forEach(function(r) {
    if (t[r]) {
      var i = e[r], o = i.in, a = i.out;
      o && (t[r].in = o), a && (t[r].out = a);
    } else
      t[r] = e[r];
  }), t;
}, jn = {
  "bpmn:startEvent": {
    out: function(t) {
      var e, n, r = t.properties;
      return ((n = (e = jn[r.definitionType]) === null || e === void 0 ? void 0 : e.out) === null || n === void 0 ? void 0 : n.call(e, t)) || {};
    }
  },
  // 'bpmn:endEvent': undefined,
  "bpmn:intermediateCatchEvent": {
    out: function(t) {
      var e, n, r = t.properties;
      return ((n = (e = jn[r.definitionType]) === null || e === void 0 ? void 0 : e.out) === null || n === void 0 ? void 0 : n.call(e, t)) || {};
    }
  },
  "bpmn:intermediateThrowEvent": {
    out: function(t) {
      var e, n, r = t.properties;
      return ((n = (e = jn[r.definitionType]) === null || e === void 0 ? void 0 : e.out) === null || n === void 0 ? void 0 : n.call(e, t)) || {};
    }
  },
  "bpmn:boundaryEvent": {
    out: function(t) {
      var e, n, r = t.properties;
      return ((n = (e = jn[r.definitionType]) === null || e === void 0 ? void 0 : e.out) === null || n === void 0 ? void 0 : n.call(e, t)) || {};
    }
  },
  // 'bpmn:userTask': undefined,
  "bpmn:sequenceFlow": {
    out: function(t) {
      var e = t.properties, n = e.expressionType, r = e.condition;
      return r ? n === "cdata" ? {
        json: '<bpmn:conditionExpression xsi:type="bpmn2:tFormalExpression"><![CDATA[${'.concat(r, "}]]></bpmn:conditionExpression>")
      } : {
        json: '<bpmn:conditionExpression xsi:type="bpmn2:tFormalExpression">'.concat(r, "</bpmn:conditionExpression>")
      } : {
        json: ""
      };
    }
  },
  // 'bpmn:subProcess': undefined,
  // 'bpmn:participant': undefined,
  "bpmn:timerEventDefinition": {
    out: function(t) {
      var e = t.properties, n = e.timerType, r = e.timerValue, i = e.definitionId, o = function() {
        return "<bpmn:".concat(n, ' xsi:type="bpmn:tFormalExpression">').concat(r, "</bpmn:").concat(n, ">");
      };
      return {
        json: '<bpmn:timerEventDefinition id="'.concat(i, '"').concat(n && r ? ">".concat(o(), "</bpmn:timerEventDefinition>") : "/>")
      };
    },
    in: function(t, e) {
      var n, r, i, o, a = t, s = e["-id"], l = "", u = "";
      try {
        for (var f = md(Object.keys(e)), c = f.next(); !c.done; c = f.next()) {
          var d = c.value;
          d.includes("bpmn:") && (i = Jt(d.split(":"), 2), l = i[1], u = (o = e[d]) === null || o === void 0 ? void 0 : o["#text"]);
        }
      } catch (h) {
        n = { error: h };
      } finally {
        try {
          c && !c.done && (r = f.return) && r.call(f);
        } finally {
          if (n) throw n.error;
        }
      }
      return {
        "-definitionId": s,
        "-definitionType": a,
        "-timerType": l,
        "-timerValue": u
      };
    }
  },
  "bpmn:conditionExpression": {
    in: function(t, e) {
      var n, r = "", i = "";
      return e["#cdata-section"] ? (i = "cdata", r = ((n = /^\$\{(.*)\}$/g.exec(e["#cdata-section"])) === null || n === void 0 ? void 0 : n[1]) || "") : e["#text"] && (i = "normal", r = e["#text"]), {
        "-condition": r,
        "-expressionType": i
      };
    }
  }
};
function E4(t) {
  var e = t ?? {}, n = e.retainedAttrsFields, r = e.excludeFields, i = e.transformer, o = new Set(nr(nr([], Jt(x4), !1), Jt(n || []), !1)), a = {
    in: new Set(nr(nr([], Jt(_l.in), !1), Jt((r == null ? void 0 : r.in) || []), !1)),
    out: new Set(nr(nr([], Jt(_l.out), !1), Jt((r == null ? void 0 : r.out) || []), !1))
  };
  return jn = L_(jn, i), function(s) {
    var l = s.nodes, u = s.edges;
    function f(c, d) {
      var h, v;
      if ((c == null ? void 0 : c.flag) !== 1) {
        var p;
        if ((p = jn[c.type]) && p.out) {
          var g = p.out(c), y = Object.keys(g);
          y.length > 0 && y.forEach(function(X) {
            c[X] = g[X];
          });
        }
        c != null && c.children && (c.children = c.children.map(function(X) {
          var Q = l.find(function(ue) {
            return ue.id === X;
          }) || u.find(function(ue) {
            return ue.id === X;
          });
          return Q || {};
        }));
        var m = {};
        if (typeof c == "string")
          return c;
        if (Array.isArray(c))
          return c.map(function(X) {
            return f(X, "");
          }).filter(function(X) {
            return X != null;
          });
        try {
          for (var A = md(Object.entries(c)), T = A.next(); !T.done; T = A.next()) {
            var k = Jt(T.value, 2), C = k[0], S = k[1];
            if ((S == null ? void 0 : S.flag) === 1)
              return;
            var I = [d, C].filter(function(X) {
              return X;
            }).join(".");
            a.out.has(I) || (typeof S != "object" ? C.indexOf("-") === 0 || ["#text", "#cdata-section", "#comment"].includes(C) ? m[C] = S : m["-".concat(C)] = S : o.has(I) ? m["-".concat(C)] = f(S, I) : m[C] = f(S, I));
          }
        } catch (X) {
          h = { error: X };
        } finally {
          try {
            T && !T.done && (v = A.return) && v.call(A);
          } finally {
            if (h) throw h.error;
          }
        }
        return m;
      }
    }
    return f(s, "");
  };
}
function bl(t) {
  var e, n, r = {};
  try {
    for (var i = md(Object.entries(t)), o = i.next(); !o.done; o = i.next()) {
      var a = Jt(o.value, 2), s = a[0], l = a[1];
      s.indexOf("-") === 0 ? r[s.substring(1)] = ml(l) : typeof l == "string" ? r[s] = l : Object.prototype.toString.call(l) === "[object Object]" ? r[s] = bl(l) : Array.isArray(l) ? r[s] = l.map(function(u) {
        return bl(u);
      }) : r[s] = l;
    }
  } catch (u) {
    e = { error: u };
  } finally {
    try {
      o && !o.done && (n = i.return) && n.call(i);
    } finally {
      if (e) throw e.error;
    }
  }
  return r;
}
function w4(t, e, n) {
  var r, i = /* @__PURE__ */ new Map(), o = E4(n)(e);
  o.nodes.forEach(function(s) {
    var l = s["-id"], u = s["-type"], f = s.text, c = s.children, d = Ev(s, ["-id", "-type", "text", "children"]), h = { "-id": l };
    f != null && f["-value"] && (h["-name"] = f["-value"]), d["-json"] && (h["-json"] = d["-json"]), d["-properties"] && Object.assign(h, d["-properties"]), c && (h.children = c), t[u] || (t[u] = []), t[u].push(h), i.set(l, h);
  });
  var a = o.edges.map(function(s) {
    var l = s["-id"], u = s["-sourceNodeId"], f = s["-targetNodeId"], c = s.text, d = Ev(s, ["-id", "-sourceNodeId", "-targetNodeId", "text"]), h = i.get(f);
    h["bpmn:incoming"] || (h["bpmn:incoming"] = []), h["bpmn:incoming"].push(l);
    var v = {
      "-id": l,
      "-sourceRef": u,
      "-targetRef": f
    };
    return c != null && c["-value"] && (v["-name"] = c["-value"]), d["-json"] && (v["-json"] = d["-json"]), d["-properties"] && Object.assign(v, d["-properties"]), v;
  });
  return e.edges.forEach(function(s) {
    var l = s.sourceNodeId, u = s.id, f = i.get(l);
    f["bpmn:outgoing"] || (f["bpmn:outgoing"] = []), f["bpmn:outgoing"].push(u);
  }), (r = t["bpmn:subProcess"]) === null || r === void 0 || r.forEach(function(s) {
    var l = {
      "bpmn:incoming": /* @__PURE__ */ new Set(),
      "bpmn:outgoing": /* @__PURE__ */ new Set()
    }, u = [];
    s.children.forEach(function(p) {
      var g, y = i.get(p["-id"]);
      ["bpmn:incoming", "bpmn:outgoing"].forEach(function(A) {
        y[A] && y[A].forEach(function(T) {
          l[A].add(T);
        });
      });
      var m = (g = t[p["-type"]]) === null || g === void 0 ? void 0 : g.findIndex(function(A) {
        return A["-id"] === p["-id"];
      });
      m >= 0 && t[p["-type"]].splice(m, 1), i.delete(p["-id"]), s[p["-type"]] || (s[p["-type"]] = []), s[p["-type"]].push(y);
    });
    var f = l["bpmn:incoming"], c = l["bpmn:outgoing"];
    c.forEach(function(p) {
      f.has(p) && u.push(p);
    });
    for (var d = function(p) {
      var g = a.findIndex(function(y) {
        return y["-id"] === u[p];
      });
      g >= 0 ? (s["bpmn:sequenceFlow"] || (s["bpmn:sequenceFlow"] = []), s["bpmn:sequenceFlow"].push(a[g]), a.splice(g, 1)) : p++, h = p;
    }, h, v = 0; v < u.length; )
      d(v), v = h;
    delete s.children;
  }), t[ln.FLOW] = a, t;
}
function S4(t, e) {
  t["bpmndi:BPMNEdge"] = e.edges.map(function(n) {
    var r, i = n.id, o = n.pointsList.map(function(s) {
      var l = s.x, u = s.y;
      return {
        "-x": l,
        "-y": u
      };
    }), a = {
      "-id": "".concat(i, "_di"),
      "-bpmnElement": i,
      "di:waypoint": o
    };
    return !((r = n.text) === null || r === void 0) && r.value && (a["bpmndi:BPMNLabel"] = {
      "dc:Bounds": {
        "-x": n.text.x - n.text.value.length * 10 / 2,
        "-y": n.text.y - 7,
        "-width": n.text.value.length * 10,
        "-height": 14
      }
    }), a;
  }), t["bpmndi:BPMNShape"] = e.nodes.map(function(n) {
    var r, i = n.id, o = 100, a = 80, s = n.x, l = n.y, u = En.shapeConfigMap.get(n.type);
    u && (o = u.width, a = u.height), s -= o / 2, l -= a / 2;
    var f = {
      "-id": "".concat(i, "_di"),
      "-bpmnElement": i,
      "dc:Bounds": {
        "-x": s,
        "-y": l,
        "-width": o,
        "-height": a
      }
    };
    return !((r = n.text) === null || r === void 0) && r.value && (f["bpmndi:BPMNLabel"] = {
      "dc:Bounds": {
        "-x": n.text.x - n.text.value.length * 10 / 2,
        "-y": n.text.y - 7,
        "-width": n.text.value.length * 10,
        "-height": 14
      }
    }), f;
  });
}
var O4 = ["bpmn:incoming", "bpmn:outgoing"];
function A4(t, e) {
  var n = [], r = [], i = /* @__PURE__ */ new Map(), o = e ?? {}, a = o.transformer, s = o.excludeFields, l = {
    in: new Set(nr(nr([], Jt(_l.in), !1), Jt((s == null ? void 0 : s.in) || []), !1)),
    out: new Set(nr(nr([], Jt(_l.out), !1), Jt((s == null ? void 0 : s.out) || []), !1))
  };
  jn = L_(jn, a);
  var u = t["bpmn:definitions"];
  if (u) {
    var f = u["bpmn:process"];
    (function(d, h) {
      h.forEach(function(v) {
        try {
          Object.keys(d).forEach(function(p) {
            try {
              v(p);
            } catch (g) {
              console.error(g);
            }
          });
        } catch (p) {
          console.error(p);
        }
      });
    })(f, [
      function(d) {
        function h(p) {
          p["-children"] || (p["-children"] = []), Object.keys(p).forEach(function(g) {
            var y;
            g.indexOf("bpmn:") === 0 && !O4.includes(g) && (f[g] || (f[g] = []), !Array.isArray(f[g]) && (f[g] = [f[g]]), Array.isArray(p[g]) ? (y = f[g]).push.apply(y, nr([], Jt(p[g]), !1)) : f[g].push(p[g]), Array.isArray(p[g]) ? p[g].forEach(function(m) {
              !g.includes("Flow") && p["-children"].push(m["-id"]);
            }) : !g.includes("Flow") && p["-children"].push(p[g]["-id"]), delete p[g]);
          });
        }
        if (d === "bpmn:subProcess") {
          var v = f[d];
          Array.isArray(v) ? v.forEach(function(p) {
            d === "bpmn:subProcess" && h(p);
          }) : h(v);
        }
      },
      function(d) {
        var h = function(p) {
          Object.keys(p).forEach(function(g) {
            var y, m;
            if (g.includes("bpmn:")) {
              var A = {};
              jn[g] && jn[g].in ? (A = (m = (y = jn[g]).in) === null || m === void 0 ? void 0 : m.call(y, g, _.cloneDeep(p[g])), delete p[g]) : v(p[g]);
              var T = void 0;
              (T = Reflect.ownKeys(A)).length > 0 && T.forEach(function(k) {
                Reflect.set(p, k, A[k]);
              });
            }
          });
        };
        function v(p) {
          i.set(p["-id"], p), Array.isArray(p) ? p.forEach(function(g) {
            v(g);
          }) : typeof p == "object" && h(p);
        }
        v(f[d]);
      },
      function(d) {
        if (d.indexOf("bpmn:") === 0) {
          var h = f[d];
          if (d === "bpmn:sequenceFlow") {
            var v = u["bpmndi:BPMNDiagram"]["bpmndi:BPMNPlane"]["bpmndi:BPMNEdge"];
            r = T4(h, v);
          } else {
            var p = u["bpmndi:BPMNDiagram"]["bpmndi:BPMNPlane"]["bpmndi:BPMNShape"];
            if (d === "bpmn:boundaryEvent") {
              var g = f[d], y = function(m) {
                var A = m["-attachedToRef"], T = i.get(A);
                T["-boundaryEvents"] || (T["-boundaryEvents"] = []), T["-boundaryEvents"].push(m["-id"]);
              };
              Array.isArray(g) ? g.forEach(function(m) {
                y(m);
              }) : y(g);
            }
            n = n.concat(C4(h, p, d));
          }
        }
      }
    ]);
  }
  var c = function(d, h, v) {
    Object.keys(d).forEach(function(p) {
      var g = v ? "".concat(v, ".").concat(p) : p;
      h.has(g) ? delete d[p] : typeof d[p] == "object" && c(d[p], h, g);
    });
  };
  return n.forEach(function(d) {
    var h, v;
    if (!((h = e == null ? void 0 : e.mapping) === null || h === void 0) && h.in) {
      var p = (v = e == null ? void 0 : e.mapping) === null || v === void 0 ? void 0 : v.in, g = d.type;
      p[g] && (d.type = p[g]);
    }
    c(d, l.in, "");
  }), r.forEach(function(d) {
    var h, v;
    if (!((h = e == null ? void 0 : e.mapping) === null || h === void 0) && h.in) {
      var p = (v = e == null ? void 0 : e.mapping) === null || v === void 0 ? void 0 : v.in, g = d.type;
      p[g] && (d.type = p[g]);
    }
    c(d, l.in, "");
  }), {
    nodes: n,
    edges: r
  };
}
function C4(t, e, n) {
  var r = [];
  if (Array.isArray(t))
    t.forEach(function(a) {
      var s;
      Array.isArray(e) ? s = e.find(function(u) {
        return u["-bpmnElement"] === a["-id"];
      }) : s = e;
      var l = wv(s, n, a);
      r.push(l);
    });
  else {
    var i = void 0;
    Array.isArray(e) ? i = e.find(function(a) {
      return a["-bpmnElement"] === t["-id"];
    }) : i = e;
    var o = wv(i, n, t);
    r.push(o);
  }
  return r;
}
function wv(t, e, n) {
  var r = Number(t["dc:Bounds"]["-x"]), i = Number(t["dc:Bounds"]["-y"]), o = n["-children"], a = n["-name"], s = En.shapeConfigMap.get(e);
  s && (r += s.width / 2, i += s.height / 2);
  var l = {};
  Object.entries(n).forEach(function(d) {
    var h = Jt(d, 2), v = h[0], p = h[1];
    R_.includes(v) || (l[v] = p);
  }), l = bl(l);
  var u;
  if (a && (u = {
    x: r,
    y: i,
    value: a
  }, t["bpmndi:BPMNLabel"] && t["bpmndi:BPMNLabel"]["dc:Bounds"])) {
    var f = t["bpmndi:BPMNLabel"]["dc:Bounds"];
    u.x = Number(f["-x"]) + Number(f["-width"]) / 2, u.y = Number(f["-y"]) + Number(f["-height"]) / 2;
  }
  var c = {
    id: t["-bpmnElement"],
    type: e,
    x: r,
    y: i,
    properties: l
  };
  return o && (c.children = o), u && (c.text = u), c;
}
function T4(t, e) {
  var n = [];
  if (Array.isArray(t))
    t.forEach(function(i) {
      var o;
      Array.isArray(e) ? o = e.find(function(a) {
        return a["-bpmnElement"] === i["-id"];
      }) : o = e, n.push(Sv(o, i));
    });
  else {
    var r = void 0;
    Array.isArray(e) ? r = e.find(function(i) {
      return i["-bpmnElement"] === t["-id"];
    }) : r = e, n.push(Sv(r, t));
  }
  return n;
}
function Sv(t, e) {
  var n, r = e["-name"] ? "".concat(e["-name"]) : "";
  if (r) {
    var i = t["bpmndi:BPMNLabel"]["dc:Bounds"], o = 0;
    r.split(`
`).forEach(function(u) {
      o < u.length && (o = u.length);
    }), n = {
      value: r,
      x: Number(i["-x"]) + o * 10 / 2,
      y: Number(i["-y"]) + 7
    };
  }
  var a = {};
  Object.entries(e).forEach(function(u) {
    var f = Jt(u, 2), c = f[0], d = f[1];
    R_.includes(c) || (a[c] = d);
  }), a = bl(a);
  var s = t["di:waypoint"].map(function(u) {
    return {
      x: Number(u["-x"]),
      y: Number(u["-y"])
    };
  }), l = {
    id: e["-id"],
    type: ln.FLOW,
    pointsList: s,
    sourceNodeId: e["-sourceRef"],
    targetNodeId: e["-targetRef"],
    properties: a
  };
  return n && (l.text = n), l;
}
var En = (
  /** @class */
  function() {
    function t(e) {
      var n = e.lf, r = this;
      this.adapterOut = function(i, o) {
        var a, s, l = ec({}, r.processAttributes);
        w4(l, i, o);
        var u = {
          "-id": "BPMNPlane_1",
          "-bpmnElement": l["-id"]
        };
        S4(u, i);
        var f = r.definitionAttributes;
        f["bpmn:process"] = l, f["bpmndi:BPMNDiagram"] = {
          "-id": "BPMNDiagram_1",
          "bpmndi:BPMNPlane": u
        };
        var c = {
          "bpmn:definitions": f
        };
        if (!((a = o == null ? void 0 : o.mapping) === null || a === void 0) && a.out) {
          var d = (s = o == null ? void 0 : o.mapping) === null || s === void 0 ? void 0 : s.out, h = function(v) {
            Array.isArray(v) && v.forEach(function(p) {
              return h(p);
            }), typeof v == "object" && Object.keys(v).forEach(function(p) {
              var g;
              (g = d[p]) ? (v[g] = _.cloneDeep(v[p]), delete v[p], h(v[g])) : h(v[p]);
            });
          };
          h(c);
        }
        return c;
      }, this.adapterIn = function(i, o) {
        if (i)
          return A4(i, o);
      }, n.adapterIn = this.adapterIn, n.adapterOut = this.adapterOut, this.processAttributes = {
        "-isExecutable": "true",
        "-id": "Process"
      }, this.definitionAttributes = {
        "-id": "Definitions",
        "-xmlns:xsi": "http://www.w3.org/2001/XMLSchema-instance",
        "-xmlns:bpmn": "http://www.omg.org/spec/BPMN/20100524/MODEL",
        "-xmlns:bpmndi": "http://www.omg.org/spec/BPMN/20100524/DI",
        "-xmlns:dc": "http://www.omg.org/spec/DD/20100524/DC",
        "-xmlns:di": "http://www.omg.org/spec/DD/20100524/DI",
        "-targetNamespace": "http://logic-flow.org",
        "-exporter": "logicflow",
        "-exporterVersion": "1.2.10"
      };
    }
    return t.prototype.setCustomShape = function(e, n) {
      t.shapeConfigMap.set(e, n);
    }, t.pluginName = "bpmn-adapter", t.shapeConfigMap = /* @__PURE__ */ new Map(), t;
  }()
);
En.shapeConfigMap.set(ln.START, {
  width: cv.width,
  height: cv.height
});
En.shapeConfigMap.set(ln.END, {
  width: dv.width,
  height: dv.height
});
En.shapeConfigMap.set(ln.INTERMEDIATE_CATCH, {
  width: yl.width,
  height: yl.height
});
En.shapeConfigMap.set(ln.INTERMEDIATE_THROW, {
  width: yl.width,
  height: yl.height
});
En.shapeConfigMap.set(ln.BOUNDARY, {
  width: hv.width,
  height: hv.height
});
En.shapeConfigMap.set(ln.PARALLEL_GATEWAY, {
  width: pv.width,
  height: pv.height
});
En.shapeConfigMap.set(ln.INCLUSIVE_GATEWAY, {
  width: vv.width,
  height: vv.height
});
En.shapeConfigMap.set(ln.EXCLUSIVE_GATEWAY, {
  width: gv.width,
  height: gv.height
});
En.shapeConfigMap.set(ln.SYSTEM, {
  width: yv.width,
  height: yv.height
});
En.shapeConfigMap.set(ln.USER, {
  width: mv.width,
  height: mv.height
});
En.shapeConfigMap.set(ln.SUBPROCESS, {
  width: _v.width,
  height: _v.height
});
var N4 = (
  /** @class */
  function(t) {
    b4(e, t);
    function e(n) {
      var r = t.call(this, n) || this;
      r.adapterXmlIn = function(a) {
        var s = y4(a);
        return r.adapterIn(s, r.props);
      }, r.adapterXmlOut = function(a) {
        var s = r.adapterOut(a, r.props);
        return _4(s);
      };
      var i = n.lf, o = n.props;
      return i.adapterIn = r.adapterXmlIn, i.adapterOut = r.adapterXmlOut, r.props = o, r;
    }
    return e.pluginName = "BPMNAdapter", e;
  }(En)
);
function M4(t, e, n) {
  var r = e.x, i = e.y, o = t.x, a = t.y, s = o - r, l = a - i, u = s * Math.cos(n) - l * Math.sin(n), f = s * Math.sin(n) + l * Math.cos(n), c = u + r, d = f + i;
  return {
    x: c,
    y: d
  };
}
var P4 = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), xl = function() {
  return xl = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, xl.apply(this, arguments);
}, D4 = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, R4 = function(t, e, n) {
  if (n || arguments.length === 2) for (var r = 0, i = e.length, o; r < i; r++)
    (o || !(r in e)) && (o || (o = Array.prototype.slice.call(e, 0, r)), o[r] = e[r]);
  return t.concat(o || Array.prototype.slice.call(e));
};
(function(t) {
  P4(e, t);
  function e() {
    var n = t.apply(this, R4([], D4(arguments), !1)) || this;
    return n.childrenPositionMap = /* @__PURE__ */ new Map(), n.onNodeRotate = function(r) {
      var i = r.model, o = n.props, a = o.model, s = o.graphModel, l = a.transformWithContainer, u = a.isRestrict, f = n.childrenPositionMap;
      if (!(!l || u) && i.id === a.id) {
        var c = { x: a.x, y: a.y };
        at(Array.from(a.children), function(d) {
          var h = s.getNodeModelById(d);
          if (h) {
            var v = { x: h.x, y: h.y };
            f.has(h.id) ? v = f.get(h.id) : f.set(h.id, v);
            var p = i.rotate * (180 / Math.PI);
            p < 0 && (p += 360);
            var g = p * (Math.PI / 180), y = M4(v, c, g);
            h.moveTo(y.x, y.y), h.rotate = i.rotate;
          }
        });
      }
    }, n.onNodeResize = function(r) {
      var i = r.deltaX, o = r.deltaY, a = r.index, s = r.model, l = r.preData, u = n.props, f = u.model, c = u.graphModel, d = f.transformWithContainer, h = f.isRestrict;
      if (!(!d || h) && s.id === f.id) {
        var v = l.properties, p = v || {}, g = p.width, y = p.height;
        at(Array.from(f.children), function(m) {
          var A = c.getNodeModelById(m);
          if (A) {
            var T = A.width / g * i, k = A.height / y * o;
            h_({
              deltaX: T,
              deltaY: k,
              index: a,
              nodeModel: A,
              graphModel: c,
              cancelCallback: function() {
              }
            });
          }
        });
      }
    }, n.onNodeMouseMove = function() {
    }, n.graphRendered = function() {
      var r = n.props.model;
      r.isCollapsed && r.toggleCollapse(!0);
    }, n;
  }
  return e.prototype.componentDidMount = function() {
    t.prototype.componentDidMount.call(this);
    var n = this.props.graphModel.eventCenter;
    n.on("node:rotate", this.onNodeRotate), n.on("node:resize", this.onNodeResize), n.on("node:mousemove", this.onNodeMouseMove), n.on("graph:rendered", this.graphRendered);
  }, e.prototype.componentWillUnmount = function() {
    t.prototype.componentWillUnmount.call(this);
    var n = this.props.graphModel.eventCenter;
    n.off("node:rotate", this.onNodeRotate), n.off("node:resize", this.onNodeResize), n.off("node:mousemove", this.onNodeMouseMove), n.off("graph:rendered", this.graphRendered);
  }, e.prototype.getNodesInGroup = function(n, r) {
    var i = this, o = [];
    return n.isGroup && at(Array.from(n.children), function(a) {
      o.push(a);
      var s = r.getNodeModelById(a);
      s != null && s.isGroup && (o = o.concat(i.getNodesInGroup(s, r)));
    }), o;
  }, e.prototype.getResizeControl = function() {
    var n = this.props.model, r = n.resizable, i = n.isCollapsed, o = r && !i;
    return o ? t.prototype.getResizeControl.call(this) : null;
  }, e.prototype.getAppendAreaShape = function() {
    var n = this.props.model, r = n.width, i = n.height, o = n.x, a = n.y, s = n.radius, l = n.groupAddable;
    if (!l)
      return null;
    var u = n.getNodeStyle().strokeWidth, f = u === void 0 ? 0 : u, c = n.getAddableOutlineStyle(), d = r + f + 8, h = i + f + 8;
    return ae("rect", xl(xl({}, c), { width: d, height: h, x: o - d / 2, y: a - h / 2, rx: s, ry: s }));
  }, e.prototype.getCollapseIcon = function(n, r) {
    return "M ".concat(n + 3, ",").concat(r + 6, " ").concat(n + 11, ",").concat(r + 6, " M").concat(n + 7, ",").concat(r + 2, " ").concat(n + 7, ",").concat(r + 10);
  }, e.prototype.getExpandIcon = function(n, r) {
    return "M ".concat(n + 3, ",").concat(r + 6, " ").concat(n + 11, ",").concat(r + 6, " ");
  }, e.prototype.getOperateIcon = function() {
    var n = this.props.model, r = n.x, i = n.y, o = n.width, a = n.height, s = r - o / 2 + 10, l = i - a / 2 + 10;
    if (!n.collapsible)
      return null;
    var u = n != null && n.isCollapsed ? this.getCollapseIcon(s, l) : this.getExpandIcon(s, l), f = ae("path", {
      fill: "none",
      stroke: "#818281",
      strokeWidth: 2,
      "pointer-events": "none",
      d: u
    });
    return ae("g", {}, [
      ae("rect", {
        height: 12,
        width: 14,
        rx: 2,
        ry: 2,
        strokeWidth: 1,
        fill: "#f4f5f6",
        stroke: "#cecece",
        cursor: "pointer",
        x: s,
        y: l,
        onClick: function() {
          n.toggleCollapse(!n.isCollapsed);
        }
      }),
      f
    ]);
  }, e.prototype.getShape = function() {
    return ae("g", {}, [
      this.getAppendAreaShape(),
      t.prototype.getShape.call(this),
      this.getOperateIcon()
    ]);
  }, e;
})(pr);
var L4 = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), El = function() {
  return El = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, El.apply(this, arguments);
}, ku = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, eo = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, Jo = function(t, e, n) {
  if (n || arguments.length === 2) for (var r = 0, i = e.length, o; r < i; r++)
    (o || !(r in e)) && (o || (o = Array.prototype.slice.call(e, 0, r)), o[r] = e[r]);
  return t.concat(o || Array.prototype.slice.call(e));
}, I4 = 400, j4 = 230, k4 = 80, B4 = 60, F4 = -1e4;
(function(t) {
  L4(e, t);
  function e(n, r) {
    var i = t.call(this, n, r) || this;
    return i.isGroup = !0, i.isRestrict = !1, i.autoResize = !1, i.collapsible = !0, i.isCollapsed = !1, i.groupAddable = !1, i.transformWithContainer = !1, i.childrenLastCollapseStateDict = /* @__PURE__ */ new Map(), i.childrenLastCollapseStateDict = /* @__PURE__ */ new Map(), i.initNodeData(n), i.setAttributes(), i;
  }
  return e.prototype.initNodeData = function(n) {
    var r;
    t.prototype.initNodeData.call(this, n);
    var i = (r = n.properties) !== null && r !== void 0 ? r : {}, o = i.children, a = i.width, s = i.height, l = i.collapsedWidth, u = i.collapsedHeight, f = i.collapsible, c = i.isCollapsed, d = i.zIndex, h = i.isRestrict, v = i.autoResize, p = i.autoToFront, g = i.transformWithContainer;
    this.children = o ? new Set(o) : /* @__PURE__ */ new Set(), this.zIndex = d ?? F4, this.isCollapsed = c ?? !1;
    var y = a ?? I4, m = s ?? j4;
    this.width = y, this.height = m, this.expandWidth = y, this.expandHeight = m, this.collapsedWidth = l ?? k4, this.collapsedHeight = u ?? B4, this.isRestrict = h ?? !1, this.transformWithContainer = g ?? !1, this.autoResize = v ?? !1, this.collapsible = f ?? !0, this.autoToFront = p ?? !1, this.text.editable = !1, this.text.draggable = !1;
  }, e.prototype.setAttributes = function() {
    t.prototype.setAttributes.call(this);
  }, e.prototype.getData = function() {
    var n = this, r = t.prototype.getData.call(this), i = [];
    return at(Array.from(this.children), function(o) {
      var a = n.graphModel.getNodeModelById(o);
      a && !a.virtual && i.push(o);
    }), r.children = i, r.properties && (r.properties.children = i, r.properties.isCollapsed = this.isCollapsed), r;
  }, e.prototype.getNodesInGroup = function(n) {
    var r = [];
    return n.isGroup && at(Array.from(n.children), function(i) {
      r.push(i);
    }), r;
  }, e.prototype.getMoveDistance = function(n, r, i) {
    i === void 0 && (i = !1);
    var o = eo(t.prototype.getMoveDistance.call(this, n, r, i), 2), a = o[0], s = o[1], l = this.getNodesInGroup(this);
    return this.graphModel.moveNodes(l, n, r, i), [a, s];
  }, e.prototype.getHistoryData = function() {
    var n = t.prototype.getHistoryData.call(this);
    n.children = Array.from(this.children), n.isGroup = !0;
    var r = this, i = r.x, o = r.y, a = r.collapsedWidth, s = r.collapsedHeight, l = r.expandWidth, u = r.expandHeight, f = r.isCollapsed;
    return f && (n.x = i + l / 2 - a / 2, n.y = o + u / 2 - s / 2, n.text && (n.text.x = n.text.x + l / 2 - a / 2, n.text.y = n.text.y + u / 2 - s / 2)), n;
  }, e.prototype.toggleCollapse = function(n) {
    var r = this, i = !!n;
    this.isCollapsed = i, i ? this.collapse() : this.expand();
    var o = Jo(Jo([], eo(this.incoming.edges), !1), eo(this.outgoing.edges), !1), a = Array.from(this.children);
    at(a, function(s) {
      var l, u, f = r.graphModel.elementsModelMap.get(s);
      if (f) {
        var c = f.isCollapsed;
        if (f.isGroup) {
          var d = f;
          if (d.isCollapsed || d.toggleCollapse(n), !n) {
            var h = (l = r.childrenLastCollapseStateDict) === null || l === void 0 ? void 0 : l.get(s);
            h !== void 0 && h !== f.isCollapsed && d.toggleCollapse(h);
          }
        }
        if ((u = r.childrenLastCollapseStateDict) === null || u === void 0 || u.set(s, !!c), f.visible = !n, f.BaseType === At.NODE) {
          var v = f.incoming.edges, p = f.outgoing.edges;
          o = Jo(Jo(Jo([], eo(o), !1), eo(v), !1), eo(p), !1);
        }
      }
    }), this.collapseEdge(i, o);
  }, e.prototype.collapse = function() {
    var n = this, r = n.x, i = n.y, o = n.text, a = n.width, s = n.height, l = n.collapsedWidth, u = n.collapsedHeight;
    this.x = r - a / 2 + l / 2, this.y = i - s / 2 + u / 2, this.text.x = o.x - a / 2 + l / 2, this.text.y = o.y - s / 2 + u / 2, this.expandWidth = a, this.expandHeight = s, this.width = l, this.height = u;
  }, e.prototype.expand = function() {
    var n = this, r = n.x, i = n.y, o = n.text, a = n.expandWidth, s = n.expandHeight, l = n.collapsedWidth, u = n.collapsedHeight;
    this.width = a, this.height = s, this.x = r + this.width / 2 - l / 2, this.y = i + this.height / 2 - u / 2, this.text.x = o.x + this.width / 2 - l / 2, this.text.y = o.y + this.height / 2 - u / 2;
  }, e.prototype.createVirtualEdge = function(n) {
    n.pointsList = void 0;
    var r = this.graphModel.addEdge(n);
    r.virtual = !0, r.text.editable = !1, r.isCollapsedEdge = !0;
  }, e.prototype.collapseEdge = function(n, r) {
    var i = this, o = this.graphModel;
    at(r, function(a, s) {
      var l, u = a.getData(), f = u.targetNodeId, c = u.sourceNodeId, d = El(El({}, u), { id: "".concat(u.id, "__").concat(s), text: (l = u.text) === null || l === void 0 ? void 0 : l.value });
      a.virtual && o.deleteEdgeById(a.id);
      var h = o.dynamicGroup.getGroupByNodeId(f);
      h || (h = o.getNodeModelById(f));
      var v = o.dynamicGroup.getGroupByNodeId(c);
      v || (v = o.getNodeModelById(c)), n && a.visible && (i.children.has(c) || i.id === c ? (d.startPoint = void 0, d.sourceNodeId = i.id) : (d.endPoint = void 0, d.targetNodeId = i.id), (h.id !== i.id || v.id !== i.id) && i.createVirtualEdge(d), a.visible = !1), !n && !a.visible && (h && h.isGroup && h.isCollapsed ? (d.targetNodeId = h.id, d.endPoint = void 0, i.createVirtualEdge(d)) : v && v.isGroup && v.isCollapsed ? (d.sourceNodeId = v.id, d.startPoint = void 0, i.createVirtualEdge(d)) : a.visible = !0);
    });
  }, e.prototype.isAllowAppendIn = function(n) {
    return !0;
  }, e.prototype.setAllowAppendChild = function(n) {
    this.groupAddable = n;
  }, e.prototype.addChild = function(n) {
    this.children.add(n);
    var r = this.getData();
    this.graphModel.eventCenter.emit("group:add-node", { data: r });
  }, e.prototype.removeChild = function(n) {
    this.children.delete(n);
    var r = this.getData();
    this.graphModel.eventCenter.emit("group:remove-node", { data: r });
  }, e.prototype.toBack = function() {
    this.zIndex--;
  }, e.prototype.getResizeOutlineStyle = function() {
    var n = t.prototype.getResizeOutlineStyle.call(this);
    return n.stroke = "none", n;
  }, e.prototype.getAnchorStyle = function() {
    var n = t.prototype.getAnchorStyle.call(this);
    return n.stroke = "transparent", n.fill = "transparent", n.hover && (n.hover.fill = "transparent", n.hover.stroke = "transparent"), n;
  }, e.prototype.getAddableOutlineStyle = function() {
    return {
      stroke: "#feb663",
      strokeWidth: 2,
      strokeDasharray: "4 4",
      fill: "transparent"
    };
  }, ku([
    H
  ], e.prototype, "isCollapsed", void 0), ku([
    H
  ], e.prototype, "groupAddable", void 0), ku([
    H
  ], e.prototype, "transformWithContainer", void 0), e;
})(Or);
var Ov;
(function(t) {
  t.HORIZONTAL = "horizontal", t.VERTICAL = "vertical";
})(Ov || (Ov = {}));
var $4 = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), xa = function() {
  return xa = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, xa.apply(this, arguments);
}, H4 = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, W4 = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, z4 = (
  /** @class */
  function(t) {
    $4(e, t);
    function e(n) {
      var r = t.call(this, n) || this;
      r.textRef = Tl(), r.setHoverOn = function() {
        var l = r.props.element;
        l.isDragging || r.state.isHovered || (r.setState({ isHovered: !0 }), l.setHovered(!0));
      }, r.setHoverOff = function() {
        var l = r.props.element;
        r.state.isHovered && (r.setState({ isHovered: !1 }), l.setHovered(!1));
      }, r.handleMouseDown = function(l) {
        var u, f = r.props, c = f.label, d = f.graphModel, h = d.editConfigModel.nodeTextDraggable;
        ((u = c.draggable) !== null && u !== void 0 ? u : h) && !r.state.isDragging && !r.state.isEditing && r.stepDrag.handleMouseDown(l);
      }, r.handleMouseUp = function(l) {
        r.state.isDragging && r.stepDrag.handleMouseUp(l);
      }, r.handleDragging = function(l) {
        var u = l.deltaX, f = l.deltaY;
        r.state.isDragging || r.setState({ isDragging: !0 });
        var c = r.props, d = c.label, h = c.graphModel, v = h.transformModel, p = W4(v.fixDeltaXY(u, f), 2), g = p[0], y = p[1];
        r.setElementModelLabelInfo({
          x: d.x + g,
          y: d.y + y
        }), h.eventCenter.emit("label:drag", {
          data: d.getData(),
          model: d
        });
      }, r.handleDragEnd = function() {
        r.setState({ isDragging: !1 });
      }, r.handleClick = function(l) {
        var u = r.props, f = u.label, c = u.element, d = u.graphModel;
        c.setSelected(!r.state.isSelected), r.setState({ isSelected: !r.state.isSelected }), r.setElementModelLabelInfo({
          isSelected: !0
        }), d.eventCenter.emit("label:click", {
          data: f.getData(),
          e: l,
          model: c
        });
      }, r.handleDbClick = function(l) {
        var u = r.props, f = u.label, c = u.element, d = u.graphModel;
        if (d.eventCenter.emit("label:dblclick", {
          data: f.getData(),
          e: l,
          model: c
        }), !f.editable) {
          c.setSelected(!0);
          return;
        }
        if (c.setSelected(), c.setElementState(Qe.TEXT_EDIT), r.setState({ isEditing: !0 }), r.textRef.current) {
          r.textRef.current.contentEditable = "true", r.textRef.current.focus();
          var h = document.createRange(), v = window.getSelection();
          h.selectNodeContents(r.textRef.current), h.collapse(!1), v == null || v.removeAllRanges(), v == null || v.addRange(h);
        }
      }, r.handleBlur = function(l) {
        var u = r.props, f = u.label, c = u.element, d = u.graphModel.eventCenter;
        d.emit("label:blur", {
          e: l,
          model: c,
          data: f.getData(),
          element: r.textRef.current
        }), r.setState({
          isDragging: !1,
          isHovered: !1,
          isSelected: !1
        });
      }, r.handleInput = function(l) {
        var u = r.props, f = u.label, c = u.graphModel;
        c.eventCenter.emit("label:input", {
          e: l,
          data: f.getData()
        });
      }, r.reCalcLabelSize = function() {
      };
      var i = n.label, o = n.graphModel, a = o.gridSize, s = o.eventCenter;
      return r.stepDrag = new Kn({
        onDragging: r.handleDragging,
        onDragEnd: r.handleDragEnd,
        step: a,
        eventType: "LABEL",
        model: i,
        eventCenter: s
      }), r.state = {
        isEditing: !1,
        isHovered: !1,
        isDragging: !1,
        isSelected: !1
      }, r;
    }
    return e.prototype.setElementModelLabelInfo = function(n) {
      var r = this.props, i = r.label, o = r.element, a = r.graphModel, s = o.properties._label, l = s, u = Vc(l, function(d) {
        return d.id === i.id;
      }), f = l[u];
      l[u] = xa(xa({}, f), n);
      var c = a.getElement(o.id);
      c == null || c.setProperty("_label", l);
    }, e.prototype.componentDidMount = function() {
      var n = this, r = this.props, i = r.label, o = r.element, a = r.graphModel;
      a.eventCenter.on("blank:click,node:click,edge:click,label:click", function(s) {
        var l, u, f, c, d = s.data;
        if (((d == null ? void 0 : d.type) !== "label" || d.type === "label" && d.id !== i.id || n.state.isSelected) && n.setState({ isSelected: !1 }), ((d == null ? void 0 : d.type) !== "label" || d.type == "label" && d.id !== i.id) && n.state.isEditing) {
          n.setState({ isEditing: !1 });
          var h = (u = (l = n.textRef.current) === null || l === void 0 ? void 0 : l.innerText) !== null && u !== void 0 ? u : "", v = (c = (f = n.textRef.current) === null || f === void 0 ? void 0 : f.innerHTML) !== null && c !== void 0 ? c : "";
          n.setElementModelLabelInfo({
            value: h,
            content: v,
            isSelected: !1
          }), o.setElementState(Qe.DEFAULT);
        }
        ((d == null ? void 0 : d.type) !== "label" || d.type == "label" && d.id !== i.id) && n.textRef.current && (n.textRef.current.contentEditable = "false");
      });
    }, e.prototype.componentDidUpdate = function() {
    }, e.prototype.componentWillUnmount = function() {
      var n = this.props.graphModel;
      n.eventCenter.off("blank:click,node:click,edge:click");
    }, e.prototype.render = function() {
      var n, r = this.props, i = r.label, o = r.element, a = r.graphModel, s = this.state, l = s.isDragging, u = s.isHovered, f = s.isSelected, c = s.isEditing, d = a.transformModel, h = d.getTransformStyle().transform, v = i.id, p = i.x, g = i.y, y = i.zIndex, m = i.vertical, A = i.style, T = i.rotate, k = i.content, C = i.labelWidth, S = i.textOverflowMode, I = C ?? (o.BaseType === "node" ? o.width - 20 : 80), X = {
        left: "".concat(p - I / 2, "px"),
        top: "".concat(g - 10, "px"),
        width: "".concat(I, "px"),
        height: "20px",
        zIndex: y ?? 1,
        transform: T ? "".concat(h, " rotate(").concat(T, "deg)") : "".concat(h, " rotate(").concat(m ? -0.25 : 0, "turn)")
      };
      return B("div", { id: "element-container-".concat(v), className: jf("lf-label-editor-container"), style: X, onMouseDown: this.handleMouseDown, onMouseUp: this.handleMouseUp, onClick: this.handleClick, onDblClick: this.handleDbClick, onBlur: this.handleBlur, onMouseEnter: this.setHoverOn, onMouseOver: this.setHoverOn, onMouseLeave: this.setHoverOff, children: B("div", { ref: this.textRef, id: "editor-container-".concat(v), className: jf("lf-label-editor", (n = {
        "lf-label-editor-dragging": l,
        "lf-label-editor-editing": c,
        "lf-label-editor-hover": !c && (u || f)
      }, n["lf-label-editor-".concat(S)] = !c, n)), onInput: this.handleInput, style: xa({ maxWidth: "".concat(I, "px"), boxSizing: "border-box", display: "inline-block", background: c || o.BaseType === "edge" ? "#fff" : "transparent" }, A), dangerouslySetInnerHTML: { __html: k } }) });
    }, e = H4([
      sn
    ], e), e;
  }(Ye)
), In = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, X4 = ti, G4 = (
  /** @class */
  function() {
    function t(e, n, r) {
      var i;
      this.type = "label", this.content = "", this.value = "", this.style = {}, this.vertical = !1, this.editable = !0, this.draggable = !0, this.textOverflowMode = "default", this.element = n, this.graphModel = r, this.id = (i = e.id) !== null && i !== void 0 ? i : X4(), this.initLabelData(e);
    }
    return t.prototype.initLabelData = function(e) {
      ut(this, e);
    }, t.prototype.getData = function() {
      return {
        id: this.id,
        x: this.x,
        y: this.y,
        type: "label",
        content: this.content,
        value: this.value,
        rotate: this.rotate,
        style: tr(this.style),
        draggable: this.draggable,
        editable: this.editable,
        labelWidth: this.labelWidth,
        textOverflowMode: this.textOverflowMode,
        vertical: this.vertical
      };
    }, In([
      H
    ], t.prototype, "x", void 0), In([
      H
    ], t.prototype, "y", void 0), In([
      H
    ], t.prototype, "content", void 0), In([
      H
    ], t.prototype, "value", void 0), In([
      H
    ], t.prototype, "rotate", void 0), In([
      H
    ], t.prototype, "style", void 0), In([
      H
    ], t.prototype, "zIndex", void 0), In([
      H
    ], t.prototype, "vertical", void 0), In([
      H
    ], t.prototype, "editable", void 0), In([
      H
    ], t.prototype, "draggable", void 0), In([
      H
    ], t.prototype, "labelWidth", void 0), In([
      H
    ], t.prototype, "textOverflowMode", void 0), t;
  }()
), Ps = { exports: {} }, Bu = Ps.exports, Av;
function U4() {
  return Av || (Av = 1, function(t) {
    /*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js */
    "classList" in document.createElement("_") || function(e) {
      if ("Element" in e) {
        var n = "classList", r = "prototype", i = e.Element[r], o = Object, a = String[r].trim || function() {
          return this.replace(/^\s+|\s+$/g, "");
        }, s = Array[r].indexOf || function(v) {
          for (var p = 0, g = this.length; p < g; p++)
            if (p in this && this[p] === v)
              return p;
          return -1;
        }, l = function(v, p) {
          this.name = v, this.code = DOMException[v], this.message = p;
        }, u = function(v, p) {
          if (p === "")
            throw new l(
              "SYNTAX_ERR",
              "An invalid or illegal string was specified"
            );
          if (/\s/.test(p))
            throw new l(
              "INVALID_CHARACTER_ERR",
              "String contains an invalid character"
            );
          return s.call(v, p);
        }, f = function(v) {
          for (var p = a.call(v.getAttribute("class") || ""), g = p ? p.split(/\s+/) : [], y = 0, m = g.length; y < m; y++)
            this.push(g[y]);
          this._updateClassName = function() {
            v.setAttribute("class", this.toString());
          };
        }, c = f[r] = [], d = function() {
          return new f(this);
        };
        if (l[r] = Error[r], c.item = function(v) {
          return this[v] || null;
        }, c.contains = function(v) {
          return v += "", u(this, v) !== -1;
        }, c.add = function() {
          var v = arguments, p = 0, g = v.length, y, m = !1;
          do
            y = v[p] + "", u(this, y) === -1 && (this.push(y), m = !0);
          while (++p < g);
          m && this._updateClassName();
        }, c.remove = function() {
          var v = arguments, p = 0, g = v.length, y, m = !1, A;
          do
            for (y = v[p] + "", A = u(this, y); A !== -1; )
              this.splice(A, 1), m = !0, A = u(this, y);
          while (++p < g);
          m && this._updateClassName();
        }, c.toggle = function(v, p) {
          v += "";
          var g = this.contains(v), y = g ? p !== !0 && "remove" : p !== !1 && "add";
          return y && this[y](v), p === !0 || p === !1 ? p : !g;
        }, c.toString = function() {
          return this.join(" ");
        }, o.defineProperty) {
          var h = {
            get: d,
            enumerable: !0,
            configurable: !0
          };
          try {
            o.defineProperty(i, n, h);
          } catch (v) {
            v.number === -2146823252 && (h.enumerable = !1, o.defineProperty(i, n, h));
          }
        } else o[r].__defineGetter__ && i.__defineGetter__(n, d);
      }
    }(self);
    /*! @source http://purl.eligrey.com/github/Blob.js/blob/master/Blob.js */
    (function(e) {
      if (e.URL = e.URL || e.webkitURL, e.Blob && e.URL)
        try {
          new Blob();
          return;
        } catch {
        }
      var n = e.BlobBuilder || e.WebKitBlobBuilder || e.MozBlobBuilder || function(i) {
        var o = function(S) {
          return Object.prototype.toString.call(S).match(/^\[object\s(.*)\]$/)[1];
        }, a = function() {
          this.data = [];
        }, s = function(I, X, Q) {
          this.data = I, this.size = I.length, this.type = X, this.encoding = Q;
        }, l = a.prototype, u = s.prototype, f = i.FileReaderSync, c = function(S) {
          this.code = this[this.name = S];
        }, d = "NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "), h = d.length, v = i.URL || i.webkitURL || i, p = v.createObjectURL, g = v.revokeObjectURL, y = v, m = i.btoa, A = i.atob, T = i.ArrayBuffer, k = i.Uint8Array, C = /^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;
        for (s.fake = u.fake = !0; h--; )
          c.prototype[d[h]] = h + 1;
        return v.createObjectURL || (y = i.URL = function(S) {
          var I = document.createElementNS("http://www.w3.org/1999/xhtml", "a"), X;
          return I.href = S, "origin" in I || (I.protocol.toLowerCase() === "data:" ? I.origin = null : (X = S.match(C), I.origin = X && X[1])), I;
        }), y.createObjectURL = function(S) {
          var I = S.type, X;
          if (I === null && (I = "application/octet-stream"), S instanceof s)
            return X = "data:" + I, S.encoding === "base64" ? X + ";base64," + S.data : S.encoding === "URI" ? X + "," + decodeURIComponent(S.data) : m ? X + ";base64," + m(S.data) : X + "," + encodeURIComponent(S.data);
          if (p)
            return p.call(v, S);
        }, y.revokeObjectURL = function(S) {
          S.substring(0, 5) !== "data:" && g && g.call(v, S);
        }, l.append = function(S) {
          var I = this.data;
          if (k && (S instanceof T || S instanceof k)) {
            for (var X = "", Q = new k(S), ue = 0, de = Q.length; ue < de; ue++)
              X += String.fromCharCode(Q[ue]);
            I.push(X);
          } else if (o(S) === "Blob" || o(S) === "File")
            if (f) {
              var w = new f();
              I.push(w.readAsBinaryString(S));
            } else
              throw new c("NOT_READABLE_ERR");
          else S instanceof s ? S.encoding === "base64" && A ? I.push(A(S.data)) : S.encoding === "URI" ? I.push(decodeURIComponent(S.data)) : S.encoding === "raw" && I.push(S.data) : (typeof S != "string" && (S += ""), I.push(unescape(encodeURIComponent(S))));
        }, l.getBlob = function(S) {
          return arguments.length || (S = null), new s(this.data.join(""), S, "raw");
        }, l.toString = function() {
          return "[object BlobBuilder]";
        }, u.slice = function(S, I, X) {
          var Q = arguments.length;
          return Q < 3 && (X = null), new s(
            this.data.slice(S, Q > 1 ? I : this.data.length),
            X,
            this.encoding
          );
        }, u.toString = function() {
          return "[object Blob]";
        }, u.close = function() {
          this.size = 0, delete this.data;
        }, a;
      }(e);
      e.Blob = function(i, o) {
        var a = o && o.type || "", s = new n();
        if (i)
          for (var l = 0, u = i.length; l < u; l++)
            Uint8Array && i[l] instanceof Uint8Array ? s.append(i[l].buffer) : s.append(i[l]);
        var f = s.getBlob(a);
        return !f.slice && f.webkitSlice && (f.slice = f.webkitSlice), f;
      };
      var r = Object.getPrototypeOf || function(i) {
        return i.__proto__;
      };
      e.Blob.prototype = r(new e.Blob());
    })(typeof self < "u" && self || typeof window < "u" && window || Bu.content || Bu), function(e, n) {
      var r = typeof process < "u" && process && process.versions && process.versions.electron;
      r ? e.MediumEditor = n : t.exports = n;
    }(Bu, function() {
      function e(n, r) {
        return this.init(n, r);
      }
      return e.extensions = {}, function(n) {
        function r(l, u) {
          var f, c = Array.prototype.slice.call(arguments, 2);
          u = u || {};
          for (var d = 0; d < c.length; d++) {
            var h = c[d];
            if (h)
              for (f in h)
                h.hasOwnProperty(f) && typeof h[f] < "u" && (l || u.hasOwnProperty(f) === !1) && (u[f] = h[f]);
          }
          return u;
        }
        var i = !1;
        try {
          var o = document.createElement("div"), a = document.createTextNode(" ");
          o.appendChild(a), i = o.contains(a);
        } catch {
        }
        var s = {
          // http://stackoverflow.com/questions/17907445/how-to-detect-ie11#comment30165888_17907562
          // by rg89
          isIE: navigator.appName === "Microsoft Internet Explorer" || navigator.appName === "Netscape" && new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent) !== null,
          isEdge: /Edge\/\d+/.exec(navigator.userAgent) !== null,
          // if firefox
          isFF: navigator.userAgent.toLowerCase().indexOf("firefox") > -1,
          // http://stackoverflow.com/a/11752084/569101
          isMac: n.navigator.platform.toUpperCase().indexOf("MAC") >= 0,
          // https://github.com/jashkenas/underscore
          // Lonely letter MUST USE the uppercase code
          keyCode: {
            BACKSPACE: 8,
            TAB: 9,
            ENTER: 13,
            ESCAPE: 27,
            SPACE: 32,
            DELETE: 46,
            K: 75,
            // K keycode, and not k
            M: 77,
            V: 86
          },
          /**
           * Returns true if it's metaKey on Mac, or ctrlKey on non-Mac.
           * See #591
           */
          isMetaCtrlKey: function(l) {
            return !!(s.isMac && l.metaKey || !s.isMac && l.ctrlKey);
          },
          /**
           * Returns true if the key associated to the event is inside keys array
           *
           * @see : https://github.com/jquery/jquery/blob/0705be475092aede1eddae01319ec931fb9c65fc/src/event.js#L473-L484
           * @see : http://stackoverflow.com/q/4471582/569101
           */
          isKey: function(l, u) {
            var f = s.getKeyCode(l);
            return Array.isArray(u) === !1 ? f === u : u.indexOf(f) !== -1;
          },
          getKeyCode: function(l) {
            var u = l.which;
            return u === null && (u = l.charCode !== null ? l.charCode : l.keyCode), u;
          },
          blockContainerElementNames: [
            // elements our editor generates
            "p",
            "h1",
            "h2",
            "h3",
            "h4",
            "h5",
            "h6",
            "blockquote",
            "pre",
            "ul",
            "li",
            "ol",
            // all other known block elements
            "address",
            "article",
            "aside",
            "audio",
            "canvas",
            "dd",
            "dl",
            "dt",
            "fieldset",
            "figcaption",
            "figure",
            "footer",
            "form",
            "header",
            "hgroup",
            "main",
            "nav",
            "noscript",
            "output",
            "section",
            "video",
            "table",
            "thead",
            "tbody",
            "tfoot",
            "tr",
            "th",
            "td"
          ],
          emptyElementNames: ["br", "col", "colgroup", "hr", "img", "input", "source", "wbr"],
          extend: function() {
            var u = [!0].concat(Array.prototype.slice.call(arguments));
            return r.apply(this, u);
          },
          defaults: function() {
            var u = [!1].concat(Array.prototype.slice.call(arguments));
            return r.apply(this, u);
          },
          /*
           * Create a link around the provided text nodes which must be adjacent to each other and all be
           * descendants of the same closest block container. If the preconditions are not met, unexpected
           * behavior will result.
           */
          createLink: function(l, u, f, c) {
            var d = l.createElement("a");
            return s.moveTextRangeIntoElement(u[0], u[u.length - 1], d), d.setAttribute("href", f), c && (c === "_blank" && d.setAttribute("rel", "noopener noreferrer"), d.setAttribute("target", c)), d;
          },
          /*
           * Given the provided match in the format {start: 1, end: 2} where start and end are indices into the
           * textContent of the provided element argument, modify the DOM inside element to ensure that the text
           * identified by the provided match can be returned as text nodes that contain exactly that text, without
           * any additional text at the beginning or end of the returned array of adjacent text nodes.
           *
           * The only DOM manipulation performed by this function is splitting the text nodes, non-text nodes are
           * not affected in any way.
           */
          findOrCreateMatchingTextNodes: function(l, u, f) {
            for (var c = l.createTreeWalker(u, NodeFilter.SHOW_ALL, null, !1), d = [], h = 0, v = !1, p = null, g = null; (p = c.nextNode()) !== null; )
              if (!(p.nodeType > 3))
                if (p.nodeType === 3) {
                  if (!v && f.start < h + p.nodeValue.length && (v = !0, g = s.splitStartNodeIfNeeded(p, f.start, h)), v && s.splitEndNodeIfNeeded(p, g, f.end, h), v && h === f.end)
                    break;
                  if (v && h > f.end + 1)
                    throw new Error("PerformLinking overshot the target!");
                  v && d.push(g || p), h += p.nodeValue.length, g !== null && (h += g.nodeValue.length, c.nextNode()), g = null;
                } else p.tagName.toLowerCase() === "img" && (!v && f.start <= h && (v = !0), v && d.push(p));
            return d;
          },
          /*
           * Given the provided text node and text coordinates, split the text node if needed to make it align
           * precisely with the coordinates.
           *
           * This function is intended to be called from Util.findOrCreateMatchingTextNodes.
           */
          splitStartNodeIfNeeded: function(l, u, f) {
            return u !== f ? l.splitText(u - f) : null;
          },
          /*
           * Given the provided text node and text coordinates, split the text node if needed to make it align
           * precisely with the coordinates. The newNode argument should from the result of Util.splitStartNodeIfNeeded,
           * if that function has been called on the same currentNode.
           *
           * This function is intended to be called from Util.findOrCreateMatchingTextNodes.
           */
          splitEndNodeIfNeeded: function(l, u, f, c) {
            var d, h;
            d = c + l.nodeValue.length + (u ? u.nodeValue.length : 0) - 1, h = f - c - (u ? l.nodeValue.length : 0), d >= f && c !== d && h !== 0 && (u || l).splitText(h);
          },
          /*
          * Take an element, and break up all of its text content into unique pieces such that:
           * 1) All text content of the elements are in separate blocks. No piece of text content should span
           *    across multiple blocks. This means no element return by this function should have
           *    any blocks as children.
           * 2) The union of the textcontent of all of the elements returned here covers all
           *    of the text within the element.
           *
           *
           * EXAMPLE:
           * In the event that we have something like:
           *
           * <blockquote>
           *   <p>Some Text</p>
           *   <ol>
           *     <li>List Item 1</li>
           *     <li>List Item 2</li>
           *   </ol>
           * </blockquote>
           *
           * This function would return these elements as an array:
           *   [ <p>Some Text</p>, <li>List Item 1</li>, <li>List Item 2</li> ]
           *
           * Since the <blockquote> and <ol> elements contain blocks within them they are not returned.
           * Since the <p> and <li>'s don't contain block elements and cover all the text content of the
           * <blockquote> container, they are the elements returned.
           */
          splitByBlockElements: function(l) {
            if (l.nodeType !== 3 && l.nodeType !== 1)
              return [];
            var u = [], f = e.util.blockContainerElementNames.join(",");
            if (l.nodeType === 3 || l.querySelectorAll(f).length === 0)
              return [l];
            for (var c = 0; c < l.childNodes.length; c++) {
              var d = l.childNodes[c];
              if (d.nodeType === 3)
                u.push(d);
              else if (d.nodeType === 1) {
                var h = d.querySelectorAll(f);
                h.length === 0 ? u.push(d) : u = u.concat(e.util.splitByBlockElements(d));
              }
            }
            return u;
          },
          // Find the next node in the DOM tree that represents any text that is being
          // displayed directly next to the targetNode (passed as an argument)
          // Text that appears directly next to the current node can be:
          //  - A sibling text node
          //  - A descendant of a sibling element
          //  - A sibling text node of an ancestor
          //  - A descendant of a sibling element of an ancestor
          findAdjacentTextNodeWithContent: function(u, f, c) {
            var d = !1, h, v = c.createNodeIterator(u, NodeFilter.SHOW_TEXT, null, !1);
            for (h = v.nextNode(); h; ) {
              if (h === f)
                d = !0;
              else if (d && h.nodeType === 3 && h.nodeValue && h.nodeValue.trim().length > 0)
                break;
              h = v.nextNode();
            }
            return h;
          },
          // Find an element's previous sibling within a medium-editor element
          // If one doesn't exist, find the closest ancestor's previous sibling
          findPreviousSibling: function(l) {
            if (!l || s.isMediumEditorElement(l))
              return !1;
            for (var u = l.previousSibling; !u && !s.isMediumEditorElement(l.parentNode); )
              l = l.parentNode, u = l.previousSibling;
            return u;
          },
          isDescendant: function(u, f, c) {
            if (!u || !f)
              return !1;
            if (u === f)
              return !!c;
            if (u.nodeType !== 1)
              return !1;
            if (i || f.nodeType !== 3)
              return u.contains(f);
            for (var d = f.parentNode; d !== null; ) {
              if (d === u)
                return !0;
              d = d.parentNode;
            }
            return !1;
          },
          // https://github.com/jashkenas/underscore
          isElement: function(u) {
            return !!(u && u.nodeType === 1);
          },
          // https://github.com/jashkenas/underscore
          throttle: function(l, u) {
            var f = 50, c, d, h, v = null, p = 0, g = function() {
              p = Date.now(), v = null, h = l.apply(c, d), v || (c = d = null);
            };
            return !u && u !== 0 && (u = f), function() {
              var y = Date.now(), m = u - (y - p);
              return c = this, d = arguments, m <= 0 || m > u ? (v && (clearTimeout(v), v = null), p = y, h = l.apply(c, d), v || (c = d = null)) : v || (v = setTimeout(g, m)), h;
            };
          },
          traverseUp: function(l, u) {
            if (!l)
              return !1;
            do {
              if (l.nodeType === 1) {
                if (u(l))
                  return l;
                if (s.isMediumEditorElement(l))
                  return !1;
              }
              l = l.parentNode;
            } while (l);
            return !1;
          },
          htmlEntities: function(l) {
            return String(l).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;");
          },
          // http://stackoverflow.com/questions/6690752/insert-html-at-caret-in-a-contenteditable-div
          insertHTMLCommand: function(l, u) {
            var f, c, d, h, v, p, g, y = !1, m = ["insertHTML", !1, u];
            if (!e.util.isEdge && l.queryCommandSupported("insertHTML"))
              try {
                return l.execCommand.apply(l, m);
              } catch {
              }
            if (f = l.getSelection(), f.rangeCount) {
              if (c = f.getRangeAt(0), g = c.commonAncestorContainer, s.isMediumEditorElement(g) && !g.firstChild)
                c.selectNode(g.appendChild(l.createTextNode("")));
              else if (g.nodeType === 3 && c.startOffset === 0 && c.endOffset === g.nodeValue.length || g.nodeType !== 3 && g.innerHTML === c.toString()) {
                for (; !s.isMediumEditorElement(g) && g.parentNode && g.parentNode.childNodes.length === 1 && !s.isMediumEditorElement(g.parentNode); )
                  g = g.parentNode;
                c.selectNode(g);
              }
              for (c.deleteContents(), d = l.createElement("div"), d.innerHTML = u, h = l.createDocumentFragment(); d.firstChild; )
                v = d.firstChild, p = h.appendChild(v);
              c.insertNode(h), p && (c = c.cloneRange(), c.setStartAfter(p), c.collapse(!0), e.selection.selectRange(l, c)), y = !0;
            }
            return l.execCommand.callListeners && l.execCommand.callListeners(m, y), y;
          },
          execFormatBlock: function(l, u) {
            var f = s.getTopBlockContainer(e.selection.getSelectionStart(l)), c;
            if (u === "blockquote") {
              if (f && (c = Array.prototype.slice.call(f.childNodes), c.some(function(d) {
                return s.isBlockContainer(d);
              })))
                return l.execCommand("outdent", !1, null);
              if (s.isIE)
                return l.execCommand("indent", !1, u);
            }
            if (f && u === f.nodeName.toLowerCase() && (u = "p"), s.isIE && (u = "<" + u + ">"), f && f.nodeName.toLowerCase() === "blockquote") {
              if (s.isIE && u === "<p>")
                return l.execCommand("outdent", !1, u);
              if ((s.isFF || s.isEdge) && u === "p")
                return c = Array.prototype.slice.call(f.childNodes), c.some(function(d) {
                  return !s.isBlockContainer(d);
                }) && l.execCommand("formatBlock", !1, u), l.execCommand("outdent", !1, u);
            }
            return l.execCommand("formatBlock", !1, u);
          },
          /**
           * Set target to blank on the given el element
           *
           * TODO: not sure if this should be here
           *
           * When creating a link (using core -> createLink) the selection returned by Firefox will be the parent of the created link
           * instead of the created link itself (as it is for Chrome for example), so we retrieve all "a" children to grab the good one by
           * using `anchorUrl` to ensure that we are adding target="_blank" on the good one.
           * This isn't a bulletproof solution anyway ..
           */
          setTargetBlank: function(l, u) {
            var f, c = u || !1;
            if (l.nodeName.toLowerCase() === "a")
              l.target = "_blank", l.rel = "noopener noreferrer";
            else
              for (l = l.getElementsByTagName("a"), f = 0; f < l.length; f += 1)
                (c === !1 || c === l[f].attributes.href.value) && (l[f].target = "_blank", l[f].rel = "noopener noreferrer");
          },
          /*
           * this function is called to explicitly remove the target='_blank' as FF holds on to _blank value even
           * after unchecking the checkbox on anchor form
           */
          removeTargetBlank: function(l, u) {
            var f;
            if (l.nodeName.toLowerCase() === "a")
              l.removeAttribute("target"), l.removeAttribute("rel");
            else
              for (l = l.getElementsByTagName("a"), f = 0; f < l.length; f += 1)
                u === l[f].attributes.href.value && (l[f].removeAttribute("target"), l[f].removeAttribute("rel"));
          },
          /*
           * this function adds one or several classes on an a element.
           * if el parameter is not an a, it will look for a children of el.
           * if no a children are found, it will look for the a parent.
           */
          addClassToAnchors: function(l, u) {
            var f = u.split(" "), c, d;
            if (l.nodeName.toLowerCase() === "a")
              for (d = 0; d < f.length; d += 1)
                l.classList.add(f[d]);
            else {
              var h = l.getElementsByTagName("a");
              if (h.length === 0) {
                var v = s.getClosestTag(l, "a");
                l = v ? [v] : [];
              } else
                l = h;
              for (c = 0; c < l.length; c += 1)
                for (d = 0; d < f.length; d += 1)
                  l[c].classList.add(f[d]);
            }
          },
          isListItem: function(l) {
            if (!l)
              return !1;
            if (l.nodeName.toLowerCase() === "li")
              return !0;
            for (var u = l.parentNode, f = u.nodeName.toLowerCase(); f === "li" || !s.isBlockContainer(u) && f !== "div"; ) {
              if (f === "li")
                return !0;
              if (u = u.parentNode, u)
                f = u.nodeName.toLowerCase();
              else
                return !1;
            }
            return !1;
          },
          cleanListDOM: function(l, u) {
            if (u.nodeName.toLowerCase() === "li") {
              var f = u.parentElement;
              f.parentElement.nodeName.toLowerCase() === "p" && (s.unwrap(f.parentElement, l), e.selection.moveCursor(l, u.firstChild, u.firstChild.textContent.length));
            }
          },
          /* splitDOMTree
           *
           * Given a root element some descendant element, split the root element
           * into its own element containing the descendant element and all elements
           * on the left or right side of the descendant ('right' is default)
           *
           * example:
           *
           *         <div>
           *      /    |   \
           *  <span> <span> <span>
           *   / \    / \    / \
           *  1   2  3   4  5   6
           *
           *  If I wanted to split this tree given the <div> as the root and "4" as the leaf
           *  the result would be (the prime ' marks indicates nodes that are created as clones):
           *
           *   SPLITTING OFF 'RIGHT' TREE       SPLITTING OFF 'LEFT' TREE
           *
           *     <div>            <div>'              <div>'      <div>
           *      / \              / \                 / \          |
           * <span> <span>   <span>' <span>       <span> <span>   <span>
           *   / \    |        |      / \           /\     /\       /\
           *  1   2   3        4     5   6         1  2   3  4     5  6
           *
           *  The above example represents splitting off the 'right' or 'left' part of a tree, where
           *  the <div>' would be returned as an element not appended to the DOM, and the <div>
           *  would remain in place where it was
           *
          */
          splitOffDOMTree: function(l, u, f) {
            for (var c = u, d = null, h = !f; c !== l; ) {
              var v = c.parentNode, p = v.cloneNode(!1), g = h ? c : v.firstChild, y;
              for (d && (h ? p.appendChild(d) : y = d), d = p; g; ) {
                var m = g.nextSibling;
                g === c ? (g.hasChildNodes() ? g = g.cloneNode(!1) : g.parentNode.removeChild(g), g.textContent && d.appendChild(g), g = h ? m : null) : (g.parentNode.removeChild(g), (g.hasChildNodes() || g.textContent) && d.appendChild(g), g = m);
              }
              y && d.appendChild(y), c = v;
            }
            return d;
          },
          moveTextRangeIntoElement: function(l, u, f) {
            if (!l || !u)
              return !1;
            var c = s.findCommonRoot(l, u);
            if (!c)
              return !1;
            if (u === l) {
              var d = l.parentNode, h = l.nextSibling;
              return d.removeChild(l), f.appendChild(l), h ? d.insertBefore(f, h) : d.appendChild(f), f.hasChildNodes();
            }
            for (var v = [], p, g, y, m = 0; m < c.childNodes.length; m++)
              if (y = c.childNodes[m], !p)
                s.isDescendant(y, l, !0) && (p = y);
              else if (s.isDescendant(y, u, !0)) {
                g = y;
                break;
              } else
                v.push(y);
            var A = g.nextSibling, T = c.ownerDocument.createDocumentFragment();
            return p === l ? (p.parentNode.removeChild(p), T.appendChild(p)) : T.appendChild(s.splitOffDOMTree(p, l)), v.forEach(function(k) {
              k.parentNode.removeChild(k), T.appendChild(k);
            }), g === u ? (g.parentNode.removeChild(g), T.appendChild(g)) : T.appendChild(s.splitOffDOMTree(g, u, !0)), f.appendChild(T), g.parentNode === c ? c.insertBefore(f, g) : A ? c.insertBefore(f, A) : c.appendChild(f), f.hasChildNodes();
          },
          /* based on http://stackoverflow.com/a/6183069 */
          depthOfNode: function(l) {
            for (var u = 0, f = l; f.parentNode !== null; )
              f = f.parentNode, u++;
            return u;
          },
          findCommonRoot: function(l, u) {
            for (var f = s.depthOfNode(l), c = s.depthOfNode(u), d = l, h = u; f !== c; )
              f > c ? (d = d.parentNode, f -= 1) : (h = h.parentNode, c -= 1);
            for (; d !== h; )
              d = d.parentNode, h = h.parentNode;
            return d;
          },
          /* END - based on http://stackoverflow.com/a/6183069 */
          isElementAtBeginningOfBlock: function(l) {
            for (var u, f; !s.isBlockContainer(l) && !s.isMediumEditorElement(l); ) {
              for (f = l; f = f.previousSibling; )
                if (u = f.nodeType === 3 ? f.nodeValue : f.textContent, u.length > 0)
                  return !1;
              l = l.parentNode;
            }
            return !0;
          },
          isMediumEditorElement: function(l) {
            return l && l.getAttribute && !!l.getAttribute("data-medium-editor-element");
          },
          getContainerEditorElement: function(l) {
            return s.traverseUp(l, function(u) {
              return s.isMediumEditorElement(u);
            });
          },
          isBlockContainer: function(l) {
            return l && l.nodeType !== 3 && s.blockContainerElementNames.indexOf(l.nodeName.toLowerCase()) !== -1;
          },
          /* Finds the closest ancestor which is a block container element
           * If element is within editor element but not within any other block element,
           * the editor element is returned
           */
          getClosestBlockContainer: function(l) {
            return s.traverseUp(l, function(u) {
              return s.isBlockContainer(u) || s.isMediumEditorElement(u);
            });
          },
          /* Finds highest level ancestor element which is a block container element
           * If element is within editor element but not within any other block element,
           * the editor element is returned
           */
          getTopBlockContainer: function(l) {
            var u = s.isBlockContainer(l) ? l : !1;
            return s.traverseUp(l, function(f) {
              return s.isBlockContainer(f) && (u = f), !u && s.isMediumEditorElement(f) ? (u = f, !0) : !1;
            }), u;
          },
          getFirstSelectableLeafNode: function(l) {
            for (; l && l.firstChild; )
              l = l.firstChild;
            if (l = s.traverseUp(l, function(f) {
              return s.emptyElementNames.indexOf(f.nodeName.toLowerCase()) === -1;
            }), l.nodeName.toLowerCase() === "table") {
              var u = l.querySelector("th, td");
              u && (l = u);
            }
            return l;
          },
          // TODO: remove getFirstTextNode AND _getFirstTextNode when jumping in 6.0.0 (no code references)
          getFirstTextNode: function(l) {
            return s.warn("getFirstTextNode is deprecated and will be removed in version 6.0.0"), s._getFirstTextNode(l);
          },
          _getFirstTextNode: function(l) {
            if (l.nodeType === 3)
              return l;
            for (var u = 0; u < l.childNodes.length; u++) {
              var f = s._getFirstTextNode(l.childNodes[u]);
              if (f !== null)
                return f;
            }
            return null;
          },
          ensureUrlHasProtocol: function(l) {
            return l.indexOf("://") === -1 ? "http://" + l : l;
          },
          warn: function() {
            n.console !== void 0 && typeof n.console.warn == "function" && n.console.warn.apply(n.console, arguments);
          },
          deprecated: function(l, u, f) {
            var c = l + " is deprecated, please use " + u + " instead.";
            f && (c += " Will be removed in " + f), s.warn(c);
          },
          deprecatedMethod: function(l, u, f, c) {
            s.deprecated(l, u, c), typeof this[u] == "function" && this[u].apply(this, f);
          },
          cleanupAttrs: function(l, u) {
            u.forEach(function(f) {
              l.removeAttribute(f);
            });
          },
          cleanupTags: function(l, u) {
            u.indexOf(l.nodeName.toLowerCase()) !== -1 && l.parentNode.removeChild(l);
          },
          unwrapTags: function(l, u) {
            u.indexOf(l.nodeName.toLowerCase()) !== -1 && e.util.unwrap(l, document);
          },
          // get the closest parent
          getClosestTag: function(l, u) {
            return s.traverseUp(l, function(f) {
              return f.nodeName.toLowerCase() === u.toLowerCase();
            });
          },
          unwrap: function(l, u) {
            for (var f = u.createDocumentFragment(), c = Array.prototype.slice.call(l.childNodes), d = 0; d < c.length; d++)
              f.appendChild(c[d]);
            f.childNodes.length ? l.parentNode.replaceChild(f, l) : l.parentNode.removeChild(l);
          },
          guid: function() {
            function l() {
              return Math.floor((1 + Math.random()) * 65536).toString(16).substring(1);
            }
            return l() + l() + "-" + l() + "-" + l() + "-" + l() + "-" + l() + l() + l();
          }
        };
        e.util = s;
      }(window), function() {
        var n = function(r) {
          e.util.extend(this, r);
        };
        n.extend = function(r) {
          var i = this, o;
          r && r.hasOwnProperty("constructor") ? o = r.constructor : o = function() {
            return i.apply(this, arguments);
          }, e.util.extend(o, i);
          var a = function() {
            this.constructor = o;
          };
          return a.prototype = i.prototype, o.prototype = new a(), r && e.util.extend(o.prototype, r), o;
        }, n.prototype = {
          /* init: [function]
           *
           * Called by MediumEditor during initialization.
           * The .base property will already have been set to
           * current instance of MediumEditor when this is called.
           * All helper methods will exist as well
           */
          init: function() {
          },
          /* base: [MediumEditor instance]
           *
           * If not overriden, this will be set to the current instance
           * of MediumEditor, before the init method is called
           */
          base: void 0,
          /* name: [string]
           *
           * 'name' of the extension, used for retrieving the extension.
           * If not set, MediumEditor will set this to be the key
           * used when passing the extension into MediumEditor via the
           * 'extensions' option
           */
          name: void 0,
          /* checkState: [function (node)]
           *
           * If implemented, this function will be called one or more times
           * the state of the editor & toolbar are updated.
           * When the state is updated, the editor does the following:
           *
           * 1) Find the parent node containing the current selection
           * 2) Call checkState on the extension, passing the node as an argument
           * 3) Get the parent node of the previous node
           * 4) Repeat steps #2 and #3 until we move outside the parent contenteditable
           */
          checkState: void 0,
          /* destroy: [function ()]
           *
           * This method should remove any created html, custom event handlers
           * or any other cleanup tasks that should be performed.
           * If implemented, this function will be called when MediumEditor's
           * destroy method has been called.
           */
          destroy: void 0,
          /* As alternatives to checkState, these functions provide a more structured
           * path to updating the state of an extension (usually a button) whenever
           * the state of the editor & toolbar are updated.
           */
          /* queryCommandState: [function ()]
           *
           * If implemented, this function will be called once on each extension
           * when the state of the editor/toolbar is being updated.
           *
           * If this function returns a non-null value, the extension will
           * be ignored as the code climbs the dom tree.
           *
           * If this function returns true, and the setActive() function is defined
           * setActive() will be called
           */
          queryCommandState: void 0,
          /* isActive: [function ()]
           *
           * If implemented, this function will be called when MediumEditor
           * has determined that this extension is 'active' for the current selection.
           * This may be called when the editor & toolbar are being updated,
           * but only if queryCommandState() or isAlreadyApplied() functions
           * are implemented, and when called, return true.
           */
          isActive: void 0,
          /* isAlreadyApplied: [function (node)]
           *
           * If implemented, this function is similar to checkState() in
           * that it will be called repeatedly as MediumEditor moves up
           * the DOM to update the editor & toolbar after a state change.
           *
           * NOTE: This function will NOT be called if checkState() has
           * been implemented. This function will NOT be called if
           * queryCommandState() is implemented and returns a non-null
           * value when called
           */
          isAlreadyApplied: void 0,
          /* setActive: [function ()]
           *
           * If implemented, this function is called when MediumEditor knows
           * that this extension is currently enabled.  Currently, this
           * function is called when updating the editor & toolbar, and
           * only if queryCommandState() or isAlreadyApplied(node) return
           * true when called
           */
          setActive: void 0,
          /* setInactive: [function ()]
           *
           * If implemented, this function is called when MediumEditor knows
           * that this extension is currently disabled.  Curently, this
           * is called at the beginning of each state change for
           * the editor & toolbar. After calling this, MediumEditor
           * will attempt to update the extension, either via checkState()
           * or the combination of queryCommandState(), isAlreadyApplied(node),
           * isActive(), and setActive()
           */
          setInactive: void 0,
          /* getInteractionElements: [function ()]
           *
           * If the extension renders any elements that the user can interact with,
           * this method should be implemented and return the root element or an array
           * containing all of the root elements. MediumEditor will call this function
           * during interaction to see if the user clicked on something outside of the editor.
           * The elements are used to check if the target element of a click or
           * other user event is a descendant of any extension elements.
           * This way, the editor can also count user interaction within editor elements as
           * interactions with the editor, and thus not trigger 'blur'
           */
          getInteractionElements: void 0,
          /************************ Helpers ************************
           * The following are helpers that are either set by MediumEditor
           * during initialization, or are helper methods which either
           * route calls to the MediumEditor instance or provide common
           * functionality for all extensions
           *********************************************************/
          /* window: [Window]
           *
           * If not overriden, this will be set to the window object
           * to be used by MediumEditor and its extensions.  This is
           * passed via the 'contentWindow' option to MediumEditor
           * and is the global 'window' object by default
           */
          window: void 0,
          /* document: [Document]
           *
           * If not overriden, this will be set to the document object
           * to be used by MediumEditor and its extensions. This is
           * passed via the 'ownerDocument' optin to MediumEditor
           * and is the global 'document' object by default
           */
          document: void 0,
          /* getEditorElements: [function ()]
           *
           * Helper function which returns an array containing
           * all the contenteditable elements for this instance
           * of MediumEditor
           */
          getEditorElements: function() {
            return this.base.elements;
          },
          /* getEditorId: [function ()]
           *
           * Helper function which returns a unique identifier
           * for this instance of MediumEditor
           */
          getEditorId: function() {
            return this.base.id;
          },
          /* getEditorOptions: [function (option)]
           *
           * Helper function which returns the value of an option
           * used to initialize this instance of MediumEditor
           */
          getEditorOption: function(r) {
            return this.base.options[r];
          }
        }, [
          // general helpers
          "execAction",
          // event handling
          "on",
          "off",
          "subscribe",
          "trigger"
        ].forEach(function(r) {
          n.prototype[r] = function() {
            return this.base[r].apply(this.base, arguments);
          };
        }), e.Extension = n;
      }(), function() {
        function n(i) {
          return e.util.isBlockContainer(i) ? NodeFilter.FILTER_ACCEPT : NodeFilter.FILTER_SKIP;
        }
        var r = {
          findMatchingSelectionParent: function(i, o) {
            var a = o.getSelection(), s, l;
            return a.rangeCount === 0 ? !1 : (s = a.getRangeAt(0), l = s.commonAncestorContainer, e.util.traverseUp(l, i));
          },
          getSelectionElement: function(i) {
            return this.findMatchingSelectionParent(function(o) {
              return e.util.isMediumEditorElement(o);
            }, i);
          },
          // http://stackoverflow.com/questions/17678843/cant-restore-selection-after-html-modify-even-if-its-the-same-html
          // Tim Down
          exportSelection: function(i, o) {
            if (!i)
              return null;
            var a = null, s = o.getSelection();
            if (s.rangeCount > 0) {
              var l = s.getRangeAt(0), u = l.cloneRange(), f;
              u.selectNodeContents(i), u.setEnd(l.startContainer, l.startOffset), f = u.toString().length, a = {
                start: f,
                end: f + l.toString().length
              }, this.doesRangeStartWithImages(l, o) && (a.startsWithImage = !0);
              var c = this.getTrailingImageCount(i, a, l.endContainer, l.endOffset);
              if (c && (a.trailingImageCount = c), f !== 0) {
                var d = this.getIndexRelativeToAdjacentEmptyBlocks(o, i, l.startContainer, l.startOffset);
                d !== -1 && (a.emptyBlocksIndex = d);
              }
            }
            return a;
          },
          // http://stackoverflow.com/questions/17678843/cant-restore-selection-after-html-modify-even-if-its-the-same-html
          // Tim Down
          //
          // {object} selectionState - the selection to import
          // {DOMElement} root - the root element the selection is being restored inside of
          // {Document} doc - the document to use for managing selection
          // {boolean} [favorLaterSelectionAnchor] - defaults to false. If true, import the cursor immediately
          //      subsequent to an anchor tag if it would otherwise be placed right at the trailing edge inside the
          //      anchor. This cursor positioning, even though visually equivalent to the user, can affect behavior
          //      in MS IE.
          importSelection: function(i, o, a, s) {
            if (!(!i || !o)) {
              var l = a.createRange();
              l.setStart(o, 0), l.collapse(!0);
              var u = o, f = [], c = 0, d = !1, h = !1, v = 0, p = !1, g, y = !1, m = null;
              for ((s || i.startsWithImage || typeof i.emptyBlocksIndex < "u") && (y = !0); !p && u; ) {
                if (u.nodeType > 3) {
                  u = f.pop();
                  continue;
                }
                if (u.nodeType === 3 && !h)
                  g = c + u.length, !d && i.start >= c && i.start <= g && (y || i.start < g ? (l.setStart(u, i.start - c), d = !0) : m = u), d && i.end >= c && i.end <= g && (i.trailingImageCount ? h = !0 : (l.setEnd(u, i.end - c), p = !0)), c = g;
                else {
                  if (i.trailingImageCount && h && (u.nodeName.toLowerCase() === "img" && v++, v === i.trailingImageCount)) {
                    for (var A = 0; u.parentNode.childNodes[A] !== u; )
                      A++;
                    l.setEnd(u.parentNode, A + 1), p = !0;
                  }
                  if (!p && u.nodeType === 1)
                    for (var T = u.childNodes.length - 1; T >= 0; )
                      f.push(u.childNodes[T]), T -= 1;
                }
                p || (u = f.pop());
              }
              !d && m && (l.setStart(m, m.length), l.setEnd(m, m.length)), typeof i.emptyBlocksIndex < "u" && (l = this.importSelectionMoveCursorPastBlocks(a, o, i.emptyBlocksIndex, l)), s && (l = this.importSelectionMoveCursorPastAnchor(i, l)), this.selectRange(a, l);
            }
          },
          // Utility method called from importSelection only
          importSelectionMoveCursorPastAnchor: function(i, o) {
            var a = function(c) {
              return c.nodeName.toLowerCase() === "a";
            };
            if (i.start === i.end && o.startContainer.nodeType === 3 && o.startOffset === o.startContainer.nodeValue.length && e.util.traverseUp(o.startContainer, a)) {
              for (var s = o.startContainer, l = o.startContainer.parentNode; l !== null && l.nodeName.toLowerCase() !== "a"; )
                l.childNodes[l.childNodes.length - 1] !== s ? l = null : (s = l, l = l.parentNode);
              if (l !== null && l.nodeName.toLowerCase() === "a") {
                for (var u = null, f = 0; u === null && f < l.parentNode.childNodes.length; f++)
                  l.parentNode.childNodes[f] === l && (u = f);
                o.setStart(l.parentNode, u + 1), o.collapse(!0);
              }
            }
            return o;
          },
          // Uses the emptyBlocksIndex calculated by getIndexRelativeToAdjacentEmptyBlocks
          // to move the cursor back to the start of the correct paragraph
          importSelectionMoveCursorPastBlocks: function(i, o, a, s) {
            var l = i.createTreeWalker(o, NodeFilter.SHOW_ELEMENT, n, !1), u = s.startContainer, f, c, d = 0;
            for (a = a || 1, u.nodeType === 3 && e.util.isBlockContainer(u.previousSibling) ? f = u.previousSibling : f = e.util.getClosestBlockContainer(u); l.nextNode(); )
              if (!c)
                f === l.currentNode && (c = l.currentNode);
              else if (c = l.currentNode, d++, d === a || c.textContent.length > 0)
                break;
            return c || (c = f), s.setStart(e.util.getFirstSelectableLeafNode(c), 0), s;
          },
          // Returns -1 unless the cursor is at the beginning of a paragraph/block
          // If the paragraph/block is preceeded by empty paragraphs/block (with no text)
          // it will return the number of empty paragraphs before the cursor.
          // Otherwise, it will return 0, which indicates the cursor is at the beginning
          // of a paragraph/block, and not at the end of the paragraph/block before it
          getIndexRelativeToAdjacentEmptyBlocks: function(i, o, a, s) {
            if (a.textContent.length > 0 && s > 0)
              return -1;
            var l = a;
            if (l.nodeType !== 3 && (l = a.childNodes[s]), l) {
              if (!e.util.isElementAtBeginningOfBlock(l))
                return -1;
              var u = e.util.findPreviousSibling(l);
              if (u) {
                if (u.nodeValue)
                  return -1;
              } else return -1;
            }
            for (var f = e.util.getClosestBlockContainer(a), c = i.createTreeWalker(o, NodeFilter.SHOW_ELEMENT, n, !1), d = 0; c.nextNode(); ) {
              var h = c.currentNode.textContent === "";
              if ((h || d > 0) && (d += 1), c.currentNode === f)
                return d;
              h || (d = 0);
            }
            return d;
          },
          // Returns true if the selection range begins with an image tag
          // Returns false if the range starts with any non empty text nodes
          doesRangeStartWithImages: function(i, o) {
            if (i.startOffset !== 0 || i.startContainer.nodeType !== 1)
              return !1;
            if (i.startContainer.nodeName.toLowerCase() === "img")
              return !0;
            var a = i.startContainer.querySelector("img");
            if (!a)
              return !1;
            for (var s = o.createTreeWalker(i.startContainer, NodeFilter.SHOW_ALL, null, !1); s.nextNode(); ) {
              var l = s.currentNode;
              if (l === a)
                break;
              if (l.nodeValue)
                return !1;
            }
            return !0;
          },
          getTrailingImageCount: function(i, o, a, s) {
            if (s === 0 || a.nodeType !== 1 || a.nodeName.toLowerCase() !== "img" && !a.querySelector("img"))
              return 0;
            for (var l = a.childNodes[s - 1]; l.hasChildNodes(); )
              l = l.lastChild;
            for (var u = i, f = [], c = 0, d = !1, h = !1, v = !1, p, g = 0; !v && u; ) {
              if (u.nodeType > 3) {
                u = f.pop();
                continue;
              }
              if (u.nodeType === 3 && !h)
                g = 0, p = c + u.length, !d && o.start >= c && o.start <= p && (d = !0), d && o.end >= c && o.end <= p && (h = !0), c = p;
              else if (u.nodeName.toLowerCase() === "img" && g++, u === l)
                v = !0;
              else if (u.nodeType === 1)
                for (var y = u.childNodes.length - 1; y >= 0; )
                  f.push(u.childNodes[y]), y -= 1;
              v || (u = f.pop());
            }
            return g;
          },
          // determine if the current selection contains any 'content'
          // content being any non-white space text or an image
          selectionContainsContent: function(i) {
            var o = i.getSelection();
            if (!o || o.isCollapsed || !o.rangeCount)
              return !1;
            if (o.toString().trim() !== "")
              return !0;
            var a = this.getSelectedParentElement(o.getRangeAt(0));
            return !!(a && (a.nodeName.toLowerCase() === "img" || a.nodeType === 1 && a.querySelector("img")));
          },
          selectionInContentEditableFalse: function(i) {
            var o, a = this.findMatchingSelectionParent(function(s) {
              var l = s && s.getAttribute("contenteditable");
              return l === "true" && (o = !0), s.nodeName !== "#text" && l === "false";
            }, i);
            return !o && a;
          },
          // http://stackoverflow.com/questions/4176923/html-of-selected-text
          // by Tim Down
          getSelectionHtml: function(o) {
            var a, s = "", l = o.getSelection(), u, f;
            if (l.rangeCount) {
              for (f = o.createElement("div"), a = 0, u = l.rangeCount; a < u; a += 1)
                f.appendChild(l.getRangeAt(a).cloneContents());
              s = f.innerHTML;
            }
            return s;
          },
          /**
           *  Find the caret position within an element irrespective of any inline tags it may contain.
           *
           *  @param {DOMElement} An element containing the cursor to find offsets relative to.
           *  @param {Range} A Range representing cursor position. Will window.getSelection if none is passed.
           *  @return {Object} 'left' and 'right' attributes contain offsets from begining and end of Element
           */
          getCaretOffsets: function(o, a) {
            var s, l;
            return a || (a = window.getSelection().getRangeAt(0)), s = a.cloneRange(), l = a.cloneRange(), s.selectNodeContents(o), s.setEnd(a.endContainer, a.endOffset), l.selectNodeContents(o), l.setStart(a.endContainer, a.endOffset), {
              left: s.toString().length,
              right: l.toString().length
            };
          },
          // http://stackoverflow.com/questions/15867542/range-object-get-selection-parent-node-chrome-vs-firefox
          rangeSelectsSingleNode: function(i) {
            var o = i.startContainer;
            return o === i.endContainer && o.hasChildNodes() && i.endOffset === i.startOffset + 1;
          },
          getSelectedParentElement: function(i) {
            return i ? this.rangeSelectsSingleNode(i) && i.startContainer.childNodes[i.startOffset].nodeType !== 3 ? i.startContainer.childNodes[i.startOffset] : i.startContainer.nodeType === 3 ? i.startContainer.parentNode : i.startContainer : null;
          },
          getSelectedElements: function(i) {
            var o = i.getSelection(), a, s, l;
            if (!o.rangeCount || o.isCollapsed || !o.getRangeAt(0).commonAncestorContainer)
              return [];
            if (a = o.getRangeAt(0), a.commonAncestorContainer.nodeType === 3) {
              for (s = [], l = a.commonAncestorContainer; l.parentNode && l.parentNode.childNodes.length === 1; )
                s.push(l.parentNode), l = l.parentNode;
              return s;
            }
            return [].filter.call(a.commonAncestorContainer.getElementsByTagName("*"), function(u) {
              return typeof o.containsNode == "function" ? o.containsNode(u, !0) : !0;
            });
          },
          selectNode: function(i, o) {
            var a = o.createRange();
            a.selectNodeContents(i), this.selectRange(o, a);
          },
          select: function(i, o, a, s, l) {
            var u = i.createRange();
            return u.setStart(o, a), s ? u.setEnd(s, l) : u.collapse(!0), this.selectRange(i, u), u;
          },
          /**
           *  Clear the current highlighted selection and set the caret to the start or the end of that prior selection, defaults to end.
           *
           *  @param {DomDocument} doc            Current document
           *  @param {boolean} moveCursorToStart  A boolean representing whether or not to set the caret to the beginning of the prior selection.
           */
          clearSelection: function(i, o) {
            o ? i.getSelection().collapseToStart() : i.getSelection().collapseToEnd();
          },
          /**
           * Move cursor to the given node with the given offset.
           *
           * @param  {DomDocument} doc     Current document
           * @param  {DomElement}  node    Element where to jump
           * @param  {integer}     offset  Where in the element should we jump, 0 by default
           */
          moveCursor: function(i, o, a) {
            this.select(i, o, a);
          },
          getSelectionRange: function(i) {
            var o = i.getSelection();
            return o.rangeCount === 0 ? null : o.getRangeAt(0);
          },
          selectRange: function(i, o) {
            var a = i.getSelection();
            a.removeAllRanges(), a.addRange(o);
          },
          // http://stackoverflow.com/questions/1197401/how-can-i-get-the-element-the-caret-is-in-with-javascript-when-using-contentedi
          // by You
          getSelectionStart: function(i) {
            var o = i.getSelection().anchorNode, a = o && o.nodeType === 3 ? o.parentNode : o;
            return a;
          }
        };
        e.selection = r;
      }(), function() {
        function n(i, o) {
          return i ? i.some(function(a) {
            if (typeof a.getInteractionElements != "function")
              return !1;
            var s = a.getInteractionElements();
            return s ? (Array.isArray(s) || (s = [s]), s.some(function(l) {
              return e.util.isDescendant(l, o, !0);
            })) : !1;
          }) : !1;
        }
        var r = function(i) {
          this.base = i, this.options = this.base.options, this.events = [], this.disabledEvents = {}, this.customEvents = {}, this.listeners = {};
        };
        r.prototype = {
          InputEventOnContenteditableSupported: !e.util.isIE && !e.util.isEdge,
          // Helpers for event handling
          attachDOMEvent: function(i, o, a, s) {
            var l = this.base.options.contentWindow, u = this.base.options.ownerDocument;
            i = e.util.isElement(i) || [l, u].indexOf(i) > -1 ? [i] : i, Array.prototype.forEach.call(i, (function(f) {
              f.addEventListener(o, a, s), this.events.push([f, o, a, s]);
            }).bind(this));
          },
          detachDOMEvent: function(i, o, a, s) {
            var l, u, f = this.base.options.contentWindow, c = this.base.options.ownerDocument;
            i && (i = e.util.isElement(i) || [f, c].indexOf(i) > -1 ? [i] : i, Array.prototype.forEach.call(i, (function(d) {
              l = this.indexOfListener(d, o, a, s), l !== -1 && (u = this.events.splice(l, 1)[0], u[0].removeEventListener(u[1], u[2], u[3]));
            }).bind(this)));
          },
          indexOfListener: function(i, o, a, s) {
            var l, u, f;
            for (l = 0, u = this.events.length; l < u; l = l + 1)
              if (f = this.events[l], f[0] === i && f[1] === o && f[2] === a && f[3] === s)
                return l;
            return -1;
          },
          detachAllDOMEvents: function() {
            for (var i = this.events.pop(); i; )
              i[0].removeEventListener(i[1], i[2], i[3]), i = this.events.pop();
          },
          detachAllEventsFromElement: function(i) {
            for (var o = this.events.filter(function(u) {
              return u && u[0].getAttribute && u[0].getAttribute("medium-editor-index") === i.getAttribute("medium-editor-index");
            }), a = 0, s = o.length; a < s; a++) {
              var l = o[a];
              this.detachDOMEvent(l[0], l[1], l[2], l[3]);
            }
          },
          // Attach all existing handlers to a new element
          attachAllEventsToElement: function(i) {
            this.listeners.editableInput && (this.contentCache[i.getAttribute("medium-editor-index")] = i.innerHTML), this.eventsCache && this.eventsCache.forEach(function(o) {
              this.attachDOMEvent(i, o.name, o.handler.bind(this));
            }, this);
          },
          enableCustomEvent: function(i) {
            this.disabledEvents[i] !== void 0 && delete this.disabledEvents[i];
          },
          disableCustomEvent: function(i) {
            this.disabledEvents[i] = !0;
          },
          // custom events
          attachCustomEvent: function(i, o) {
            this.setupListener(i), this.customEvents[i] || (this.customEvents[i] = []), this.customEvents[i].push(o);
          },
          detachCustomEvent: function(i, o) {
            var a = this.indexOfCustomListener(i, o);
            a !== -1 && this.customEvents[i].splice(a, 1);
          },
          indexOfCustomListener: function(i, o) {
            return !this.customEvents[i] || !this.customEvents[i].length ? -1 : this.customEvents[i].indexOf(o);
          },
          detachAllCustomEvents: function() {
            this.customEvents = {};
          },
          triggerCustomEvent: function(i, o, a) {
            this.customEvents[i] && !this.disabledEvents[i] && this.customEvents[i].forEach(function(s) {
              s(o, a);
            });
          },
          // Cleaning up
          destroy: function() {
            this.detachAllDOMEvents(), this.detachAllCustomEvents(), this.detachExecCommand(), this.base.elements && this.base.elements.forEach(function(i) {
              i.removeAttribute("data-medium-focused");
            });
          },
          // Listening to calls to document.execCommand
          // Attach a listener to be notified when document.execCommand is called
          attachToExecCommand: function() {
            this.execCommandListener || (this.execCommandListener = (function(i) {
              this.handleDocumentExecCommand(i);
            }).bind(this), this.wrapExecCommand(), this.options.ownerDocument.execCommand.listeners.push(this.execCommandListener));
          },
          // Remove our listener for calls to document.execCommand
          detachExecCommand: function() {
            var i = this.options.ownerDocument;
            if (!(!this.execCommandListener || !i.execCommand.listeners)) {
              var o = i.execCommand.listeners.indexOf(this.execCommandListener);
              o !== -1 && i.execCommand.listeners.splice(o, 1), i.execCommand.listeners.length || this.unwrapExecCommand();
            }
          },
          // Wrap document.execCommand in a custom method so we can listen to calls to it
          wrapExecCommand: function() {
            var i = this.options.ownerDocument;
            if (!i.execCommand.listeners) {
              var o = function(s, l) {
                i.execCommand.listeners && i.execCommand.listeners.forEach(function(u) {
                  u({
                    command: s[0],
                    value: s[2],
                    args: s,
                    result: l
                  });
                });
              }, a = function() {
                var s = i.execCommand.orig.apply(this, arguments);
                if (!i.execCommand.listeners)
                  return s;
                var l = Array.prototype.slice.call(arguments);
                return o(l, s), s;
              };
              a.orig = i.execCommand, a.listeners = [], a.callListeners = o, i.execCommand = a;
            }
          },
          // Revert document.execCommand back to its original self
          unwrapExecCommand: function() {
            var i = this.options.ownerDocument;
            i.execCommand.orig && (i.execCommand = i.execCommand.orig);
          },
          // Listening to browser events to emit events medium-editor cares about
          setupListener: function(i) {
            if (!this.listeners[i]) {
              switch (i) {
                case "externalInteraction":
                  this.attachDOMEvent(this.options.ownerDocument.body, "mousedown", this.handleBodyMousedown.bind(this), !0), this.attachDOMEvent(this.options.ownerDocument.body, "click", this.handleBodyClick.bind(this), !0), this.attachDOMEvent(this.options.ownerDocument.body, "focus", this.handleBodyFocus.bind(this), !0);
                  break;
                case "blur":
                  this.setupListener("externalInteraction");
                  break;
                case "focus":
                  this.setupListener("externalInteraction");
                  break;
                case "editableInput":
                  this.contentCache = {}, this.base.elements.forEach(function(o) {
                    this.contentCache[o.getAttribute("medium-editor-index")] = o.innerHTML;
                  }, this), this.InputEventOnContenteditableSupported && this.attachToEachElement("input", this.handleInput), this.InputEventOnContenteditableSupported || (this.setupListener("editableKeypress"), this.keypressUpdateInput = !0, this.attachDOMEvent(document, "selectionchange", this.handleDocumentSelectionChange.bind(this)), this.attachToExecCommand());
                  break;
                case "editableClick":
                  this.attachToEachElement("click", this.handleClick);
                  break;
                case "editableBlur":
                  this.attachToEachElement("blur", this.handleBlur);
                  break;
                case "editableKeypress":
                  this.attachToEachElement("keypress", this.handleKeypress);
                  break;
                case "editableKeyup":
                  this.attachToEachElement("keyup", this.handleKeyup);
                  break;
                case "editableKeydown":
                  this.attachToEachElement("keydown", this.handleKeydown);
                  break;
                case "editableKeydownSpace":
                  this.setupListener("editableKeydown");
                  break;
                case "editableKeydownEnter":
                  this.setupListener("editableKeydown");
                  break;
                case "editableKeydownTab":
                  this.setupListener("editableKeydown");
                  break;
                case "editableKeydownDelete":
                  this.setupListener("editableKeydown");
                  break;
                case "editableMouseover":
                  this.attachToEachElement("mouseover", this.handleMouseover);
                  break;
                case "editableDrag":
                  this.attachToEachElement("dragover", this.handleDragging), this.attachToEachElement("dragleave", this.handleDragging);
                  break;
                case "editableDrop":
                  this.attachToEachElement("drop", this.handleDrop);
                  break;
                // TODO: We need to have a custom 'paste' event separate from 'editablePaste'
                // Need to think about the way to introduce this without breaking folks
                case "editablePaste":
                  this.attachToEachElement("paste", this.handlePaste);
                  break;
              }
              this.listeners[i] = !0;
            }
          },
          attachToEachElement: function(i, o) {
            this.eventsCache || (this.eventsCache = []), this.base.elements.forEach(function(a) {
              this.attachDOMEvent(a, i, o.bind(this));
            }, this), this.eventsCache.push({ name: i, handler: o });
          },
          cleanupElement: function(i) {
            var o = i.getAttribute("medium-editor-index");
            o && (this.detachAllEventsFromElement(i), this.contentCache && delete this.contentCache[o]);
          },
          focusElement: function(i) {
            i.focus(), this.updateFocus(i, { target: i, type: "focus" });
          },
          updateFocus: function(i, o) {
            var a = this.base.getFocusedElement(), s;
            a && o.type === "click" && this.lastMousedownTarget && (e.util.isDescendant(a, this.lastMousedownTarget, !0) || n(this.base.extensions, this.lastMousedownTarget)) && (s = a), s || this.base.elements.some(function(u) {
              return !s && e.util.isDescendant(u, i, !0) && (s = u), !!s;
            }, this);
            var l = !e.util.isDescendant(a, i, !0) && !n(this.base.extensions, i);
            s !== a && (a && l && (a.removeAttribute("data-medium-focused"), this.triggerCustomEvent("blur", o, a)), s && (s.setAttribute("data-medium-focused", !0), this.triggerCustomEvent("focus", o, s))), l && this.triggerCustomEvent("externalInteraction", o);
          },
          updateInput: function(i, o) {
            if (this.contentCache) {
              var a = i.getAttribute("medium-editor-index"), s = i.innerHTML;
              s !== this.contentCache[a] && this.triggerCustomEvent("editableInput", o, i), this.contentCache[a] = s;
            }
          },
          handleDocumentSelectionChange: function(i) {
            if (i.currentTarget && i.currentTarget.activeElement) {
              var o = i.currentTarget.activeElement, a;
              this.base.elements.some(function(s) {
                return e.util.isDescendant(s, o, !0) ? (a = s, !0) : !1;
              }, this), a && this.updateInput(a, { target: o, currentTarget: a });
            }
          },
          handleDocumentExecCommand: function() {
            var i = this.base.getFocusedElement();
            i && this.updateInput(i, { target: i, currentTarget: i });
          },
          handleBodyClick: function(i) {
            this.updateFocus(i.target, i);
          },
          handleBodyFocus: function(i) {
            this.updateFocus(i.target, i);
          },
          handleBodyMousedown: function(i) {
            this.lastMousedownTarget = i.target;
          },
          handleInput: function(i) {
            this.updateInput(i.currentTarget, i);
          },
          handleClick: function(i) {
            this.triggerCustomEvent("editableClick", i, i.currentTarget);
          },
          handleBlur: function(i) {
            this.triggerCustomEvent("editableBlur", i, i.currentTarget);
          },
          handleKeypress: function(i) {
            if (this.triggerCustomEvent("editableKeypress", i, i.currentTarget), this.keypressUpdateInput) {
              var o = { target: i.target, currentTarget: i.currentTarget };
              setTimeout((function() {
                this.updateInput(o.currentTarget, o);
              }).bind(this), 0);
            }
          },
          handleKeyup: function(i) {
            this.triggerCustomEvent("editableKeyup", i, i.currentTarget);
          },
          handleMouseover: function(i) {
            this.triggerCustomEvent("editableMouseover", i, i.currentTarget);
          },
          handleDragging: function(i) {
            this.triggerCustomEvent("editableDrag", i, i.currentTarget);
          },
          handleDrop: function(i) {
            this.triggerCustomEvent("editableDrop", i, i.currentTarget);
          },
          handlePaste: function(i) {
            this.triggerCustomEvent("editablePaste", i, i.currentTarget);
          },
          handleKeydown: function(i) {
            if (this.triggerCustomEvent("editableKeydown", i, i.currentTarget), e.util.isKey(i, e.util.keyCode.SPACE))
              return this.triggerCustomEvent("editableKeydownSpace", i, i.currentTarget);
            if (e.util.isKey(i, e.util.keyCode.ENTER) || i.ctrlKey && e.util.isKey(i, e.util.keyCode.M))
              return this.triggerCustomEvent("editableKeydownEnter", i, i.currentTarget);
            if (e.util.isKey(i, e.util.keyCode.TAB))
              return this.triggerCustomEvent("editableKeydownTab", i, i.currentTarget);
            if (e.util.isKey(i, [e.util.keyCode.DELETE, e.util.keyCode.BACKSPACE]))
              return this.triggerCustomEvent("editableKeydownDelete", i, i.currentTarget);
          }
        }, e.Events = r;
      }(), function() {
        var n = e.Extension.extend({
          /* Button Options */
          /* action: [string]
           * The action argument to pass to MediumEditor.execAction()
           * when the button is clicked
           */
          action: void 0,
          /* aria: [string]
           * The value to add as the aria-label attribute of the button
           * element displayed in the toolbar.
           * This is also used as the tooltip for the button
           */
          aria: void 0,
          /* tagNames: [Array]
           * NOTE: This is not used if useQueryState is set to true.
           *
           * Array of element tag names that would indicate that this
           * button has already been applied. If this action has already
           * been applied, the button will be displayed as 'active' in the toolbar
           *
           * Example:
           * For 'bold', if the text is ever within a <b> or <strong>
           * tag that indicates the text is already bold. So the array
           * of tagNames for bold would be: ['b', 'strong']
           */
          tagNames: void 0,
          /* style: [Object]
           * NOTE: This is not used if useQueryState is set to true.
           *
           * A pair of css property & value(s) that indicate that this
           * button has already been applied. If this action has already
           * been applied, the button will be displayed as 'active' in the toolbar
           * Properties of the object:
           *   prop [String]: name of the css property
           *   value [String]: value(s) of the css property
           *                   multiple values can be separated by a '|'
           *
           * Example:
           * For 'bold', if the text is ever within an element with a 'font-weight'
           * style property set to '700' or 'bold', that indicates the text
           * is already bold.  So the style object for bold would be:
           * { prop: 'font-weight', value: '700|bold' }
           */
          style: void 0,
          /* useQueryState: [boolean]
           * Enables/disables whether this button should use the built-in
           * document.queryCommandState() method to determine whether
           * the action has already been applied.  If the action has already
           * been applied, the button will be displayed as 'active' in the toolbar
           *
           * Example:
           * For 'bold', if this is set to true, the code will call:
           * document.queryCommandState('bold') which will return true if the
           * browser thinks the text is already bold, and false otherwise
           */
          useQueryState: void 0,
          /* contentDefault: [string]
           * Default innerHTML to put inside the button
           */
          contentDefault: void 0,
          /* contentFA: [string]
           * The innerHTML to use for the content of the button
           * if the `buttonLabels` option for MediumEditor is set to 'fontawesome'
           */
          contentFA: void 0,
          /* classList: [Array]
           * An array of classNames (strings) to be added to the button
           */
          classList: void 0,
          /* attrs: [object]
           * A set of key-value pairs to add to the button as custom attributes
           */
          attrs: void 0,
          // The button constructor can optionally accept the name of a built-in button
          // (ie 'bold', 'italic', etc.)
          // When the name of a button is passed, it will initialize itself with the
          // configuration for that button
          constructor: function(r) {
            n.isBuiltInButton(r) ? e.Extension.call(this, this.defaults[r]) : e.Extension.call(this, r);
          },
          init: function() {
            e.Extension.prototype.init.apply(this, arguments), this.button = this.createButton(), this.on(this.button, "click", this.handleClick.bind(this));
          },
          /* getButton: [function ()]
           *
           * If implemented, this function will be called when
           * the toolbar is being created.  The DOM Element returned
           * by this function will be appended to the toolbar along
           * with any other buttons.
           */
          getButton: function() {
            return this.button;
          },
          getAction: function() {
            return typeof this.action == "function" ? this.action(this.base.options) : this.action;
          },
          getAria: function() {
            return typeof this.aria == "function" ? this.aria(this.base.options) : this.aria;
          },
          getTagNames: function() {
            return typeof this.tagNames == "function" ? this.tagNames(this.base.options) : this.tagNames;
          },
          createButton: function() {
            var r = this.document.createElement("button"), i = this.contentDefault, o = this.getAria(), a = this.getEditorOption("buttonLabels");
            return r.classList.add("medium-editor-action"), r.classList.add("medium-editor-action-" + this.name), this.classList && this.classList.forEach(function(s) {
              r.classList.add(s);
            }), r.setAttribute("data-action", this.getAction()), o && (r.setAttribute("title", o), r.setAttribute("aria-label", o)), this.attrs && Object.keys(this.attrs).forEach(function(s) {
              r.setAttribute(s, this.attrs[s]);
            }, this), a === "fontawesome" && this.contentFA && (i = this.contentFA), r.innerHTML = i, r;
          },
          handleClick: function(r) {
            r.preventDefault(), r.stopPropagation();
            var i = this.getAction();
            i && this.execAction(i);
          },
          isActive: function() {
            return this.button.classList.contains(this.getEditorOption("activeButtonClass"));
          },
          setInactive: function() {
            this.button.classList.remove(this.getEditorOption("activeButtonClass")), delete this.knownState;
          },
          setActive: function() {
            this.button.classList.add(this.getEditorOption("activeButtonClass")), delete this.knownState;
          },
          queryCommandState: function() {
            var r = null;
            return this.useQueryState && (r = this.base.queryCommandState(this.getAction())), r;
          },
          isAlreadyApplied: function(r) {
            var i = !1, o = this.getTagNames(), a, s;
            return this.knownState === !1 || this.knownState === !0 ? this.knownState : (o && o.length > 0 && (i = o.indexOf(r.nodeName.toLowerCase()) !== -1), !i && this.style && (a = this.style.value.split("|"), s = this.window.getComputedStyle(r, null).getPropertyValue(this.style.prop), a.forEach(function(l) {
              this.knownState || (i = s.indexOf(l) !== -1, (i || this.style.prop !== "text-decoration") && (this.knownState = i));
            }, this)), i);
          }
        });
        n.isBuiltInButton = function(r) {
          return typeof r == "string" && e.extensions.button.prototype.defaults.hasOwnProperty(r);
        }, e.extensions.button = n;
      }(), function() {
        e.extensions.button.prototype.defaults = {
          bold: {
            name: "bold",
            action: "bold",
            aria: "bold",
            tagNames: ["b", "strong"],
            style: {
              prop: "font-weight",
              value: "700|bold"
            },
            useQueryState: !0,
            contentDefault: "<b>B</b>",
            contentFA: '<i class="fa fa-bold"></i>'
          },
          italic: {
            name: "italic",
            action: "italic",
            aria: "italic",
            tagNames: ["i", "em"],
            style: {
              prop: "font-style",
              value: "italic"
            },
            useQueryState: !0,
            contentDefault: "<b><i>I</i></b>",
            contentFA: '<i class="fa fa-italic"></i>'
          },
          underline: {
            name: "underline",
            action: "underline",
            aria: "underline",
            tagNames: ["u"],
            style: {
              prop: "text-decoration",
              value: "underline"
            },
            useQueryState: !0,
            contentDefault: "<b><u>U</u></b>",
            contentFA: '<i class="fa fa-underline"></i>'
          },
          strikethrough: {
            name: "strikethrough",
            action: "strikethrough",
            aria: "strike through",
            tagNames: ["strike"],
            style: {
              prop: "text-decoration",
              value: "line-through"
            },
            useQueryState: !0,
            contentDefault: "<s>A</s>",
            contentFA: '<i class="fa fa-strikethrough"></i>'
          },
          superscript: {
            name: "superscript",
            action: "superscript",
            aria: "superscript",
            tagNames: ["sup"],
            /* firefox doesn't behave the way we want it to, so we CAN'T use queryCommandState for superscript
               https://github.com/guardian/scribe/blob/master/BROWSERINCONSISTENCIES.md#documentquerycommandstate */
            // useQueryState: true
            contentDefault: "<b>x<sup>1</sup></b>",
            contentFA: '<i class="fa fa-superscript"></i>'
          },
          subscript: {
            name: "subscript",
            action: "subscript",
            aria: "subscript",
            tagNames: ["sub"],
            /* firefox doesn't behave the way we want it to, so we CAN'T use queryCommandState for subscript
               https://github.com/guardian/scribe/blob/master/BROWSERINCONSISTENCIES.md#documentquerycommandstate */
            // useQueryState: true
            contentDefault: "<b>x<sub>1</sub></b>",
            contentFA: '<i class="fa fa-subscript"></i>'
          },
          image: {
            name: "image",
            action: "image",
            aria: "image",
            tagNames: ["img"],
            contentDefault: "<b>image</b>",
            contentFA: '<i class="fa fa-picture-o"></i>'
          },
          html: {
            name: "html",
            action: "html",
            aria: "evaluate html",
            tagNames: ["iframe", "object"],
            contentDefault: "<b>html</b>",
            contentFA: '<i class="fa fa-code"></i>'
          },
          orderedlist: {
            name: "orderedlist",
            action: "insertorderedlist",
            aria: "ordered list",
            tagNames: ["ol"],
            useQueryState: !0,
            contentDefault: "<b>1.</b>",
            contentFA: '<i class="fa fa-list-ol"></i>'
          },
          unorderedlist: {
            name: "unorderedlist",
            action: "insertunorderedlist",
            aria: "unordered list",
            tagNames: ["ul"],
            useQueryState: !0,
            contentDefault: "<b>&bull;</b>",
            contentFA: '<i class="fa fa-list-ul"></i>'
          },
          indent: {
            name: "indent",
            action: "indent",
            aria: "indent",
            tagNames: [],
            contentDefault: "<b>&rarr;</b>",
            contentFA: '<i class="fa fa-indent"></i>'
          },
          outdent: {
            name: "outdent",
            action: "outdent",
            aria: "outdent",
            tagNames: [],
            contentDefault: "<b>&larr;</b>",
            contentFA: '<i class="fa fa-outdent"></i>'
          },
          justifyCenter: {
            name: "justifyCenter",
            action: "justifyCenter",
            aria: "center justify",
            tagNames: [],
            style: {
              prop: "text-align",
              value: "center"
            },
            contentDefault: "<b>C</b>",
            contentFA: '<i class="fa fa-align-center"></i>'
          },
          justifyFull: {
            name: "justifyFull",
            action: "justifyFull",
            aria: "full justify",
            tagNames: [],
            style: {
              prop: "text-align",
              value: "justify"
            },
            contentDefault: "<b>J</b>",
            contentFA: '<i class="fa fa-align-justify"></i>'
          },
          justifyLeft: {
            name: "justifyLeft",
            action: "justifyLeft",
            aria: "left justify",
            tagNames: [],
            style: {
              prop: "text-align",
              value: "left"
            },
            contentDefault: "<b>L</b>",
            contentFA: '<i class="fa fa-align-left"></i>'
          },
          justifyRight: {
            name: "justifyRight",
            action: "justifyRight",
            aria: "right justify",
            tagNames: [],
            style: {
              prop: "text-align",
              value: "right"
            },
            contentDefault: "<b>R</b>",
            contentFA: '<i class="fa fa-align-right"></i>'
          },
          // Known inline elements that are not removed, or not removed consistantly across browsers:
          // <span>, <label>, <br>
          removeFormat: {
            name: "removeFormat",
            aria: "remove formatting",
            action: "removeFormat",
            contentDefault: "<b>X</b>",
            contentFA: '<i class="fa fa-eraser"></i>'
          },
          /***** Buttons for appending block elements (append-<element> action) *****/
          quote: {
            name: "quote",
            action: "append-blockquote",
            aria: "blockquote",
            tagNames: ["blockquote"],
            contentDefault: "<b>&ldquo;</b>",
            contentFA: '<i class="fa fa-quote-right"></i>'
          },
          pre: {
            name: "pre",
            action: "append-pre",
            aria: "preformatted text",
            tagNames: ["pre"],
            contentDefault: "<b>0101</b>",
            contentFA: '<i class="fa fa-code fa-lg"></i>'
          },
          h1: {
            name: "h1",
            action: "append-h1",
            aria: "header type one",
            tagNames: ["h1"],
            contentDefault: "<b>H1</b>",
            contentFA: '<i class="fa fa-header"><sup>1</sup>'
          },
          h2: {
            name: "h2",
            action: "append-h2",
            aria: "header type two",
            tagNames: ["h2"],
            contentDefault: "<b>H2</b>",
            contentFA: '<i class="fa fa-header"><sup>2</sup>'
          },
          h3: {
            name: "h3",
            action: "append-h3",
            aria: "header type three",
            tagNames: ["h3"],
            contentDefault: "<b>H3</b>",
            contentFA: '<i class="fa fa-header"><sup>3</sup>'
          },
          h4: {
            name: "h4",
            action: "append-h4",
            aria: "header type four",
            tagNames: ["h4"],
            contentDefault: "<b>H4</b>",
            contentFA: '<i class="fa fa-header"><sup>4</sup>'
          },
          h5: {
            name: "h5",
            action: "append-h5",
            aria: "header type five",
            tagNames: ["h5"],
            contentDefault: "<b>H5</b>",
            contentFA: '<i class="fa fa-header"><sup>5</sup>'
          },
          h6: {
            name: "h6",
            action: "append-h6",
            aria: "header type six",
            tagNames: ["h6"],
            contentDefault: "<b>H6</b>",
            contentFA: '<i class="fa fa-header"><sup>6</sup>'
          }
        };
      }(), function() {
        var n = e.extensions.button.extend({
          init: function() {
            e.extensions.button.prototype.init.apply(this, arguments);
          },
          // default labels for the form buttons
          formSaveLabel: "&#10003;",
          formCloseLabel: "&times;",
          /* activeClass: [string]
           * set class which added to shown form
           */
          activeClass: "medium-editor-toolbar-form-active",
          /* hasForm: [boolean]
           *
           * Setting this to true will cause getForm() to be called
           * when the toolbar is created, so the form can be appended
           * inside the toolbar container
           */
          hasForm: !0,
          /* getForm: [function ()]
           *
           * When hasForm is true, this function must be implemented
           * and return a DOM Element which will be appended to
           * the toolbar container. The form should start hidden, and
           * the extension can choose when to hide/show it
           */
          getForm: function() {
          },
          /* isDisplayed: [function ()]
           *
           * This function should return true/false reflecting
           * whether the form is currently displayed
           */
          isDisplayed: function() {
            return this.hasForm ? this.getForm().classList.contains(this.activeClass) : !1;
          },
          /* hideForm: [function ()]
           *
           * This function should show the form element inside
           * the toolbar container
           */
          showForm: function() {
            this.hasForm && this.getForm().classList.add(this.activeClass);
          },
          /* hideForm: [function ()]
           *
           * This function should hide the form element inside
           * the toolbar container
           */
          hideForm: function() {
            this.hasForm && this.getForm().classList.remove(this.activeClass);
          },
          /************************ Helpers ************************
           * The following are helpers that are either set by MediumEditor
           * during initialization, or are helper methods which either
           * route calls to the MediumEditor instance or provide common
           * functionality for all form extensions
           *********************************************************/
          /* showToolbarDefaultActions: [function ()]
           *
           * Helper method which will turn back the toolbar after canceling
           * the customized form
           */
          showToolbarDefaultActions: function() {
            var r = this.base.getExtensionByName("toolbar");
            r && r.showToolbarDefaultActions();
          },
          /* hideToolbarDefaultActions: [function ()]
           *
           * Helper function which will hide the default contents of the
           * toolbar, but leave the toolbar container in the same state
           * to allow a form to display its custom contents inside the toolbar
           */
          hideToolbarDefaultActions: function() {
            var r = this.base.getExtensionByName("toolbar");
            r && r.hideToolbarDefaultActions();
          },
          /* setToolbarPosition: [function ()]
           *
           * Helper function which will update the size and position
           * of the toolbar based on the toolbar content and the current
           * position of the user's selection
           */
          setToolbarPosition: function() {
            var r = this.base.getExtensionByName("toolbar");
            r && r.setToolbarPosition();
          }
        });
        e.extensions.form = n;
      }(), function() {
        var n = e.extensions.form.extend({
          /* Anchor Form Options */
          /* customClassOption: [string]  (previously options.anchorButton + options.anchorButtonClass)
           * Custom class name the user can optionally have added to their created links (ie 'button').
           * If passed as a non-empty string, a checkbox will be displayed allowing the user to choose
           * whether to have the class added to the created link or not.
           */
          customClassOption: null,
          /* customClassOptionText: [string]
           * text to be shown in the checkbox when the __customClassOption__ is being used.
           */
          customClassOptionText: "Button",
          /* linkValidation: [boolean]  (previously options.checkLinkFormat)
           * enables/disables check for common URL protocols on anchor links.
           */
          linkValidation: !1,
          /* placeholderText: [string]  (previously options.anchorInputPlaceholder)
           * text to be shown as placeholder of the anchor input.
           */
          placeholderText: "Paste or type a link",
          /* targetCheckbox: [boolean]  (previously options.anchorTarget)
           * enables/disables displaying a "Open in new window" checkbox, which when checked
           * changes the `target` attribute of the created link.
           */
          targetCheckbox: !1,
          /* targetCheckboxText: [string]  (previously options.anchorInputCheckboxLabel)
           * text to be shown in the checkbox enabled via the __targetCheckbox__ option.
           */
          targetCheckboxText: "Open in new window",
          // Options for the Button base class
          name: "anchor",
          action: "createLink",
          aria: "link",
          tagNames: ["a"],
          contentDefault: "<b>#</b>",
          contentFA: '<i class="fa fa-link"></i>',
          init: function() {
            e.extensions.form.prototype.init.apply(this, arguments), this.subscribe("editableKeydown", this.handleKeydown.bind(this));
          },
          // Called when the button the toolbar is clicked
          // Overrides ButtonExtension.handleClick
          handleClick: function(r) {
            r.preventDefault(), r.stopPropagation();
            var i = e.selection.getSelectionRange(this.document);
            return i.startContainer.nodeName.toLowerCase() === "a" || i.endContainer.nodeName.toLowerCase() === "a" || e.util.getClosestTag(e.selection.getSelectedParentElement(i), "a") ? this.execAction("unlink") : (this.isDisplayed() || this.showForm(), !1);
          },
          // Called when user hits the defined shortcut (CTRL / COMMAND + K)
          handleKeydown: function(r) {
            e.util.isKey(r, e.util.keyCode.K) && e.util.isMetaCtrlKey(r) && !r.shiftKey && this.handleClick(r);
          },
          // Called by medium-editor to append form to the toolbar
          getForm: function() {
            return this.form || (this.form = this.createForm()), this.form;
          },
          getTemplate: function() {
            var r = [
              '<input type="text" class="medium-editor-toolbar-input" placeholder="',
              this.placeholderText,
              '">'
            ];
            return r.push(
              '<a href="#" class="medium-editor-toolbar-save">',
              this.getEditorOption("buttonLabels") === "fontawesome" ? '<i class="fa fa-check"></i>' : this.formSaveLabel,
              "</a>"
            ), r.push(
              '<a href="#" class="medium-editor-toolbar-close">',
              this.getEditorOption("buttonLabels") === "fontawesome" ? '<i class="fa fa-times"></i>' : this.formCloseLabel,
              "</a>"
            ), this.targetCheckbox && r.push(
              '<div class="medium-editor-toolbar-form-row">',
              '<input type="checkbox" class="medium-editor-toolbar-anchor-target" id="medium-editor-toolbar-anchor-target-field-' + this.getEditorId() + '">',
              '<label for="medium-editor-toolbar-anchor-target-field-' + this.getEditorId() + '">',
              this.targetCheckboxText,
              "</label>",
              "</div>"
            ), this.customClassOption && r.push(
              '<div class="medium-editor-toolbar-form-row">',
              '<input type="checkbox" class="medium-editor-toolbar-anchor-button">',
              "<label>",
              this.customClassOptionText,
              "</label>",
              "</div>"
            ), r.join("");
          },
          // Used by medium-editor when the default toolbar is to be displayed
          isDisplayed: function() {
            return e.extensions.form.prototype.isDisplayed.apply(this);
          },
          hideForm: function() {
            e.extensions.form.prototype.hideForm.apply(this), this.getInput().value = "";
          },
          showForm: function(r) {
            var i = this.getInput(), o = this.getAnchorTargetCheckbox(), a = this.getAnchorButtonCheckbox();
            if (r = r || { value: "" }, typeof r == "string" && (r = {
              value: r
            }), this.base.saveSelection(), this.hideToolbarDefaultActions(), e.extensions.form.prototype.showForm.apply(this), this.setToolbarPosition(), i.value = r.value, i.focus(), o && (o.checked = r.target === "_blank"), a) {
              var s = r.buttonClass ? r.buttonClass.split(" ") : [];
              a.checked = s.indexOf(this.customClassOption) !== -1;
            }
          },
          // Called by core when tearing down medium-editor (destroy)
          destroy: function() {
            if (!this.form)
              return !1;
            this.form.parentNode && this.form.parentNode.removeChild(this.form), delete this.form;
          },
          // core methods
          getFormOpts: function() {
            var r = this.getAnchorTargetCheckbox(), i = this.getAnchorButtonCheckbox(), o = {
              value: this.getInput().value.trim()
            };
            return this.linkValidation && (o.value = this.checkLinkFormat(o.value)), o.target = "_self", r && r.checked && (o.target = "_blank"), i && i.checked && (o.buttonClass = this.customClassOption), o;
          },
          doFormSave: function() {
            var r = this.getFormOpts();
            this.completeFormSave(r);
          },
          completeFormSave: function(r) {
            this.base.restoreSelection(), this.execAction(this.action, r), this.base.checkSelection();
          },
          ensureEncodedUri: function(r) {
            return r === decodeURI(r) ? encodeURI(r) : r;
          },
          ensureEncodedUriComponent: function(r) {
            return r === decodeURIComponent(r) ? encodeURIComponent(r) : r;
          },
          ensureEncodedParam: function(r) {
            var i = r.split("="), o = i[0], a = i[1];
            return o + (a === void 0 ? "" : "=" + this.ensureEncodedUriComponent(a));
          },
          ensureEncodedQuery: function(r) {
            return r.split("&").map(this.ensureEncodedParam.bind(this)).join("&");
          },
          checkLinkFormat: function(r) {
            var i = /^([a-z]+:)?\/\/|^(mailto|tel|maps):|^\#/i, o = i.test(r), a = "", s = /^\+?\s?\(?(?:\d\s?\-?\)?){3,20}$/, l = r.match(/^(.*?)(?:\?(.*?))?(?:#(.*))?$/), u = l[1], f = l[2], c = l[3];
            if (s.test(r))
              return "tel:" + r;
            if (!o) {
              var d = u.split("/")[0];
              (d.match(/.+(\.|:).+/) || d === "localhost") && (a = "http://");
            }
            return a + // Ensure path is encoded
            this.ensureEncodedUri(u) + // Ensure query is encoded
            (f === void 0 ? "" : "?" + this.ensureEncodedQuery(f)) + // Include fragment unencoded as encodeUriComponent is too
            // heavy handed for the many characters allowed in a fragment
            (c === void 0 ? "" : "#" + c);
          },
          doFormCancel: function() {
            this.base.restoreSelection(), this.base.checkSelection();
          },
          // form creation and event handling
          attachFormEvents: function(r) {
            var i = r.querySelector(".medium-editor-toolbar-close"), o = r.querySelector(".medium-editor-toolbar-save"), a = r.querySelector(".medium-editor-toolbar-input");
            this.on(r, "click", this.handleFormClick.bind(this)), this.on(a, "keyup", this.handleTextboxKeyup.bind(this)), this.on(i, "click", this.handleCloseClick.bind(this)), this.on(o, "click", this.handleSaveClick.bind(this), !0);
          },
          createForm: function() {
            var r = this.document, i = r.createElement("div");
            return i.className = "medium-editor-toolbar-form", i.id = "medium-editor-toolbar-form-anchor-" + this.getEditorId(), i.innerHTML = this.getTemplate(), this.attachFormEvents(i), i;
          },
          getInput: function() {
            return this.getForm().querySelector("input.medium-editor-toolbar-input");
          },
          getAnchorTargetCheckbox: function() {
            return this.getForm().querySelector(".medium-editor-toolbar-anchor-target");
          },
          getAnchorButtonCheckbox: function() {
            return this.getForm().querySelector(".medium-editor-toolbar-anchor-button");
          },
          handleTextboxKeyup: function(r) {
            if (r.keyCode === e.util.keyCode.ENTER) {
              r.preventDefault(), this.doFormSave();
              return;
            }
            r.keyCode === e.util.keyCode.ESCAPE && (r.preventDefault(), this.doFormCancel());
          },
          handleFormClick: function(r) {
            r.stopPropagation();
          },
          handleSaveClick: function(r) {
            r.preventDefault(), this.doFormSave();
          },
          handleCloseClick: function(r) {
            r.preventDefault(), this.doFormCancel();
          }
        });
        e.extensions.anchor = n;
      }(), function() {
        var n = e.Extension.extend({
          name: "anchor-preview",
          // Anchor Preview Options
          /* hideDelay: [number]  (previously options.anchorPreviewHideDelay)
           * time in milliseconds to show the anchor tag preview after the mouse has left the anchor tag.
           */
          hideDelay: 500,
          /* previewValueSelector: [string]
           * the default selector to locate where to put the activeAnchor value in the preview
           */
          previewValueSelector: "a",
          /* showWhenToolbarIsVisible: [boolean]
           * determines whether the anchor tag preview shows up when the toolbar is visible
           */
          showWhenToolbarIsVisible: !1,
          /* showOnEmptyLinks: [boolean]
          * determines whether the anchor tag preview shows up on links with href="" or href="#something"
          */
          showOnEmptyLinks: !0,
          init: function() {
            this.anchorPreview = this.createPreview(), this.getEditorOption("elementsContainer").appendChild(this.anchorPreview), this.attachToEditables();
          },
          getInteractionElements: function() {
            return this.getPreviewElement();
          },
          // TODO: Remove this function in 6.0.0
          getPreviewElement: function() {
            return this.anchorPreview;
          },
          createPreview: function() {
            var r = this.document.createElement("div");
            return r.id = "medium-editor-anchor-preview-" + this.getEditorId(), r.className = "medium-editor-anchor-preview", r.innerHTML = this.getTemplate(), this.on(r, "click", this.handleClick.bind(this)), r;
          },
          getTemplate: function() {
            return '<div class="medium-editor-toolbar-anchor-preview" id="medium-editor-toolbar-anchor-preview">    <a class="medium-editor-toolbar-anchor-preview-inner"></a></div>';
          },
          destroy: function() {
            this.anchorPreview && (this.anchorPreview.parentNode && this.anchorPreview.parentNode.removeChild(this.anchorPreview), delete this.anchorPreview);
          },
          hidePreview: function() {
            this.anchorPreview && this.anchorPreview.classList.remove("medium-editor-anchor-preview-active"), this.activeAnchor = null;
          },
          showPreview: function(r) {
            return this.anchorPreview.classList.contains("medium-editor-anchor-preview-active") || r.getAttribute("data-disable-preview") ? !0 : (this.previewValueSelector && (this.anchorPreview.querySelector(this.previewValueSelector).textContent = r.attributes.href.value, this.anchorPreview.querySelector(this.previewValueSelector).href = r.attributes.href.value), this.anchorPreview.classList.add("medium-toolbar-arrow-over"), this.anchorPreview.classList.remove("medium-toolbar-arrow-under"), this.anchorPreview.classList.contains("medium-editor-anchor-preview-active") || this.anchorPreview.classList.add("medium-editor-anchor-preview-active"), this.activeAnchor = r, this.positionPreview(), this.attachPreviewHandlers(), this);
          },
          positionPreview: function(r) {
            r = r || this.activeAnchor;
            var i = this.window.innerWidth, o = this.anchorPreview.offsetHeight, a = r.getBoundingClientRect(), s = this.diffLeft, l = this.diffTop, u = this.getEditorOption("elementsContainer"), f = ["absolute", "fixed"].indexOf(window.getComputedStyle(u).getPropertyValue("position")) > -1, c = {}, d, h, v, p, g;
            d = this.anchorPreview.offsetWidth / 2;
            var y = this.base.getExtensionByName("toolbar");
            y && (s = y.diffLeft, l = y.diffTop), h = s - d, f ? (p = u.getBoundingClientRect(), ["top", "left"].forEach(function(m) {
              c[m] = a[m] - p[m];
            }), c.width = a.width, c.height = a.height, a = c, i = p.width, g = u.scrollTop) : g = this.window.pageYOffset, v = a.left + a.width / 2, g += o + a.top + a.height - l - this.anchorPreview.offsetHeight, this.anchorPreview.style.top = Math.round(g) + "px", this.anchorPreview.style.right = "initial", v < d ? (this.anchorPreview.style.left = h + d + "px", this.anchorPreview.style.right = "initial") : i - v < d ? (this.anchorPreview.style.left = "auto", this.anchorPreview.style.right = 0) : (this.anchorPreview.style.left = h + v + "px", this.anchorPreview.style.right = "initial");
          },
          attachToEditables: function() {
            this.subscribe("editableMouseover", this.handleEditableMouseover.bind(this)), this.subscribe("positionedToolbar", this.handlePositionedToolbar.bind(this));
          },
          handlePositionedToolbar: function() {
            this.showWhenToolbarIsVisible || this.hidePreview();
          },
          handleClick: function(r) {
            var i = this.base.getExtensionByName("anchor"), o = this.activeAnchor;
            i && o && (r.preventDefault(), this.base.selectElement(this.activeAnchor), this.base.delay((function() {
              if (o) {
                var a = {
                  value: o.attributes.href.value,
                  target: o.getAttribute("target"),
                  buttonClass: o.getAttribute("class")
                };
                i.showForm(a), o = null;
              }
            }).bind(this))), this.hidePreview();
          },
          handleAnchorMouseout: function() {
            this.anchorToPreview = null, this.off(this.activeAnchor, "mouseout", this.instanceHandleAnchorMouseout), this.instanceHandleAnchorMouseout = null;
          },
          handleEditableMouseover: function(r) {
            var i = e.util.getClosestTag(r.target, "a");
            if (i !== !1) {
              if (!this.showOnEmptyLinks && (!/href=["']\S+["']/.test(i.outerHTML) || /href=["']#\S+["']/.test(i.outerHTML)))
                return !0;
              var o = this.base.getExtensionByName("toolbar");
              if (!this.showWhenToolbarIsVisible && o && o.isDisplayed && o.isDisplayed())
                return !0;
              this.activeAnchor && this.activeAnchor !== i && this.detachPreviewHandlers(), this.anchorToPreview = i, this.instanceHandleAnchorMouseout = this.handleAnchorMouseout.bind(this), this.on(this.anchorToPreview, "mouseout", this.instanceHandleAnchorMouseout), this.base.delay((function() {
                this.anchorToPreview && this.showPreview(this.anchorToPreview);
              }).bind(this));
            }
          },
          handlePreviewMouseover: function() {
            this.lastOver = (/* @__PURE__ */ new Date()).getTime(), this.hovering = !0;
          },
          handlePreviewMouseout: function(r) {
            (!r.relatedTarget || !/anchor-preview/.test(r.relatedTarget.className)) && (this.hovering = !1);
          },
          updatePreview: function() {
            if (this.hovering)
              return !0;
            var r = (/* @__PURE__ */ new Date()).getTime() - this.lastOver;
            r > this.hideDelay && this.detachPreviewHandlers();
          },
          detachPreviewHandlers: function() {
            clearInterval(this.intervalTimer), this.instanceHandlePreviewMouseover && (this.off(this.anchorPreview, "mouseover", this.instanceHandlePreviewMouseover), this.off(this.anchorPreview, "mouseout", this.instanceHandlePreviewMouseout), this.activeAnchor && (this.off(this.activeAnchor, "mouseover", this.instanceHandlePreviewMouseover), this.off(this.activeAnchor, "mouseout", this.instanceHandlePreviewMouseout))), this.hidePreview(), this.hovering = this.instanceHandlePreviewMouseover = this.instanceHandlePreviewMouseout = null;
          },
          // TODO: break up method and extract out handlers
          attachPreviewHandlers: function() {
            this.lastOver = (/* @__PURE__ */ new Date()).getTime(), this.hovering = !0, this.instanceHandlePreviewMouseover = this.handlePreviewMouseover.bind(this), this.instanceHandlePreviewMouseout = this.handlePreviewMouseout.bind(this), this.intervalTimer = setInterval(this.updatePreview.bind(this), 200), this.on(this.anchorPreview, "mouseover", this.instanceHandlePreviewMouseover), this.on(this.anchorPreview, "mouseout", this.instanceHandlePreviewMouseout), this.on(this.activeAnchor, "mouseover", this.instanceHandlePreviewMouseover), this.on(this.activeAnchor, "mouseout", this.instanceHandlePreviewMouseout);
          }
        });
        e.extensions.anchorPreview = n;
      }(), function() {
        var n, r, i, o, a;
        n = [
          " ",
          "	",
          `
`,
          "\r",
          " ",
          " ",
          " ",
          " ",
          " ",
          "\u2028",
          "\u2029"
        ], r = "com|net|org|edu|gov|mil|aero|asia|biz|cat|coop|info|int|jobs|mobi|museum|name|post|pro|tel|travel|xxx|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cs|cu|cv|cx|cy|cz|dd|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|ja|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw", i = "(((?:(https?://|ftps?://|nntp://)|www\\d{0,3}[.]|[a-z0-9.\\-]+[.](" + r + ")\\/)\\S+(?:[^\\s`!\\[\\]{};:'\".,?«»“”‘’])))|(([a-z0-9\\-]+\\.)?[a-z0-9\\-]+\\.(" + r + "))", o = new RegExp("^(" + r + ")$", "i"), a = new RegExp(i, "gi");
        function s(u) {
          return !e.util.getClosestTag(u, "a");
        }
        var l = e.Extension.extend({
          init: function() {
            e.Extension.prototype.init.apply(this, arguments), this.disableEventHandling = !1, this.subscribe("editableKeypress", this.onKeypress.bind(this)), this.subscribe("editableBlur", this.onBlur.bind(this)), this.document.execCommand("AutoUrlDetect", !1, !1);
          },
          isLastInstance: function() {
            for (var u = 0, f = 0; f < this.window._mediumEditors.length; f++) {
              var c = this.window._mediumEditors[f];
              c !== null && c.getExtensionByName("autoLink") !== void 0 && u++;
            }
            return u === 1;
          },
          destroy: function() {
            this.document.queryCommandSupported("AutoUrlDetect") && this.isLastInstance() && this.document.execCommand("AutoUrlDetect", !1, !0);
          },
          onBlur: function(u, f) {
            this.performLinking(f);
          },
          onKeypress: function(u) {
            this.disableEventHandling || e.util.isKey(u, [e.util.keyCode.SPACE, e.util.keyCode.ENTER]) && (clearTimeout(this.performLinkingTimeout), this.performLinkingTimeout = setTimeout((function() {
              try {
                var f = this.base.exportSelection();
                this.performLinking(u.target) && this.base.importSelection(f, !0);
              } catch (c) {
                window.console && window.console.error("Failed to perform linking", c), this.disableEventHandling = !0;
              }
            }).bind(this), 0));
          },
          performLinking: function(u) {
            var f = e.util.splitByBlockElements(u), c = !1;
            f.length === 0 && (f = [u]);
            for (var d = 0; d < f.length; d++)
              c = this.removeObsoleteAutoLinkSpans(f[d]) || c, c = this.performLinkingWithinElement(f[d]) || c;
            return this.base.events.updateInput(u, { target: u, currentTarget: u }), c;
          },
          removeObsoleteAutoLinkSpans: function(u) {
            if (!u || u.nodeType === 3)
              return !1;
            for (var f = u.querySelectorAll('span[data-auto-link="true"]'), c = !1, d = 0; d < f.length; d++) {
              var h = f[d].textContent;
              if (h.indexOf("://") === -1 && (h = e.util.ensureUrlHasProtocol(h)), f[d].getAttribute("data-href") !== h && s(f[d])) {
                c = !0;
                var v = h.replace(/\s+$/, "");
                if (f[d].getAttribute("data-href") === v) {
                  var p = h.length - v.length, g = e.util.splitOffDOMTree(f[d], this.splitTextBeforeEnd(f[d], p));
                  f[d].parentNode.insertBefore(g, f[d].nextSibling);
                } else
                  e.util.unwrap(f[d], this.document);
              }
            }
            return c;
          },
          splitTextBeforeEnd: function(u, f) {
            for (var c = this.document.createTreeWalker(u, NodeFilter.SHOW_TEXT, null, !1), d = !0; d; )
              d = c.lastChild() !== null;
            for (var h, v, p; f > 0 && p !== null; )
              h = c.currentNode, v = h.nodeValue, v.length > f ? (p = h.splitText(v.length - f), f = 0) : (p = c.previousNode(), f -= v.length);
            return p;
          },
          performLinkingWithinElement: function(u) {
            for (var f = this.findLinkableText(u), c = !1, d = 0; d < f.length; d++) {
              var h = e.util.findOrCreateMatchingTextNodes(
                this.document,
                u,
                f[d]
              );
              this.shouldNotLink(h) || this.createAutoLink(h, f[d].href);
            }
            return c;
          },
          shouldNotLink: function(u) {
            for (var f = !1, c = 0; c < u.length && f === !1; c++)
              f = !!e.util.traverseUp(u[c], function(d) {
                return d.nodeName.toLowerCase() === "a" || d.getAttribute && d.getAttribute("data-auto-link") === "true";
              });
            return f;
          },
          findLinkableText: function(u) {
            for (var f = u.textContent, c = null, d = []; (c = a.exec(f)) !== null; ) {
              var h = !0, v = c.index + c[0].length;
              h = (c.index === 0 || n.indexOf(f[c.index - 1]) !== -1) && (v === f.length || n.indexOf(f[v]) !== -1), h = h && (c[0].indexOf("/") !== -1 || o.test(c[0].split(".").pop().split("?").shift())), h && d.push({
                href: c[0],
                start: c.index,
                end: v
              });
            }
            return d;
          },
          createAutoLink: function(u, f) {
            f = e.util.ensureUrlHasProtocol(f);
            var c = e.util.createLink(this.document, u, f, this.getEditorOption("targetBlank") ? "_blank" : null), d = this.document.createElement("span");
            for (d.setAttribute("data-auto-link", "true"), d.setAttribute("data-href", f), c.insertBefore(d, c.firstChild); c.childNodes.length > 1; )
              d.appendChild(c.childNodes[1]);
          }
        });
        e.extensions.autoLink = l;
      }(), function() {
        var n = "medium-editor-dragover";
        function r(o) {
          var a = e.util.getContainerEditorElement(o), s = Array.prototype.slice.call(a.parentElement.querySelectorAll("." + n));
          s.forEach(function(l) {
            l.classList.remove(n);
          });
        }
        var i = e.Extension.extend({
          name: "fileDragging",
          allowedTypes: ["image"],
          init: function() {
            e.Extension.prototype.init.apply(this, arguments), this.subscribe("editableDrag", this.handleDrag.bind(this)), this.subscribe("editableDrop", this.handleDrop.bind(this));
          },
          handleDrag: function(o) {
            o.preventDefault(), o.dataTransfer.dropEffect = "copy";
            var a = o.target.classList ? o.target : o.target.parentElement;
            r(a), o.type === "dragover" && a.classList.add(n);
          },
          handleDrop: function(o) {
            o.preventDefault(), o.stopPropagation(), this.base.selectElement(o.target);
            var a = this.base.exportSelection();
            a.start = a.end, this.base.importSelection(a), o.dataTransfer.files && Array.prototype.slice.call(o.dataTransfer.files).forEach(function(s) {
              this.isAllowedFile(s) && s.type.match("image") && this.insertImageFile(s);
            }, this), r(o.target);
          },
          isAllowedFile: function(o) {
            return this.allowedTypes.some(function(a) {
              return !!o.type.match(a);
            });
          },
          insertImageFile: function(o) {
            if (typeof FileReader == "function") {
              var a = new FileReader();
              a.readAsDataURL(o), a.addEventListener("load", (function(s) {
                var l = this.document.createElement("img");
                l.src = s.target.result, e.util.insertHTMLCommand(this.document, l.outerHTML);
              }).bind(this));
            }
          }
        });
        e.extensions.fileDragging = i;
      }(), function() {
        var n = e.Extension.extend({
          name: "keyboard-commands",
          /* KeyboardCommands Options */
          /* commands: [Array]
           * Array of objects describing each command and the combination of keys that will trigger it
           * Required for each object:
           *   command [String] (argument passed to editor.execAction())
           *   key [String] (keyboard character that triggers this command)
           *   meta [boolean] (whether the ctrl/meta key has to be active or inactive)
           *   shift [boolean] (whether the shift key has to be active or inactive)
           *   alt [boolean] (whether the alt key has to be active or inactive)
           */
          commands: [
            {
              command: "bold",
              key: "B",
              meta: !0,
              shift: !1,
              alt: !1
            },
            {
              command: "italic",
              key: "I",
              meta: !0,
              shift: !1,
              alt: !1
            },
            {
              command: "underline",
              key: "U",
              meta: !0,
              shift: !1,
              alt: !1
            }
          ],
          init: function() {
            e.Extension.prototype.init.apply(this, arguments), this.subscribe("editableKeydown", this.handleKeydown.bind(this)), this.keys = {}, this.commands.forEach(function(r) {
              var i = r.key.charCodeAt(0);
              this.keys[i] || (this.keys[i] = []), this.keys[i].push(r);
            }, this);
          },
          handleKeydown: function(r) {
            var i = e.util.getKeyCode(r);
            if (this.keys[i]) {
              var o = e.util.isMetaCtrlKey(r), a = !!r.shiftKey, s = !!r.altKey;
              this.keys[i].forEach(function(l) {
                l.meta === o && l.shift === a && (l.alt === s || l.alt === void 0) && (r.preventDefault(), r.stopPropagation(), typeof l.command == "function" ? l.command.apply(this) : l.command !== !1 && this.execAction(l.command));
              }, this);
            }
          }
        });
        e.extensions.keyboardCommands = n;
      }(), function() {
        var n = e.extensions.form.extend({
          name: "fontname",
          action: "fontName",
          aria: "change font name",
          contentDefault: "&#xB1;",
          // ±
          contentFA: '<i class="fa fa-font"></i>',
          fonts: ["", "Arial", "Verdana", "Times New Roman"],
          init: function() {
            e.extensions.form.prototype.init.apply(this, arguments);
          },
          // Called when the button the toolbar is clicked
          // Overrides ButtonExtension.handleClick
          handleClick: function(r) {
            if (r.preventDefault(), r.stopPropagation(), !this.isDisplayed()) {
              var i = this.document.queryCommandValue("fontName") + "";
              this.showForm(i);
            }
            return !1;
          },
          // Called by medium-editor to append form to the toolbar
          getForm: function() {
            return this.form || (this.form = this.createForm()), this.form;
          },
          // Used by medium-editor when the default toolbar is to be displayed
          isDisplayed: function() {
            return this.getForm().style.display === "block";
          },
          hideForm: function() {
            this.getForm().style.display = "none", this.getSelect().value = "";
          },
          showForm: function(r) {
            var i = this.getSelect();
            this.base.saveSelection(), this.hideToolbarDefaultActions(), this.getForm().style.display = "block", this.setToolbarPosition(), i.value = r || "", i.focus();
          },
          // Called by core when tearing down medium-editor (destroy)
          destroy: function() {
            if (!this.form)
              return !1;
            this.form.parentNode && this.form.parentNode.removeChild(this.form), delete this.form;
          },
          // core methods
          doFormSave: function() {
            this.base.restoreSelection(), this.base.checkSelection();
          },
          doFormCancel: function() {
            this.base.restoreSelection(), this.clearFontName(), this.base.checkSelection();
          },
          // form creation and event handling
          createForm: function() {
            var r = this.document, i = r.createElement("div"), o = r.createElement("select"), a = r.createElement("a"), s = r.createElement("a"), l;
            i.className = "medium-editor-toolbar-form", i.id = "medium-editor-toolbar-form-fontname-" + this.getEditorId(), this.on(i, "click", this.handleFormClick.bind(this));
            for (var u = 0; u < this.fonts.length; u++)
              l = r.createElement("option"), l.innerHTML = this.fonts[u], l.value = this.fonts[u], o.appendChild(l);
            return o.className = "medium-editor-toolbar-select", i.appendChild(o), this.on(o, "change", this.handleFontChange.bind(this)), s.setAttribute("href", "#"), s.className = "medium-editor-toobar-save", s.innerHTML = this.getEditorOption("buttonLabels") === "fontawesome" ? '<i class="fa fa-check"></i>' : "&#10003;", i.appendChild(s), this.on(s, "click", this.handleSaveClick.bind(this), !0), a.setAttribute("href", "#"), a.className = "medium-editor-toobar-close", a.innerHTML = this.getEditorOption("buttonLabels") === "fontawesome" ? '<i class="fa fa-times"></i>' : "&times;", i.appendChild(a), this.on(a, "click", this.handleCloseClick.bind(this)), i;
          },
          getSelect: function() {
            return this.getForm().querySelector("select.medium-editor-toolbar-select");
          },
          clearFontName: function() {
            e.selection.getSelectedElements(this.document).forEach(function(r) {
              r.nodeName.toLowerCase() === "font" && r.hasAttribute("face") && r.removeAttribute("face");
            });
          },
          handleFontChange: function() {
            var r = this.getSelect().value;
            r === "" ? this.clearFontName() : this.execAction("fontName", { value: r });
          },
          handleFormClick: function(r) {
            r.stopPropagation();
          },
          handleSaveClick: function(r) {
            r.preventDefault(), this.doFormSave();
          },
          handleCloseClick: function(r) {
            r.preventDefault(), this.doFormCancel();
          }
        });
        e.extensions.fontName = n;
      }(), function() {
        var n = e.extensions.form.extend({
          name: "fontsize",
          action: "fontSize",
          aria: "increase/decrease font size",
          contentDefault: "&#xB1;",
          // ±
          contentFA: '<i class="fa fa-text-height"></i>',
          init: function() {
            e.extensions.form.prototype.init.apply(this, arguments);
          },
          // Called when the button the toolbar is clicked
          // Overrides ButtonExtension.handleClick
          handleClick: function(r) {
            if (r.preventDefault(), r.stopPropagation(), !this.isDisplayed()) {
              var i = this.document.queryCommandValue("fontSize") + "";
              this.showForm(i);
            }
            return !1;
          },
          // Called by medium-editor to append form to the toolbar
          getForm: function() {
            return this.form || (this.form = this.createForm()), this.form;
          },
          // Used by medium-editor when the default toolbar is to be displayed
          isDisplayed: function() {
            return this.getForm().style.display === "block";
          },
          hideForm: function() {
            this.getForm().style.display = "none", this.getInput().value = "";
          },
          showForm: function(r) {
            var i = this.getInput();
            this.base.saveSelection(), this.hideToolbarDefaultActions(), this.getForm().style.display = "block", this.setToolbarPosition(), i.value = r || "", i.focus();
          },
          // Called by core when tearing down medium-editor (destroy)
          destroy: function() {
            if (!this.form)
              return !1;
            this.form.parentNode && this.form.parentNode.removeChild(this.form), delete this.form;
          },
          // core methods
          doFormSave: function() {
            this.base.restoreSelection(), this.base.checkSelection();
          },
          doFormCancel: function() {
            this.base.restoreSelection(), this.clearFontSize(), this.base.checkSelection();
          },
          // form creation and event handling
          createForm: function() {
            var r = this.document, i = r.createElement("div"), o = r.createElement("input"), a = r.createElement("a"), s = r.createElement("a");
            return i.className = "medium-editor-toolbar-form", i.id = "medium-editor-toolbar-form-fontsize-" + this.getEditorId(), this.on(i, "click", this.handleFormClick.bind(this)), o.setAttribute("type", "range"), o.setAttribute("min", "1"), o.setAttribute("max", "7"), o.className = "medium-editor-toolbar-input", i.appendChild(o), this.on(o, "change", this.handleSliderChange.bind(this)), s.setAttribute("href", "#"), s.className = "medium-editor-toobar-save", s.innerHTML = this.getEditorOption("buttonLabels") === "fontawesome" ? '<i class="fa fa-check"></i>' : "&#10003;", i.appendChild(s), this.on(s, "click", this.handleSaveClick.bind(this), !0), a.setAttribute("href", "#"), a.className = "medium-editor-toobar-close", a.innerHTML = this.getEditorOption("buttonLabels") === "fontawesome" ? '<i class="fa fa-times"></i>' : "&times;", i.appendChild(a), this.on(a, "click", this.handleCloseClick.bind(this)), i;
          },
          getInput: function() {
            return this.getForm().querySelector("input.medium-editor-toolbar-input");
          },
          clearFontSize: function() {
            e.selection.getSelectedElements(this.document).forEach(function(r) {
              r.nodeName.toLowerCase() === "font" && r.hasAttribute("size") && r.removeAttribute("size");
            });
          },
          handleSliderChange: function() {
            var r = this.getInput().value;
            r === "4" ? this.clearFontSize() : this.execAction("fontSize", { value: r });
          },
          handleFormClick: function(r) {
            r.stopPropagation();
          },
          handleSaveClick: function(r) {
            r.preventDefault(), this.doFormSave();
          },
          handleCloseClick: function(r) {
            r.preventDefault(), this.doFormCancel();
          }
        });
        e.extensions.fontSize = n;
      }(), function() {
        var n = "%ME_PASTEBIN%", r = null, i = null, o = function(u) {
          u.stopPropagation();
        };
        function a() {
          return [
            // Remove anything but the contents within the BODY element
            [new RegExp(/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/g), ""],
            // cleanup comments added by Chrome when pasting html
            [new RegExp(/<!--StartFragment-->|<!--EndFragment-->/g), ""],
            // Trailing BR elements
            [new RegExp(/<br>$/i), ""],
            // replace two bogus tags that begin pastes from google docs
            [new RegExp(/<[^>]*docs-internal-guid[^>]*>/gi), ""],
            [new RegExp(/<\/b>(<br[^>]*>)?$/gi), ""],
            // un-html spaces and newlines inserted by OS X
            [new RegExp(/<span class="Apple-converted-space">\s+<\/span>/g), " "],
            [new RegExp(/<br class="Apple-interchange-newline">/g), "<br>"],
            // replace google docs italics+bold with a span to be replaced once the html is inserted
            [new RegExp(/<span[^>]*(font-style:italic;font-weight:(bold|700)|font-weight:(bold|700);font-style:italic)[^>]*>/gi), '<span class="replace-with italic bold">'],
            // replace google docs italics with a span to be replaced once the html is inserted
            [new RegExp(/<span[^>]*font-style:italic[^>]*>/gi), '<span class="replace-with italic">'],
            //[replace google docs bolds with a span to be replaced once the html is inserted
            [new RegExp(/<span[^>]*font-weight:(bold|700)[^>]*>/gi), '<span class="replace-with bold">'],
            // replace manually entered b/i/a tags with real ones
            [new RegExp(/&lt;(\/?)(i|b|a)&gt;/gi), "<$1$2>"],
            // replace manually a tags with real ones, converting smart-quotes from google docs
            [new RegExp(/&lt;a(?:(?!href).)+href=(?:&quot;|&rdquo;|&ldquo;|"|“|”)(((?!&quot;|&rdquo;|&ldquo;|"|“|”).)*)(?:&quot;|&rdquo;|&ldquo;|"|“|”)(?:(?!&gt;).)*&gt;/gi), '<a href="$1">'],
            // Newlines between paragraphs in html have no syntactic value,
            // but then have a tendency to accidentally become additional paragraphs down the line
            [new RegExp(/<\/p>\n+/gi), "</p>"],
            [new RegExp(/\n+<p/gi), "<p"],
            // Microsoft Word makes these odd tags, like <o:p></o:p>
            [new RegExp(/<\/?o:[a-z]*>/gi), ""],
            // Microsoft Word adds some special elements around list items
            [new RegExp(/<!\[if !supportLists\]>(((?!<!).)*)<!\[endif]\>/gi), "$1"]
          ];
        }
        function s(u, f, c) {
          var d = u.clipboardData || f.clipboardData || c.dataTransfer, h = {};
          if (!d)
            return h;
          if (d.getData) {
            var v = d.getData("Text");
            v && v.length > 0 && (h["text/plain"] = v);
          }
          if (d.types)
            for (var p = 0; p < d.types.length; p++) {
              var g = d.types[p];
              h[g] = d.getData(g);
            }
          return h;
        }
        var l = e.Extension.extend({
          /* Paste Options */
          /* forcePlainText: [boolean]
           * Forces pasting as plain text.
           */
          forcePlainText: !0,
          /* cleanPastedHTML: [boolean]
           * cleans pasted content from different sources, like google docs etc.
           */
          cleanPastedHTML: !1,
          /* preCleanReplacements: [Array]
           * custom pairs (2 element arrays) of RegExp and replacement text to use during past when
           * __forcePlainText__ or __cleanPastedHTML__ are `true` OR when calling `cleanPaste(text)` helper method.
           * These replacements are executed before any medium editor defined replacements.
           */
          preCleanReplacements: [],
          /* cleanReplacements: [Array]
           * custom pairs (2 element arrays) of RegExp and replacement text to use during paste when
           * __forcePlainText__ or __cleanPastedHTML__ are `true` OR when calling `cleanPaste(text)` helper method.
           * These replacements are executed after any medium editor defined replacements.
           */
          cleanReplacements: [],
          /* cleanAttrs:: [Array]
           * list of element attributes to remove during paste when __cleanPastedHTML__ is `true` or when
           * calling `cleanPaste(text)` or `pasteHTML(html, options)` helper methods.
           */
          cleanAttrs: ["class", "style", "dir"],
          /* cleanTags: [Array]
           * list of element tag names to remove during paste when __cleanPastedHTML__ is `true` or when
           * calling `cleanPaste(text)` or `pasteHTML(html, options)` helper methods.
           */
          cleanTags: ["meta"],
          /* unwrapTags: [Array]
           * list of element tag names to unwrap (remove the element tag but retain its child elements)
           * during paste when __cleanPastedHTML__ is `true` or when
           * calling `cleanPaste(text)` or `pasteHTML(html, options)` helper methods.
           */
          unwrapTags: [],
          init: function() {
            e.Extension.prototype.init.apply(this, arguments), (this.forcePlainText || this.cleanPastedHTML) && (this.subscribe("editableKeydown", this.handleKeydown.bind(this)), this.getEditorElements().forEach(function(u) {
              this.on(u, "paste", this.handlePaste.bind(this));
            }, this), this.subscribe("addElement", this.handleAddElement.bind(this)));
          },
          handleAddElement: function(u, f) {
            this.on(f, "paste", this.handlePaste.bind(this));
          },
          destroy: function() {
            (this.forcePlainText || this.cleanPastedHTML) && this.removePasteBin();
          },
          handlePaste: function(u, f) {
            if (!u.defaultPrevented) {
              var c = s(u, this.window, this.document), d = c["text/html"], h = c["text/plain"];
              this.window.clipboardData && u.clipboardData === void 0 && !d && (d = h), (d || h) && (u.preventDefault(), this.doPaste(d, h, f));
            }
          },
          doPaste: function(u, f, c) {
            var d, h = "", v;
            if (this.cleanPastedHTML && u)
              return this.cleanPaste(u);
            if (f) {
              if (this.getEditorOption("disableReturn") || c && c.getAttribute("data-disable-return"))
                h = e.util.htmlEntities(f);
              else if (d = f.split(/[\r\n]+/g), d.length > 1)
                for (v = 0; v < d.length; v += 1)
                  d[v] !== "" && (h += "<p>" + e.util.htmlEntities(d[v]) + "</p>");
              else
                h = e.util.htmlEntities(d[0]);
              e.util.insertHTMLCommand(this.document, h);
            }
          },
          handlePasteBinPaste: function(u) {
            if (u.defaultPrevented) {
              this.removePasteBin();
              return;
            }
            var f = s(u, this.window, this.document), c = f["text/html"], d = f["text/plain"], h = i;
            if (!this.cleanPastedHTML || c) {
              u.preventDefault(), this.removePasteBin(), this.doPaste(c, d, h), this.trigger("editablePaste", { currentTarget: h, target: h }, h);
              return;
            }
            setTimeout((function() {
              this.cleanPastedHTML && (c = this.getPasteBinHtml()), this.removePasteBin(), this.doPaste(c, d, h), this.trigger("editablePaste", { currentTarget: h, target: h }, h);
            }).bind(this), 0);
          },
          handleKeydown: function(u, f) {
            e.util.isKey(u, e.util.keyCode.V) && e.util.isMetaCtrlKey(u) && (u.stopImmediatePropagation(), this.removePasteBin(), this.createPasteBin(f));
          },
          createPasteBin: function(u) {
            var f, c = e.selection.getSelectionRange(this.document), d = this.window.pageYOffset;
            i = u, c && (f = c.getClientRects(), f.length ? d += f[0].top : c.startContainer.getBoundingClientRect !== void 0 ? d += c.startContainer.getBoundingClientRect().top : d += c.getBoundingClientRect().top), r = c;
            var h = this.document.createElement("div");
            h.id = this.pasteBinId = "medium-editor-pastebin-" + +Date.now(), h.setAttribute("style", "border: 1px red solid; position: absolute; top: " + d + "px; width: 10px; height: 10px; overflow: hidden; opacity: 0"), h.setAttribute("contentEditable", !0), h.innerHTML = n, this.document.body.appendChild(h), this.on(h, "focus", o), this.on(h, "focusin", o), this.on(h, "focusout", o), h.focus(), e.selection.selectNode(h, this.document), this.boundHandlePaste || (this.boundHandlePaste = this.handlePasteBinPaste.bind(this)), this.on(h, "paste", this.boundHandlePaste);
          },
          removePasteBin: function() {
            r !== null && (e.selection.selectRange(this.document, r), r = null), i !== null && (i = null);
            var u = this.getPasteBin();
            u && u && (this.off(u, "focus", o), this.off(u, "focusin", o), this.off(u, "focusout", o), this.off(u, "paste", this.boundHandlePaste), u.parentElement.removeChild(u));
          },
          getPasteBin: function() {
            return this.document.getElementById(this.pasteBinId);
          },
          getPasteBinHtml: function() {
            var u = this.getPasteBin();
            if (!u || u.firstChild && u.firstChild.id === "mcepastebin")
              return !1;
            var f = u.innerHTML;
            return !f || f === n ? !1 : f;
          },
          cleanPaste: function(u) {
            var f, c, d, h, v = /<p|<br|<div/.test(u), p = [].concat(
              this.preCleanReplacements || [],
              a(),
              this.cleanReplacements || []
            );
            for (f = 0; f < p.length; f += 1)
              u = u.replace(p[f][0], p[f][1]);
            if (!v)
              return this.pasteHTML(u);
            for (d = this.document.createElement("div"), d.innerHTML = "<p>" + u.split("<br><br>").join("</p><p>") + "</p>", c = d.querySelectorAll("a,p,div,br"), f = 0; f < c.length; f += 1)
              switch (h = c[f], h.innerHTML = h.innerHTML.replace(/\n/gi, " "), h.nodeName.toLowerCase()) {
                case "p":
                case "div":
                  this.filterCommonBlocks(h);
                  break;
                case "br":
                  this.filterLineBreak(h);
                  break;
              }
            this.pasteHTML(d.innerHTML);
          },
          pasteHTML: function(u, f) {
            f = e.util.defaults({}, f, {
              cleanAttrs: this.cleanAttrs,
              cleanTags: this.cleanTags,
              unwrapTags: this.unwrapTags
            });
            var c, d, h, v, p = this.document.createDocumentFragment();
            for (p.appendChild(this.document.createElement("body")), v = p.querySelector("body"), v.innerHTML = u, this.cleanupSpans(v), c = v.querySelectorAll("*"), h = 0; h < c.length; h += 1)
              d = c[h], d.nodeName.toLowerCase() === "a" && this.getEditorOption("targetBlank") && e.util.setTargetBlank(d), e.util.cleanupAttrs(d, f.cleanAttrs), e.util.cleanupTags(d, f.cleanTags), e.util.unwrapTags(d, f.unwrapTags);
            e.util.insertHTMLCommand(this.document, v.innerHTML.replace(/&nbsp;/g, " "));
          },
          // TODO (6.0): Make this an internal helper instead of member of paste handler
          isCommonBlock: function(u) {
            return u && (u.nodeName.toLowerCase() === "p" || u.nodeName.toLowerCase() === "div");
          },
          // TODO (6.0): Make this an internal helper instead of member of paste handler
          filterCommonBlocks: function(u) {
            /^\s*$/.test(u.textContent) && u.parentNode && u.parentNode.removeChild(u);
          },
          // TODO (6.0): Make this an internal helper instead of member of paste handler
          filterLineBreak: function(u) {
            this.isCommonBlock(u.previousElementSibling) ? this.removeWithParent(u) : this.isCommonBlock(u.parentNode) && (u.parentNode.firstChild === u || u.parentNode.lastChild === u) ? this.removeWithParent(u) : u.parentNode && u.parentNode.childElementCount === 1 && u.parentNode.textContent === "" && this.removeWithParent(u);
          },
          // TODO (6.0): Make this an internal helper instead of member of paste handler
          // remove an element, including its parent, if it is the only element within its parent
          removeWithParent: function(u) {
            u && u.parentNode && (u.parentNode.parentNode && u.parentNode.childElementCount === 1 ? u.parentNode.parentNode.removeChild(u.parentNode) : u.parentNode.removeChild(u));
          },
          // TODO (6.0): Make this an internal helper instead of member of paste handler
          cleanupSpans: function(u) {
            var f, c, d, h = u.querySelectorAll(".replace-with"), v = function(p) {
              return p && p.nodeName !== "#text" && p.getAttribute("contenteditable") === "false";
            };
            for (f = 0; f < h.length; f += 1)
              c = h[f], d = this.document.createElement(c.classList.contains("bold") ? "b" : "i"), c.classList.contains("bold") && c.classList.contains("italic") ? d.innerHTML = "<i>" + c.innerHTML + "</i>" : d.innerHTML = c.innerHTML, c.parentNode.replaceChild(d, c);
            for (h = u.querySelectorAll("span"), f = 0; f < h.length; f += 1) {
              if (c = h[f], e.util.traverseUp(c, v))
                return !1;
              e.util.unwrap(c, this.document);
            }
          }
        });
        e.extensions.paste = l;
      }(), function() {
        var n = e.Extension.extend({
          name: "placeholder",
          /* Placeholder Options */
          /* text: [string]
           * Text to display in the placeholder
           */
          text: "Type your text",
          /* hideOnClick: [boolean]
           * Should we hide the placeholder on click (true) or when user starts typing (false)
           */
          hideOnClick: !0,
          init: function() {
            e.Extension.prototype.init.apply(this, arguments), this.initPlaceholders(), this.attachEventHandlers();
          },
          initPlaceholders: function() {
            this.getEditorElements().forEach(this.initElement, this);
          },
          handleAddElement: function(r, i) {
            this.initElement(i);
          },
          initElement: function(r) {
            r.getAttribute("data-placeholder") || r.setAttribute("data-placeholder", this.text), this.updatePlaceholder(r);
          },
          destroy: function() {
            this.getEditorElements().forEach(this.cleanupElement, this);
          },
          handleRemoveElement: function(r, i) {
            this.cleanupElement(i);
          },
          cleanupElement: function(r) {
            r.getAttribute("data-placeholder") === this.text && r.removeAttribute("data-placeholder");
          },
          showPlaceholder: function(r) {
            r && (e.util.isFF && r.childNodes.length === 0 ? (r.classList.add("medium-editor-placeholder-relative"), r.classList.remove("medium-editor-placeholder")) : (r.classList.add("medium-editor-placeholder"), r.classList.remove("medium-editor-placeholder-relative")));
          },
          hidePlaceholder: function(r) {
            r && (r.classList.remove("medium-editor-placeholder"), r.classList.remove("medium-editor-placeholder-relative"));
          },
          updatePlaceholder: function(r, i) {
            if (r.querySelector("img, blockquote, ul, ol, table") || r.textContent.replace(/^\s+|\s+$/g, "") !== "")
              return this.hidePlaceholder(r);
            i || this.showPlaceholder(r);
          },
          attachEventHandlers: function() {
            this.hideOnClick && this.subscribe("focus", this.handleFocus.bind(this)), this.subscribe("editableInput", this.handleInput.bind(this)), this.subscribe("blur", this.handleBlur.bind(this)), this.subscribe("addElement", this.handleAddElement.bind(this)), this.subscribe("removeElement", this.handleRemoveElement.bind(this));
          },
          handleInput: function(r, i) {
            var o = this.hideOnClick && i === this.base.getFocusedElement();
            this.updatePlaceholder(i, o);
          },
          handleFocus: function(r, i) {
            this.hidePlaceholder(i);
          },
          handleBlur: function(r, i) {
            this.updatePlaceholder(i);
          }
        });
        e.extensions.placeholder = n;
      }(), function() {
        var n = e.Extension.extend({
          name: "toolbar",
          /* Toolbar Options */
          /* align: ['left'|'center'|'right']
           * When the __static__ option is true, this aligns the static toolbar
           * relative to the medium-editor element.
           */
          align: "center",
          /* allowMultiParagraphSelection: [boolean]
           * enables/disables whether the toolbar should be displayed when
           * selecting multiple paragraphs/block elements
           */
          allowMultiParagraphSelection: !0,
          /* buttons: [Array]
           * the names of the set of buttons to display on the toolbar.
           */
          buttons: ["bold", "italic", "underline", "anchor", "h2", "h3", "quote"],
          /* diffLeft: [Number]
           * value in pixels to be added to the X axis positioning of the toolbar.
           */
          diffLeft: 0,
          /* diffTop: [Number]
           * value in pixels to be added to the Y axis positioning of the toolbar.
           */
          diffTop: -10,
          /* firstButtonClass: [string]
           * CSS class added to the first button in the toolbar.
           */
          firstButtonClass: "medium-editor-button-first",
          /* lastButtonClass: [string]
           * CSS class added to the last button in the toolbar.
           */
          lastButtonClass: "medium-editor-button-last",
          /* standardizeSelectionStart: [boolean]
           * enables/disables standardizing how the beginning of a range is decided
           * between browsers whenever the selected text is analyzed for updating toolbar buttons status.
           */
          standardizeSelectionStart: !1,
          /* static: [boolean]
           * enable/disable the toolbar always displaying in the same location
           * relative to the medium-editor element.
           */
          static: !1,
          /* sticky: [boolean]
           * When the __static__ option is true, this enables/disables the toolbar
           * "sticking" to the viewport and staying visible on the screen while
           * the page scrolls.
           */
          sticky: !1,
          /* stickyTopOffset: [Number]
           * Value in pixel of the top offset above the toolbar
           */
          stickyTopOffset: 0,
          /* updateOnEmptySelection: [boolean]
           * When the __static__ option is true, this enables/disables updating
           * the state of the toolbar buttons even when the selection is collapsed
           * (there is no selection, just a cursor).
           */
          updateOnEmptySelection: !1,
          /* relativeContainer: [node]
           * appending the toolbar to a given node instead of body
           */
          relativeContainer: null,
          init: function() {
            e.Extension.prototype.init.apply(this, arguments), this.initThrottledMethods(), this.relativeContainer ? this.relativeContainer.appendChild(this.getToolbarElement()) : this.getEditorOption("elementsContainer").appendChild(this.getToolbarElement());
          },
          // Helper method to execute method for every extension, but ignoring the toolbar extension
          forEachExtension: function(r, i) {
            return this.base.extensions.forEach(function(o) {
              if (o !== this)
                return r.apply(i || this, arguments);
            }, this);
          },
          // Toolbar creation/deletion
          createToolbar: function() {
            var r = this.document.createElement("div");
            return r.id = "medium-editor-toolbar-" + this.getEditorId(), r.className = "medium-editor-toolbar", this.static ? r.className += " static-toolbar" : this.relativeContainer ? r.className += " medium-editor-relative-toolbar" : r.className += " medium-editor-stalker-toolbar", r.appendChild(this.createToolbarButtons()), this.forEachExtension(function(i) {
              i.hasForm && r.appendChild(i.getForm());
            }), this.attachEventHandlers(), r;
          },
          createToolbarButtons: function() {
            var r = this.document.createElement("ul"), i, o, a, s, l, u;
            return r.id = "medium-editor-toolbar-actions" + this.getEditorId(), r.className = "medium-editor-toolbar-actions", r.style.display = "block", this.buttons.forEach(function(f) {
              typeof f == "string" ? (l = f, u = null) : (l = f.name, u = f), s = this.base.addBuiltInExtension(l, u), s && typeof s.getButton == "function" && (o = s.getButton(this.base), i = this.document.createElement("li"), e.util.isElement(o) ? i.appendChild(o) : i.innerHTML = o, r.appendChild(i));
            }, this), a = r.querySelectorAll("button"), a.length > 0 && (a[0].classList.add(this.firstButtonClass), a[a.length - 1].classList.add(this.lastButtonClass)), r;
          },
          destroy: function() {
            this.toolbar && (this.toolbar.parentNode && this.toolbar.parentNode.removeChild(this.toolbar), delete this.toolbar);
          },
          // Toolbar accessors
          getInteractionElements: function() {
            return this.getToolbarElement();
          },
          getToolbarElement: function() {
            return this.toolbar || (this.toolbar = this.createToolbar()), this.toolbar;
          },
          getToolbarActionsElement: function() {
            return this.getToolbarElement().querySelector(".medium-editor-toolbar-actions");
          },
          // Toolbar event handlers
          initThrottledMethods: function() {
            this.throttledPositionToolbar = e.util.throttle((function() {
              this.base.isActive && this.positionToolbarIfShown();
            }).bind(this));
          },
          attachEventHandlers: function() {
            this.subscribe("blur", this.handleBlur.bind(this)), this.subscribe("focus", this.handleFocus.bind(this)), this.subscribe("editableClick", this.handleEditableClick.bind(this)), this.subscribe("editableKeyup", this.handleEditableKeyup.bind(this)), this.on(this.document.documentElement, "mouseup", this.handleDocumentMouseup.bind(this)), this.static && this.sticky && this.on(this.window, "scroll", this.handleWindowScroll.bind(this), !0), this.on(this.window, "resize", this.handleWindowResize.bind(this));
          },
          handleWindowScroll: function() {
            this.positionToolbarIfShown();
          },
          handleWindowResize: function() {
            this.throttledPositionToolbar();
          },
          handleDocumentMouseup: function(r) {
            if (r && r.target && e.util.isDescendant(this.getToolbarElement(), r.target))
              return !1;
            this.checkState();
          },
          handleEditableClick: function() {
            setTimeout((function() {
              this.checkState();
            }).bind(this), 0);
          },
          handleEditableKeyup: function() {
            this.checkState();
          },
          handleBlur: function() {
            clearTimeout(this.hideTimeout), clearTimeout(this.delayShowTimeout), this.hideTimeout = setTimeout((function() {
              this.hideToolbar();
            }).bind(this), 1);
          },
          handleFocus: function() {
            this.checkState();
          },
          // Hiding/showing toolbar
          isDisplayed: function() {
            return this.getToolbarElement().classList.contains("medium-editor-toolbar-active");
          },
          showToolbar: function() {
            clearTimeout(this.hideTimeout), this.isDisplayed() || (this.getToolbarElement().classList.add("medium-editor-toolbar-active"), this.trigger("showToolbar", {}, this.base.getFocusedElement()));
          },
          hideToolbar: function() {
            this.isDisplayed() && (this.getToolbarElement().classList.remove("medium-editor-toolbar-active"), this.trigger("hideToolbar", {}, this.base.getFocusedElement()));
          },
          isToolbarDefaultActionsDisplayed: function() {
            return this.getToolbarActionsElement().style.display === "block";
          },
          hideToolbarDefaultActions: function() {
            this.isToolbarDefaultActionsDisplayed() && (this.getToolbarActionsElement().style.display = "none");
          },
          showToolbarDefaultActions: function() {
            this.hideExtensionForms(), this.isToolbarDefaultActionsDisplayed() || (this.getToolbarActionsElement().style.display = "block"), this.delayShowTimeout = this.base.delay((function() {
              this.showToolbar();
            }).bind(this));
          },
          hideExtensionForms: function() {
            this.forEachExtension(function(r) {
              r.hasForm && r.isDisplayed() && r.hideForm();
            });
          },
          // Responding to changes in user selection
          // Checks for existance of multiple block elements in the current selection
          multipleBlockElementsSelected: function() {
            var r = /<[^\/>][^>]*><\/[^>]+>/gim, i = new RegExp("<(" + e.util.blockContainerElementNames.join("|") + ")[^>]*>", "g"), o = e.selection.getSelectionHtml(this.document).replace(r, ""), a = o.match(i);
            return !!a && a.length > 1;
          },
          modifySelection: function() {
            var r = this.window.getSelection(), i = r.getRangeAt(0);
            if (this.standardizeSelectionStart && i.startContainer.nodeValue && i.startOffset === i.startContainer.nodeValue.length) {
              var o = e.util.findAdjacentTextNodeWithContent(e.selection.getSelectionElement(this.window), i.startContainer, this.document);
              if (o) {
                for (var a = 0; o.nodeValue.substr(a, 1).trim().length === 0; )
                  a = a + 1;
                i = e.selection.select(
                  this.document,
                  o,
                  a,
                  i.endContainer,
                  i.endOffset
                );
              }
            }
          },
          checkState: function() {
            if (!this.base.preventSelectionUpdates) {
              if (!this.base.getFocusedElement() || e.selection.selectionInContentEditableFalse(this.window))
                return this.hideToolbar();
              var r = e.selection.getSelectionElement(this.window);
              if (!r || this.getEditorElements().indexOf(r) === -1 || r.getAttribute("data-disable-toolbar"))
                return this.hideToolbar();
              if (this.updateOnEmptySelection && this.static)
                return this.showAndUpdateToolbar();
              if (!e.selection.selectionContainsContent(this.document) || this.allowMultiParagraphSelection === !1 && this.multipleBlockElementsSelected())
                return this.hideToolbar();
              this.showAndUpdateToolbar();
            }
          },
          // Updating the toolbar
          showAndUpdateToolbar: function() {
            this.modifySelection(), this.setToolbarButtonStates(), this.trigger("positionToolbar", {}, this.base.getFocusedElement()), this.showToolbarDefaultActions(), this.setToolbarPosition();
          },
          setToolbarButtonStates: function() {
            this.forEachExtension(function(r) {
              typeof r.isActive == "function" && typeof r.setInactive == "function" && r.setInactive();
            }), this.checkActiveButtons();
          },
          checkActiveButtons: function() {
            var r = [], i = null, o = e.selection.getSelectionRange(this.document), a, s = function(l) {
              typeof l.checkState == "function" ? l.checkState(a) : typeof l.isActive == "function" && typeof l.isAlreadyApplied == "function" && typeof l.setActive == "function" && !l.isActive() && l.isAlreadyApplied(a) && l.setActive();
            };
            if (o && (this.forEachExtension(function(l) {
              if (typeof l.queryCommandState == "function" && (i = l.queryCommandState(), i !== null)) {
                i && typeof l.setActive == "function" && l.setActive();
                return;
              }
              r.push(l);
            }), a = e.selection.getSelectedParentElement(o), !!this.getEditorElements().some(function(l) {
              return e.util.isDescendant(l, a, !0);
            })))
              for (; a && (r.forEach(s), !e.util.isMediumEditorElement(a)); )
                a = a.parentNode;
          },
          // Positioning toolbar
          positionToolbarIfShown: function() {
            this.isDisplayed() && this.setToolbarPosition();
          },
          setToolbarPosition: function() {
            var r = this.base.getFocusedElement(), i = this.window.getSelection();
            if (!r)
              return this;
            (this.static || !i.isCollapsed) && (this.showToolbar(), this.relativeContainer || (this.static ? this.positionStaticToolbar(r) : this.positionToolbar(i)), this.trigger("positionedToolbar", {}, this.base.getFocusedElement()));
          },
          positionStaticToolbar: function(r) {
            this.getToolbarElement().style.left = "0";
            var i = this.document.documentElement && this.document.documentElement.scrollTop || this.document.body.scrollTop, o = this.window.innerWidth, a = this.getToolbarElement(), s = r.getBoundingClientRect(), l = s.top + i, u = s.left + s.width / 2, f = a.offsetHeight, c = a.offsetWidth, d = c / 2, h;
            switch (this.sticky ? i > l + r.offsetHeight - f - this.stickyTopOffset ? (a.style.top = l + r.offsetHeight - f + "px", a.classList.remove("medium-editor-sticky-toolbar")) : i > l - f - this.stickyTopOffset ? (a.classList.add("medium-editor-sticky-toolbar"), a.style.top = this.stickyTopOffset + "px") : (a.classList.remove("medium-editor-sticky-toolbar"), a.style.top = l - f + "px") : a.style.top = l - f + "px", this.align) {
              case "left":
                h = s.left;
                break;
              case "right":
                h = s.right - c;
                break;
              case "center":
                h = u - d;
                break;
            }
            h < 0 ? h = 0 : h + c > o && (h = o - Math.ceil(c) - 1), a.style.left = h + "px";
          },
          positionToolbar: function(r) {
            this.getToolbarElement().style.left = "0", this.getToolbarElement().style.right = "initial";
            var i = r.getRangeAt(0), o = i.getBoundingClientRect();
            (!o || o.height === 0 && o.width === 0 && i.startContainer === i.endContainer) && (i.startContainer.nodeType === 1 && i.startContainer.querySelector("img") ? o = i.startContainer.querySelector("img").getBoundingClientRect() : o = i.startContainer.getBoundingClientRect());
            var a = this.window.innerWidth, s = this.getToolbarElement(), l = s.offsetHeight, u = s.offsetWidth, f = u / 2, c = 50, d = this.diffLeft - f, h = this.getEditorOption("elementsContainer"), v = ["absolute", "fixed"].indexOf(window.getComputedStyle(h).getPropertyValue("position")) > -1, p = {}, g = {}, y, m;
            v ? (m = h.getBoundingClientRect(), ["top", "left"].forEach(function(A) {
              g[A] = o[A] - m[A];
            }), g.width = o.width, g.height = o.height, o = g, a = m.width, p.top = h.scrollTop) : p.top = this.window.pageYOffset, y = o.left + o.width / 2, p.top += o.top - l, o.top < c ? (s.classList.add("medium-toolbar-arrow-over"), s.classList.remove("medium-toolbar-arrow-under"), p.top += c + o.height - this.diffTop) : (s.classList.add("medium-toolbar-arrow-under"), s.classList.remove("medium-toolbar-arrow-over"), p.top += this.diffTop), y < f ? (p.left = d + f, p.right = "initial") : a - y < f ? (p.left = "auto", p.right = 0) : (p.left = d + y, p.right = "initial"), ["top", "left", "right"].forEach(function(A) {
              s.style[A] = p[A] + (isNaN(p[A]) ? "" : "px");
            });
          }
        });
        e.extensions.toolbar = n;
      }(), function() {
        var n = e.Extension.extend({
          init: function() {
            e.Extension.prototype.init.apply(this, arguments), this.subscribe("editableDrag", this.handleDrag.bind(this)), this.subscribe("editableDrop", this.handleDrop.bind(this));
          },
          handleDrag: function(r) {
            var i = "medium-editor-dragover";
            r.preventDefault(), r.dataTransfer.dropEffect = "copy", r.type === "dragover" ? r.target.classList.add(i) : r.type === "dragleave" && r.target.classList.remove(i);
          },
          handleDrop: function(r) {
            var i = "medium-editor-dragover", o;
            r.preventDefault(), r.stopPropagation(), r.dataTransfer.files && (o = Array.prototype.slice.call(r.dataTransfer.files, 0), o.some((function(a) {
              if (a.type.match("image")) {
                var s, l;
                s = new FileReader(), s.readAsDataURL(a), l = "medium-img-" + +/* @__PURE__ */ new Date(), e.util.insertHTMLCommand(this.document, '<img class="medium-editor-image-loading" id="' + l + '" />'), s.onload = (function() {
                  var u = this.document.getElementById(l);
                  u && (u.removeAttribute("id"), u.removeAttribute("class"), u.src = s.result);
                }).bind(this);
              }
            }).bind(this))), r.target.classList.remove(i);
          }
        });
        e.extensions.imageDragging = n;
      }(), function() {
        function n(w) {
          var D = e.selection.getSelectionStart(this.options.ownerDocument), R = D.textContent, K = e.selection.getCaretOffsets(D);
          (R[K.left - 1] === void 0 || R[K.left - 1].trim() === "" || R[K.left] !== void 0 && R[K.left].trim() === "") && w.preventDefault();
        }
        function r(w, D) {
          if (this.options.disableReturn || D.getAttribute("data-disable-return"))
            w.preventDefault();
          else if (this.options.disableDoubleReturn || D.getAttribute("data-disable-double-return")) {
            var R = e.selection.getSelectionStart(this.options.ownerDocument);
            (R && R.textContent.trim() === "" && R.nodeName.toLowerCase() !== "li" || R.previousElementSibling && R.previousElementSibling.nodeName.toLowerCase() !== "br" && R.previousElementSibling.textContent.trim() === "") && w.preventDefault();
          }
        }
        function i(w) {
          var D = e.selection.getSelectionStart(this.options.ownerDocument), R = D && D.nodeName.toLowerCase();
          R === "pre" && (w.preventDefault(), e.util.insertHTMLCommand(this.options.ownerDocument, "    ")), e.util.isListItem(D) && (w.preventDefault(), w.shiftKey ? this.options.ownerDocument.execCommand("outdent", !1, null) : this.options.ownerDocument.execCommand("indent", !1, null));
        }
        function o(w) {
          var D, R = e.selection.getSelectionStart(this.options.ownerDocument), K = R.nodeName.toLowerCase(), ye = /^(\s+|<br\/?>)?$/i, Oe = /h\d/i;
          e.util.isKey(w, [e.util.keyCode.BACKSPACE, e.util.keyCode.ENTER]) && // has a preceeding sibling
          R.previousElementSibling && // in a header
          Oe.test(K) && // at the very end of the block
          e.selection.getCaretOffsets(R).left === 0 ? e.util.isKey(w, e.util.keyCode.BACKSPACE) && ye.test(R.previousElementSibling.innerHTML) ? (R.previousElementSibling.parentNode.removeChild(R.previousElementSibling), w.preventDefault()) : !this.options.disableDoubleReturn && e.util.isKey(w, e.util.keyCode.ENTER) && (D = this.options.ownerDocument.createElement("p"), D.innerHTML = "<br>", R.previousElementSibling.parentNode.insertBefore(D, R), w.preventDefault()) : e.util.isKey(w, e.util.keyCode.DELETE) && // between two sibling elements
          R.nextElementSibling && R.previousElementSibling && // not in a header
          !Oe.test(K) && // in an empty tag
          ye.test(R.innerHTML) && // when the next tag *is* a header
          Oe.test(R.nextElementSibling.nodeName.toLowerCase()) ? (e.selection.moveCursor(this.options.ownerDocument, R.nextElementSibling), R.previousElementSibling.parentNode.removeChild(R), w.preventDefault()) : e.util.isKey(w, e.util.keyCode.BACKSPACE) && K === "li" && // hitting backspace inside an empty li
          ye.test(R.innerHTML) && // is first element (no preceeding siblings)
          !R.previousElementSibling && // parent also does not have a sibling
          !R.parentElement.previousElementSibling && // is not the only li in a list
          R.nextElementSibling && R.nextElementSibling.nodeName.toLowerCase() === "li" ? (D = this.options.ownerDocument.createElement("p"), D.innerHTML = "<br>", R.parentElement.parentElement.insertBefore(D, R.parentElement), e.selection.moveCursor(this.options.ownerDocument, D), R.parentElement.removeChild(R), w.preventDefault()) : e.util.isKey(w, e.util.keyCode.BACKSPACE) && e.util.getClosestTag(R, "blockquote") !== !1 && e.selection.getCaretOffsets(R).left === 0 ? (w.preventDefault(), e.util.execFormatBlock(this.options.ownerDocument, "p")) : e.util.isKey(w, e.util.keyCode.ENTER) && e.util.getClosestTag(R, "blockquote") !== !1 && e.selection.getCaretOffsets(R).right === 0 ? (D = this.options.ownerDocument.createElement("p"), D.innerHTML = "<br>", R.parentElement.insertBefore(D, R.nextSibling), e.selection.moveCursor(this.options.ownerDocument, D), w.preventDefault()) : e.util.isKey(w, e.util.keyCode.BACKSPACE) && e.util.isMediumEditorElement(R.parentElement) && !R.previousElementSibling && R.nextElementSibling && ye.test(R.innerHTML) && (w.preventDefault(), e.selection.moveCursor(this.options.ownerDocument, R.nextSibling), R.parentElement.removeChild(R));
        }
        function a(w) {
          var D = e.selection.getSelectionStart(this.options.ownerDocument), R;
          D && (e.util.isMediumEditorElement(D) && D.children.length === 0 && !e.util.isBlockContainer(D) && this.options.ownerDocument.execCommand("formatBlock", !1, "p"), e.util.isKey(w, e.util.keyCode.ENTER) && !e.util.isListItem(D) && !e.util.isBlockContainer(D) && (R = D.nodeName.toLowerCase(), R === "a" ? this.options.ownerDocument.execCommand("unlink", !1, null) : !w.shiftKey && !w.ctrlKey && this.options.ownerDocument.execCommand("formatBlock", !1, "p")));
        }
        function s(w, D) {
          var R = D.parentNode.querySelector('textarea[medium-editor-textarea-id="' + D.getAttribute("medium-editor-textarea-id") + '"]');
          R && (R.value = D.innerHTML.trim());
        }
        function l(w) {
          w._mediumEditors || (w._mediumEditors = [null]), this.id || (this.id = w._mediumEditors.length), w._mediumEditors[this.id] = this;
        }
        function u(w) {
          !w._mediumEditors || !w._mediumEditors[this.id] || (w._mediumEditors[this.id] = null);
        }
        function f(w, D, R) {
          var K = [];
          if (w || (w = []), typeof w == "string" && (w = D.querySelectorAll(w)), e.util.isElement(w) && (w = [w]), R)
            for (var ye = 0; ye < w.length; ye++) {
              var Oe = w[ye];
              e.util.isElement(Oe) && !Oe.getAttribute("data-medium-editor-element") && !Oe.getAttribute("medium-editor-textarea-id") && K.push(Oe);
            }
          else
            K = Array.prototype.slice.apply(w);
          return K;
        }
        function c(w) {
          var D = w.parentNode.querySelector('textarea[medium-editor-textarea-id="' + w.getAttribute("medium-editor-textarea-id") + '"]');
          D && (D.classList.remove("medium-editor-hidden"), D.removeAttribute("medium-editor-textarea-id")), w.parentNode && w.parentNode.removeChild(w);
        }
        function d(w, D) {
          return Object.keys(D).forEach(function(R) {
            w[R] === void 0 && (w[R] = D[R]);
          }), w;
        }
        function h(w, D, R) {
          var K = {
            window: R.options.contentWindow,
            document: R.options.ownerDocument,
            base: R
          };
          return w = d(w, K), typeof w.init == "function" && w.init(), w.name || (w.name = D), w;
        }
        function v() {
          return this.elements.every(function(w) {
            return !!w.getAttribute("data-disable-toolbar");
          }) ? !1 : this.options.toolbar !== !1;
        }
        function p() {
          return v.call(this) ? this.options.anchorPreview !== !1 : !1;
        }
        function g() {
          return this.options.placeholder !== !1;
        }
        function y() {
          return this.options.autoLink !== !1;
        }
        function m() {
          return this.options.imageDragging !== !1;
        }
        function A() {
          return this.options.keyboardCommands !== !1;
        }
        function T() {
          return !this.options.extensions.imageDragging;
        }
        function k(w) {
          for (var D = this.options.ownerDocument.createElement("div"), R = Date.now(), K = "medium-editor-" + R, ye = w.attributes; this.options.ownerDocument.getElementById(K); )
            R++, K = "medium-editor-" + R;
          D.className = w.className, D.id = K, D.innerHTML = w.value, w.setAttribute("medium-editor-textarea-id", K);
          for (var Oe = 0, nt = ye.length; Oe < nt; Oe++)
            D.hasAttribute(ye[Oe].nodeName) || D.setAttribute(ye[Oe].nodeName, ye[Oe].value);
          return w.form && this.on(w.form, "reset", (function(rt) {
            rt.defaultPrevented || this.resetContent(this.options.ownerDocument.getElementById(K));
          }).bind(this)), w.classList.add("medium-editor-hidden"), w.parentNode.insertBefore(
            D,
            w
          ), D;
        }
        function C(w, D) {
          if (!w.getAttribute("data-medium-editor-element")) {
            w.nodeName.toLowerCase() === "textarea" && (w = k.call(this, w), this.instanceHandleEditableInput || (this.instanceHandleEditableInput = s.bind(this), this.subscribe("editableInput", this.instanceHandleEditableInput))), !this.options.disableEditing && !w.getAttribute("data-disable-editing") && (w.setAttribute("contentEditable", !0), w.setAttribute("spellcheck", this.options.spellcheck)), this.instanceHandleEditableKeydownEnter || (w.getAttribute("data-disable-return") || w.getAttribute("data-disable-double-return")) && (this.instanceHandleEditableKeydownEnter = r.bind(this), this.subscribe("editableKeydownEnter", this.instanceHandleEditableKeydownEnter)), !this.options.disableReturn && !w.getAttribute("data-disable-return") && this.on(w, "keyup", a.bind(this));
            var R = e.util.guid();
            w.setAttribute("data-medium-editor-element", !0), w.classList.add("medium-editor-element"), w.setAttribute("role", "textbox"), w.setAttribute("aria-multiline", !0), w.setAttribute("data-medium-editor-editor-index", D), w.setAttribute("medium-editor-index", R), de[R] = w.innerHTML, this.events.attachAllEventsToElement(w);
          }
          return w;
        }
        function S() {
          this.subscribe("editableKeydownTab", i.bind(this)), this.subscribe("editableKeydownDelete", o.bind(this)), this.subscribe("editableKeydownEnter", o.bind(this)), this.options.disableExtraSpaces && this.subscribe("editableKeydownSpace", n.bind(this)), this.instanceHandleEditableKeydownEnter || (this.options.disableReturn || this.options.disableDoubleReturn) && (this.instanceHandleEditableKeydownEnter = r.bind(this), this.subscribe("editableKeydownEnter", this.instanceHandleEditableKeydownEnter));
        }
        function I() {
          if (this.extensions = [], Object.keys(this.options.extensions).forEach(function(ye) {
            ye !== "toolbar" && this.options.extensions[ye] && this.extensions.push(h(this.options.extensions[ye], ye, this));
          }, this), T.call(this)) {
            var w = this.options.fileDragging;
            w || (w = {}, m.call(this) || (w.allowedTypes = [])), this.addBuiltInExtension("fileDragging", w);
          }
          var D = {
            paste: !0,
            "anchor-preview": p.call(this),
            autoLink: y.call(this),
            keyboardCommands: A.call(this),
            placeholder: g.call(this)
          };
          Object.keys(D).forEach(function(ye) {
            D[ye] && this.addBuiltInExtension(ye);
          }, this);
          var R = this.options.extensions.toolbar;
          if (!R && v.call(this)) {
            var K = e.util.extend({}, this.options.toolbar, {
              allowMultiParagraphSelection: this.options.allowMultiParagraphSelection
              // deprecated
            });
            R = new e.extensions.toolbar(K);
          }
          R && this.extensions.push(h(R, "toolbar", this));
        }
        function X(w, D) {
          var R = [
            ["allowMultiParagraphSelection", "toolbar.allowMultiParagraphSelection"]
          ];
          return D && R.forEach(function(K) {
            D.hasOwnProperty(K[0]) && D[K[0]] !== void 0 && e.util.deprecated(K[0], K[1], "v6.0.0");
          }), e.util.defaults({}, D, w);
        }
        function Q(w, D) {
          var R = /^append-(.+)$/gi, K = /justify([A-Za-z]*)$/g, ye, Oe;
          if (ye = R.exec(w), ye)
            return e.util.execFormatBlock(this.options.ownerDocument, ye[1]);
          if (w === "fontSize")
            return D.size && e.util.deprecated(".size option for fontSize command", ".value", "6.0.0"), Oe = D.value || D.size, this.options.ownerDocument.execCommand("fontSize", !1, Oe);
          if (w === "fontName")
            return D.name && e.util.deprecated(".name option for fontName command", ".value", "6.0.0"), Oe = D.value || D.name, this.options.ownerDocument.execCommand("fontName", !1, Oe);
          if (w === "createLink")
            return this.createLink(D);
          if (w === "image") {
            var nt = this.options.contentWindow.getSelection().toString().trim();
            return this.options.ownerDocument.execCommand("insertImage", !1, nt);
          }
          if (w === "html") {
            var rt = this.options.contentWindow.getSelection().toString().trim();
            return e.util.insertHTMLCommand(this.options.ownerDocument, rt);
          }
          if (K.exec(w)) {
            var me = this.options.ownerDocument.execCommand(w, !1, null), ke = e.selection.getSelectedParentElement(e.selection.getSelectionRange(this.options.ownerDocument));
            return ke && ue.call(this, e.util.getTopBlockContainer(ke)), me;
          }
          return Oe = D && D.value, this.options.ownerDocument.execCommand(w, !1, Oe);
        }
        function ue(w) {
          if (w) {
            var D, R = Array.prototype.slice.call(w.childNodes).filter(function(K) {
              var ye = K.nodeName.toLowerCase() === "div";
              return ye && !D && (D = K.style.textAlign), ye;
            });
            R.length && (this.saveSelection(), R.forEach(function(K) {
              if (K.style.textAlign === D) {
                var ye = K.lastChild;
                if (ye) {
                  e.util.unwrap(K, this.options.ownerDocument);
                  var Oe = this.options.ownerDocument.createElement("BR");
                  ye.parentNode.insertBefore(Oe, ye.nextSibling);
                }
              }
            }, this), w.style.textAlign = D, this.restoreSelection());
          }
        }
        var de = {};
        e.prototype = {
          // NOT DOCUMENTED - exposed for backwards compatability
          init: function(w, D) {
            return this.options = X.call(this, this.defaults, D), this.origElements = w, this.options.elementsContainer || (this.options.elementsContainer = this.options.ownerDocument.body), this.setup();
          },
          setup: function() {
            this.isActive || (l.call(this, this.options.contentWindow), this.events = new e.Events(this), this.elements = [], this.addElements(this.origElements), this.elements.length !== 0 && (this.isActive = !0, I.call(this), S.call(this)));
          },
          destroy: function() {
            this.isActive && (this.isActive = !1, this.extensions.forEach(function(w) {
              typeof w.destroy == "function" && w.destroy();
            }, this), this.events.destroy(), this.elements.forEach(function(w) {
              this.options.spellcheck && (w.innerHTML = w.innerHTML), w.removeAttribute("contentEditable"), w.removeAttribute("spellcheck"), w.removeAttribute("data-medium-editor-element"), w.classList.remove("medium-editor-element"), w.removeAttribute("role"), w.removeAttribute("aria-multiline"), w.removeAttribute("medium-editor-index"), w.removeAttribute("data-medium-editor-editor-index"), w.getAttribute("medium-editor-textarea-id") && c(w);
            }, this), this.elements = [], this.instanceHandleEditableKeydownEnter = null, this.instanceHandleEditableInput = null, u.call(this, this.options.contentWindow));
          },
          on: function(w, D, R, K) {
            return this.events.attachDOMEvent(w, D, R, K), this;
          },
          off: function(w, D, R, K) {
            return this.events.detachDOMEvent(w, D, R, K), this;
          },
          subscribe: function(w, D) {
            return this.events.attachCustomEvent(w, D), this;
          },
          unsubscribe: function(w, D) {
            return this.events.detachCustomEvent(w, D), this;
          },
          trigger: function(w, D, R) {
            return this.events.triggerCustomEvent(w, D, R), this;
          },
          delay: function(w) {
            var D = this;
            return setTimeout(function() {
              D.isActive && w();
            }, this.options.delay);
          },
          serialize: function() {
            var w, D, R = {}, K = this.elements.length;
            for (w = 0; w < K; w += 1)
              D = this.elements[w].id !== "" ? this.elements[w].id : "element-" + w, R[D] = {
                value: this.elements[w].innerHTML.trim()
              };
            return R;
          },
          getExtensionByName: function(w) {
            var D;
            return this.extensions && this.extensions.length && this.extensions.some(function(R) {
              return R.name === w ? (D = R, !0) : !1;
            }), D;
          },
          /**
           * NOT DOCUMENTED - exposed as a helper for other extensions to use
           */
          addBuiltInExtension: function(w, D) {
            var R = this.getExtensionByName(w), K;
            if (R)
              return R;
            switch (w) {
              case "anchor":
                K = e.util.extend({}, this.options.anchor, D), R = new e.extensions.anchor(K);
                break;
              case "anchor-preview":
                R = new e.extensions.anchorPreview(this.options.anchorPreview);
                break;
              case "autoLink":
                R = new e.extensions.autoLink();
                break;
              case "fileDragging":
                R = new e.extensions.fileDragging(D);
                break;
              case "fontname":
                R = new e.extensions.fontName(this.options.fontName);
                break;
              case "fontsize":
                R = new e.extensions.fontSize(D);
                break;
              case "keyboardCommands":
                R = new e.extensions.keyboardCommands(this.options.keyboardCommands);
                break;
              case "paste":
                R = new e.extensions.paste(this.options.paste);
                break;
              case "placeholder":
                R = new e.extensions.placeholder(this.options.placeholder);
                break;
              default:
                e.extensions.button.isBuiltInButton(w) && (D ? (K = e.util.defaults({}, D, e.extensions.button.prototype.defaults[w]), R = new e.extensions.button(K)) : R = new e.extensions.button(w));
            }
            return R && this.extensions.push(h(R, w, this)), R;
          },
          stopSelectionUpdates: function() {
            this.preventSelectionUpdates = !0;
          },
          startSelectionUpdates: function() {
            this.preventSelectionUpdates = !1;
          },
          checkSelection: function() {
            var w = this.getExtensionByName("toolbar");
            return w && w.checkState(), this;
          },
          // Wrapper around document.queryCommandState for checking whether an action has already
          // been applied to the current selection
          queryCommandState: function(w) {
            var D = /^full-(.+)$/gi, R, K = null;
            R = D.exec(w), R && (w = R[1]);
            try {
              K = this.options.ownerDocument.queryCommandState(w);
            } catch {
              K = null;
            }
            return K;
          },
          execAction: function(w, D) {
            var R = /^full-(.+)$/gi, K, ye;
            return K = R.exec(w), K ? (this.saveSelection(), this.selectAllContents(), ye = Q.call(this, K[1], D), this.restoreSelection()) : ye = Q.call(this, w, D), (w === "insertunorderedlist" || w === "insertorderedlist") && e.util.cleanListDOM(this.options.ownerDocument, this.getSelectedParentElement()), this.checkSelection(), ye;
          },
          getSelectedParentElement: function(w) {
            return w === void 0 && (w = this.options.contentWindow.getSelection().getRangeAt(0)), e.selection.getSelectedParentElement(w);
          },
          selectAllContents: function() {
            var w = e.selection.getSelectionElement(this.options.contentWindow);
            if (w) {
              for (; w.children.length === 1; )
                w = w.children[0];
              this.selectElement(w);
            }
          },
          selectElement: function(w) {
            e.selection.selectNode(w, this.options.ownerDocument);
            var D = e.selection.getSelectionElement(this.options.contentWindow);
            D && this.events.focusElement(D);
          },
          getFocusedElement: function() {
            var w;
            return this.elements.some(function(D) {
              return !w && D.getAttribute("data-medium-focused") && (w = D), !!w;
            }, this), w;
          },
          // Export the state of the selection in respect to one of this
          // instance of MediumEditor's elements
          exportSelection: function() {
            var w = e.selection.getSelectionElement(this.options.contentWindow), D = this.elements.indexOf(w), R = null;
            return D >= 0 && (R = e.selection.exportSelection(w, this.options.ownerDocument)), R !== null && D !== 0 && (R.editableElementIndex = D), R;
          },
          saveSelection: function() {
            this.selectionState = this.exportSelection();
          },
          // Restore a selection based on a selectionState returned by a call
          // to MediumEditor.exportSelection
          importSelection: function(w, D) {
            if (w) {
              var R = this.elements[w.editableElementIndex || 0];
              e.selection.importSelection(w, R, this.options.ownerDocument, D);
            }
          },
          restoreSelection: function() {
            this.importSelection(this.selectionState);
          },
          createLink: function(w) {
            var D = e.selection.getSelectionElement(this.options.contentWindow), R = {}, K;
            if (this.elements.indexOf(D) !== -1) {
              try {
                if (this.events.disableCustomEvent("editableInput"), w.url && e.util.deprecated(".url option for createLink", ".value", "6.0.0"), K = w.url || w.value, K && K.trim().length > 0) {
                  var ye = this.options.contentWindow.getSelection();
                  if (ye) {
                    var Oe = ye.getRangeAt(0), nt = Oe.commonAncestorContainer, rt, me, ke, ze;
                    if (Oe.endContainer.nodeType === 3 && Oe.startContainer.nodeType !== 3 && Oe.startOffset === 0 && Oe.startContainer.firstChild === Oe.endContainer && (nt = Oe.endContainer), me = e.util.getClosestBlockContainer(Oe.startContainer), ke = e.util.getClosestBlockContainer(Oe.endContainer), nt.nodeType !== 3 && nt.textContent.length !== 0 && me === ke) {
                      var Te = me || D, Xe = this.options.ownerDocument.createDocumentFragment();
                      this.execAction("unlink"), rt = this.exportSelection(), Xe.appendChild(Te.cloneNode(!0)), D === Te ? e.selection.select(
                        this.options.ownerDocument,
                        Te.firstChild,
                        0,
                        Te.lastChild,
                        Te.lastChild.nodeType === 3 ? Te.lastChild.nodeValue.length : Te.lastChild.childNodes.length
                      ) : e.selection.select(
                        this.options.ownerDocument,
                        Te,
                        0,
                        Te,
                        Te.childNodes.length
                      );
                      var M = this.exportSelection();
                      ze = e.util.findOrCreateMatchingTextNodes(
                        this.options.ownerDocument,
                        Xe,
                        {
                          start: rt.start - M.start,
                          end: rt.end - M.start,
                          editableElementIndex: rt.editableElementIndex
                        }
                      ), ze.length === 0 && (Xe = this.options.ownerDocument.createDocumentFragment(), Xe.appendChild(nt.cloneNode(!0)), ze = [Xe.firstChild.firstChild, Xe.firstChild.lastChild]), e.util.createLink(this.options.ownerDocument, ze, K.trim());
                      var W = (Xe.firstChild.innerHTML.match(/^\s+/) || [""])[0].length;
                      e.util.insertHTMLCommand(this.options.ownerDocument, Xe.firstChild.innerHTML.replace(/^\s+/, "")), rt.start -= W, rt.end -= W, this.importSelection(rt);
                    } else
                      this.options.ownerDocument.execCommand("createLink", !1, K);
                    this.options.targetBlank || w.target === "_blank" ? e.util.setTargetBlank(e.selection.getSelectionStart(this.options.ownerDocument), K) : e.util.removeTargetBlank(e.selection.getSelectionStart(this.options.ownerDocument), K), w.buttonClass && e.util.addClassToAnchors(e.selection.getSelectionStart(this.options.ownerDocument), w.buttonClass);
                  }
                }
                if (this.options.targetBlank || w.target === "_blank" || w.buttonClass) {
                  R = this.options.ownerDocument.createEvent("HTMLEvents"), R.initEvent("input", !0, !0, this.options.contentWindow);
                  for (var G = 0, ee = this.elements.length; G < ee; G += 1)
                    this.elements[G].dispatchEvent(R);
                }
              } finally {
                this.events.enableCustomEvent("editableInput");
              }
              this.events.triggerCustomEvent("editableInput", R, D);
            }
          },
          cleanPaste: function(w) {
            this.getExtensionByName("paste").cleanPaste(w);
          },
          pasteHTML: function(w, D) {
            this.getExtensionByName("paste").pasteHTML(w, D);
          },
          setContent: function(w, D) {
            if (D = D || 0, this.elements[D]) {
              var R = this.elements[D];
              R.innerHTML = w, this.checkContentChanged(R);
            }
          },
          getContent: function(w) {
            return w = w || 0, this.elements[w] ? this.elements[w].innerHTML.trim() : null;
          },
          checkContentChanged: function(w) {
            w = w || e.selection.getSelectionElement(this.options.contentWindow), this.events.updateInput(w, { target: w, currentTarget: w });
          },
          resetContent: function(w) {
            if (w) {
              var D = this.elements.indexOf(w);
              D !== -1 && this.setContent(de[w.getAttribute("medium-editor-index")], D);
              return;
            }
            this.elements.forEach(function(R, K) {
              this.setContent(de[R.getAttribute("medium-editor-index")], K);
            }, this);
          },
          addElements: function(w) {
            var D = f(w, this.options.ownerDocument, !0);
            if (D.length === 0)
              return !1;
            D.forEach(function(R) {
              R = C.call(this, R, this.id), this.elements.push(R), this.trigger("addElement", { target: R, currentTarget: R }, R);
            }, this);
          },
          removeElements: function(w) {
            var D = f(w, this.options.ownerDocument), R = D.map(function(K) {
              return K.getAttribute("medium-editor-textarea-id") && K.parentNode ? K.parentNode.querySelector('div[medium-editor-textarea-id="' + K.getAttribute("medium-editor-textarea-id") + '"]') : K;
            });
            this.elements = this.elements.filter(function(K) {
              return R.indexOf(K) !== -1 ? (this.events.cleanupElement(K), K.getAttribute("medium-editor-textarea-id") && c(K), this.trigger("removeElement", { target: K, currentTarget: K }, K), !1) : !0;
            }, this);
          }
        }, e.getEditorFromElement = function(w) {
          var D = w.getAttribute("data-medium-editor-editor-index"), R = w && w.ownerDocument && (w.ownerDocument.defaultView || w.ownerDocument.parentWindow);
          return R && R._mediumEditors && R._mediumEditors[D] ? R._mediumEditors[D] : null;
        };
      }(), function() {
        e.prototype.defaults = {
          activeButtonClass: "medium-editor-button-active",
          buttonLabels: !1,
          delay: 0,
          disableReturn: !1,
          disableDoubleReturn: !1,
          disableExtraSpaces: !1,
          disableEditing: !1,
          autoLink: !1,
          elementsContainer: !1,
          contentWindow: window,
          ownerDocument: document,
          targetBlank: !1,
          extensions: {},
          spellcheck: !0
        };
      }(), e.parseVersionString = function(n) {
        var r = n.split("-"), i = r[0].split("."), o = r.length > 1 ? r[1] : "";
        return {
          major: parseInt(i[0], 10),
          minor: parseInt(i[1], 10),
          revision: parseInt(i[2], 10),
          preRelease: o,
          toString: function() {
            return [i[0], i[1], i[2]].join(".") + (o ? "-" + o : "");
          }
        };
      }, e.version = e.parseVersionString.call(this, "5.23.3"), e;
    }());
  }(Ps)), Ps.exports;
}
var Y4 = U4();
const wl = /* @__PURE__ */ uu(Y4);
/*!
 * vanilla-picker v2.12.3
 * https://vanilla-picker.js.org
 *
 * Copyright 2017-2024 Andreas Borgen (https://github.com/Sphinxxxx), Adam Brooks (https://github.com/dissimulate)
 * Released under the ISC license.
 */
var _d = function(t, e) {
  if (!(t instanceof e))
    throw new TypeError("Cannot call a class as a function");
}, bd = /* @__PURE__ */ function() {
  function t(e, n) {
    for (var r = 0; r < n.length; r++) {
      var i = n[r];
      i.enumerable = i.enumerable || !1, i.configurable = !0, "value" in i && (i.writable = !0), Object.defineProperty(e, i.key, i);
    }
  }
  return function(e, n, r) {
    return n && t(e.prototype, n), r && t(e, r), e;
  };
}(), bs = /* @__PURE__ */ function() {
  function t(e, n) {
    var r = [], i = !0, o = !1, a = void 0;
    try {
      for (var s = e[Symbol.iterator](), l; !(i = (l = s.next()).done) && (r.push(l.value), !(n && r.length === n)); i = !0)
        ;
    } catch (u) {
      o = !0, a = u;
    } finally {
      try {
        !i && s.return && s.return();
      } finally {
        if (o) throw a;
      }
    }
    return r;
  }
  return function(e, n) {
    if (Array.isArray(e))
      return e;
    if (Symbol.iterator in Object(e))
      return t(e, n);
    throw new TypeError("Invalid attempt to destructure non-iterable instance");
  };
}();
String.prototype.startsWith = String.prototype.startsWith || function(t) {
  return this.indexOf(t) === 0;
};
String.prototype.padStart = String.prototype.padStart || function(t, e) {
  for (var n = this; n.length < t; )
    n = e + n;
  return n;
};
var V4 = { cb: "0f8ff", tqw: "aebd7", q: "-ffff", qmrn: "7fffd4", zr: "0ffff", bg: "5f5dc", bsq: "e4c4", bck: "---", nch: "ebcd", b: "--ff", bvt: "8a2be2", brwn: "a52a2a", brw: "deb887", ctb: "5f9ea0", hrt: "7fff-", chcT: "d2691e", cr: "7f50", rnw: "6495ed", crns: "8dc", crms: "dc143c", cn: "-ffff", Db: "--8b", Dcn: "-8b8b", Dgnr: "b8860b", Dgr: "a9a9a9", Dgrn: "-64-", Dkhk: "bdb76b", Dmgn: "8b-8b", Dvgr: "556b2f", Drng: "8c-", Drch: "9932cc", Dr: "8b--", Dsmn: "e9967a", Dsgr: "8fbc8f", DsTb: "483d8b", DsTg: "2f4f4f", Dtrq: "-ced1", Dvt: "94-d3", ppnk: "1493", pskb: "-bfff", mgr: "696969", grb: "1e90ff", rbrc: "b22222", rwht: "af0", stg: "228b22", chs: "-ff", gnsb: "dcdcdc", st: "8f8ff", g: "d7-", gnr: "daa520", gr: "808080", grn: "-8-0", grnw: "adff2f", hnw: "0fff0", htpn: "69b4", nnr: "cd5c5c", ng: "4b-82", vr: "0", khk: "0e68c", vnr: "e6e6fa", nrb: "0f5", wngr: "7cfc-", mnch: "acd", Lb: "add8e6", Lcr: "08080", Lcn: "e0ffff", Lgnr: "afad2", Lgr: "d3d3d3", Lgrn: "90ee90", Lpnk: "b6c1", Lsmn: "a07a", Lsgr: "20b2aa", Lskb: "87cefa", LsTg: "778899", Lstb: "b0c4de", Lw: "e0", m: "-ff-", mgrn: "32cd32", nn: "af0e6", mgnt: "-ff", mrn: "8--0", mqm: "66cdaa", mmb: "--cd", mmrc: "ba55d3", mmpr: "9370db", msg: "3cb371", mmsT: "7b68ee", "": "-fa9a", mtr: "48d1cc", mmvt: "c71585", mnLb: "191970", ntc: "5fffa", mstr: "e4e1", mccs: "e4b5", vjw: "dead", nv: "--80", c: "df5e6", v: "808-0", vrb: "6b8e23", rng: "a5-", rngr: "45-", rch: "da70d6", pgnr: "eee8aa", pgrn: "98fb98", ptrq: "afeeee", pvtr: "db7093", ppwh: "efd5", pchp: "dab9", pr: "cd853f", pnk: "c0cb", pm: "dda0dd", pwrb: "b0e0e6", prp: "8-080", cc: "663399", r: "--", sbr: "bc8f8f", rb: "4169e1", sbrw: "8b4513", smn: "a8072", nbr: "4a460", sgrn: "2e8b57", ssh: "5ee", snn: "a0522d", svr: "c0c0c0", skb: "87ceeb", sTb: "6a5acd", sTgr: "708090", snw: "afa", n: "-ff7f", stb: "4682b4", tn: "d2b48c", t: "-8080", thst: "d8bfd8", tmT: "6347", trqs: "40e0d0", vt: "ee82ee", whT: "5deb3", wht: "", hts: "5f5f5", w: "-", wgrn: "9acd32" };
function Cv(t) {
  var e = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : 1, n = e > 0 ? t.toFixed(e).replace(/0+$/, "").replace(/\.$/, "") : t.toString();
  return n || "0";
}
var K4 = function() {
  function t(e, n, r, i) {
    _d(this, t);
    var o = this;
    function a(l) {
      if (l.startsWith("hsl")) {
        var u = l.match(/([\-\d\.e]+)/g).map(Number), f = bs(u, 4), c = f[0], d = f[1], h = f[2], v = f[3];
        v === void 0 && (v = 1), c /= 360, d /= 100, h /= 100, o.hsla = [c, d, h, v];
      } else if (l.startsWith("rgb")) {
        var p = l.match(/([\-\d\.e]+)/g).map(Number), g = bs(p, 4), y = g[0], m = g[1], A = g[2], T = g[3];
        T === void 0 && (T = 1), o.rgba = [y, m, A, T];
      } else
        l.startsWith("#") ? o.rgba = t.hexToRgb(l) : o.rgba = t.nameToRgb(l) || t.hexToRgb(l);
    }
    if (e !== void 0) if (Array.isArray(e))
      this.rgba = e;
    else if (r === void 0) {
      var s = e && "" + e;
      s && a(s.toLowerCase());
    } else
      this.rgba = [e, n, r, i === void 0 ? 1 : i];
  }
  return bd(t, [{
    key: "printRGB",
    value: function(n) {
      var r = n ? this.rgba : this.rgba.slice(0, 3), i = r.map(function(o, a) {
        return Cv(o, a === 3 ? 3 : 0);
      });
      return n ? "rgba(" + i + ")" : "rgb(" + i + ")";
    }
  }, {
    key: "printHSL",
    value: function(n) {
      var r = [360, 100, 100, 1], i = ["", "%", "%", ""], o = n ? this.hsla : this.hsla.slice(0, 3), a = o.map(function(s, l) {
        return Cv(s * r[l], l === 3 ? 3 : 1) + i[l];
      });
      return n ? "hsla(" + a + ")" : "hsl(" + a + ")";
    }
  }, {
    key: "printHex",
    value: function(n) {
      var r = this.hex;
      return n ? r : r.substring(0, 7);
    }
  }, {
    key: "rgba",
    get: function() {
      if (this._rgba)
        return this._rgba;
      if (!this._hsla)
        throw new Error("No color is set");
      return this._rgba = t.hslToRgb(this._hsla);
    },
    set: function(n) {
      n.length === 3 && (n[3] = 1), this._rgba = n, this._hsla = null;
    }
  }, {
    key: "rgbString",
    get: function() {
      return this.printRGB();
    }
  }, {
    key: "rgbaString",
    get: function() {
      return this.printRGB(!0);
    }
  }, {
    key: "hsla",
    get: function() {
      if (this._hsla)
        return this._hsla;
      if (!this._rgba)
        throw new Error("No color is set");
      return this._hsla = t.rgbToHsl(this._rgba);
    },
    set: function(n) {
      n.length === 3 && (n[3] = 1), this._hsla = n, this._rgba = null;
    }
  }, {
    key: "hslString",
    get: function() {
      return this.printHSL();
    }
  }, {
    key: "hslaString",
    get: function() {
      return this.printHSL(!0);
    }
  }, {
    key: "hex",
    get: function() {
      var n = this.rgba, r = n.map(function(i, o) {
        return o < 3 ? i.toString(16) : Math.round(i * 255).toString(16);
      });
      return "#" + r.map(function(i) {
        return i.padStart(2, "0");
      }).join("");
    },
    set: function(n) {
      this.rgba = t.hexToRgb(n);
    }
  }], [{
    key: "hexToRgb",
    value: function(n) {
      var r = (n.startsWith("#") ? n.slice(1) : n).replace(/^(\w{3})$/, "$1F").replace(/^(\w)(\w)(\w)(\w)$/, "$1$1$2$2$3$3$4$4").replace(/^(\w{6})$/, "$1FF");
      if (!r.match(/^([0-9a-fA-F]{8})$/))
        throw new Error("Unknown hex color; " + n);
      var i = r.match(/^(\w\w)(\w\w)(\w\w)(\w\w)$/).slice(1).map(function(o) {
        return parseInt(o, 16);
      });
      return i[3] = i[3] / 255, i;
    }
  }, {
    key: "nameToRgb",
    value: function(n) {
      var r = n.toLowerCase().replace("at", "T").replace(/[aeiouyldf]/g, "").replace("ght", "L").replace("rk", "D").slice(-5, 4), i = V4[r];
      return i === void 0 ? i : t.hexToRgb(i.replace(/\-/g, "00").padStart(6, "f"));
    }
  }, {
    key: "rgbToHsl",
    value: function(n) {
      var r = bs(n, 4), i = r[0], o = r[1], a = r[2], s = r[3];
      i /= 255, o /= 255, a /= 255;
      var l = Math.max(i, o, a), u = Math.min(i, o, a), f = void 0, c = void 0, d = (l + u) / 2;
      if (l === u)
        f = c = 0;
      else {
        var h = l - u;
        switch (c = d > 0.5 ? h / (2 - l - u) : h / (l + u), l) {
          case i:
            f = (o - a) / h + (o < a ? 6 : 0);
            break;
          case o:
            f = (a - i) / h + 2;
            break;
          case a:
            f = (i - o) / h + 4;
            break;
        }
        f /= 6;
      }
      return [f, c, d, s];
    }
  }, {
    key: "hslToRgb",
    value: function(n) {
      var r = bs(n, 4), i = r[0], o = r[1], a = r[2], s = r[3], l = void 0, u = void 0, f = void 0;
      if (o === 0)
        l = u = f = a;
      else {
        var c = function(g, y, m) {
          return m < 0 && (m += 1), m > 1 && (m -= 1), m < 0.16666666666666666 ? g + (y - g) * 6 * m : m < 0.5 ? y : m < 0.6666666666666666 ? g + (y - g) * (0.6666666666666666 - m) * 6 : g;
        }, d = a < 0.5 ? a * (1 + o) : a + o - a * o, h = 2 * a - d;
        l = c(h, d, i + 1 / 3), u = c(h, d, i), f = c(h, d, i - 1 / 3);
      }
      var v = [l * 255, u * 255, f * 255].map(Math.round);
      return v[3] = s, v;
    }
  }]), t;
}(), q4 = function() {
  function t() {
    _d(this, t), this._events = [];
  }
  return bd(t, [{
    key: "add",
    value: function(n, r, i) {
      n.addEventListener(r, i, !1), this._events.push({
        target: n,
        type: r,
        handler: i
      });
    }
  }, {
    key: "remove",
    value: function(n, r, i) {
      this._events = this._events.filter(function(o) {
        var a = !0;
        return n && n !== o.target && (a = !1), r && r !== o.type && (a = !1), i && i !== o.handler && (a = !1), a && t._doRemove(o.target, o.type, o.handler), !a;
      });
    }
  }, {
    key: "destroy",
    value: function() {
      this._events.forEach(function(n) {
        return t._doRemove(n.target, n.type, n.handler);
      }), this._events = [];
    }
  }], [{
    key: "_doRemove",
    value: function(n, r, i) {
      n.removeEventListener(r, i, !1);
    }
  }]), t;
}();
function Z4(t) {
  var e = document.createElement("div");
  return e.innerHTML = t, e.firstElementChild;
}
function Fu(t, e, n) {
  var r = !1;
  function i(l, u, f) {
    return Math.max(u, Math.min(l, f));
  }
  function o(l, u, f) {
    if (f && (r = !0), !!r) {
      l.preventDefault();
      var c = e.getBoundingClientRect(), d = c.width, h = c.height, v = u.clientX, p = u.clientY, g = i(v - c.left, 0, d), y = i(p - c.top, 0, h);
      n(g / d, y / h);
    }
  }
  function a(l, u) {
    var f = l.buttons === void 0 ? l.which : l.buttons;
    f === 1 ? o(l, l, u) : r = !1;
  }
  function s(l, u) {
    l.touches.length === 1 ? o(l, l.touches[0], u) : r = !1;
  }
  t.add(e, "mousedown", function(l) {
    a(l, !0);
  }), t.add(e, "touchstart", function(l) {
    s(l, !0);
  }), t.add(window, "mousemove", a), t.add(e, "touchmove", s), t.add(window, "mouseup", function(l) {
    r = !1;
  }), t.add(e, "touchend", function(l) {
    r = !1;
  }), t.add(e, "touchcancel", function(l) {
    r = !1;
  });
}
var J4 = `linear-gradient(45deg, lightgrey 25%, transparent 25%, transparent 75%, lightgrey 75%) 0 0 / 2em 2em,
                   linear-gradient(45deg, lightgrey 25%,       white 25%,       white 75%, lightgrey 75%) 1em 1em / 2em 2em`, Q4 = 360, I_ = "keydown", xs = "mousedown", $u = "focusin";
function _r(t, e) {
  return (e || document).querySelector(t);
}
function ej(t) {
  t.preventDefault(), t.stopPropagation();
}
function Hu(t, e, n, r, i) {
  t.add(e, I_, function(o) {
    n.indexOf(o.key) >= 0 && r(o);
  });
}
var j_ = function() {
  function t(e) {
    _d(this, t), this.settings = {
      popup: "right",
      layout: "default",
      alpha: !0,
      editor: !0,
      editorFormat: "hex",
      cancelButton: !1,
      defaultColor: "#0cf"
    }, this._events = new q4(), this.onChange = null, this.onDone = null, this.onOpen = null, this.onClose = null, this.setOptions(e);
  }
  return bd(t, [{
    key: "setOptions",
    value: function(n) {
      var r = this;
      if (!n)
        return;
      var i = this.settings;
      function o(u, f, c) {
        for (var d in u)
          f[d] = u[d];
      }
      if (n instanceof HTMLElement)
        i.parent = n;
      else {
        i.parent && n.parent && i.parent !== n.parent && (this._events.remove(i.parent), this._popupInited = !1), o(n, i), n.onChange && (this.onChange = n.onChange), n.onDone && (this.onDone = n.onDone), n.onOpen && (this.onOpen = n.onOpen), n.onClose && (this.onClose = n.onClose);
        var a = n.color || n.colour;
        a && this._setColor(a);
      }
      var s = i.parent;
      if (s && i.popup && !this._popupInited) {
        var l = function(f) {
          return r.openHandler(f);
        };
        this._events.add(s, "click", l), Hu(this._events, s, [" ", "Spacebar", "Enter"], l), this._popupInited = !0;
      } else n.parent && !i.popup && this.show();
    }
  }, {
    key: "openHandler",
    value: function(n) {
      if (this.show()) {
        n && n.preventDefault(), this.settings.parent.style.pointerEvents = "none";
        var r = n && n.type === I_ ? this._domEdit : this.domElement;
        setTimeout(function() {
          return r.focus();
        }, 100), this.onOpen && this.onOpen(this.colour);
      }
    }
  }, {
    key: "closeHandler",
    value: function(n) {
      var r = n && n.type, i = !1;
      if (!n)
        i = !0;
      else if (r === xs || r === $u) {
        var o = (this.__containedEvent || 0) + 100;
        n.timeStamp > o && (i = !0);
      } else
        ej(n), i = !0;
      i && this.hide() && (this.settings.parent.style.pointerEvents = "", r !== xs && this.settings.parent.focus(), this.onClose && this.onClose(this.colour));
    }
  }, {
    key: "movePopup",
    value: function(n, r) {
      this.closeHandler(), this.setOptions(n), r && this.openHandler();
    }
  }, {
    key: "setColor",
    value: function(n, r) {
      this._setColor(n, { silent: r });
    }
  }, {
    key: "_setColor",
    value: function(n, r) {
      if (typeof n == "string" && (n = n.trim()), !!n) {
        r = r || {};
        var i = void 0;
        try {
          i = new K4(n);
        } catch (a) {
          if (r.failSilently)
            return;
          throw a;
        }
        if (!this.settings.alpha) {
          var o = i.hsla;
          o[3] = 1, i.hsla = o;
        }
        this.colour = this.color = i, this._setHSLA(null, null, null, null, r);
      }
    }
  }, {
    key: "setColour",
    value: function(n, r) {
      this.setColor(n, r);
    }
  }, {
    key: "show",
    value: function() {
      var n = this.settings.parent;
      if (!n)
        return !1;
      if (this.domElement) {
        var r = this._toggleDOM(!0);
        return this._setPosition(), r;
      }
      var i = this.settings.template || '<div class="picker_wrapper" tabindex="-1"><div class="picker_arrow"></div><div class="picker_hue picker_slider"><div class="picker_selector"></div></div><div class="picker_sl"><div class="picker_selector"></div></div><div class="picker_alpha picker_slider"><div class="picker_selector"></div></div><div class="picker_editor"><input aria-label="Type a color name or hex value"/></div><div class="picker_sample"></div><div class="picker_done"><button>Ok</button></div><div class="picker_cancel"><button>Cancel</button></div></div>', o = Z4(i);
      return this.domElement = o, this._domH = _r(".picker_hue", o), this._domSL = _r(".picker_sl", o), this._domA = _r(".picker_alpha", o), this._domEdit = _r(".picker_editor input", o), this._domSample = _r(".picker_sample", o), this._domOkay = _r(".picker_done button", o), this._domCancel = _r(".picker_cancel button", o), o.classList.add("layout_" + this.settings.layout), this.settings.alpha || o.classList.add("no_alpha"), this.settings.editor || o.classList.add("no_editor"), this.settings.cancelButton || o.classList.add("no_cancel"), this._ifPopup(function() {
        return o.classList.add("popup");
      }), this._setPosition(), this.colour ? this._updateUI() : this._setColor(this.settings.defaultColor), this._bindEvents(), !0;
    }
  }, {
    key: "hide",
    value: function() {
      return this._toggleDOM(!1);
    }
  }, {
    key: "destroy",
    value: function() {
      this._events.destroy(), this.domElement && this.settings.parent.removeChild(this.domElement);
    }
  }, {
    key: "_bindEvents",
    value: function() {
      var n = this, r = this, i = this.domElement, o = this._events;
      function a(u, f, c) {
        o.add(u, f, c);
      }
      a(i, "click", function(u) {
        return u.preventDefault();
      }), Fu(o, this._domH, function(u, f) {
        return r._setHSLA(u);
      }), Fu(o, this._domSL, function(u, f) {
        return r._setHSLA(null, u, 1 - f);
      }), this.settings.alpha && Fu(o, this._domA, function(u, f) {
        return r._setHSLA(null, null, null, 1 - f);
      });
      var s = this._domEdit;
      a(s, "input", function(u) {
        r._setColor(this.value, { fromEditor: !0, failSilently: !0 });
      }), a(s, "focus", function(u) {
        var f = this;
        f.selectionStart === f.selectionEnd && f.select();
      }), this._ifPopup(function() {
        var u = function(d) {
          return n.closeHandler(d);
        };
        a(window, xs, u), a(window, $u, u), Hu(o, i, ["Esc", "Escape"], u);
        var f = function(d) {
          n.__containedEvent = d.timeStamp;
        };
        a(i, xs, f), a(i, $u, f), a(n._domCancel, "click", u);
      });
      var l = function(f) {
        n._ifPopup(function() {
          return n.closeHandler(f);
        }), n.onDone && n.onDone(n.colour);
      };
      a(this._domOkay, "click", l), Hu(o, i, ["Enter"], l);
    }
  }, {
    key: "_setPosition",
    value: function() {
      var n = this.settings.parent, r = this.domElement;
      n !== r.parentNode && n.appendChild(r), this._ifPopup(function(i) {
        getComputedStyle(n).position === "static" && (n.style.position = "relative");
        var o = i === !0 ? "popup_right" : "popup_" + i;
        ["popup_top", "popup_bottom", "popup_left", "popup_right"].forEach(function(a) {
          a === o ? r.classList.add(a) : r.classList.remove(a);
        }), r.classList.add(o);
      });
    }
  }, {
    key: "_setHSLA",
    value: function(n, r, i, o, a) {
      a = a || {};
      var s = this.colour, l = s.hsla;
      [n, r, i, o].forEach(function(u, f) {
        (u || u === 0) && (l[f] = u);
      }), s.hsla = l, this._updateUI(a), this.onChange && !a.silent && this.onChange(s);
    }
  }, {
    key: "_updateUI",
    value: function(n) {
      if (!this.domElement)
        return;
      n = n || {};
      var r = this.colour, i = r.hsla, o = "hsl(" + i[0] * Q4 + ", 100%, 50%)", a = r.hslString, s = r.hslaString, l = this._domH, u = this._domSL, f = this._domA, c = _r(".picker_selector", l), d = _r(".picker_selector", u), h = _r(".picker_selector", f);
      function v(C, S, I) {
        S.style.left = I * 100 + "%";
      }
      function p(C, S, I) {
        S.style.top = I * 100 + "%";
      }
      v(l, c, i[0]), this._domSL.style.backgroundColor = this._domH.style.color = o, v(u, d, i[1]), p(u, d, 1 - i[2]), u.style.color = a, p(f, h, 1 - i[3]);
      var g = a, y = g.replace("hsl", "hsla").replace(")", ", 0)"), m = "linear-gradient(" + [g, y] + ")";
      if (this._domA.style.background = m + ", " + J4, !n.fromEditor) {
        var A = this.settings.editorFormat, T = this.settings.alpha, k = void 0;
        switch (A) {
          case "rgb":
            k = r.printRGB(T);
            break;
          case "hsl":
            k = r.printHSL(T);
            break;
          default:
            k = r.printHex(T);
        }
        this._domEdit.value = k;
      }
      this._domSample.style.color = s;
    }
  }, {
    key: "_ifPopup",
    value: function(n, r) {
      this.settings.parent && this.settings.popup ? n && n(this.settings.popup) : r && r();
    }
  }, {
    key: "_toggleDOM",
    value: function(n) {
      var r = this.domElement;
      if (!r)
        return !1;
      var i = n ? "" : "none", o = r.style.display !== i;
      return o && (r.style.display = i), o;
    }
  }]), t;
}();
{
  var Wu = document.createElement("style");
  Wu.textContent = '.picker_wrapper.no_alpha .picker_alpha{display:none}.picker_wrapper.no_editor .picker_editor{position:absolute;z-index:-1;opacity:0}.picker_wrapper.no_cancel .picker_cancel{display:none}.layout_default.picker_wrapper{display:flex;flex-flow:row wrap;justify-content:space-between;align-items:stretch;font-size:10px;width:25em;padding:.5em}.layout_default.picker_wrapper input,.layout_default.picker_wrapper button{font-size:1rem}.layout_default.picker_wrapper>*{margin:.5em}.layout_default.picker_wrapper::before{content:"";display:block;width:100%;height:0;order:1}.layout_default .picker_slider,.layout_default .picker_selector{padding:1em}.layout_default .picker_hue{width:100%}.layout_default .picker_sl{flex:1 1 auto}.layout_default .picker_sl::before{content:"";display:block;padding-bottom:100%}.layout_default .picker_editor{order:1;width:6.5rem}.layout_default .picker_editor input{width:100%;height:100%}.layout_default .picker_sample{order:1;flex:1 1 auto}.layout_default .picker_done,.layout_default .picker_cancel{order:1}.picker_wrapper{box-sizing:border-box;background:#f2f2f2;box-shadow:0 0 0 1px silver;cursor:default;font-family:sans-serif;color:#444;pointer-events:auto}.picker_wrapper:focus{outline:none}.picker_wrapper button,.picker_wrapper input{box-sizing:border-box;border:none;box-shadow:0 0 0 1px silver;outline:none}.picker_wrapper button:focus,.picker_wrapper button:active,.picker_wrapper input:focus,.picker_wrapper input:active{box-shadow:0 0 2px 1px #1e90ff}.picker_wrapper button{padding:.4em .6em;cursor:pointer;background-color:#f5f5f5;background-image:linear-gradient(0deg, gainsboro, transparent)}.picker_wrapper button:active{background-image:linear-gradient(0deg, transparent, gainsboro)}.picker_wrapper button:hover{background-color:#fff}.picker_selector{position:absolute;z-index:1;display:block;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);border:2px solid #fff;border-radius:100%;box-shadow:0 0 3px 1px #67b9ff;background:currentColor;cursor:pointer}.picker_slider .picker_selector{border-radius:2px}.picker_hue{position:relative;background-image:linear-gradient(90deg, red, yellow, lime, cyan, blue, magenta, red);box-shadow:0 0 0 1px silver}.picker_sl{position:relative;box-shadow:0 0 0 1px silver;background-image:linear-gradient(180deg, white, rgba(255, 255, 255, 0) 50%),linear-gradient(0deg, black, rgba(0, 0, 0, 0) 50%),linear-gradient(90deg, #808080, rgba(128, 128, 128, 0))}.picker_alpha,.picker_sample{position:relative;background:linear-gradient(45deg, lightgrey 25%, transparent 25%, transparent 75%, lightgrey 75%) 0 0/2em 2em,linear-gradient(45deg, lightgrey 25%, white 25%, white 75%, lightgrey 75%) 1em 1em/2em 2em;box-shadow:0 0 0 1px silver}.picker_alpha .picker_selector,.picker_sample .picker_selector{background:none}.picker_editor input{font-family:monospace;padding:.2em .4em}.picker_sample::before{content:"";position:absolute;display:block;width:100%;height:100%;background:currentColor}.picker_arrow{position:absolute;z-index:-1}.picker_wrapper.popup{position:absolute;z-index:2;margin:1.5em}.picker_wrapper.popup,.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{background:#f2f2f2;box-shadow:0 0 10px 1px rgba(0,0,0,.4)}.picker_wrapper.popup .picker_arrow{width:3em;height:3em;margin:0}.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{content:"";display:block;position:absolute;top:0;left:0;z-index:-99}.picker_wrapper.popup .picker_arrow::before{width:100%;height:100%;-webkit-transform:skew(45deg);transform:skew(45deg);-webkit-transform-origin:0 100%;transform-origin:0 100%}.picker_wrapper.popup .picker_arrow::after{width:150%;height:150%;box-shadow:none}.popup.popup_top{bottom:100%;left:0}.popup.popup_top .picker_arrow{bottom:0;left:0;-webkit-transform:rotate(-90deg);transform:rotate(-90deg)}.popup.popup_bottom{top:100%;left:0}.popup.popup_bottom .picker_arrow{top:0;left:0;-webkit-transform:rotate(90deg) scale(1, -1);transform:rotate(90deg) scale(1, -1)}.popup.popup_left{top:0;right:100%}.popup.popup_left .picker_arrow{top:0;right:0;-webkit-transform:scale(-1, 1);transform:scale(-1, 1)}.popup.popup_right{top:0;left:100%}.popup.popup_right .picker_arrow{top:0;left:0}', document.documentElement.firstElementChild.appendChild(Wu), j_.StyleElement = Wu;
}
var zu = { exports: {} }, Tv;
function k_() {
  return Tv || (Tv = 1, function(t, e) {
    (function(n, r) {
      t.exports = n();
    })(function() {
      var n = "object", r = "function", i = "undefined", o = [
        "startContainer",
        "startOffset",
        "endContainer",
        "endOffset",
        "collapsed",
        "commonAncestorContainer"
      ], a = [
        "setStart",
        "setStartBefore",
        "setStartAfter",
        "setEnd",
        "setEndBefore",
        "setEndAfter",
        "collapse",
        "selectNode",
        "selectNodeContents",
        "compareBoundaryPoints",
        "deleteContents",
        "extractContents",
        "cloneContents",
        "insertNode",
        "surroundContents",
        "cloneRange",
        "toString",
        "detach"
      ], s = ["boundingHeight", "boundingLeft", "boundingTop", "boundingWidth", "htmlText", "text"], l = [
        "collapse",
        "compareEndPoints",
        "duplicate",
        "moveToElementText",
        "parentElement",
        "select",
        "setEndPoint",
        "getBoundingClientRect"
      ];
      function u(M, W) {
        var G = typeof M[W];
        return G == r || !!(G == n && M[W]) || G == "unknown";
      }
      function f(M, W) {
        return !!(typeof M[W] == n && M[W]);
      }
      function c(M, W) {
        return typeof M[W] != i;
      }
      function d(M) {
        return function(W, G) {
          for (var ee = G.length; ee--; )
            if (!M(W, G[ee]))
              return !1;
          return !0;
        };
      }
      var h = d(u), v = d(f), p = d(c);
      function g(M) {
        return M && h(M, l) && p(M, s);
      }
      function y(M) {
        return f(M, "body") ? M.body : M.getElementsByTagName("body")[0];
      }
      var m = [].forEach ? function(M, W) {
        M.forEach(W);
      } : function(M, W) {
        for (var G = 0, ee = M.length; G < ee; ++G)
          W(M[G], G);
      }, A = {}, T = typeof window != i && typeof document != i, k = {
        isHostMethod: u,
        isHostObject: f,
        isHostProperty: c,
        areHostMethods: h,
        areHostObjects: v,
        areHostProperties: p,
        isTextRange: g,
        getBody: y,
        forEach: m
      }, C = {
        version: "1.3.2",
        initialized: !1,
        isBrowser: T,
        supported: !0,
        util: k,
        features: {},
        modules: A,
        config: {
          alertOnFail: !1,
          alertOnWarn: !1,
          preferTextRange: !1,
          autoInitialize: typeof rangyAutoInitialize == i ? !0 : rangyAutoInitialize
        }
      };
      function S(M) {
        typeof console != i && u(console, "log") && console.log(M);
      }
      function I(M, W) {
        T && W ? alert(M) : S(M);
      }
      function X(M) {
        C.initialized = !0, C.supported = !1, I("Rangy is not supported in this environment. Reason: " + M, C.config.alertOnFail);
      }
      C.fail = X;
      function Q(M) {
        I("Rangy warning: " + M, C.config.alertOnWarn);
      }
      C.warn = Q;
      var ue;
      ({}).hasOwnProperty ? (k.extend = ue = function(M, W, G) {
        var ee, re;
        for (var ge in W)
          ge === "__proto__" || ge === "constructor" || ge === "prototype" || W.hasOwnProperty(ge) && (ee = M[ge], re = W[ge], G && ee !== null && typeof ee == "object" && re !== null && typeof re == "object" && ue(ee, re, !0), M[ge] = re);
        return W.hasOwnProperty("toString") && (M.toString = W.toString), M;
      }, k.createOptions = function(M, W) {
        var G = {};
        return ue(G, W), M && ue(G, M), G;
      }) : X("hasOwnProperty not supported"), T || X("Rangy can only run in a browser"), function() {
        var M;
        if (T) {
          var W = document.createElement("div");
          W.appendChild(document.createElement("span"));
          var G = [].slice;
          try {
            G.call(W.childNodes, 0)[0].nodeType == 1 && (M = function(ee) {
              return G.call(ee, 0);
            });
          } catch {
          }
        }
        M || (M = function(ee) {
          for (var re = [], ge = 0, we = ee.length; ge < we; ++ge)
            re[ge] = ee[ge];
          return re;
        }), k.toArray = M;
      }();
      var de;
      T && (u(document, "addEventListener") ? de = function(M, W, G) {
        M.addEventListener(W, G, !1);
      } : u(document, "attachEvent") ? de = function(M, W, G) {
        M.attachEvent("on" + W, G);
      } : X("Document does not have required addEventListener or attachEvent method"), k.addListener = de);
      var w = [];
      function D(M) {
        return M.message || M.description || String(M);
      }
      function R() {
        if (!(!T || C.initialized)) {
          var M, W = !1, G = !1;
          u(document, "createRange") && (M = document.createRange(), h(M, a) && p(M, o) && (W = !0));
          var ee = y(document);
          if (!ee || ee.nodeName.toLowerCase() != "body") {
            X("No body element found");
            return;
          }
          if (ee && u(ee, "createTextRange") && (M = ee.createTextRange(), g(M) && (G = !0)), !W && !G) {
            X("Neither Range nor TextRange are available");
            return;
          }
          C.initialized = !0, C.features = {
            implementsDomRange: W,
            implementsTextRange: G
          };
          var re, ge;
          for (var we in A)
            (re = A[we]) instanceof rt && re.init(re, C);
          for (var ct = 0, Ot = w.length; ct < Ot; ++ct)
            try {
              w[ct](C);
            } catch (Rt) {
              ge = "Rangy init listener threw an exception. Continuing. Detail: " + D(Rt), S(ge);
            }
        }
      }
      function K(M, W, G) {
        G && (M += " in module " + G.name), C.warn("DEPRECATED: " + M + " is deprecated. Please use " + W + " instead.");
      }
      function ye(M, W, G, ee) {
        M[W] = function() {
          return K(W, G, ee), M[G].apply(M, k.toArray(arguments));
        };
      }
      k.deprecationNotice = K, k.createAliasForDeprecatedMethod = ye, C.init = R, C.addInitListener = function(M) {
        C.initialized ? M(C) : w.push(M);
      };
      var Oe = [];
      C.addShimListener = function(M) {
        Oe.push(M);
      };
      function nt(M) {
        M = M || window, R();
        for (var W = 0, G = Oe.length; W < G; ++W)
          Oe[W](M);
      }
      T && (C.shim = C.createMissingNativeApi = nt, ye(C, "createMissingNativeApi", "shim"));
      function rt(M, W, G) {
        this.name = M, this.dependencies = W, this.initialized = !1, this.supported = !1, this.initializer = G;
      }
      rt.prototype = {
        init: function() {
          for (var M = this.dependencies || [], W = 0, G = M.length, ee, re; W < G; ++W) {
            if (re = M[W], ee = A[re], !ee || !(ee instanceof rt))
              throw new Error("required module '" + re + "' not found");
            if (ee.init(), !ee.supported)
              throw new Error("required module '" + re + "' not supported");
          }
          this.initializer(this);
        },
        fail: function(M) {
          throw this.initialized = !0, this.supported = !1, new Error(M);
        },
        warn: function(M) {
          C.warn("Module " + this.name + ": " + M);
        },
        deprecationNotice: function(M, W) {
          C.warn("DEPRECATED: " + M + " in module " + this.name + " is deprecated. Please use " + W + " instead");
        },
        createError: function(M) {
          return new Error("Error in Rangy " + this.name + " module: " + M);
        }
      };
      function me(M, W, G) {
        var ee = new rt(M, W, function(re) {
          if (!re.initialized) {
            re.initialized = !0;
            try {
              G(C, re), re.supported = !0;
            } catch (we) {
              var ge = "Module '" + M + "' failed to load: " + D(we);
              S(ge), we.stack && S(we.stack);
            }
          }
        });
        return A[M] = ee, ee;
      }
      C.createModule = function(M) {
        var W, G;
        arguments.length == 2 ? (W = arguments[1], G = []) : (W = arguments[2], G = arguments[1]);
        var ee = me(M, G, W);
        C.initialized && C.supported && ee.init();
      }, C.createCoreModule = function(M, W, G) {
        me(M, W, G);
      };
      function ke() {
      }
      C.RangePrototype = ke, C.rangePrototype = new ke();
      function ze() {
      }
      C.selectionPrototype = new ze(), C.createCoreModule("DomUtil", [], function(M, W) {
        var G = "undefined", ee = M.util, re = ee.getBody;
        ee.areHostMethods(document, ["createDocumentFragment", "createElement", "createTextNode"]) || W.fail("document missing a Node creation method"), ee.isHostMethod(document, "getElementsByTagName") || W.fail("document missing getElementsByTagName method");
        var ge = document.createElement("div");
        ee.areHostMethods(ge, ["insertBefore", "appendChild", "cloneNode"]) || W.fail("Incomplete Element implementation"), ee.isHostProperty(ge, "innerHTML") || W.fail("Element is missing innerHTML property");
        var we = document.createTextNode("test");
        ee.areHostMethods(we, ["splitText", "deleteData", "insertData", "appendData", "cloneNode"]) || W.fail("Incomplete Text Node implementation");
        var ct = (
          /*Array.prototype.indexOf ?
          function(arr, val) {
              return arr.indexOf(val) > -1;
          }:*/
          function($, ne) {
            for (var Le = $.length; Le--; )
              if ($[Le] === ne)
                return !0;
            return !1;
          }
        );
        function Ot($) {
          var ne;
          return typeof $.namespaceURI == G || (ne = $.namespaceURI) === null || ne == "http://www.w3.org/1999/xhtml";
        }
        function Rt($) {
          var ne = $.parentNode;
          return ne.nodeType == 1 ? ne : null;
        }
        function ot($) {
          for (var ne = 0; $ = $.previousSibling; )
            ++ne;
          return ne;
        }
        function kt($) {
          switch ($.nodeType) {
            case 7:
            case 10:
              return 0;
            case 3:
            case 8:
              return $.length;
            default:
              return $.childNodes.length;
          }
        }
        function Ht($, ne) {
          var Le = [], Ee;
          for (Ee = $; Ee; Ee = Ee.parentNode)
            Le.push(Ee);
          for (Ee = ne; Ee; Ee = Ee.parentNode)
            if (ct(Le, Ee))
              return Ee;
          return null;
        }
        function E($, ne, Le) {
          for (var Ee = Le ? ne : ne.parentNode; Ee; ) {
            if (Ee === $)
              return !0;
            Ee = Ee.parentNode;
          }
          return !1;
        }
        function O($, ne) {
          return E($, ne, !0);
        }
        function N($, ne, Le) {
          for (var Ee, Et = Le ? $ : $.parentNode; Et; ) {
            if (Ee = Et.parentNode, Ee === ne)
              return Et;
            Et = Ee;
          }
          return null;
        }
        function z($) {
          var ne = $.nodeType;
          return ne == 3 || ne == 4 || ne == 8;
        }
        function P($) {
          if (!$)
            return !1;
          var ne = $.nodeType;
          return ne == 3 || ne == 8;
        }
        function q($, ne) {
          var Le = ne.nextSibling, Ee = ne.parentNode;
          return Le ? Ee.insertBefore($, Le) : Ee.appendChild($), $;
        }
        function Y($, ne, Le) {
          var Ee = $.cloneNode(!1);
          if (Ee.deleteData(0, ne), $.deleteData(ne, $.length - ne), q(Ee, $), Le)
            for (var Et = 0, lt; lt = Le[Et++]; )
              lt.node == $ && lt.offset > ne ? (lt.node = Ee, lt.offset -= ne) : lt.node == $.parentNode && lt.offset > ot($) && ++lt.offset;
          return Ee;
        }
        function Z($) {
          if ($.nodeType == 9)
            return $;
          if (typeof $.ownerDocument != G)
            return $.ownerDocument;
          if (typeof $.document != G)
            return $.document;
          if ($.parentNode)
            return Z($.parentNode);
          throw W.createError("getDocument: no document found for node");
        }
        function Ae($) {
          var ne = Z($);
          if (typeof ne.defaultView != G)
            return ne.defaultView;
          if (typeof ne.parentWindow != G)
            return ne.parentWindow;
          throw W.createError("Cannot get a window object for node");
        }
        function ve($) {
          if (typeof $.contentDocument != G)
            return $.contentDocument;
          if (typeof $.contentWindow != G)
            return $.contentWindow.document;
          throw W.createError("getIframeDocument: No Document object found for iframe element");
        }
        function oe($) {
          if (typeof $.contentWindow != G)
            return $.contentWindow;
          if (typeof $.contentDocument != G)
            return $.contentDocument.defaultView;
          throw W.createError("getIframeWindow: No Window object found for iframe element");
        }
        function Ze($) {
          return $ && ee.isHostMethod($, "setTimeout") && ee.isHostObject($, "document");
        }
        function Ge($, ne, Le) {
          var Ee;
          if ($ ? ee.isHostProperty($, "nodeType") ? Ee = $.nodeType == 1 && $.tagName.toLowerCase() == "iframe" ? ve($) : Z($) : Ze($) && (Ee = $.document) : Ee = document, !Ee)
            throw ne.createError(Le + "(): Parameter must be a Window object or DOM node");
          return Ee;
        }
        function Ke($) {
          for (var ne; ne = $.parentNode; )
            $ = ne;
          return $;
        }
        function Wt($, ne, Le, Ee) {
          var Et, lt, qn, Sn, rn;
          if ($ == Le)
            return ne === Ee ? 0 : ne < Ee ? -1 : 1;
          if (Et = N(Le, $, !0))
            return ne <= ot(Et) ? -1 : 1;
          if (Et = N($, Le, !0))
            return ot(Et) < Ee ? -1 : 1;
          if (lt = Ht($, Le), !lt)
            throw new Error("comparePoints error: nodes have no common ancestor");
          if (qn = $ === lt ? lt : N($, lt, !0), Sn = Le === lt ? lt : N(Le, lt, !0), qn === Sn)
            throw W.createError("comparePoints got to case 4 and childA and childB are the same!");
          for (rn = lt.firstChild; rn; ) {
            if (rn === qn)
              return -1;
            if (rn === Sn)
              return 1;
            rn = rn.nextSibling;
          }
        }
        var se = !1;
        function _e($) {
          var ne;
          try {
            return ne = $.parentNode, !1;
          } catch {
            return !0;
          }
        }
        (function() {
          var $ = document.createElement("b");
          $.innerHTML = "1";
          var ne = $.firstChild;
          $.innerHTML = "<br />", se = _e(ne), M.features.crashyTextNodes = se;
        })();
        function et($) {
          if (!$)
            return "[No node]";
          if (se && _e($))
            return "[Broken node]";
          if (z($))
            return '"' + $.data + '"';
          if ($.nodeType == 1) {
            var ne = $.id ? ' id="' + $.id + '"' : "";
            return "<" + $.nodeName + ne + ">[index:" + ot($) + ",length:" + $.childNodes.length + "][" + ($.innerHTML || "[innerHTML not supported]").slice(0, 25) + "]";
          }
          return $.nodeName;
        }
        function gt($) {
          for (var ne = Z($).createDocumentFragment(), Le; Le = $.firstChild; )
            ne.appendChild(Le);
          return ne;
        }
        var Lt;
        typeof window.getComputedStyle != G ? Lt = function($, ne) {
          return Ae($).getComputedStyle($, null)[ne];
        } : typeof document.documentElement.currentStyle != G ? Lt = function($, ne) {
          return $.currentStyle ? $.currentStyle[ne] : "";
        } : W.fail("No means of obtaining computed style properties found");
        function wn($, ne, Le) {
          var Ee = re($), Et = $.createElement("div");
          Et.contentEditable = "" + !!Le, ne && (Et.innerHTML = ne);
          var lt = Ee.firstChild;
          return lt ? Ee.insertBefore(Et, lt) : Ee.appendChild(Et), Et;
        }
        function nn($) {
          return $.parentNode.removeChild($);
        }
        function zt($) {
          this.root = $, this._next = $;
        }
        zt.prototype = {
          _current: null,
          hasNext: function() {
            return !!this._next;
          },
          next: function() {
            var $ = this._current = this._next, ne, Le;
            if (this._current)
              if (ne = $.firstChild, ne)
                this._next = ne;
              else {
                for (Le = null; $ !== this.root && !(Le = $.nextSibling); )
                  $ = $.parentNode;
                this._next = Le;
              }
            return this._current;
          },
          detach: function() {
            this._current = this._next = this.root = null;
          }
        };
        function Xt($) {
          return new zt($);
        }
        function qt($, ne) {
          this.node = $, this.offset = ne;
        }
        qt.prototype = {
          equals: function($) {
            return !!$ && this.node === $.node && this.offset == $.offset;
          },
          inspect: function() {
            return "[DomPosition(" + et(this.node) + ":" + this.offset + ")]";
          },
          toString: function() {
            return this.inspect();
          }
        };
        function pn($) {
          this.code = this[$], this.codeName = $, this.message = "DOMException: " + this.codeName;
        }
        pn.prototype = {
          INDEX_SIZE_ERR: 1,
          HIERARCHY_REQUEST_ERR: 3,
          WRONG_DOCUMENT_ERR: 4,
          NO_MODIFICATION_ALLOWED_ERR: 7,
          NOT_FOUND_ERR: 8,
          NOT_SUPPORTED_ERR: 9,
          INVALID_STATE_ERR: 11,
          INVALID_NODE_TYPE_ERR: 24
        }, pn.prototype.toString = function() {
          return this.message;
        }, M.dom = {
          arrayContains: ct,
          isHtmlNamespace: Ot,
          parentElement: Rt,
          getNodeIndex: ot,
          getNodeLength: kt,
          getCommonAncestor: Ht,
          isAncestorOf: E,
          isOrIsAncestorOf: O,
          getClosestAncestorIn: N,
          isCharacterDataNode: z,
          isTextOrCommentNode: P,
          insertAfter: q,
          splitDataNode: Y,
          getDocument: Z,
          getWindow: Ae,
          getIframeWindow: oe,
          getIframeDocument: ve,
          getBody: re,
          isWindow: Ze,
          getContentDocument: Ge,
          getRootContainer: Ke,
          comparePoints: Wt,
          isBrokenNode: _e,
          inspectNode: et,
          getComputedStyleProperty: Lt,
          createTestElement: wn,
          removeNode: nn,
          fragmentFromNodeChildren: gt,
          createIterator: Xt,
          DomPosition: qt
        }, M.DOMException = pn;
      }), C.createCoreModule("DomRange", ["DomUtil"], function(M, W) {
        var G = M.dom, ee = M.util, re = G.DomPosition, ge = M.DOMException, we = G.isCharacterDataNode, ct = G.getNodeIndex, Ot = G.isOrIsAncestorOf, Rt = G.getDocument, ot = G.comparePoints, kt = G.splitDataNode, Ht = G.getClosestAncestorIn, E = G.getNodeLength, O = G.arrayContains, N = G.getRootContainer, z = M.features.crashyTextNodes, P = G.removeNode;
        function q(x, L) {
          return x.nodeType != 3 && (Ot(x, L.startContainer) || Ot(x, L.endContainer));
        }
        function Y(x) {
          return x.document || Rt(x.startContainer);
        }
        function Z(x) {
          return N(x.startContainer);
        }
        function Ae(x) {
          return new re(x.parentNode, ct(x));
        }
        function ve(x) {
          return new re(x.parentNode, ct(x) + 1);
        }
        function oe(x, L, U) {
          var te = x.nodeType == 11 ? x.firstChild : x;
          return we(L) ? U == L.length ? G.insertAfter(x, L) : L.parentNode.insertBefore(x, U == 0 ? L : kt(L, U)) : U >= L.childNodes.length ? L.appendChild(x) : L.insertBefore(x, L.childNodes[U]), te;
        }
        function Ze(x, L, U) {
          if (dt(x), dt(L), Y(L) != Y(x))
            throw new ge("WRONG_DOCUMENT_ERR");
          var te = ot(x.startContainer, x.startOffset, L.endContainer, L.endOffset), be = ot(x.endContainer, x.endOffset, L.startContainer, L.startOffset);
          return U ? te <= 0 && be >= 0 : te < 0 && be > 0;
        }
        function Ge(x) {
          for (var L, U, te = Y(x.range).createDocumentFragment(), be; U = x.next(); ) {
            if (L = x.isPartiallySelectedSubtree(), U = U.cloneNode(!L), L && (be = x.getSubtreeIterator(), U.appendChild(Ge(be)), be.detach()), U.nodeType == 10)
              throw new ge("HIERARCHY_REQUEST_ERR");
            te.appendChild(U);
          }
          return te;
        }
        function Ke(x, L, U) {
          var te, be;
          U = U || { stop: !1 };
          for (var qe, J; qe = x.next(); )
            if (x.isPartiallySelectedSubtree()) {
              if (L(qe) === !1) {
                U.stop = !0;
                return;
              } else if (J = x.getSubtreeIterator(), Ke(J, L, U), J.detach(), U.stop)
                return;
            } else
              for (te = G.createIterator(qe); be = te.next(); )
                if (L(be) === !1) {
                  U.stop = !0;
                  return;
                }
        }
        function Wt(x) {
          for (var L; x.next(); )
            x.isPartiallySelectedSubtree() ? (L = x.getSubtreeIterator(), Wt(L), L.detach()) : x.remove();
        }
        function se(x) {
          for (var L, U = Y(x.range).createDocumentFragment(), te; L = x.next(); ) {
            if (x.isPartiallySelectedSubtree() ? (L = L.cloneNode(!1), te = x.getSubtreeIterator(), L.appendChild(se(te)), te.detach()) : x.remove(), L.nodeType == 10)
              throw new ge("HIERARCHY_REQUEST_ERR");
            U.appendChild(L);
          }
          return U;
        }
        function _e(x, L, U) {
          var te = !!(L && L.length), be, qe = !!U;
          te && (be = new RegExp("^(" + L.join("|") + ")$"));
          var J = [];
          return Ke(new gt(x, !1), function(he) {
            if (!(te && !be.test(he.nodeType)) && !(qe && !U(he))) {
              var Ce = x.startContainer;
              if (!(he == Ce && we(Ce) && x.startOffset == Ce.length)) {
                var Ue = x.endContainer;
                he == Ue && we(Ue) && x.endOffset == 0 || J.push(he);
              }
            }
          }), J;
        }
        function et(x) {
          var L = typeof x.getName > "u" ? "Range" : x.getName();
          return "[" + L + "(" + G.inspectNode(x.startContainer) + ":" + x.startOffset + ", " + G.inspectNode(x.endContainer) + ":" + x.endOffset + ")]";
        }
        function gt(x, L) {
          if (this.range = x, this.clonePartiallySelectedTextNodes = L, !x.collapsed) {
            this.sc = x.startContainer, this.so = x.startOffset, this.ec = x.endContainer, this.eo = x.endOffset;
            var U = x.commonAncestorContainer;
            this.sc === this.ec && we(this.sc) ? (this.isSingleCharacterDataNode = !0, this._first = this._last = this._next = this.sc) : (this._first = this._next = this.sc === U && !we(this.sc) ? this.sc.childNodes[this.so] : Ht(this.sc, U, !0), this._last = this.ec === U && !we(this.ec) ? this.ec.childNodes[this.eo - 1] : Ht(this.ec, U, !0));
          }
        }
        gt.prototype = {
          _current: null,
          _next: null,
          _first: null,
          _last: null,
          isSingleCharacterDataNode: !1,
          reset: function() {
            this._current = null, this._next = this._first;
          },
          hasNext: function() {
            return !!this._next;
          },
          next: function() {
            var x = this._current = this._next;
            return x && (this._next = x !== this._last ? x.nextSibling : null, we(x) && this.clonePartiallySelectedTextNodes && (x === this.ec && (x = x.cloneNode(!0)).deleteData(this.eo, x.length - this.eo), this._current === this.sc && (x = x.cloneNode(!0)).deleteData(0, this.so))), x;
          },
          remove: function() {
            var x = this._current, L, U;
            we(x) && (x === this.sc || x === this.ec) ? (L = x === this.sc ? this.so : 0, U = x === this.ec ? this.eo : x.length, L != U && x.deleteData(L, U - L)) : x.parentNode && P(x);
          },
          // Checks if the current node is partially selected
          isPartiallySelectedSubtree: function() {
            var x = this._current;
            return q(x, this.range);
          },
          getSubtreeIterator: function() {
            var x;
            if (this.isSingleCharacterDataNode)
              x = this.range.cloneRange(), x.collapse(!1);
            else {
              x = new It(Y(this.range));
              var L = this._current, U = L, te = 0, be = L, qe = E(L);
              Ot(L, this.sc) && (U = this.sc, te = this.so), Ot(L, this.ec) && (be = this.ec, qe = this.eo), tt(x, U, te, be, qe);
            }
            return new gt(x, this.clonePartiallySelectedTextNodes);
          },
          detach: function() {
            this.range = this._current = this._next = this._first = this._last = this.sc = this.so = this.ec = this.eo = null;
          }
        };
        var Lt = [1, 3, 4, 5, 7, 8, 10], wn = [2, 9, 11], nn = [5, 6, 10, 12], zt = [1, 3, 4, 5, 7, 8, 10, 11], Xt = [1, 3, 4, 5, 7, 8];
        function qt(x) {
          return function(L, U) {
            for (var te, be = U ? L : L.parentNode; be; ) {
              if (te = be.nodeType, O(x, te))
                return be;
              be = be.parentNode;
            }
            return null;
          };
        }
        var pn = qt([9, 11]), $ = qt(nn), ne = qt([6, 10, 12]), Le = qt([1]);
        function Ee(x, L) {
          if (ne(x, L))
            throw new ge("INVALID_NODE_TYPE_ERR");
        }
        function Et(x, L) {
          if (!O(L, x.nodeType))
            throw new ge("INVALID_NODE_TYPE_ERR");
        }
        function lt(x, L) {
          if (L < 0 || L > (we(x) ? x.length : x.childNodes.length))
            throw new ge("INDEX_SIZE_ERR");
        }
        function qn(x, L) {
          if (pn(x, !0) !== pn(L, !0))
            throw new ge("WRONG_DOCUMENT_ERR");
        }
        function Sn(x) {
          if ($(x, !0))
            throw new ge("NO_MODIFICATION_ALLOWED_ERR");
        }
        function rn(x, L) {
          if (!x)
            throw new ge(L);
        }
        function Ho(x, L) {
          return L <= (we(x) ? x.length : x.childNodes.length);
        }
        function yi(x) {
          return !!x.startContainer && !!x.endContainer && !(z && (G.isBrokenNode(x.startContainer) || G.isBrokenNode(x.endContainer))) && N(x.startContainer) == N(x.endContainer) && Ho(x.startContainer, x.startOffset) && Ho(x.endContainer, x.endOffset);
        }
        function dt(x) {
          if (!yi(x))
            throw new Error("Range error: Range is not valid. This usually happens after DOM mutation. Range: (" + x.inspect() + ")");
        }
        var Wo = document.createElement("style"), Rr = !1;
        try {
          Wo.innerHTML = "<b>x</b>", Rr = Wo.firstChild.nodeType == 3;
        } catch {
        }
        M.features.htmlParsingConforms = Rr;
        var zo = Rr ? (
          // Implementation as per HTML parsing spec, trusting in the browser's implementation of innerHTML. See
          // discussion and base code for this implementation at issue 67.
          // Spec: http://html5.org/specs/dom-parsing.html#extensions-to-the-range-interface
          // Thanks to Aleks Williams.
          function(x) {
            var L = this.startContainer, U = Rt(L);
            if (!L)
              throw new ge("INVALID_STATE_ERR");
            var te = null;
            return L.nodeType == 1 ? te = L : we(L) && (te = G.parentElement(L)), te === null || te.nodeName == "HTML" && G.isHtmlNamespace(Rt(te).documentElement) && G.isHtmlNamespace(te) ? te = U.createElement("body") : te = te.cloneNode(!1), te.innerHTML = x, G.fragmentFromNodeChildren(te);
          }
        ) : (
          // In this case, innerHTML cannot be trusted, so fall back to a simpler, non-conformant implementation that
          // previous versions of Rangy used (with the exception of using a body element rather than a div)
          function(x) {
            var L = Y(this), U = L.createElement("body");
            return U.innerHTML = x, G.fragmentFromNodeChildren(U);
          }
        );
        function zi(x, L) {
          dt(x);
          var U = x.startContainer, te = x.startOffset, be = x.endContainer, qe = x.endOffset, J = U === be;
          we(be) && qe > 0 && qe < be.length && kt(be, qe, L), we(U) && te > 0 && te < U.length && (U = kt(U, te, L), J ? (qe -= te, be = U) : be == U.parentNode && qe >= ct(U) && qe++, te = 0), x.setStartAndEnd(U, te, be, qe);
        }
        function Be(x) {
          dt(x);
          var L = x.commonAncestorContainer.parentNode.cloneNode(!1);
          return L.appendChild(x.cloneContents()), L.innerHTML;
        }
        var Xi = [
          "startContainer",
          "startOffset",
          "endContainer",
          "endOffset",
          "collapsed",
          "commonAncestorContainer"
        ], Gi = 0, mi = 1, Ka = 2, Gr = 3, _i = 0, Xo = 1, Go = 2, Ui = 3;
        ee.extend(M.rangePrototype, {
          compareBoundaryPoints: function(x, L) {
            dt(this), qn(this.startContainer, L.startContainer);
            var U, te, be, qe, J = x == Gr || x == Gi ? "start" : "end", he = x == mi || x == Gi ? "start" : "end";
            return U = this[J + "Container"], te = this[J + "Offset"], be = L[he + "Container"], qe = L[he + "Offset"], ot(U, te, be, qe);
          },
          insertNode: function(x) {
            if (dt(this), Et(x, zt), Sn(this.startContainer), Ot(x, this.startContainer))
              throw new ge("HIERARCHY_REQUEST_ERR");
            var L = oe(x, this.startContainer, this.startOffset);
            this.setStartBefore(L);
          },
          cloneContents: function() {
            dt(this);
            var x, L;
            if (this.collapsed)
              return Y(this).createDocumentFragment();
            if (this.startContainer === this.endContainer && we(this.startContainer))
              return x = this.startContainer.cloneNode(!0), x.data = x.data.slice(this.startOffset, this.endOffset), L = Y(this).createDocumentFragment(), L.appendChild(x), L;
            var U = new gt(this, !0);
            return x = Ge(U), U.detach(), x;
          },
          canSurroundContents: function() {
            dt(this), Sn(this.startContainer), Sn(this.endContainer);
            var x = new gt(this, !0), L = x._first && q(x._first, this) || x._last && q(x._last, this);
            return x.detach(), !L;
          },
          surroundContents: function(x) {
            if (Et(x, Xt), !this.canSurroundContents())
              throw new ge("INVALID_STATE_ERR");
            var L = this.extractContents();
            if (x.hasChildNodes())
              for (; x.lastChild; )
                x.removeChild(x.lastChild);
            oe(x, this.startContainer, this.startOffset), x.appendChild(L), this.selectNode(x);
          },
          cloneRange: function() {
            dt(this);
            for (var x = new It(Y(this)), L = Xi.length, U; L--; )
              U = Xi[L], x[U] = this[U];
            return x;
          },
          toString: function() {
            dt(this);
            var x = this.startContainer;
            if (x === this.endContainer && we(x))
              return x.nodeType == 3 || x.nodeType == 4 ? x.data.slice(this.startOffset, this.endOffset) : "";
            var L = [], U = new gt(this, !0);
            return Ke(U, function(te) {
              (te.nodeType == 3 || te.nodeType == 4) && L.push(te.data);
            }), U.detach(), L.join("");
          },
          // The methods below are all non-standard. The following batch were introduced by Mozilla but have since
          // been removed from Mozilla.
          compareNode: function(x) {
            dt(this);
            var L = x.parentNode, U = ct(x);
            if (!L)
              throw new ge("NOT_FOUND_ERR");
            var te = this.comparePoint(L, U), be = this.comparePoint(L, U + 1);
            return te < 0 ? be > 0 ? Go : _i : be > 0 ? Xo : Ui;
          },
          comparePoint: function(x, L) {
            return dt(this), rn(x, "HIERARCHY_REQUEST_ERR"), qn(x, this.startContainer), ot(x, L, this.startContainer, this.startOffset) < 0 ? -1 : ot(x, L, this.endContainer, this.endOffset) > 0 ? 1 : 0;
          },
          createContextualFragment: zo,
          toHtml: function() {
            return Be(this);
          },
          // touchingIsIntersecting determines whether this method considers a node that borders a range intersects
          // with it (as in WebKit) or not (as in Gecko pre-1.9, and the default)
          intersectsNode: function(x, L) {
            if (dt(this), N(x) != Z(this))
              return !1;
            var U = x.parentNode, te = ct(x);
            if (!U)
              return !0;
            var be = ot(U, te, this.endContainer, this.endOffset), qe = ot(U, te + 1, this.startContainer, this.startOffset);
            return L ? be <= 0 && qe >= 0 : be < 0 && qe > 0;
          },
          isPointInRange: function(x, L) {
            return dt(this), rn(x, "HIERARCHY_REQUEST_ERR"), qn(x, this.startContainer), ot(x, L, this.startContainer, this.startOffset) >= 0 && ot(x, L, this.endContainer, this.endOffset) <= 0;
          },
          // The methods below are non-standard and invented by me.
          // Sharing a boundary start-to-end or end-to-start does not count as intersection.
          intersectsRange: function(x) {
            return Ze(this, x, !1);
          },
          // Sharing a boundary start-to-end or end-to-start does count as intersection.
          intersectsOrTouchesRange: function(x) {
            return Ze(this, x, !0);
          },
          intersection: function(x) {
            if (this.intersectsRange(x)) {
              var L = ot(this.startContainer, this.startOffset, x.startContainer, x.startOffset), U = ot(this.endContainer, this.endOffset, x.endContainer, x.endOffset), te = this.cloneRange();
              return L == -1 && te.setStart(x.startContainer, x.startOffset), U == 1 && te.setEnd(x.endContainer, x.endOffset), te;
            }
            return null;
          },
          union: function(x) {
            if (this.intersectsOrTouchesRange(x)) {
              var L = this.cloneRange();
              return ot(x.startContainer, x.startOffset, this.startContainer, this.startOffset) == -1 && L.setStart(x.startContainer, x.startOffset), ot(x.endContainer, x.endOffset, this.endContainer, this.endOffset) == 1 && L.setEnd(x.endContainer, x.endOffset), L;
            } else
              throw new ge("Ranges do not intersect");
          },
          containsNode: function(x, L) {
            return L ? this.intersectsNode(x, !1) : this.compareNode(x) == Ui;
          },
          containsNodeContents: function(x) {
            return this.comparePoint(x, 0) >= 0 && this.comparePoint(x, E(x)) <= 0;
          },
          containsRange: function(x) {
            var L = this.intersection(x);
            return L !== null && x.equals(L);
          },
          containsNodeText: function(x) {
            var L = this.cloneRange();
            L.selectNode(x);
            var U = L.getNodes([3]);
            if (U.length > 0) {
              L.setStart(U[0], 0);
              var te = U.pop();
              return L.setEnd(te, te.length), this.containsRange(L);
            } else
              return this.containsNodeContents(x);
          },
          getNodes: function(x, L) {
            return dt(this), _e(this, x, L);
          },
          getDocument: function() {
            return Y(this);
          },
          collapseBefore: function(x) {
            this.setEndBefore(x), this.collapse(!1);
          },
          collapseAfter: function(x) {
            this.setStartAfter(x), this.collapse(!0);
          },
          getBookmark: function(x) {
            var L = Y(this), U = M.createRange(L);
            x = x || G.getBody(L), U.selectNodeContents(x);
            var te = this.intersection(U), be = 0, qe = 0;
            return te && (U.setEnd(te.startContainer, te.startOffset), be = U.toString().length, qe = be + te.toString().length), {
              start: be,
              end: qe,
              containerNode: x
            };
          },
          moveToBookmark: function(x) {
            var L = x.containerNode, U = 0;
            this.setStart(L, 0), this.collapse(!0);
            for (var te = [L], be, qe = !1, J = !1, he, Ce, Ue; !J && (be = te.pop()); )
              if (be.nodeType == 3)
                he = U + be.length, !qe && x.start >= U && x.start <= he && (this.setStart(be, x.start - U), qe = !0), qe && x.end >= U && x.end <= he && (this.setEnd(be, x.end - U), J = !0), U = he;
              else
                for (Ue = be.childNodes, Ce = Ue.length; Ce--; )
                  te.push(Ue[Ce]);
          },
          getName: function() {
            return "DomRange";
          },
          equals: function(x) {
            return It.rangesEqual(this, x);
          },
          isValid: function() {
            return yi(this);
          },
          inspect: function() {
            return et(this);
          },
          detach: function() {
          }
        });
        function b(x) {
          x.START_TO_START = Gi, x.START_TO_END = mi, x.END_TO_END = Ka, x.END_TO_START = Gr, x.NODE_BEFORE = _i, x.NODE_AFTER = Xo, x.NODE_BEFORE_AND_AFTER = Go, x.NODE_INSIDE = Ui;
        }
        function j(x) {
          b(x), b(x.prototype);
        }
        function V(x, L) {
          return function() {
            dt(this);
            var U = this.startContainer, te = this.startOffset, be = this.commonAncestorContainer, qe = new gt(this, !0), J, he;
            U !== be && (J = Ht(U, be, !0), he = ve(J), U = he.node, te = he.offset), Ke(qe, Sn), qe.reset();
            var Ce = x(qe);
            return qe.detach(), L(this, U, te, U, te), Ce;
          };
        }
        function le(x, L) {
          function U(J, he) {
            return function(Ce) {
              Et(Ce, Lt), Et(N(Ce), wn);
              var Ue = (J ? Ae : ve)(Ce);
              (he ? te : be)(this, Ue.node, Ue.offset);
            };
          }
          function te(J, he, Ce) {
            var Ue = J.endContainer, on = J.endOffset;
            (he !== J.startContainer || Ce !== J.startOffset) && ((N(he) != N(Ue) || ot(he, Ce, Ue, on) == 1) && (Ue = he, on = Ce), L(J, he, Ce, Ue, on));
          }
          function be(J, he, Ce) {
            var Ue = J.startContainer, on = J.startOffset;
            (he !== J.endContainer || Ce !== J.endOffset) && ((N(he) != N(Ue) || ot(he, Ce, Ue, on) == -1) && (Ue = he, on = Ce), L(J, Ue, on, he, Ce));
          }
          var qe = function() {
          };
          qe.prototype = M.rangePrototype, x.prototype = new qe(), ee.extend(x.prototype, {
            setStart: function(J, he) {
              Ee(J, !0), lt(J, he), te(this, J, he);
            },
            setEnd: function(J, he) {
              Ee(J, !0), lt(J, he), be(this, J, he);
            },
            /**
             * Convenience method to set a range's start and end boundaries. Overloaded as follows:
             * - Two parameters (node, offset) creates a collapsed range at that position
             * - Three parameters (node, startOffset, endOffset) creates a range contained with node starting at
             *   startOffset and ending at endOffset
             * - Four parameters (startNode, startOffset, endNode, endOffset) creates a range starting at startOffset in
             *   startNode and ending at endOffset in endNode
             */
            setStartAndEnd: function() {
              var J = arguments, he = J[0], Ce = J[1], Ue = he, on = Ce;
              switch (J.length) {
                case 3:
                  on = J[2];
                  break;
                case 4:
                  Ue = J[2], on = J[3];
                  break;
              }
              Ee(he, !0), lt(he, Ce), Ee(Ue, !0), lt(Ue, on), L(this, he, Ce, Ue, on);
            },
            setBoundary: function(J, he, Ce) {
              this["set" + (Ce ? "Start" : "End")](J, he);
            },
            setStartBefore: U(!0, !0),
            setStartAfter: U(!1, !0),
            setEndBefore: U(!0, !1),
            setEndAfter: U(!1, !1),
            collapse: function(J) {
              dt(this), J ? L(this, this.startContainer, this.startOffset, this.startContainer, this.startOffset) : L(this, this.endContainer, this.endOffset, this.endContainer, this.endOffset);
            },
            selectNodeContents: function(J) {
              Ee(J, !0), L(this, J, 0, J, E(J));
            },
            selectNode: function(J) {
              Ee(J, !1), Et(J, Lt);
              var he = Ae(J), Ce = ve(J);
              L(this, he.node, he.offset, Ce.node, Ce.offset);
            },
            extractContents: V(se, L),
            deleteContents: V(Wt, L),
            canSurroundContents: function() {
              dt(this), Sn(this.startContainer), Sn(this.endContainer);
              var J = new gt(this, !0), he = J._first && q(J._first, this) || J._last && q(J._last, this);
              return J.detach(), !he;
            },
            splitBoundaries: function() {
              zi(this);
            },
            splitBoundariesPreservingPositions: function(J) {
              zi(this, J);
            },
            normalizeBoundaries: function() {
              dt(this);
              var J = this.startContainer, he = this.startOffset, Ce = this.endContainer, Ue = this.endOffset, on = function(vn) {
                var yr = vn.nextSibling;
                yr && yr.nodeType == vn.nodeType && (Ce = vn, Ue = vn.length, vn.appendData(yr.data), P(yr));
              }, xd = function(vn) {
                var yr = vn.previousSibling;
                if (yr && yr.nodeType == vn.nodeType) {
                  J = vn;
                  var $_ = vn.length;
                  if (he = yr.length, vn.insertData(0, yr.data), P(yr), J == Ce)
                    Ue += he, Ce = J;
                  else if (Ce == vn.parentNode) {
                    var Ed = ct(vn);
                    Ue == Ed ? (Ce = vn, Ue = $_) : Ue > Ed && Ue--;
                  }
                }
              }, hu = !0, Rn;
              if (we(Ce))
                Ue == Ce.length ? on(Ce) : Ue == 0 && (Rn = Ce.previousSibling, Rn && Rn.nodeType == Ce.nodeType && (Ue = Rn.length, J == Ce && (hu = !1), Rn.appendData(Ce.data), P(Ce), Ce = Rn));
              else {
                if (Ue > 0) {
                  var pu = Ce.childNodes[Ue - 1];
                  pu && we(pu) && on(pu);
                }
                hu = !this.collapsed;
              }
              if (hu) {
                if (we(J))
                  he == 0 ? xd(J) : he == J.length && (Rn = J.nextSibling, Rn && Rn.nodeType == J.nodeType && (Ce == Rn && (Ce = J, Ue += J.length), J.appendData(Rn.data), P(Rn)));
                else if (he < J.childNodes.length) {
                  var vu = J.childNodes[he];
                  vu && we(vu) && xd(vu);
                }
              } else
                J = Ce, he = Ue;
              L(this, J, he, Ce, Ue);
            },
            collapseToPoint: function(J, he) {
              Ee(J, !0), lt(J, he), this.setStartAndEnd(J, he);
            },
            parentElement: function() {
              dt(this);
              var J = this.commonAncestorContainer;
              return J ? Le(this.commonAncestorContainer, !0) : null;
            }
          }), j(x);
        }
        function Pe(x) {
          x.collapsed = x.startContainer === x.endContainer && x.startOffset === x.endOffset, x.commonAncestorContainer = x.collapsed ? x.startContainer : G.getCommonAncestor(x.startContainer, x.endContainer);
        }
        function tt(x, L, U, te, be) {
          x.startContainer = L, x.startOffset = U, x.endContainer = te, x.endOffset = be, x.document = G.getDocument(L), Pe(x);
        }
        function It(x) {
          tt(this, x, 0, x, 0);
        }
        le(It, tt), ee.extend(It, {
          rangeProperties: Xi,
          RangeIterator: gt,
          copyComparisonConstants: j,
          createPrototypeRange: le,
          inspect: et,
          toHtml: Be,
          getRangeDocument: Y,
          rangesEqual: function(x, L) {
            return x.startContainer === L.startContainer && x.startOffset === L.startOffset && x.endContainer === L.endContainer && x.endOffset === L.endOffset;
          }
        }), M.DomRange = It;
      }), C.createCoreModule("WrappedRange", ["DomRange"], function(M, W) {
        var G, ee, re = M.dom, ge = M.util, we = re.DomPosition, ct = M.DomRange, Ot = re.getBody, Rt = re.getContentDocument, ot = re.isCharacterDataNode;
        if (M.features.implementsDomRange && function() {
          var P, q = ct.rangeProperties;
          function Y(se) {
            for (var _e = q.length, et; _e--; )
              et = q[_e], se[et] = se.nativeRange[et];
            se.collapsed = se.startContainer === se.endContainer && se.startOffset === se.endOffset;
          }
          function Z(se, _e, et, gt, Lt) {
            var wn = se.startContainer !== _e || se.startOffset != et, nn = se.endContainer !== gt || se.endOffset != Lt, zt = !se.equals(se.nativeRange);
            (wn || nn || zt) && (se.setEnd(gt, Lt), se.setStart(_e, et));
          }
          var Ae;
          G = function(se) {
            if (!se)
              throw W.createError("WrappedRange: Range must be specified");
            this.nativeRange = se, Y(this);
          }, ct.createPrototypeRange(G, Z), P = G.prototype, P.selectNode = function(se) {
            this.nativeRange.selectNode(se), Y(this);
          }, P.cloneContents = function() {
            return this.nativeRange.cloneContents();
          }, P.surroundContents = function(se) {
            this.nativeRange.surroundContents(se), Y(this);
          }, P.collapse = function(se) {
            this.nativeRange.collapse(se), Y(this);
          }, P.cloneRange = function() {
            return new G(this.nativeRange.cloneRange());
          }, P.refresh = function() {
            Y(this);
          }, P.toString = function() {
            return this.nativeRange.toString();
          };
          var ve = document.createTextNode("test");
          Ot(document).appendChild(ve);
          var oe = document.createRange();
          oe.setStart(ve, 0), oe.setEnd(ve, 0);
          try {
            oe.setStart(ve, 1), P.setStart = function(se, _e) {
              this.nativeRange.setStart(se, _e), Y(this);
            }, P.setEnd = function(se, _e) {
              this.nativeRange.setEnd(se, _e), Y(this);
            }, Ae = function(se) {
              return function(_e) {
                this.nativeRange[se](_e), Y(this);
              };
            };
          } catch {
            P.setStart = function(_e, et) {
              try {
                this.nativeRange.setStart(_e, et);
              } catch {
                this.nativeRange.setEnd(_e, et), this.nativeRange.setStart(_e, et);
              }
              Y(this);
            }, P.setEnd = function(_e, et) {
              try {
                this.nativeRange.setEnd(_e, et);
              } catch {
                this.nativeRange.setStart(_e, et), this.nativeRange.setEnd(_e, et);
              }
              Y(this);
            }, Ae = function(_e, et) {
              return function(gt) {
                try {
                  this.nativeRange[_e](gt);
                } catch {
                  this.nativeRange[et](gt), this.nativeRange[_e](gt);
                }
                Y(this);
              };
            };
          }
          P.setStartBefore = Ae("setStartBefore", "setEndBefore"), P.setStartAfter = Ae("setStartAfter", "setEndAfter"), P.setEndBefore = Ae("setEndBefore", "setStartBefore"), P.setEndAfter = Ae("setEndAfter", "setStartAfter"), P.selectNodeContents = function(se) {
            this.setStartAndEnd(se, 0, re.getNodeLength(se));
          }, oe.selectNodeContents(ve), oe.setEnd(ve, 3);
          var Ze = document.createRange();
          Ze.selectNodeContents(ve), Ze.setEnd(ve, 4), Ze.setStart(ve, 2), oe.compareBoundaryPoints(oe.START_TO_END, Ze) == -1 && oe.compareBoundaryPoints(oe.END_TO_START, Ze) == 1 ? P.compareBoundaryPoints = function(se, _e) {
            return _e = _e.nativeRange || _e, se == _e.START_TO_END ? se = _e.END_TO_START : se == _e.END_TO_START && (se = _e.START_TO_END), this.nativeRange.compareBoundaryPoints(se, _e);
          } : P.compareBoundaryPoints = function(se, _e) {
            return this.nativeRange.compareBoundaryPoints(se, _e.nativeRange || _e);
          };
          var Ge = document.createElement("div");
          Ge.innerHTML = "123";
          var Ke = Ge.firstChild, Wt = Ot(document);
          Wt.appendChild(Ge), oe.setStart(Ke, 1), oe.setEnd(Ke, 2), oe.deleteContents(), Ke.data == "13" && (P.deleteContents = function() {
            this.nativeRange.deleteContents(), Y(this);
          }, P.extractContents = function() {
            var se = this.nativeRange.extractContents();
            return Y(this), se;
          }), Wt.removeChild(Ge), Wt = null, ge.isHostMethod(oe, "createContextualFragment") && (P.createContextualFragment = function(se) {
            return this.nativeRange.createContextualFragment(se);
          }), Ot(document).removeChild(ve), P.getName = function() {
            return "WrappedRange";
          }, M.WrappedRange = G, M.createNativeRange = function(se) {
            return se = Rt(se, W, "createNativeRange"), se.createRange();
          };
        }(), M.features.implementsTextRange) {
          var kt = function(P) {
            var q = P.parentElement(), Y = P.duplicate();
            Y.collapse(!0);
            var Z = Y.parentElement();
            Y = P.duplicate(), Y.collapse(!1);
            var Ae = Y.parentElement(), ve = Z == Ae ? Z : re.getCommonAncestor(Z, Ae);
            return ve == q ? ve : re.getCommonAncestor(q, ve);
          }, Ht = function(P) {
            return P.compareEndPoints("StartToEnd", P) == 0;
          }, E = function(P, q, Y, Z, Ae) {
            var ve = P.duplicate();
            ve.collapse(Y);
            var oe = ve.parentElement();
            if (re.isOrIsAncestorOf(q, oe) || (oe = q), !oe.canHaveHTML) {
              var Ze = new we(oe.parentNode, re.getNodeIndex(oe));
              return {
                boundaryPosition: Ze,
                nodeInfo: {
                  nodeIndex: Ze.offset,
                  containerElement: Ze.node
                }
              };
            }
            var Ge = re.getDocument(oe).createElement("span");
            Ge.parentNode && re.removeNode(Ge);
            for (var Ke, Wt = Y ? "StartToStart" : "StartToEnd", se, _e, et, gt, Lt = Ae && Ae.containerElement == oe ? Ae.nodeIndex : 0, wn = oe.childNodes.length, nn = wn, zt = nn; zt == wn ? oe.appendChild(Ge) : oe.insertBefore(Ge, oe.childNodes[zt]), ve.moveToElementText(Ge), Ke = ve.compareEndPoints(Wt, P), !(Ke == 0 || Lt == nn); ) {
              if (Ke == -1) {
                if (nn == Lt + 1)
                  break;
                Lt = zt;
              } else
                nn = nn == Lt + 1 ? Lt : zt;
              zt = Math.floor((Lt + nn) / 2), oe.removeChild(Ge);
            }
            if (gt = Ge.nextSibling, Ke == -1 && gt && ot(gt)) {
              ve.setEndPoint(Y ? "EndToStart" : "EndToEnd", P);
              var Xt;
              if (/[\r\n]/.test(gt.data)) {
                var qt = ve.duplicate(), pn = qt.text.replace(/\r\n/g, "\r").length;
                for (Xt = qt.moveStart("character", pn); (Ke = qt.compareEndPoints("StartToEnd", qt)) == -1; )
                  Xt++, qt.moveStart("character", 1);
              } else
                Xt = ve.text.length;
              et = new we(gt, Xt);
            } else
              se = (Z || !Y) && Ge.previousSibling, _e = (Z || Y) && Ge.nextSibling, _e && ot(_e) ? et = new we(_e, 0) : se && ot(se) ? et = new we(se, se.data.length) : et = new we(oe, re.getNodeIndex(Ge));
            return re.removeNode(Ge), {
              boundaryPosition: et,
              nodeInfo: {
                nodeIndex: zt,
                containerElement: oe
              }
            };
          }, O = function(P, q) {
            var Y, Z, Ae = P.offset, ve = re.getDocument(P.node), oe, Ze, Ge = Ot(ve).createTextRange(), Ke = ot(P.node);
            return Ke ? (Y = P.node, Z = Y.parentNode) : (Ze = P.node.childNodes, Y = Ae < Ze.length ? Ze[Ae] : null, Z = P.node), oe = ve.createElement("span"), oe.innerHTML = "&#feff;", Y ? Z.insertBefore(oe, Y) : Z.appendChild(oe), Ge.moveToElementText(oe), Ge.collapse(!q), Z.removeChild(oe), Ke && Ge[q ? "moveStart" : "moveEnd"]("character", Ae), Ge;
          };
          ee = function(P) {
            this.textRange = P, this.refresh();
          }, ee.prototype = new ct(document), ee.prototype.refresh = function() {
            var P, q, Y, Z = kt(this.textRange);
            Ht(this.textRange) ? q = P = E(
              this.textRange,
              Z,
              !0,
              !0
            ).boundaryPosition : (Y = E(this.textRange, Z, !0, !1), P = Y.boundaryPosition, q = E(
              this.textRange,
              Z,
              !1,
              !1,
              Y.nodeInfo
            ).boundaryPosition), this.setStart(P.node, P.offset), this.setEnd(q.node, q.offset);
          }, ee.prototype.getName = function() {
            return "WrappedTextRange";
          }, ct.copyComparisonConstants(ee);
          var N = function(P) {
            if (P.collapsed)
              return O(new we(P.startContainer, P.startOffset), !0);
            var q = O(new we(P.startContainer, P.startOffset), !0), Y = O(new we(P.endContainer, P.endOffset), !1), Z = Ot(ct.getRangeDocument(P)).createTextRange();
            return Z.setEndPoint("StartToStart", q), Z.setEndPoint("EndToEnd", Y), Z;
          };
          if (ee.rangeToTextRange = N, ee.prototype.toTextRange = function() {
            return N(this);
          }, M.WrappedTextRange = ee, !M.features.implementsDomRange || M.config.preferTextRange) {
            var z = function(P) {
              return P("return this;")();
            }(Function);
            typeof z.Range > "u" && (z.Range = ee), M.createNativeRange = function(P) {
              return P = Rt(P, W, "createNativeRange"), Ot(P).createTextRange();
            }, M.WrappedRange = ee;
          }
        }
        M.createRange = function(P) {
          return P = Rt(P, W, "createRange"), new M.WrappedRange(M.createNativeRange(P));
        }, M.createRangyRange = function(P) {
          return P = Rt(P, W, "createRangyRange"), new ct(P);
        }, ge.createAliasForDeprecatedMethod(M, "createIframeRange", "createRange"), ge.createAliasForDeprecatedMethod(M, "createIframeRangyRange", "createRangyRange"), M.addShimListener(function(P) {
          var q = P.document;
          typeof q.createRange > "u" && (q.createRange = function() {
            return M.createRange(q);
          }), q = P = null;
        });
      }), C.createCoreModule("WrappedSelection", ["DomRange", "WrappedRange"], function(M, W) {
        M.config.checkSelectionRanges = !0;
        var G = "boolean", ee = "number", re = M.dom, ge = M.util, we = ge.isHostMethod, ct = M.DomRange, Ot = M.WrappedRange, Rt = M.DOMException, ot = re.DomPosition, kt, Ht, E = M.features, O = "Control", N = re.getDocument, z = re.getBody, P = ct.rangesEqual;
        function q(b) {
          return typeof b == "string" ? /^backward(s)?$/i.test(b) : !!b;
        }
        function Y(b, j) {
          if (b) {
            if (re.isWindow(b))
              return b;
            if (b instanceof dt)
              return b.win;
            var V = re.getContentDocument(b, W, j);
            return re.getWindow(V);
          } else return window;
        }
        function Z(b) {
          return Y(b, "getWinSelection").getSelection();
        }
        function Ae(b) {
          return Y(b, "getDocSelection").document.selection;
        }
        function ve(b) {
          var j = !1;
          return b.anchorNode && (j = re.comparePoints(b.anchorNode, b.anchorOffset, b.focusNode, b.focusOffset) == 1), j;
        }
        var oe = we(window, "getSelection"), Ze = ge.isHostObject(document, "selection");
        E.implementsWinGetSelection = oe, E.implementsDocSelection = Ze;
        var Ge = Ze && (!oe || M.config.preferTextRange);
        if (Ge)
          kt = Ae, M.isSelectionValid = function(b) {
            var j = Y(b, "isSelectionValid").document, V = j.selection;
            return V.type != "None" || N(V.createRange().parentElement()) == j;
          };
        else if (oe)
          kt = Z, M.isSelectionValid = function() {
            return !0;
          };
        else
          return W.fail("Neither document.selection or window.getSelection() detected."), !1;
        M.getNativeSelection = kt;
        var Ke = kt();
        if (!Ke)
          return W.fail("Native selection was null (possibly issue 138?)"), !1;
        var Wt = M.createNativeRange(document), se = z(document), _e = ge.areHostProperties(
          Ke,
          ["anchorNode", "focusNode", "anchorOffset", "focusOffset"]
        );
        E.selectionHasAnchorAndFocus = _e;
        var et = we(Ke, "extend");
        E.selectionHasExtend = et;
        var gt = we(Ke, "setBaseAndExtent");
        E.selectionHasSetBaseAndExtent = gt;
        var Lt = typeof Ke.rangeCount == ee;
        E.selectionHasRangeCount = Lt;
        var wn = !1, nn = !0, zt = et ? function(b, j) {
          var V = ct.getRangeDocument(j), le = M.createRange(V);
          le.collapseToPoint(j.endContainer, j.endOffset), b.addRange(Ee(le)), b.extend(j.startContainer, j.startOffset);
        } : null;
        ge.areHostMethods(Ke, ["addRange", "getRangeAt", "removeAllRanges"]) && typeof Ke.rangeCount == ee && E.implementsDomRange && function() {
          var b = window.getSelection();
          if (b) {
            for (var j = b.rangeCount, V = j > 1, le = [], Pe = ve(b), tt = 0; tt < j; ++tt)
              le[tt] = b.getRangeAt(tt);
            var It = re.createTestElement(document, "", !1), x = It.appendChild(document.createTextNode("   ")), L = document.createRange();
            if (L.setStart(x, 1), L.collapse(!0), b.removeAllRanges(), b.addRange(L), nn = b.rangeCount == 1, b.removeAllRanges(), !V) {
              var U = window.navigator.appVersion.match(/Chrome\/(.*?) /);
              if (U && parseInt(U[1]) >= 36)
                wn = !1;
              else {
                var te = L.cloneRange();
                L.setStart(x, 0), te.setEnd(x, 3), te.setStart(x, 2), b.addRange(L), b.addRange(te), wn = b.rangeCount == 2;
              }
            }
            for (re.removeNode(It), b.removeAllRanges(), tt = 0; tt < j; ++tt)
              tt == 0 && Pe ? zt ? zt(b, le[tt]) : (M.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"), b.addRange(le[tt])) : b.addRange(le[tt]);
          }
        }(), E.selectionSupportsMultipleRanges = wn, E.collapsedNonEditableSelectionsSupported = nn;
        var Xt = !1, qt;
        se && we(se, "createControlRange") && (qt = se.createControlRange(), ge.areHostProperties(qt, ["item", "add"]) && (Xt = !0)), E.implementsControlRange = Xt, _e ? Ht = function(b) {
          return b.anchorNode === b.focusNode && b.anchorOffset === b.focusOffset;
        } : Ht = function(b) {
          return b.rangeCount ? b.getRangeAt(b.rangeCount - 1).collapsed : !1;
        };
        function pn(b, j, V) {
          var le = V ? "end" : "start", Pe = V ? "start" : "end";
          b.anchorNode = j[le + "Container"], b.anchorOffset = j[le + "Offset"], b.focusNode = j[Pe + "Container"], b.focusOffset = j[Pe + "Offset"];
        }
        function $(b) {
          var j = b.nativeSelection;
          b.anchorNode = j.anchorNode, b.anchorOffset = j.anchorOffset, b.focusNode = j.focusNode, b.focusOffset = j.focusOffset;
        }
        function ne(b) {
          b.anchorNode = b.focusNode = null, b.anchorOffset = b.focusOffset = 0, b.rangeCount = 0, b.isCollapsed = !0, b._ranges.length = 0, Le(b);
        }
        function Le(b) {
          b.type = b.rangeCount == 0 ? "None" : Ht(b) ? "Caret" : "Range";
        }
        function Ee(b) {
          var j;
          return b instanceof ct ? (j = M.createNativeRange(b.getDocument()), j.setEnd(b.endContainer, b.endOffset), j.setStart(b.startContainer, b.startOffset)) : b instanceof Ot ? j = b.nativeRange : E.implementsDomRange && b instanceof re.getWindow(b.startContainer).Range && (j = b), j;
        }
        function Et(b) {
          if (!b.length || b[0].nodeType != 1)
            return !1;
          for (var j = 1, V = b.length; j < V; ++j)
            if (!re.isAncestorOf(b[0], b[j]))
              return !1;
          return !0;
        }
        function lt(b) {
          var j = b.getNodes();
          if (!Et(j))
            throw W.createError("getSingleElementFromRange: range " + b.inspect() + " did not consist of a single element");
          return j[0];
        }
        function qn(b) {
          return !!b && typeof b.text < "u";
        }
        function Sn(b, j) {
          var V = new Ot(j);
          b._ranges = [V], pn(b, V, !1), b.rangeCount = 1, b.isCollapsed = V.collapsed, Le(b);
        }
        function rn(b) {
          if (b._ranges.length = 0, b.docSelection.type == "None")
            ne(b);
          else {
            var j = b.docSelection.createRange();
            if (qn(j))
              Sn(b, j);
            else {
              b.rangeCount = j.length;
              for (var V, le = N(j.item(0)), Pe = 0; Pe < b.rangeCount; ++Pe)
                V = M.createRange(le), V.selectNode(j.item(Pe)), b._ranges.push(V);
              b.isCollapsed = b.rangeCount == 1 && b._ranges[0].collapsed, pn(b, b._ranges[b.rangeCount - 1], !1), Le(b);
            }
          }
        }
        function Ho(b, j) {
          for (var V = b.docSelection.createRange(), le = lt(j), Pe = N(V.item(0)), tt = z(Pe).createControlRange(), It = 0, x = V.length; It < x; ++It)
            tt.add(V.item(It));
          try {
            tt.add(le);
          } catch {
            throw W.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)");
          }
          tt.select(), rn(b);
        }
        var yi;
        we(Ke, "getRangeAt") ? yi = function(b, j) {
          try {
            return b.getRangeAt(j);
          } catch {
            return null;
          }
        } : _e && (yi = function(b) {
          var j = N(b.anchorNode), V = M.createRange(j);
          return V.setStartAndEnd(b.anchorNode, b.anchorOffset, b.focusNode, b.focusOffset), V.collapsed !== this.isCollapsed && V.setStartAndEnd(b.focusNode, b.focusOffset, b.anchorNode, b.anchorOffset), V;
        });
        function dt(b, j, V) {
          this.nativeSelection = b, this.docSelection = j, this._ranges = [], this.win = V, this.refresh();
        }
        dt.prototype = M.selectionPrototype;
        function Wo(b) {
          b.win = b.anchorNode = b.focusNode = b._ranges = null, b.rangeCount = b.anchorOffset = b.focusOffset = 0, b.detached = !0, Le(b);
        }
        var Rr = [];
        function zo(b, j) {
          for (var V = Rr.length, le, Pe; V--; )
            if (le = Rr[V], Pe = le.selection, j == "deleteAll")
              Wo(Pe);
            else if (le.win == b)
              return j == "delete" ? (Rr.splice(V, 1), !0) : Pe;
          return j == "deleteAll" && (Rr.length = 0), null;
        }
        var zi = function(b) {
          if (b && b instanceof dt)
            return b.refresh(), b;
          b = Y(b, "getNativeSelection");
          var j = zo(b), V = kt(b), le = Ze ? Ae(b) : null;
          return j ? (j.nativeSelection = V, j.docSelection = le, j.refresh()) : (j = new dt(V, le, b), Rr.push({ win: b, selection: j })), j;
        };
        M.getSelection = zi, ge.createAliasForDeprecatedMethod(M, "getIframeSelection", "getSelection");
        var Be = dt.prototype;
        function Xi(b, j) {
          for (var V = N(j[0].startContainer), le = z(V).createControlRange(), Pe = 0, tt, It = j.length; Pe < It; ++Pe) {
            tt = lt(j[Pe]);
            try {
              le.add(tt);
            } catch {
              throw W.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)");
            }
          }
          le.select(), rn(b);
        }
        if (!Ge && _e && ge.areHostMethods(Ke, ["removeAllRanges", "addRange"])) {
          Be.removeAllRanges = function() {
            this.nativeSelection.removeAllRanges(), ne(this);
          };
          var Gi = function(b, j) {
            zt(b.nativeSelection, j), b.refresh();
          };
          Lt ? Be.addRange = function(b, j) {
            if (Xt && Ze && this.docSelection.type == O)
              Ho(this, b);
            else if (q(j) && et)
              Gi(this, b);
            else {
              var V;
              wn ? V = this.rangeCount : (this.removeAllRanges(), V = 0);
              var le = Ee(b).cloneRange();
              try {
                this.nativeSelection.addRange(le);
              } catch {
              }
              if (this.rangeCount = this.nativeSelection.rangeCount, this.rangeCount == V + 1) {
                if (M.config.checkSelectionRanges) {
                  var Pe = yi(this.nativeSelection, this.rangeCount - 1);
                  Pe && !P(Pe, b) && (b = new Ot(Pe));
                }
                this._ranges[this.rangeCount - 1] = b, pn(this, b, Gr(this.nativeSelection)), this.isCollapsed = Ht(this), Le(this);
              } else
                this.refresh();
            }
          } : Be.addRange = function(b, j) {
            q(j) && et ? Gi(this, b) : (this.nativeSelection.addRange(Ee(b)), this.refresh());
          }, Be.setRanges = function(b) {
            if (Xt && Ze && b.length > 1)
              Xi(this, b);
            else {
              this.removeAllRanges();
              for (var j = 0, V = b.length; j < V; ++j)
                this.addRange(b[j]);
            }
          };
        } else if (we(Ke, "empty") && we(Wt, "select") && Xt && Ge)
          Be.removeAllRanges = function() {
            try {
              if (this.docSelection.empty(), this.docSelection.type != "None") {
                var b;
                if (this.anchorNode)
                  b = N(this.anchorNode);
                else if (this.docSelection.type == O) {
                  var j = this.docSelection.createRange();
                  j.length && (b = N(j.item(0)));
                }
                if (b) {
                  var V = z(b).createTextRange();
                  V.select(), this.docSelection.empty();
                }
              }
            } catch {
            }
            ne(this);
          }, Be.addRange = function(b) {
            this.docSelection.type == O ? Ho(this, b) : (M.WrappedTextRange.rangeToTextRange(b).select(), this._ranges[0] = b, this.rangeCount = 1, this.isCollapsed = this._ranges[0].collapsed, pn(this, b, !1), Le(this));
          }, Be.setRanges = function(b) {
            this.removeAllRanges();
            var j = b.length;
            j > 1 ? Xi(this, b) : j && this.addRange(b[0]);
          };
        else
          return W.fail("No means of selecting a Range or TextRange was found"), !1;
        Be.getRangeAt = function(b) {
          if (b < 0 || b >= this.rangeCount)
            throw new Rt("INDEX_SIZE_ERR");
          return this._ranges[b].cloneRange();
        };
        var mi;
        if (Ge)
          mi = function(b) {
            var j;
            M.isSelectionValid(b.win) ? j = b.docSelection.createRange() : (j = z(b.win.document).createTextRange(), j.collapse(!0)), b.docSelection.type == O ? rn(b) : qn(j) ? Sn(b, j) : ne(b);
          };
        else if (we(Ke, "getRangeAt") && typeof Ke.rangeCount == ee)
          mi = function(b) {
            if (Xt && Ze && b.docSelection.type == O)
              rn(b);
            else if (b._ranges.length = b.rangeCount = b.nativeSelection.rangeCount, b.rangeCount) {
              for (var j = 0, V = b.rangeCount; j < V; ++j)
                b._ranges[j] = new M.WrappedRange(b.nativeSelection.getRangeAt(j));
              pn(b, b._ranges[b.rangeCount - 1], Gr(b.nativeSelection)), b.isCollapsed = Ht(b), Le(b);
            } else
              ne(b);
          };
        else if (_e && typeof Ke.isCollapsed == G && typeof Wt.collapsed == G && E.implementsDomRange)
          mi = function(b) {
            var j, V = b.nativeSelection;
            V.anchorNode ? (j = yi(V, 0), b._ranges = [j], b.rangeCount = 1, $(b), b.isCollapsed = Ht(b), Le(b)) : ne(b);
          };
        else
          return W.fail("No means of obtaining a Range or TextRange from the user's selection was found"), !1;
        Be.refresh = function(b) {
          var j = b ? this._ranges.slice(0) : null, V = this.anchorNode, le = this.anchorOffset;
          if (mi(this), b) {
            var Pe = j.length;
            if (Pe != this._ranges.length || this.anchorNode != V || this.anchorOffset != le)
              return !0;
            for (; Pe--; )
              if (!P(j[Pe], this._ranges[Pe]))
                return !0;
            return !1;
          }
        };
        var Ka = function(b, j) {
          var V = b.getAllRanges();
          b.removeAllRanges();
          for (var le = 0, Pe = V.length; le < Pe; ++le)
            P(j, V[le]) || b.addRange(V[le]);
          b.rangeCount || ne(b);
        };
        Xt && Ze ? Be.removeRange = function(b) {
          if (this.docSelection.type == O) {
            for (var j = this.docSelection.createRange(), V = lt(b), le = N(j.item(0)), Pe = z(le).createControlRange(), tt, It = !1, x = 0, L = j.length; x < L; ++x)
              tt = j.item(x), tt !== V || It ? Pe.add(j.item(x)) : It = !0;
            Pe.select(), rn(this);
          } else
            Ka(this, b);
        } : Be.removeRange = function(b) {
          Ka(this, b);
        };
        var Gr;
        !Ge && _e && E.implementsDomRange ? (Gr = ve, Be.isBackward = function() {
          return Gr(this);
        }) : Gr = Be.isBackward = function() {
          return !1;
        }, Be.isBackwards = Be.isBackward, Be.toString = function() {
          for (var b = [], j = 0, V = this.rangeCount; j < V; ++j)
            b[j] = "" + this._ranges[j];
          return b.join("");
        };
        function _i(b, j) {
          if (b.win.document != N(j))
            throw new Rt("WRONG_DOCUMENT_ERR");
        }
        function Xo(b, j) {
          if (j < 0 || j > (re.isCharacterDataNode(b) ? b.length : b.childNodes.length))
            throw new Rt("INDEX_SIZE_ERR");
        }
        Be.collapse = function(b, j) {
          _i(this, b);
          var V = M.createRange(b);
          V.collapseToPoint(b, j), this.setSingleRange(V), this.isCollapsed = !0;
        }, Be.collapseToStart = function() {
          if (this.rangeCount) {
            var b = this._ranges[0];
            this.collapse(b.startContainer, b.startOffset);
          } else
            throw new Rt("INVALID_STATE_ERR");
        }, Be.collapseToEnd = function() {
          if (this.rangeCount) {
            var b = this._ranges[this.rangeCount - 1];
            this.collapse(b.endContainer, b.endOffset);
          } else
            throw new Rt("INVALID_STATE_ERR");
        }, Be.selectAllChildren = function(b) {
          _i(this, b);
          var j = M.createRange(b);
          j.selectNodeContents(b), this.setSingleRange(j);
        }, gt ? Be.setBaseAndExtent = function(b, j, V, le) {
          this.nativeSelection.setBaseAndExtent(b, j, V, le), this.refresh();
        } : et && (Be.setBaseAndExtent = function(b, j, V, le) {
          Xo(b, j), Xo(V, le), _i(this, b), _i(this, V);
          var Pe = M.createRange(node), tt = re.comparePoints(b, j, V, le) == -1;
          tt ? Pe.setStartAndEnd(V, le, b, j) : Pe.setStartAndEnd(b, j, V, le), this.setSingleRange(Pe, tt);
        }), Be.deleteFromDocument = function() {
          if (Xt && Ze && this.docSelection.type == O) {
            for (var b = this.docSelection.createRange(), j; b.length; )
              j = b.item(0), b.remove(j), re.removeNode(j);
            this.refresh();
          } else if (this.rangeCount) {
            var V = this.getAllRanges();
            if (V.length) {
              this.removeAllRanges();
              for (var le = 0, Pe = V.length; le < Pe; ++le)
                V[le].deleteContents();
              this.addRange(V[Pe - 1]);
            }
          }
        }, Be.eachRange = function(b, j) {
          for (var V = 0, le = this._ranges.length; V < le; ++V)
            if (b(this.getRangeAt(V)))
              return j;
        }, Be.getAllRanges = function() {
          var b = [];
          return this.eachRange(function(j) {
            b.push(j);
          }), b;
        }, Be.setSingleRange = function(b, j) {
          this.removeAllRanges(), this.addRange(b, j);
        }, Be.callMethodOnEachRange = function(b, j) {
          var V = [];
          return this.eachRange(function(le) {
            V.push(le[b].apply(le, j || []));
          }), V;
        };
        function Go(b) {
          return function(j, V) {
            var le;
            this.rangeCount ? (le = this.getRangeAt(0), le["set" + (b ? "Start" : "End")](j, V)) : (le = M.createRange(this.win.document), le.setStartAndEnd(j, V)), this.setSingleRange(le, this.isBackward());
          };
        }
        Be.setStart = Go(!0), Be.setEnd = Go(!1), M.rangePrototype.select = function(b) {
          zi(this.getDocument()).setSingleRange(this, b);
        }, Be.changeEachRange = function(b) {
          var j = [], V = this.isBackward();
          this.eachRange(function(le) {
            b(le), j.push(le);
          }), this.removeAllRanges(), V && j.length == 1 ? this.addRange(j[0], "backward") : this.setRanges(j);
        }, Be.containsNode = function(b, j) {
          return this.eachRange(function(V) {
            return V.containsNode(b, j);
          }, !0) || !1;
        }, Be.getBookmark = function(b) {
          return {
            backward: this.isBackward(),
            rangeBookmarks: this.callMethodOnEachRange("getBookmark", [b])
          };
        }, Be.moveToBookmark = function(b) {
          for (var j = [], V = 0, le, Pe; le = b.rangeBookmarks[V++]; )
            Pe = M.createRange(this.win), Pe.moveToBookmark(le), j.push(Pe);
          b.backward ? this.setSingleRange(j[0], "backward") : this.setRanges(j);
        }, Be.saveRanges = function() {
          return {
            backward: this.isBackward(),
            ranges: this.callMethodOnEachRange("cloneRange")
          };
        }, Be.restoreRanges = function(b) {
          this.removeAllRanges();
          for (var j = 0, V; V = b.ranges[j]; ++j)
            this.addRange(V, b.backward && j == 0);
        }, Be.toHtml = function() {
          var b = [];
          return this.eachRange(function(j) {
            b.push(ct.toHtml(j));
          }), b.join("");
        }, E.implementsTextRange && (Be.getNativeTextRange = function() {
          var b;
          if (b = this.docSelection) {
            var j = b.createRange();
            if (qn(j))
              return j;
            throw W.createError("getNativeTextRange: selection is a control selection");
          } else {
            if (this.rangeCount > 0)
              return M.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));
            throw W.createError("getNativeTextRange: selection contains no range");
          }
        });
        function Ui(b) {
          var j = [], V = new ot(b.anchorNode, b.anchorOffset), le = new ot(b.focusNode, b.focusOffset), Pe = typeof b.getName == "function" ? b.getName() : "Selection";
          if (typeof b.rangeCount < "u")
            for (var tt = 0, It = b.rangeCount; tt < It; ++tt)
              j[tt] = ct.inspect(b.getRangeAt(tt));
          return "[" + Pe + "(Ranges: " + j.join(", ") + ")(anchor: " + V.inspect() + ", focus: " + le.inspect() + "]";
        }
        Be.getName = function() {
          return "WrappedSelection";
        }, Be.inspect = function() {
          return Ui(this);
        }, Be.detach = function() {
          zo(this.win, "delete"), Wo(this);
        }, dt.detachAll = function() {
          zo(null, "deleteAll");
        }, dt.inspect = Ui, dt.isDirectionBackward = q, M.Selection = dt, M.selectionPrototype = Be, M.addShimListener(function(b) {
          typeof b.getSelection > "u" && (b.getSelection = function() {
            return zi(b);
          }), b = null;
        });
      });
      var Te = !1, Xe = function(M) {
        Te || (Te = !0, !C.initialized && C.config.autoInitialize && R());
      };
      return T && (document.readyState == "complete" ? Xe() : (u(document, "addEventListener") && document.addEventListener("DOMContentLoaded", Xe, !1), de(window, "load", Xe))), C;
    });
  }(zu)), zu.exports;
}
var tj = k_();
const Nv = /* @__PURE__ */ uu(tj);
var Xu = { exports: {} }, Mv;
function nj() {
  return Mv || (Mv = 1, function(t, e) {
    (function(n, r) {
      t.exports = n(k_());
    })(function(n) {
      return n.createModule("ClassApplier", ["WrappedSelection"], function(r, i) {
        var o = r.dom, a = o.DomPosition, s = o.arrayContains, l = r.util, u = l.forEach, f = "span", c = l.isHostMethod(document, "createElementNS");
        function d(E, O) {
          for (var N in E)
            if (E.hasOwnProperty(N) && O(N, E[N]) === !1)
              return !1;
          return !0;
        }
        function h(E) {
          return E.replace(/^\s\s*/, "").replace(/\s\s*$/, "");
        }
        function v(E, O) {
          return !!E && new RegExp("(?:^|\\s)" + O + "(?:\\s|$)").test(E);
        }
        function p(E, O) {
          if (typeof E.classList == "object")
            return E.classList.contains(O);
          var N = typeof E.className == "string", z = N ? E.className : E.getAttribute("class");
          return v(z, O);
        }
        function g(E, O) {
          if (typeof E.classList == "object")
            E.classList.add(O);
          else {
            var N = typeof E.className == "string", z = N ? E.className : E.getAttribute("class");
            z ? v(z, O) || (z += " " + O) : z = O, N ? E.className = z : E.setAttribute("class", z);
          }
        }
        var y = /* @__PURE__ */ function() {
          function E(O, N, z) {
            return N && z ? " " : "";
          }
          return function(O, N) {
            if (typeof O.classList == "object")
              O.classList.remove(N);
            else {
              var z = typeof O.className == "string", P = z ? O.className : O.getAttribute("class");
              P = P.replace(new RegExp("(^|\\s)" + N + "(\\s|$)"), E), z ? O.className = P : O.setAttribute("class", P);
            }
          };
        }();
        function m(E) {
          var O = typeof E.className == "string";
          return O ? E.className : E.getAttribute("class");
        }
        function A(E) {
          return E && E.split(/\s+/).sort().join(" ");
        }
        function T(E) {
          return A(m(E));
        }
        function k(E, O) {
          return T(E) == T(O);
        }
        function C(E, O) {
          for (var N = O.split(/\s+/), z = 0, P = N.length; z < P; ++z)
            if (!p(E, h(N[z])))
              return !1;
          return !0;
        }
        function S(E) {
          var O = E.parentNode;
          return O && O.nodeType == 1 && !/^(textarea|style|script|select|iframe)$/i.test(O.nodeName);
        }
        function I(E, O, N, z, P) {
          var q = E.node, Y = E.offset, Z = q, Ae = Y;
          q == z && Y > P && ++Ae, q == O && (Y == N || Y == N + 1) && (Z = z, Ae += P - N), q == O && Y > N + 1 && --Ae, E.node = Z, E.offset = Ae;
        }
        function X(E, O, N) {
          E.node == O && E.offset > N && --E.offset;
        }
        function Q(E, O, N, z) {
          N == -1 && (N = O.childNodes.length);
          var P = E.parentNode, q = o.getNodeIndex(E);
          u(z, function(Y) {
            I(Y, P, q, O, N);
          }), O.childNodes.length == N ? O.appendChild(E) : O.insertBefore(E, O.childNodes[N]);
        }
        function ue(E, O) {
          var N = E.parentNode, z = o.getNodeIndex(E);
          u(O, function(P) {
            X(P, N, z);
          }), o.removeNode(E);
        }
        function de(E, O, N, z, P) {
          for (var q, Y = []; q = E.firstChild; )
            Q(q, O, N++, P), Y.push(q);
          return ue(E, P), Y;
        }
        function w(E, O) {
          return de(E, E.parentNode, o.getNodeIndex(E), !0, O);
        }
        function D(E, O) {
          var N = E.cloneRange();
          N.selectNodeContents(O);
          var z = N.intersection(E), P = z ? z.toString() : "";
          return P != "";
        }
        function R(E) {
          for (var O = E.getNodes([3]), N = 0, z; (z = O[N]) && !D(E, z); )
            ++N;
          for (var P = O.length - 1; (z = O[P]) && !D(E, z); )
            --P;
          return O.slice(N, P + 1);
        }
        function K(E, O) {
          if (E.attributes.length != O.attributes.length) return !1;
          for (var N = 0, z = E.attributes.length, P, q, Y; N < z; ++N)
            if (P = E.attributes[N], Y = P.name, Y != "class" && (q = O.attributes.getNamedItem(Y), P === null != (q === null) || P.specified != q.specified || P.specified && P.nodeValue !== q.nodeValue))
              return !1;
          return !0;
        }
        function ye(E, O) {
          for (var N = 0, z = E.attributes.length, P; N < z; ++N)
            if (P = E.attributes[N].name, !(O && s(O, P)) && E.attributes[N].specified && P != "class")
              return !0;
          return !1;
        }
        var Oe = o.getComputedStyleProperty, nt = function() {
          var E = document.createElement("div");
          return typeof E.isContentEditable == "boolean" ? function(O) {
            return O && O.nodeType == 1 && O.isContentEditable;
          } : function(O) {
            return !O || O.nodeType != 1 || O.contentEditable == "false" ? !1 : O.contentEditable == "true" || nt(O.parentNode);
          };
        }();
        function rt(E) {
          var O;
          return E && E.nodeType == 1 && ((O = E.parentNode) && O.nodeType == 9 && O.designMode == "on" || nt(E) && !nt(E.parentNode));
        }
        function me(E) {
          return (nt(E) || E.nodeType != 1 && nt(E.parentNode)) && !rt(E);
        }
        var ke = /^inline(-block|-table)?$/i;
        function ze(E) {
          return E && E.nodeType == 1 && !ke.test(Oe(E, "display"));
        }
        var Te = /[^\r\n\t\f \u200B]/;
        function Xe(E) {
          if (E.data.length == 0)
            return !0;
          if (Te.test(E.data))
            return !1;
          var O = Oe(E.parentNode, "whiteSpace");
          switch (O) {
            case "pre":
            case "pre-wrap":
            case "-moz-pre-wrap":
              return !1;
            case "pre-line":
              if (/[\r\n]/.test(E.data))
                return !1;
          }
          return ze(E.previousSibling) || ze(E.nextSibling);
        }
        function M(E) {
          var O = [], N, z;
          for (N = 0; z = E[N++]; )
            O.push(
              new a(z.startContainer, z.startOffset),
              new a(z.endContainer, z.endOffset)
            );
          return O;
        }
        function W(E, O) {
          for (var N = 0, z, P, q, Y = E.length; N < Y; ++N)
            z = E[N], P = O[N * 2], q = O[N * 2 + 1], z.setStartAndEnd(P.node, P.offset, q.node, q.offset);
        }
        function G(E, O) {
          return o.isCharacterDataNode(E) ? O == 0 ? !!E.previousSibling : O == E.length ? !!E.nextSibling : !0 : O > 0 && O < E.childNodes.length;
        }
        function ee(E, O, N, z) {
          var P, q, Y = N == 0;
          if (o.isAncestorOf(O, E))
            return E;
          if (o.isCharacterDataNode(O)) {
            var Z = o.getNodeIndex(O);
            if (N == 0)
              N = Z;
            else if (N == O.length)
              N = Z + 1;
            else
              throw i.createError("splitNodeAt() should not be called with offset in the middle of a data node (" + N + " in " + O.data);
            O = O.parentNode;
          }
          if (G(O, N)) {
            P = O.cloneNode(!1), q = O.parentNode, P.id && P.removeAttribute("id");
            for (var Ae, ve = 0; Ae = O.childNodes[N]; )
              Q(Ae, P, ve++, z);
            return Q(P, q, o.getNodeIndex(O) + 1, z), O == E ? P : ee(E, q, o.getNodeIndex(P), z);
          } else if (E != O) {
            P = O.parentNode;
            var oe = o.getNodeIndex(O);
            return Y || oe++, ee(E, P, oe, z);
          }
          return E;
        }
        function re(E, O) {
          return E.namespaceURI == O.namespaceURI && E.tagName.toLowerCase() == O.tagName.toLowerCase() && k(E, O) && K(E, O) && Oe(E, "display") == "inline" && Oe(O, "display") == "inline";
        }
        function ge(E) {
          var O = E ? "nextSibling" : "previousSibling";
          return function(N, z) {
            var P = N.parentNode, q = N[O];
            if (q) {
              if (q && q.nodeType == 3)
                return q;
            } else if (z && (q = P[O], q && q.nodeType == 1 && re(P, q))) {
              var Y = q[E ? "firstChild" : "lastChild"];
              if (Y && Y.nodeType == 3)
                return Y;
            }
            return null;
          };
        }
        var we = ge(!1), ct = ge(!0);
        function Ot(E) {
          this.isElementMerge = E.nodeType == 1, this.textNodes = [];
          var O = this.isElementMerge ? E.lastChild : E;
          O && (this.textNodes[0] = O);
        }
        Ot.prototype = {
          doMerge: function(E) {
            var O = this.textNodes, N = O[0];
            if (O.length > 1) {
              var z = o.getNodeIndex(N), P = [], q = 0, Y;
              u(O, function(Z, Ae) {
                Y = Z.parentNode, Ae > 0 && (Y.removeChild(Z), Y.hasChildNodes() || o.removeNode(Y), E && u(E, function(ve) {
                  ve.node == Z && (ve.node = N, ve.offset += q), ve.node == Y && ve.offset > z && (--ve.offset, ve.offset == z + 1 && Ae < O.length - 1 && (ve.node = N, ve.offset = q));
                })), P[Ae] = Z.data, q += Z.data.length;
              }), N.data = P.join("");
            }
            return N.data;
          },
          getLength: function() {
            for (var E = this.textNodes.length, O = 0; E--; )
              O += this.textNodes[E].length;
            return O;
          },
          toString: function() {
            var E = [];
            return u(this.textNodes, function(O, N) {
              E[N] = "'" + O.data + "'";
            }), "[Merge(" + E.join(",") + ")]";
          }
        };
        var Rt = [
          "elementTagName",
          "ignoreWhiteSpace",
          "applyToEditableOnly",
          "useExistingElements",
          "removeEmptyElements",
          "onElementCreate"
        ], ot = {};
        function kt(E, O, N) {
          var z, P, q, Y, Z = this;
          Z.cssClass = Z.className = E;
          var Ae = null, ve = {};
          if (typeof O == "object" && O !== null) {
            for (typeof O.elementTagName < "u" && (O.elementTagName = O.elementTagName.toLowerCase()), N = O.tagNames, Ae = O.elementProperties, ve = O.elementAttributes, P = 0; Y = Rt[P++]; )
              O.hasOwnProperty(Y) && (Z[Y] = O[Y]);
            z = O.normalize;
          } else
            z = O;
          Z.normalize = typeof z > "u" ? !0 : z, Z.attrExceptions = [];
          var oe = document.createElement(Z.elementTagName);
          Z.elementProperties = Z.copyPropertiesToElement(Ae, oe, !0), d(ve, function(Ge, Ke) {
            Z.attrExceptions.push(Ge), ve[Ge] = "" + Ke;
          }), Z.elementAttributes = ve, Z.elementSortedClassName = Z.elementProperties.hasOwnProperty("className") ? A(Z.elementProperties.className + " " + E) : E, Z.applyToAnyTagName = !1;
          var Ze = typeof N;
          if (Ze == "string")
            N == "*" ? Z.applyToAnyTagName = !0 : Z.tagNames = h(N.toLowerCase()).split(/\s*,\s*/);
          else if (Ze == "object" && typeof N.length == "number")
            for (Z.tagNames = [], P = 0, q = N.length; P < q; ++P)
              N[P] == "*" ? Z.applyToAnyTagName = !0 : Z.tagNames.push(N[P].toLowerCase());
          else
            Z.tagNames = [Z.elementTagName];
        }
        kt.prototype = {
          elementTagName: f,
          elementProperties: {},
          elementAttributes: {},
          ignoreWhiteSpace: !0,
          applyToEditableOnly: !1,
          useExistingElements: !0,
          removeEmptyElements: !0,
          onElementCreate: null,
          copyPropertiesToElement: function(E, O, N) {
            var z, P, q = {}, Y, Z, Ae, ve;
            for (var oe in E)
              if (E.hasOwnProperty(oe))
                if (Z = E[oe], Ae = O[oe], oe == "className")
                  g(O, Z), g(O, this.className), O[oe] = A(O[oe]), N && (q[oe] = Z);
                else if (oe == "style") {
                  P = Ae, N && (q[oe] = Y = {});
                  for (z in E[oe])
                    E[oe].hasOwnProperty(z) && (P[z] = Z[z], N && (Y[z] = P[z]));
                  this.attrExceptions.push(oe);
                } else
                  O[oe] = Z, N && (q[oe] = O[oe], ve = ot.hasOwnProperty(oe) ? ot[oe] : oe, this.attrExceptions.push(ve));
            return N ? q : "";
          },
          copyAttributesToElement: function(E, O) {
            for (var N in E)
              E.hasOwnProperty(N) && !/^class(?:Name)?$/i.test(N) && O.setAttribute(N, E[N]);
          },
          appliesToElement: function(E) {
            return s(this.tagNames, E.tagName.toLowerCase());
          },
          getEmptyElements: function(E) {
            var O = this;
            return E.getNodes([1], function(N) {
              return O.appliesToElement(N) && !N.hasChildNodes();
            });
          },
          hasClass: function(E) {
            return E.nodeType == 1 && (this.applyToAnyTagName || this.appliesToElement(E)) && p(E, this.className);
          },
          getSelfOrAncestorWithClass: function(E) {
            for (; E; ) {
              if (this.hasClass(E))
                return E;
              E = E.parentNode;
            }
            return null;
          },
          isModifiable: function(E) {
            return !this.applyToEditableOnly || me(E);
          },
          // White space adjacent to an unwrappable node can be ignored for wrapping
          isIgnorableWhiteSpaceNode: function(E) {
            return this.ignoreWhiteSpace && E && E.nodeType == 3 && Xe(E);
          },
          // Normalizes nodes after applying a class to a Range.
          postApply: function(E, O, N, z) {
            var P = E[0], q = E[E.length - 1], Y = [], Z, Ae = P, ve = q, oe = 0, Ze = q.length, Ge;
            u(E, function(_e) {
              Ge = we(_e, !z), Ge ? (Z || (Z = new Ot(Ge), Y.push(Z)), Z.textNodes.push(_e), _e === P && (Ae = Z.textNodes[0], oe = Ae.length), _e === q && (ve = Z.textNodes[0], Ze = Z.getLength())) : Z = null;
            });
            var Ke = ct(q, !z);
            if (Ke && (Z || (Z = new Ot(q), Y.push(Z)), Z.textNodes.push(Ke)), Y.length) {
              for (var Wt = 0, se = Y.length; Wt < se; ++Wt)
                Y[Wt].doMerge(N);
              O.setStartAndEnd(Ae, oe, ve, Ze);
            }
          },
          createContainer: function(E) {
            var O = o.getDocument(E), N = c && !o.isHtmlNamespace(E) && E.namespaceURI ? O.createElementNS(E.namespaceURI, this.elementTagName) : O.createElement(this.elementTagName);
            return this.copyPropertiesToElement(this.elementProperties, N, !1), this.copyAttributesToElement(this.elementAttributes, N), g(N, this.className), this.onElementCreate && this.onElementCreate(N, this), N;
          },
          elementHasProperties: function(E, O) {
            var N = this;
            return d(O, function(z, P) {
              if (z == "className")
                return C(E, P);
              if (typeof P == "object") {
                if (!N.elementHasProperties(E[z], P))
                  return !1;
              } else if (E[z] !== P)
                return !1;
            });
          },
          elementHasAttributes: function(E, O) {
            return d(O, function(N, z) {
              if (E.getAttribute(N) !== z)
                return !1;
            });
          },
          applyToTextNode: function(E, O) {
            if (S(E)) {
              var N = E.parentNode;
              if (N.childNodes.length == 1 && this.useExistingElements && this.appliesToElement(N) && this.elementHasProperties(N, this.elementProperties) && this.elementHasAttributes(N, this.elementAttributes))
                g(N, this.className);
              else {
                var z = E.parentNode, P = this.createContainer(z);
                z.insertBefore(P, E), P.appendChild(E);
              }
            }
          },
          isRemovable: function(E) {
            return E.tagName.toLowerCase() == this.elementTagName && T(E) == this.elementSortedClassName && this.elementHasProperties(E, this.elementProperties) && !ye(E, this.attrExceptions) && this.elementHasAttributes(E, this.elementAttributes) && this.isModifiable(E);
          },
          isEmptyContainer: function(E) {
            var O = E.childNodes.length;
            return E.nodeType == 1 && this.isRemovable(E) && (O == 0 || O == 1 && this.isEmptyContainer(E.firstChild));
          },
          removeEmptyContainers: function(E) {
            var O = this, N = E.getNodes([1], function(q) {
              return O.isEmptyContainer(q);
            }), z = [E], P = M(z);
            u(N, function(q) {
              ue(q, P);
            }), W(z, P);
          },
          undoToTextNode: function(E, O, N, z) {
            if (!O.containsNode(N)) {
              var P = O.cloneRange();
              P.selectNode(N), P.isPointInRange(O.endContainer, O.endOffset) && (ee(N, O.endContainer, O.endOffset, z), O.setEndAfter(N)), P.isPointInRange(O.startContainer, O.startOffset) && (N = ee(N, O.startContainer, O.startOffset, z));
            }
            this.isRemovable(N) ? w(N, z) : y(N, this.className);
          },
          splitAncestorWithClass: function(E, O, N) {
            var z = this.getSelfOrAncestorWithClass(E);
            z && ee(z, E, O, N);
          },
          undoToAncestor: function(E, O) {
            this.isRemovable(E) ? w(E, O) : y(E, this.className);
          },
          applyToRange: function(E, O) {
            var N = this;
            O = O || [];
            var z = M(O || []);
            E.splitBoundariesPreservingPositions(z), N.removeEmptyElements && N.removeEmptyContainers(E);
            var P = R(E);
            if (P.length) {
              u(P, function(Z) {
                !N.isIgnorableWhiteSpaceNode(Z) && !N.getSelfOrAncestorWithClass(Z) && N.isModifiable(Z) && N.applyToTextNode(Z, z);
              });
              var q = P[P.length - 1];
              E.setStartAndEnd(P[0], 0, q, q.length), N.normalize && N.postApply(P, E, z, !1), W(O, z);
            }
            var Y = N.getEmptyElements(E);
            u(Y, function(Z) {
              g(Z, N.className);
            });
          },
          applyToRanges: function(E) {
            for (var O = E.length; O--; )
              this.applyToRange(E[O], E);
            return E;
          },
          applyToSelection: function(E) {
            var O = r.getSelection(E);
            O.setRanges(this.applyToRanges(O.getAllRanges()));
          },
          undoToRange: function(E, O) {
            var N = this;
            O = O || [];
            var z = M(O);
            E.splitBoundariesPreservingPositions(z), N.removeEmptyElements && N.removeEmptyContainers(E, z);
            var P = R(E), q, Y, Z = P[P.length - 1];
            if (P.length) {
              N.splitAncestorWithClass(E.endContainer, E.endOffset, z), N.splitAncestorWithClass(E.startContainer, E.startOffset, z);
              for (var Ae = 0, ve = P.length; Ae < ve; ++Ae)
                q = P[Ae], Y = N.getSelfOrAncestorWithClass(q), Y && N.isModifiable(q) && N.undoToAncestor(Y, z);
              E.setStartAndEnd(P[0], 0, Z, Z.length), N.normalize && N.postApply(P, E, z, !0), W(O, z);
            }
            var oe = N.getEmptyElements(E);
            u(oe, function(Ze) {
              y(Ze, N.className);
            });
          },
          undoToRanges: function(E) {
            for (var O = E.length; O--; )
              this.undoToRange(E[O], E);
            return E;
          },
          undoToSelection: function(E) {
            var O = r.getSelection(E), N = r.getSelection(E).getAllRanges();
            this.undoToRanges(N), O.setRanges(N);
          },
          isAppliedToRange: function(E) {
            if (E.collapsed || E.toString() == "")
              return !!this.getSelfOrAncestorWithClass(E.commonAncestorContainer);
            var O = E.getNodes([3]);
            if (O.length) {
              for (var N = 0, z; z = O[N++]; )
                if (!this.isIgnorableWhiteSpaceNode(z) && D(E, z) && this.isModifiable(z) && !this.getSelfOrAncestorWithClass(z))
                  return !1;
            }
            return !0;
          },
          isAppliedToRanges: function(E) {
            var O = E.length;
            if (O == 0)
              return !1;
            for (; O--; )
              if (!this.isAppliedToRange(E[O]))
                return !1;
            return !0;
          },
          isAppliedToSelection: function(E) {
            var O = r.getSelection(E);
            return this.isAppliedToRanges(O.getAllRanges());
          },
          toggleRange: function(E) {
            this.isAppliedToRange(E) ? this.undoToRange(E) : this.applyToRange(E);
          },
          toggleSelection: function(E) {
            this.isAppliedToSelection(E) ? this.undoToSelection(E) : this.applyToSelection(E);
          },
          getElementsWithClassIntersectingRange: function(E) {
            var O = [], N = this;
            return E.getNodes([3], function(z) {
              var P = N.getSelfOrAncestorWithClass(z);
              P && !s(O, P) && O.push(P);
            }), O;
          },
          detach: function() {
          }
        };
        function Ht(E, O, N) {
          return new kt(E, O, N);
        }
        kt.util = {
          hasClass: p,
          addClass: g,
          removeClass: y,
          getClass: m,
          hasSameClasses: k,
          hasAllClasses: C,
          replaceWithOwnChildren: w,
          elementsHaveSameNonClassAttributes: K,
          elementHasNonClassAttributes: ye,
          splitNodeAt: ee,
          isEditableElement: nt,
          isEditingHost: rt,
          isEditable: me
        }, r.CssClassApplier = r.ClassApplier = kt, r.createClassApplier = Ht, l.createAliasForDeprecatedMethod(r, "createCssClassApplier", "createClassApplier", i);
      }), n;
    });
  }(Xu)), Xu.exports;
}
nj();
var Pv = {
  toolbar: {
    allowMultiParagraphSelection: !0,
    buttons: [
      "bold",
      "colorpicker",
      "italic",
      "underline",
      "strikethrough",
      "quote",
      "justifyLeft",
      "justifyCenter",
      "justifyRight",
      "justifyFull",
      "superscript",
      "subscript",
      "orderedlist",
      "unorderedlist",
      "pre",
      "removeFormat",
      "outdent",
      "indent",
      "h2",
      "h3"
    ],
    standardizeSelectionStart: !1,
    updateOnEmptySelection: !1
  },
  placeholder: {
    text: "请输入内容",
    hideOnClick: !0
  },
  disableEditing: !0
}, Dv = wl.extensions.button.extend({
  name: "colorpicker",
  tagNames: ["mark"],
  contentDefault: "<b>Color</b>",
  aria: "Color Picker",
  action: "colorPicker",
  init: function() {
    var t = this;
    Nv.init(), wl.extensions.button.prototype.init.call(this), this.colorPicker = new j_({
      parent: this.button,
      color: "#000",
      onDone: function(e) {
        t.coloredText && t.coloredText.isAppliedToSelection() && t.coloredText.undoToSelection(), t.coloredText = Nv.createClassApplier("colored", {
          elementTagName: "span",
          elementProperties: {
            style: {
              color: e.hex
            }
          },
          normalize: !0
        }), t.coloredText.toggleSelection(), t.base.checkContentChanged(), t.setInactive();
      }
    });
  },
  getButton: function() {
    return this.button;
  },
  handleClick: function() {
    this.setActive(), this.colorPicker.show();
  },
  isAlreadyApplied: function(t) {
    return t.nodeName.toLowerCase() === "mark";
  },
  isActive: function() {
    return this.button.classList.contains("medium-editor-button-active");
  },
  setInactive: function() {
    this.button.classList.remove("medium-editor-button-active");
  },
  setActive: function() {
    this.button.classList.add("medium-editor-button-active");
  }
}), rj = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), ij = function(t, e, n, r) {
  var i = arguments.length, o = i < 3 ? e : r === null ? r = Object.getOwnPropertyDescriptor(e, n) : r, a;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function") o = Reflect.decorate(t, e, n, r);
  else for (var s = t.length - 1; s >= 0; s--) (a = t[s]) && (o = (i < 3 ? a(o) : i > 3 ? a(e, n, o) : a(e, n)) || o);
  return i > 3 && o && Object.defineProperty(e, n, o), o;
}, Rv = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, Lv = function(t, e, n) {
  if (n || arguments.length === 2) for (var r = 0, i = e.length, o; r < i; r++)
    (o || !(r in e)) && (o || (o = Array.prototype.slice.call(e, 0, r)), o[r] = e[r]);
  return t.concat(o || Array.prototype.slice.call(e));
};
(function(t) {
  rj(e, t);
  function e(n) {
    var r = t.call(this, n) || this;
    r.labelMap = /* @__PURE__ */ new Map();
    var i = n.lf, o = n.graphModel;
    return r.lf = i, r.graphModel = o, r.state = { tick: 0 }, r;
  }
  return e.prototype.componentDidMount = function() {
    var n = this, r = this.props.graphModel;
    this.editor = new wl(".lf-label-editor", mo(Pv, {
      autoLink: !0,
      extensions: {
        colorPicker: new Dv()
      }
    })), r.eventCenter.on("text:update,node:mousemove,node:resize,node:rotate,node:drag,label:drop,node:drop", function() {
    }), r.eventCenter.on("node:properties-change,node:properties-delete", function() {
      n.setState({ tick: n.state.tick + 1 });
    });
  }, e.prototype.componentDidUpdate = function() {
    var n;
    this.editor && this.editor.elements.length > 0 ? this.editor.addElements(".lf-label-editor") : ((n = this.editor) === null || n === void 0 || n.destroy(), this.editor = new wl(".lf-label-editor", mo(Pv, {
      autoLink: !0,
      extensions: {
        colorPicker: new Dv()
      }
    })));
  }, e.prototype.componentWillUnmount = function() {
    var n;
    (n = this.editor) === null || n === void 0 || n.destroy();
  }, e.prototype.getLabels = function() {
    var n = this, r = this.props, i = r.lf.extension, o = r.graphModel, a = Lv(Lv([], Rv(o.nodes), !1), Rv(o.edges), !1), s = i.label;
    if (s) {
      var l = [];
      return at(a, function(u) {
        var f, c, d = u.getData(), h = (c = (f = d.properties) === null || f === void 0 ? void 0 : f._label) !== null && c !== void 0 ? c : [];
        at(h, function(v) {
          var p = n.labelMap, g = new G4(v, u, o);
          p.set(g.id, g), l.push(B(z4, { label: g, element: u, graphModel: o }, g.id));
        });
      }), l;
    }
    return null;
  }, e.prototype.render = function() {
    return B("foreignObject", { id: "lf-label-overlay", class: "lf-label-overlay", children: this.getLabels() });
  }, e.toolName = "label-edit-tool", e = ij([
    sn
  ], e), e;
})(Ye);
var oj = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, aj = function(t, e, n) {
  if (n || arguments.length === 2) for (var r = 0, i = e.length, o; r < i; r++)
    (o || !(r in e)) && (o || (o = Array.prototype.slice.call(e, 0, r)), o[r] = e[r]);
  return t.concat(o || Array.prototype.slice.call(e));
}, sj = (
  /** @class */
  function() {
    function t(e) {
      var n = e.lf, r = this;
      this.controlItems = [
        {
          key: "zoom-out",
          iconClass: "lf-control-zoomOut",
          title: "缩小流程图",
          text: "缩小",
          onClick: function() {
            r.lf.zoom(!1);
          }
        },
        {
          key: "zoom-in",
          iconClass: "lf-control-zoomIn",
          title: "放大流程图",
          text: "放大",
          onClick: function() {
            r.lf.zoom(!0);
          }
        },
        {
          key: "reset",
          iconClass: "lf-control-fit",
          title: "恢复流程原有尺寸",
          text: "适应",
          onClick: function() {
            r.lf.resetZoom();
          }
        },
        {
          key: "undo",
          iconClass: "lf-control-undo",
          title: "回到上一步",
          text: "上一步",
          onClick: function() {
            r.lf.undo();
          }
        },
        {
          key: "redo",
          iconClass: "lf-control-redo",
          title: "移到下一步",
          text: "下一步",
          onClick: function() {
            r.lf.redo();
          }
        }
      ], this.lf = n;
    }
    return t.prototype.render = function(e, n) {
      this.destroy();
      var r = this.getControlTool();
      this.toolEl = r, n.appendChild(r), this.domContainer = n;
    }, t.prototype.destroy = function() {
      this.domContainer && this.toolEl && this.domContainer.contains(this.toolEl) && this.domContainer.removeChild(this.toolEl);
    }, t.prototype.addItem = function(e) {
      this.controlItems.push(e);
    }, t.prototype.removeItem = function(e) {
      var n = this.controlItems.findIndex(function(r) {
        return r.key === e;
      });
      return n == -1 ? null : this.controlItems.splice(n, 1)[0];
    }, t.prototype.getControlTool = function() {
      var e = this, n = "lf-control-item", r = "lf-control-item disabled", i = document.createElement("div"), o = [];
      return i.className = "lf-control", this.controlItems.forEach(function(a) {
        var s = document.createElement("div"), l = document.createElement("i"), u = document.createElement("span");
        switch (s.className = r, a.onClick && (s.onclick = a.onClick.bind(null, e.lf)), a.onMouseEnter && (s.onmouseenter = a.onMouseEnter.bind(null, e.lf)), a.onMouseLeave && (s.onmouseleave = a.onMouseLeave.bind(null, e.lf)), l.className = a.iconClass, u.className = "lf-control-text", u.title = a.title, u.innerText = a.text, s.append(l, u), a.text) {
          case "上一步":
            e.lf.on("history:change", function(f) {
              var c = f.data.undoAble;
              s.className = c ? n : r;
            });
            break;
          case "下一步":
            e.lf.on("history:change", function(f) {
              var c = f.data.redoAble;
              s.className = c ? n : r;
            });
            break;
          default:
            s.className = n;
            break;
        }
        o.push(s);
      }), i.append.apply(i, aj([], oj(o), !1)), i;
    }, t.pluginName = "control", t;
  }()
), lj = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, uj = function(t, e, n) {
  if (n || arguments.length === 2) for (var r = 0, i = e.length, o; r < i; r++)
    (o || !(r in e)) && (o || (o = Array.prototype.slice.call(e, 0, r)), o[r] = e[r]);
  return t.concat(o || Array.prototype.slice.call(e));
}, Qo = "lf:defaultNodeMenu", ea = "lf:defaultEdgeMenu", ta = "lf:defaultGraphMenu", Iv = "lf:defaultSelectionMenu", fj = (
  /** @class */
  function() {
    function t(e) {
      var n = e.lf, r = this;
      this.__currentData = null, this.lf = n;
      var i = n.options.isSilentMode;
      i || (this.__menuDOM = document.createElement("ul"), this.menuTypeMap = /* @__PURE__ */ new Map(), this.init(), this.lf.setMenuConfig = function(o) {
        r.setMenuConfig(o);
      }, this.lf.addMenuConfig = function(o) {
        r.addMenuConfig(o);
      }, this.lf.setMenuByType = function(o) {
        r.setMenuByType(o);
      });
    }
    return t.prototype.init = function() {
      var e = this, n, r, i, o, a = [
        {
          text: "删除",
          callback: function(u) {
            e.lf.deleteNode(u.id);
          }
        },
        {
          text: "编辑文本",
          callback: function(u) {
            e.lf.graphModel.editText(u.id);
          }
        },
        {
          text: "复制",
          callback: function(u) {
            e.lf.cloneNode(u.id);
          }
        }
      ];
      (n = this.menuTypeMap) === null || n === void 0 || n.set(Qo, a);
      var s = [
        {
          text: "删除",
          callback: function(u) {
            e.lf.deleteEdge(u.id);
          }
        },
        {
          text: "编辑文本",
          callback: function(u) {
            e.lf.graphModel.editText(u.id);
          }
        }
      ];
      (r = this.menuTypeMap) === null || r === void 0 || r.set(ea, s), (i = this.menuTypeMap) === null || i === void 0 || i.set(ta, []);
      var l = [
        {
          text: "删除",
          callback: function(u) {
            e.lf.clearSelectElements(), u.edges.forEach(function(f) {
              return e.lf.deleteEdge(f.id);
            }), u.nodes.forEach(function(f) {
              return e.lf.deleteNode(f.id);
            });
          }
        }
      ];
      (o = this.menuTypeMap) === null || o === void 0 || o.set(Iv, l);
    }, t.prototype.render = function(e, n) {
      var r = this;
      e.options.isSilentMode || (this.__container = n, this.__currentData = null, this.__menuDOM && (this.__menuDOM.className = "lf-menu", n.appendChild(this.__menuDOM), this.__menuDOM.addEventListener("click", function(i) {
        i.stopPropagation();
        for (var o = i.target; Array.from(o.classList).indexOf("lf-menu-item") === -1 && Array.from(o.classList).indexOf("lf-menu") === -1; )
          o = o == null ? void 0 : o.parentElement;
        Array.from(o.classList).indexOf("lf-menu-item") > -1 ? (o.onclickCallback(r.__currentData), r.__menuDOM && (r.__menuDOM.style.display = "none"), r.__currentData = null) : console.warn("点击区域不在菜单项内，请检查代码！");
      }, !0)), this.lf.on("node:contextmenu", function(i) {
        var o, a, s = i.data, l = i.position, u = i.e, f = l.domOverlayPosition, c = f.x, d = f.y, h = s.id, v = r.lf.graphModel.getNodeModelById(h);
        if (v) {
          var p = [], g = (o = r.menuTypeMap) === null || o === void 0 ? void 0 : o.get(v.type);
          v && v.menu && Array.isArray(v.menu) ? p = v.menu : g ? p = g : p = (a = r.menuTypeMap) === null || a === void 0 ? void 0 : a.get(Qo), r.__currentData = s, r.showMenu(c, d, p, {
            width: v.width,
            height: v.height,
            clientX: u.clientX,
            clientY: u.clientY
          });
        }
      }), this.lf.on("edge:contextmenu", function(i) {
        var o, a, s, l = i.data, u = i.position, f = i.e, c = u.domOverlayPosition, d = c.x, h = c.y, v = l.id, p = r.lf.graphModel.getEdgeModelById(v);
        if (p) {
          var g = [], y = (o = r.menuTypeMap) === null || o === void 0 ? void 0 : o.get(p.type);
          p && p.menu && Array.isArray(p.menu) ? g = p.menu : y ? g = y : g = (s = (a = r.menuTypeMap) === null || a === void 0 ? void 0 : a.get(ea)) !== null && s !== void 0 ? s : [], r.__currentData = l, r.showMenu(d, h, g, {
            width: p.width,
            height: p.height,
            clientX: f.clientX,
            clientY: f.clientY
          });
        }
      }), this.lf.on("blank:contextmenu", function(i) {
        var o, a, s = i.position, l = (a = (o = r.menuTypeMap) === null || o === void 0 ? void 0 : o.get(ta)) !== null && a !== void 0 ? a : [], u = s.domOverlayPosition, f = u.x, c = u.y;
        r.showMenu(f, c, l);
      }), this.lf.on("selection:contextmenu", function(i) {
        var o, a = i.data, s = i.position, l = (o = r.menuTypeMap) === null || o === void 0 ? void 0 : o.get(Iv), u = s.domOverlayPosition, f = u.x, c = u.y;
        r.__currentData = a, r.showMenu(f, c, l);
      }), this.lf.on("node:mousedown", function() {
        r.__menuDOM.style.display = "none";
      }), this.lf.on("edge:click", function() {
        r.__menuDOM.style.display = "none";
      }), this.lf.on("blank:click", function() {
        r.__menuDOM.style.display = "none";
      }));
    }, t.prototype.destroy = function() {
      var e;
      this.__menuDOM && ((e = this === null || this === void 0 ? void 0 : this.__container) === null || e === void 0 || e.removeChild(this.__menuDOM), this.__menuDOM = void 0);
    }, t.prototype.showMenu = function(e, n, r, i) {
      if (!(!r || !r.length)) {
        var o = this.__menuDOM;
        if (o) {
          if (o.innerHTML = "", o.append.apply(o, uj([], lj(this.__getMenuDom(r)), !1)), !o.children.length)
            return;
          if (o.style.display = "block", !i) {
            o.style.top = "".concat(n, "px"), o.style.left = "".concat(e, "px");
            return;
          }
          var a = i.width, s = i.height, l = i.clientX, u = i.clientY, f = this.lf.graphModel, c = o.offsetWidth, d = !0, h = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth, v = h - l, p = f.rootEl.getBoundingClientRect(), g = p.left + p.width;
          g < h && (v = g - l), v < c && (d = !1), d ? o.style.left = "".concat(e, "px") : o.style.left = "".concat(e - a, "px");
          var y = o.offsetHeight, m = !0, A = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight, T = A - u, k = p.top + p.height;
          k < A && (T = k - u), T < y && (m = !1), m ? o.style.top = "".concat(n, "px") : o.style.top = "".concat(n - s, "px");
        }
      }
    }, t.prototype.setMenuByType = function(e) {
      var n, r = e.type, i = e.menu;
      !r || !i || (n = this.menuTypeMap) === null || n === void 0 || n.set(r, i);
    }, t.prototype.__getMenuDom = function(e) {
      var n = [];
      return e && e.length > 0 && e.forEach(function(r) {
        var i = document.createElement("li");
        if (r.className ? i.className = "lf-menu-item ".concat(r.className) : i.className = "lf-menu-item", r.icon === !0) {
          var o = document.createElement("span");
          o.className = "lf-menu-item-icon", i.appendChild(o);
        }
        var a = document.createElement("span");
        a.className = "lf-menu-item-text", r.text && (a.innerText = r.text), i.appendChild(a), i.onclickCallback = r.callback, n.push(i);
      }), n;
    }, t.prototype.setMenuConfig = function(e) {
      var n, r, i;
      e && (e.nodeMenu !== void 0 && ((n = this.menuTypeMap) === null || n === void 0 || n.set(Qo, e.nodeMenu ? e.nodeMenu : [])), e.edgeMenu !== void 0 && ((r = this.menuTypeMap) === null || r === void 0 || r.set(ea, e.edgeMenu ? e.edgeMenu : [])), e.graphMenu !== void 0 && ((i = this.menuTypeMap) === null || i === void 0 || i.set(ta, e.graphMenu ? e.graphMenu : [])));
    }, t.prototype.addMenuConfig = function(e) {
      var n, r, i, o, a, s, l, u, f;
      if (e) {
        if (Array.isArray(e.nodeMenu)) {
          var c = (r = (n = this.menuTypeMap) === null || n === void 0 ? void 0 : n.get(Qo)) !== null && r !== void 0 ? r : [];
          (i = this.menuTypeMap) === null || i === void 0 || i.set(Qo, c.concat(e.nodeMenu));
        }
        if (Array.isArray(e.edgeMenu)) {
          var c = (a = (o = this.menuTypeMap) === null || o === void 0 ? void 0 : o.get(ea)) !== null && a !== void 0 ? a : [];
          (s = this.menuTypeMap) === null || s === void 0 || s.set(ea, c.concat(e.edgeMenu));
        }
        if (Array.isArray(e.graphMenu)) {
          var c = (u = (l = this.menuTypeMap) === null || l === void 0 ? void 0 : l.get(ta)) !== null && u !== void 0 ? u : [];
          (f = this.menuTypeMap) === null || f === void 0 || f.set(ta, c.concat(e.graphMenu));
        }
      }
    }, t.prototype.changeMenuItem = function(e, n) {
      if (e === "add")
        this.addMenuConfig(n);
      else if (e === "reset")
        this.setMenuConfig(n);
      else
        throw new Error("The first parameter of changeMenuConfig should be 'add' or 'reset'");
    }, t.pluginName = "menu", t;
  }()
), cj = (
  /** @class */
  function() {
    function t(e) {
      var n = e.lf, r = this;
      this.lf = n, this.lf.setPatternItems = function(i) {
        r.setPatternItems(i);
      };
    }
    return t.prototype.render = function(e, n) {
      var r = this;
      if (this.destroy(), !this.shapeList || this.shapeList.length === 0) {
        this.domContainer = n;
        return;
      }
      this.panelEl = document.createElement("div"), this.panelEl.className = "lf-dndpanel", this.shapeList.forEach(function(i) {
        var o;
        (o = r.panelEl) === null || o === void 0 || o.appendChild(r.createDndItem(i));
      }), n.appendChild(this.panelEl), this.domContainer = n;
    }, t.prototype.destroy = function() {
      this.domContainer && this.panelEl && this.domContainer.contains(this.panelEl) && this.domContainer.removeChild(this.panelEl);
    }, t.prototype.setPatternItems = function(e) {
      this.shapeList = e, this.domContainer && this.render(this.lf, this.domContainer);
    }, t.prototype.createDndItem = function(e) {
      var n = this, r = document.createElement("div");
      r.className = e.className ? "lf-dnd-item ".concat(e.className) : "lf-dnd-item";
      var i = document.createElement("div");
      if (i.className = "lf-dnd-shape", e.icon && (i.style.backgroundImage = "url(".concat(e.icon, ")")), r.appendChild(i), e.label) {
        var o = document.createElement("div");
        o.innerText = e.label, o.className = "lf-dnd-text", r.appendChild(o);
      }
      return e.disabled ? (r.classList.add("disabled"), r.onmousedown = function() {
        e.callback && e.callback(n.lf, n.domContainer);
      }, r) : (r.onmousedown = function() {
        e.type && n.lf.dnd.startDrag({
          type: e.type,
          properties: e.properties,
          text: e.text
        }), e.callback && e.callback(n.lf, n.domContainer);
      }, r.ondblclick = function(a) {
        n.lf.graphModel.eventCenter.emit("dnd:panel-dbclick", {
          e: a,
          data: e
        });
      }, r.onclick = function(a) {
        n.lf.graphModel.eventCenter.emit("dnd:panel-click", {
          e: a,
          data: e
        });
      }, r.oncontextmenu = function(a) {
        n.lf.graphModel.eventCenter.emit("dnd:panel-contextmenu", {
          e: a,
          data: e
        });
      }, r);
    }, t.pluginName = "dndPanel", t;
  }()
);
var B_ = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), ao = function() {
  return ao = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, ao.apply(this, arguments);
}, Ea = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, dj = {
  tr: "tl",
  lb: "tl",
  tl: "tr",
  rb: "tr",
  br: "bl",
  lt: "bl",
  bl: "br",
  rt: "br"
};
function hj(t) {
  for (var e = t, n = 1; n < e.length - 1; ) {
    var r = Ea(e[n - 1], 2), i = r[0], o = r[1], a = Ea(e[n], 2), s = a[0], l = a[1], u = Ea(e[n + 1], 2), f = u[0], c = u[1];
    i === s && s === f || o === l && l === c ? e.splice(n, 1) : n++;
  }
  return e;
}
function pj(t, e, n, r) {
  var i = [t[0], t[1]], o = [t[0], t[1]];
  switch (n) {
    case "tl":
      return e === "tr" ? (i[1] += r, o[0] += r) : e === "lb" && (i[0] += r, o[1] += r), [i, o];
    case "tr":
      return e === "tl" ? (i[1] += r, o[0] -= r) : e === "rb" && (i[0] -= r, o[1] += r), [i, o];
    case "bl":
      return e === "br" ? (i[1] -= r, o[0] += r) : e === "lt" && (i[0] += r, o[1] -= r), [i, o];
    case "br":
      return e === "bl" ? (i[1] -= r, o[0] -= r) : e === "rt" && (i[0] -= r, o[1] -= r), [i, o];
    default:
      return [];
  }
}
function vj(t, e, n, r) {
  var i, o = "", a = "";
  t[0] === e[0] ? o = t[1] > e[1] ? "t" : "b" : t[1] === e[1] && (o = t[0] > e[0] ? "l" : "r"), e[0] === n[0] ? a = e[1] > n[1] ? "t" : "b" : e[1] === n[1] && (a = e[0] > n[0] ? "l" : "r");
  var s = Math.min(Math.hypot(e[0] - t[0], e[1] - t[1]) / 2, Math.hypot(n[0] - e[0], n[1] - e[1]) / 2, r) || 1 / 5 * r, l = "".concat(o).concat(a), u = dj[l] || "-", f = "L ".concat(t[0], " ").concat(t[1]);
  if (u === "-")
    f += "L ".concat(e[0], " ").concat(e[1], " L ").concat(n[0], " ").concat(n[1]);
  else {
    var c = Ea(pj(e, l, u, s), 2), d = c[0], h = c[1];
    d && h && (f += "L ".concat(d[0], " ").concat(d[1], " Q ").concat(e[0], " ").concat(e[1], " ").concat(h[0], " ").concat(h[1]), i = Ea(h, 2), e[0] = i[0], e[1] = i[1]);
  }
  return f;
}
function gj(t, e) {
  var n = 0, r = "";
  if (t.length === 2)
    r += "M".concat(t[n][0], " ").concat(t[n++][1], " L ").concat(t[n][0], " ").concat(t[n][1]);
  else {
    for (r += "M".concat(t[n][0], " ").concat(t[n++][1]); n + 1 < t.length; ) {
      var i = t[n - 1], o = t[n], a = t[n++ + 1];
      r += vj(i, o, a, e);
    }
    r += "L ".concat(t[n][0], " ").concat(t[n][1]);
  }
  return r;
}
(function(t) {
  B_(e, t);
  function e() {
    return t !== null && t.apply(this, arguments) || this;
  }
  return e.prototype.getEdge = function() {
    var n = this.props.model, r = n.points, i = n.isAnimation, o = n.arrowConfig, a = n.radius, s = a === void 0 ? 5 : a, l = n.getEdgeStyle(), u = n.getEdgeAnimationStyle(), f = hj(r.split(" ").map(function(h) {
      return h.split(",").map(function(v) {
        return +v;
      });
    })), c = gj(f, s), d = ao(ao(ao({ style: i ? u : {} }, l), o), { fill: "none" });
    return ae("path", ao({ d: c }, d));
  }, e;
})(Oo);
(function(t) {
  B_(e, t);
  function e() {
    return t !== null && t.apply(this, arguments) || this;
  }
  return e;
})(Eo);
var F_ = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), Sl = function() {
  return Sl = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Sl.apply(this, arguments);
}, jv = function(t, e) {
  var n = typeof Symbol == "function" && t[Symbol.iterator];
  if (!n) return t;
  var r = n.call(t), i, o = [], a;
  try {
    for (; (e === void 0 || e-- > 0) && !(i = r.next()).done; ) o.push(i.value);
  } catch (s) {
    a = { error: s };
  } finally {
    try {
      i && !i.done && (n = r.return) && n.call(r);
    } finally {
      if (a) throw a.error;
    }
  }
  return o;
}, kv = function(t, e, n) {
  if (n || arguments.length === 2) for (var r = 0, i = e.length, o; r < i; r++)
    (o || !(r in e)) && (o || (o = Array.prototype.slice.call(e, 0, r)), o[r] = e[r]);
  return t.concat(o || Array.prototype.slice.call(e));
}, yj = (
  /** @class */
  function(t) {
    F_(e, t);
    function e() {
      return t !== null && t.apply(this, arguments) || this;
    }
    return e.prototype.getLabelShape = function() {
      var n = this.props.model, r = n.id, i = n.x, o = n.y, a = n.width, s = n.height, l = n.properties, u = this.props.model.getNodeStyle();
      return ae("svg", {
        x: i - a / 2,
        y: o - s / 2,
        width: 50,
        height: 24,
        style: "z-index: 0; background: none; overflow: auto;"
      }, [
        l.labelText ? ae("text", {
          x: 0,
          y: -5,
          fontSize: "16px",
          fill: u.stroke
        }, l.labelText) : "",
        l.disabledDelete ? "" : ae("text", {
          x: l.labelText ? 50 : 0,
          y: -5,
          fontSize: "24px",
          cursor: "pointer",
          fill: u.stroke,
          onclick: this.handleCustomDeleteIconClick.bind(this, r)
        }, "x")
      ]);
    }, e.prototype.getShape = function() {
      var n = this.props.model, r = n.x, i = n.y, o = n.width, a = n.height, s = n.id, l = this.props.model.getNodeStyle();
      return ae("g", {}, [
        ae("rect", Sl(Sl({}, l), { x: r - o / 2, y: i - a / 2, width: o, height: a, id: s })),
        this.getLabelShape()
      ]);
    }, e.prototype.toFront = function() {
    }, e.prototype.handleCustomDeleteIconClick = function(n) {
      var r = this.props.graphModel;
      r.deleteNode(n);
    }, e;
  }(sl)
), mj = (
  /** @class */
  function(t) {
    F_(e, t);
    function e() {
      var n = t.apply(this, kv([], jv(arguments), !1)) || this;
      return n.d = 10, n.isResize = !1, n;
    }
    return e.prototype.initNodeData = function(n) {
      n.text = {
        value: "",
        x: n.x,
        y: n.y,
        draggable: !1,
        editable: !1
      }, t.prototype.initNodeData.call(this, n), this.zIndex = 0, this.draggable = !0;
    }, e.prototype.setAttributes = function() {
      var n = this, r;
      this.points = [], ((r = this.properties) === null || r === void 0 ? void 0 : r.node_selection_ids).length > 1 && setTimeout(function() {
        var i;
        n.updatePointsByNodes(((i = n.properties) === null || i === void 0 ? void 0 : i.node_selection_ids) || []);
      });
    }, e.prototype.getNodeStyle = function() {
      var n = t.prototype.getNodeStyle.call(this);
      return n.stroke = this.properties.strokeColor || "#008000", n.strokeDasharray = "10 5", n;
    }, e.prototype.getDefaultAnchor = function() {
      return [];
    }, e.prototype.updatePoints = function(n) {
      this.points = n;
    }, e.prototype.updateCoordinate = function(n) {
      var r = n.x, i = n.y;
      this.x = r, this.y = i;
    }, e.prototype.updatePointsByNodes = function(n) {
      var r = this, i = [], o = 1 / 0, a = 1 / 0, s = -1 / 0, l = -1 / 0;
      n.forEach(function(u) {
        var f = r.graphModel.getNodeModelById(u);
        if (f) {
          var c = f.width, d = f.height, h = f.x, v = f.y;
          o = Math.min(o, h - c / 2 - r.d), a = Math.min(a, v - d / 2 - r.d), s = Math.max(s, h + c / 2 + r.d), l = Math.max(l, v + d / 2 + r.d);
        }
      }), i.push([o, a], [s, a], [s, l], [o, l]), ![o, a, s, l].some(function(u) {
        return Math.abs(u) === 1 / 0;
      }) && (this.updatePoints(i), this.updateCoordinate({
        x: (s + o) / 2,
        y: (l + a) / 2
      }));
    }, e.prototype.resize = function(n) {
      var r;
      this.isResize = !0;
      for (var i = n.width, o = n.height, a = {
        x: i / this.width,
        y: o / this.height
      }, s = (this.properties.node_selection_ids || []).slice(), l = [], u = /* @__PURE__ */ new Set(); s.length; ) {
        var f = s.shift(), c = (r = this.graphModel.nodesMap[f]) === null || r === void 0 ? void 0 : r.model;
        if (c) {
          if (!Ds(c)) {
            l.push(c);
            continue;
          }
          u.has(c.id) || (u.add(c.id), s.push.apply(s, kv([], jv(c.properties.node_selection_ids || []), !1)));
        }
      }
      var d = {
        x: this.x - this.width / 2,
        y: this.y - this.height / 2
      }, h = t.prototype.resize.call(this, n), v = {
        x: this.x - this.width / 2,
        y: this.y - this.height / 2
      };
      return l.forEach(function(p) {
        p.width = p.width * a.x, p.height = p.height * a.y;
        var g = (p.x - d.x) * a.x + v.x - p.x, y = (p.y - d.y) * a.y + v.y - p.y;
        p.move(g, y, !0);
      }), this.isResize = !1, h;
    }, e;
  }(rl)
), tc = "node-selection";
(function() {
  function t(e) {
    var n = e.lf;
    this.selectNodes = [], this.d = 10, this.lf = n, n.register({
      type: tc,
      view: yj,
      model: mj
    });
  }
  return Object.defineProperty(t.prototype, "selectNodesIds", {
    /**
     * 获取所选node的id数组
     */
    get: function() {
      return this.selectNodes.map(function(e) {
        return e.id;
      });
    },
    enumerable: !1,
    configurable: !0
  }), t.prototype.addNodeSelection = function() {
    var e = this.lf.addNode({
      type: "node-selection",
      text: "",
      properties: {
        node_selection_ids: this.selectNodesIds
      },
      x: 0,
      y: 0
    });
    e.updatePointsByNodes(this.selectNodesIds);
  }, t.prototype.updateNodeSelection = function() {
    var e, n = this.getNodeSelection();
    n && (this.lf.setProperties(n.id, {
      node_selection_ids: this.selectNodesIds
    }), (e = this.lf.getNodeModelById(n.id)) === null || e === void 0 || e.updatePointsByNodes(this.selectNodesIds));
  }, t.prototype.getNodeSelection = function() {
    var e = this, n = this.selectNodesIds, r = this.lf.getGraphRawData(), i = n.filter(function(o) {
      return o !== e.currentClickNode.id;
    });
    return r.nodes.find(function(o) {
      if (o.type === "node-selection") {
        var a = Io(o, "properties.node_selection_ids", []);
        return i.every(function(s) {
          return a.includes(s);
        });
      }
      return !1;
    });
  }, t.prototype.onNodeChange = function(e, n) {
    var r = e.graphModel.nodes.filter(function(i) {
      if (!Ds(i))
        return !1;
      var o = i.properties.node_selection_ids || [];
      return o.includes(n.id);
    });
    Promise.resolve().then(function() {
      r.forEach(function(i) {
        i.updatePointsByNodes(i.properties.node_selection_ids || []);
      });
    });
  }, t.prototype.render = function(e) {
    var n = this;
    this.lf = e, e.on("node:click", function(r) {
      var i;
      if (!(!r.e.shiftKey || r.data.type === tc)) {
        n.currentClickNode = r.data;
        var o = !1;
        n.selectNodesIds.includes(r.data.id) && ((i = n.lf.getNodeModelById(r.data.id)) === null || i === void 0 || i.setSelected(!1), o = !0);
        var a = e.getSelectElements(!0).nodes;
        n.selectNodes = a, n.selectNodes.length === 1 ? o ? n.updateNodeSelection() : n.addNodeSelection() : n.selectNodes.length > 1 && n.updateNodeSelection();
      }
    }), e.graphModel.addNodeMoveRules(function(r, i, o) {
      if (n.onNodeChange(e, r), Ds(r) && !r.isResize) {
        var a = r.properties.node_selection_ids || [];
        return e.graphModel.moveNodes(a, i, o, !0), !0;
      }
      return !0;
    }), e.graphModel.addNodeResizeRules(function(r) {
      return Ds(r) || n.onNodeChange(e, r), !0;
    });
  }, t.pluginName = "node-selection", t;
})();
var Ds = function(t) {
  return !!(t && t.type === tc);
}, _j = /* @__PURE__ */ function() {
  var t = function(e, n) {
    return t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(r, i) {
      r.__proto__ = i;
    } || function(r, i) {
      for (var o in i) Object.prototype.hasOwnProperty.call(i, o) && (r[o] = i[o]);
    }, t(e, n);
  };
  return function(e, n) {
    if (typeof n != "function" && n !== null)
      throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
    t(e, n);
    function r() {
      this.constructor = e;
    }
    e.prototype = n === null ? Object.create(n) : (r.prototype = n.prototype, new r());
  };
}(), Ol = function() {
  return Ol = Object.assign || function(t) {
    for (var e, n = 1, r = arguments.length; n < r; n++) {
      e = arguments[n];
      for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]);
    }
    return t;
  }, Ol.apply(this, arguments);
};
(function(t) {
  _j(e, t);
  function e() {
    return t !== null && t.apply(this, arguments) || this;
  }
  return e.prototype.getLabelShape = function() {
    var n = this.props.model, r = n.x, i = n.y, o = n.width, a = n.height, s = n.properties;
    return ae("text", {
      x: r - o / 2 + 5,
      y: i - a / 2 + 16,
      fontSize: 12,
      fill: "blue"
    }, s.moreText);
  }, e.prototype.getShape = function() {
    var n = this.props.model, r = n.x, i = n.y, o = n.width, a = n.height, s = this.props.model.getNodeStyle();
    return ae("g", {}, [
      ae("rect", Ol(Ol({}, s), { fill: "#FFFFFF", x: r - o / 2, y: i - a / 2 })),
      this.getLabelShape()
    ]);
  }, e;
})(pr);
const bj = /* @__PURE__ */ H_({
  __name: "index",
  setup(t, { expose: e }) {
    Zo.use(cj), Zo.use(sj), Zo.use(N4), Zo.use(fj);
    const n = wd(), r = wd();
    W_("LF", r);
    function i() {
      var s, l, u, f, c, d;
      n.value && (r.value = new Zo({
        container: n.value,
        grid: !0,
        edgeTextDraggable: !0,
        stopScrollGraph: !0,
        stopZoomGraph: !0,
        // 节点拖拽结束后，自动吸附
        autoFocus: !0,
        //节点拖拽结束后，自动吸附
        // plugins: [DndPanel, Menu, BPMNElements, BPMNAdapter]
        style: {
          // 设置默认样式（主题）
          baseEdge: {
            stroke: "#000",
            strokeWidth: 1.5
          }
        }
      }), Array.isArray(Qi) && r.value && (Qi == null || Qi.forEach((h) => {
        var v;
        (v = r.value) == null || v.register(h);
      })), Array.isArray(_s) && r.value && (_s == null || _s.forEach((h) => {
        var v;
        (v = r.value) == null || v.register(h);
      })), (l = (s = r.value) == null ? void 0 : s.extension.dndPanel) == null || l.setPatternItems(Qi), (f = (u = r.value) == null ? void 0 : u.extension.control) == null || f.addItem({
        key: "download",
        iconClass: "custom-icon custom-download",
        title: "下载XML",
        text: "下载",
        onClick: () => {
          var v, p, g;
          const h = ((v = r.value) == null ? void 0 : v.adapterOut) && ((g = r.value) == null ? void 0 : g.adapterOut((p = r.value) == null ? void 0 : p.getGraphRawData()));
          debugger;
          o("logic-flow.bpmn", h), console.log("object");
        }
      }), (d = (c = r.value) == null ? void 0 : c.extension.control) == null || d.addItem({
        key: "clear",
        iconClass: "custom-icon custom-clear",
        title: "清空画布",
        text: "清空",
        onClick: () => {
          var h;
          (h = r.value) == null || h.clearData();
        }
      }), r.value.render({}));
    }
    function o(s, l) {
      var u = document.createElement("a");
      u.setAttribute("href", "data:text/plain;charset=utf-8," + encodeURIComponent(l)), u.setAttribute("download", s), u.style.display = "none", document.body.appendChild(u), u.click(), document.body.removeChild(u);
    }
    function a(s) {
      var c, d, h;
      if (!r.value || !r.value.adapterIn || !r.value.render) return;
      (c = r.value) == null || c.clearData();
      let l = (d = r.value) == null ? void 0 : d.adapterIn(s);
      console.log(l);
      let { edges: u, nodes: f } = l;
      u.forEach((v) => {
        v.startPoint = v.pointsList[0], v.endPoint = v.pointsList[v.pointsList.length - 1];
      }), f.forEach((v) => {
        console.log(Qi), ["bpmn:dataImportTask", "bpmn:processorTask"].some((g) => g === v.type) && (v.x = v.x + v.properties.width / 2, v.y = v.y + v.properties.height / 2);
      }), (h = r.value) == null || h.renderRawData({ edges: u, nodes: f });
    }
    return z_(() => {
      i();
    }), e({ renderData: a }), (s, l) => (G_(), X_("div", {
      id: "container",
      ref_key: "container",
      ref: n
    }, null, 512));
  }
}), xj = (t, e) => {
  const n = t.__vccOpts || t;
  for (const [r, i] of e)
    n[r] = i;
  return n;
}, Ej = /* @__PURE__ */ xj(bj, [["__scopeId", "data-v-140f5a1f"]]), Bv = Ej;
Bv.install = function(t) {
  t.component("FlowDesigner", Bv);
};
export {
  Bv as default
};
